"use strict";(self.webpackChunk_folio_stripes_components=self.webpackChunk_folio_stripes_components||[]).push([[2658],{"./node_modules/downshift/dist/downshift.esm.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{eval("\n// EXPORTS\n__webpack_require__.d(__webpack_exports__, {\n  Bp: () => (/* binding */ useCombobox),\n  mH: () => (/* binding */ useMultipleSelection)\n});\n\n// UNUSED EXPORTS: default, resetIdCounter, useSelect\n\n// EXTERNAL MODULE: ./node_modules/@babel/runtime/helpers/esm/objectWithoutPropertiesLoose.js\nvar objectWithoutPropertiesLoose = __webpack_require__(\"./node_modules/@babel/runtime/helpers/esm/objectWithoutPropertiesLoose.js\");\n// EXTERNAL MODULE: ./node_modules/@babel/runtime/helpers/esm/extends.js\nvar esm_extends = __webpack_require__(\"./node_modules/@babel/runtime/helpers/esm/extends.js\");\n// EXTERNAL MODULE: ./node_modules/prop-types/index.js\nvar prop_types = __webpack_require__(\"./node_modules/prop-types/index.js\");\nvar prop_types_default = /*#__PURE__*/__webpack_require__.n(prop_types);\n// EXTERNAL MODULE: ./node_modules/react/index.js\nvar react = __webpack_require__(\"./node_modules/react/index.js\");\n// EXTERNAL MODULE: ./node_modules/downshift/node_modules/react-is/index.js\nvar react_is = __webpack_require__(\"./node_modules/downshift/node_modules/react-is/index.js\");\n;// ./node_modules/compute-scroll-into-view/dist/index.js\nconst t=t=>\"object\"==typeof t&&null!=t&&1===t.nodeType,e=(t,e)=>(!e||\"hidden\"!==t)&&(\"visible\"!==t&&\"clip\"!==t),n=(t,n)=>{if(t.clientHeight<t.scrollHeight||t.clientWidth<t.scrollWidth){const o=getComputedStyle(t,null);return e(o.overflowY,n)||e(o.overflowX,n)||(t=>{const e=(t=>{if(!t.ownerDocument||!t.ownerDocument.defaultView)return null;try{return t.ownerDocument.defaultView.frameElement}catch(t){return null}})(t);return!!e&&(e.clientHeight<t.scrollHeight||e.clientWidth<t.scrollWidth)})(t)}return!1},o=(t,e,n,o,l,r,i,s)=>r<t&&i>e||r>t&&i<e?0:r<=t&&s<=n||i>=e&&s>=n?r-t-o:i>e&&s<n||r<t&&s>n?i-e+l:0,l=t=>{const e=t.parentElement;return null==e?t.getRootNode().host||null:e},r=(e,r)=>{var i,s,d,h;if(\"undefined\"==typeof document)return[];const{scrollMode:c,block:f,inline:u,boundary:a,skipOverflowHiddenElements:g}=r,p=\"function\"==typeof a?a:t=>t!==a;if(!t(e))throw new TypeError(\"Invalid target\");const m=document.scrollingElement||document.documentElement,w=[];let W=e;for(;t(W)&&p(W);){if(W=l(W),W===m){w.push(W);break}null!=W&&W===document.body&&n(W)&&!n(document.documentElement)||null!=W&&n(W,g)&&w.push(W)}const b=null!=(s=null==(i=window.visualViewport)?void 0:i.width)?s:innerWidth,H=null!=(h=null==(d=window.visualViewport)?void 0:d.height)?h:innerHeight,{scrollX:y,scrollY:M}=window,{height:v,width:E,top:x,right:C,bottom:I,left:R}=e.getBoundingClientRect(),{top:T,right:B,bottom:F,left:V}=(t=>{const e=window.getComputedStyle(t);return{top:parseFloat(e.scrollMarginTop)||0,right:parseFloat(e.scrollMarginRight)||0,bottom:parseFloat(e.scrollMarginBottom)||0,left:parseFloat(e.scrollMarginLeft)||0}})(e);let k=\"start\"===f||\"nearest\"===f?x-T:\"end\"===f?I+F:x+v/2-T+F,D=\"center\"===u?R+E/2-V+B:\"end\"===u?C+B:R-V;const L=[];for(let t=0;t<w.length;t++){const e=w[t],{height:l,width:r,top:i,right:s,bottom:d,left:h}=e.getBoundingClientRect();if(\"if-needed\"===c&&x>=0&&R>=0&&I<=H&&C<=b&&(e===m&&!n(e)||x>=i&&I<=d&&R>=h&&C<=s))return L;const a=getComputedStyle(e),g=parseInt(a.borderLeftWidth,10),p=parseInt(a.borderTopWidth,10),W=parseInt(a.borderRightWidth,10),T=parseInt(a.borderBottomWidth,10);let B=0,F=0;const V=\"offsetWidth\"in e?e.offsetWidth-e.clientWidth-g-W:0,S=\"offsetHeight\"in e?e.offsetHeight-e.clientHeight-p-T:0,X=\"offsetWidth\"in e?0===e.offsetWidth?0:r/e.offsetWidth:0,Y=\"offsetHeight\"in e?0===e.offsetHeight?0:l/e.offsetHeight:0;if(m===e)B=\"start\"===f?k:\"end\"===f?k-H:\"nearest\"===f?o(M,M+H,H,p,T,M+k,M+k+v,v):k-H/2,F=\"start\"===u?D:\"center\"===u?D-b/2:\"end\"===u?D-b:o(y,y+b,b,g,W,y+D,y+D+E,E),B=Math.max(0,B+M),F=Math.max(0,F+y);else{B=\"start\"===f?k-i-p:\"end\"===f?k-d+T+S:\"nearest\"===f?o(i,d,l,p,T+S,k,k+v,v):k-(i+l/2)+S/2,F=\"start\"===u?D-h-g:\"center\"===u?D-(h+r/2)+V/2:\"end\"===u?D-s+W+V:o(h,s,r,g,W+V,D,D+E,E);const{scrollLeft:t,scrollTop:n}=e;B=0===Y?0:Math.max(0,Math.min(n+B/Y,e.scrollHeight-l/Y+S)),F=0===X?0:Math.max(0,Math.min(t+F/X,e.scrollWidth-r/X+V)),k+=n-B,D+=t-F}L.push({el:e,top:B,left:F})}return L};//# sourceMappingURL=index.js.map\n\n// EXTERNAL MODULE: ./node_modules/tslib/tslib.es6.mjs\nvar tslib_es6 = __webpack_require__(\"./node_modules/tslib/tslib.es6.mjs\");\n;// ./node_modules/downshift/dist/downshift.esm.js\n\n\n\n\n\n\n\n\n\nvar idCounter = 0;\n\n/**\n * Accepts a parameter and returns it if it's a function\n * or a noop function if it's not. This allows us to\n * accept a callback, but not worry about it if it's not\n * passed.\n * @param {Function} cb the callback\n * @return {Function} a function\n */\nfunction cbToCb(cb) {\n  return typeof cb === 'function' ? cb : noop;\n}\nfunction noop() {}\n\n/**\n * Scroll node into view if necessary\n * @param {HTMLElement} node the element that should scroll into view\n * @param {HTMLElement} menuNode the menu element of the component\n */\nfunction scrollIntoView(node, menuNode) {\n  if (!node) {\n    return;\n  }\n  var actions = r(node, {\n    boundary: menuNode,\n    block: 'nearest',\n    scrollMode: 'if-needed'\n  });\n  actions.forEach(function (_ref) {\n    var el = _ref.el,\n      top = _ref.top,\n      left = _ref.left;\n    el.scrollTop = top;\n    el.scrollLeft = left;\n  });\n}\n\n/**\n * @param {HTMLElement} parent the parent node\n * @param {HTMLElement} child the child node\n * @param {Window} environment The window context where downshift renders.\n * @return {Boolean} whether the parent is the child or the child is in the parent\n */\nfunction isOrContainsNode(parent, child, environment) {\n  var result = parent === child || child instanceof environment.Node && parent.contains && parent.contains(child);\n  return result;\n}\n\n/**\n * Simple debounce implementation. Will call the given\n * function once after the time given has passed since\n * it was last called.\n * @param {Function} fn the function to call after the time\n * @param {Number} time the time to wait\n * @return {Function} the debounced function\n */\nfunction debounce(fn, time) {\n  var timeoutId;\n  function cancel() {\n    if (timeoutId) {\n      clearTimeout(timeoutId);\n    }\n  }\n  function wrapper() {\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n    cancel();\n    timeoutId = setTimeout(function () {\n      timeoutId = null;\n      fn.apply(void 0, args);\n    }, time);\n  }\n  wrapper.cancel = cancel;\n  return wrapper;\n}\n\n/**\n * This is intended to be used to compose event handlers.\n * They are executed in order until one of them sets\n * `event.preventDownshiftDefault = true`.\n * @param {...Function} fns the event handler functions\n * @return {Function} the event handler to add to an element\n */\nfunction callAllEventHandlers() {\n  for (var _len2 = arguments.length, fns = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n    fns[_key2] = arguments[_key2];\n  }\n  return function (event) {\n    for (var _len3 = arguments.length, args = new Array(_len3 > 1 ? _len3 - 1 : 0), _key3 = 1; _key3 < _len3; _key3++) {\n      args[_key3 - 1] = arguments[_key3];\n    }\n    return fns.some(function (fn) {\n      if (fn) {\n        fn.apply(void 0, [event].concat(args));\n      }\n      return event.preventDownshiftDefault || event.hasOwnProperty('nativeEvent') && event.nativeEvent.preventDownshiftDefault;\n    });\n  };\n}\nfunction handleRefs() {\n  for (var _len4 = arguments.length, refs = new Array(_len4), _key4 = 0; _key4 < _len4; _key4++) {\n    refs[_key4] = arguments[_key4];\n  }\n  return function (node) {\n    refs.forEach(function (ref) {\n      if (typeof ref === 'function') {\n        ref(node);\n      } else if (ref) {\n        ref.current = node;\n      }\n    });\n  };\n}\n\n/**\n * This generates a unique ID for an instance of Downshift\n * @return {String} the unique ID\n */\nfunction generateId() {\n  return String(idCounter++);\n}\n\n/**\n * Resets idCounter to 0. Used for SSR.\n */\nfunction resetIdCounter() {\n  // istanbul ignore next\n  if ('useId' in React) {\n    console.warn(\"It is not necessary to call resetIdCounter when using React 18+\");\n    return;\n  }\n  idCounter = 0;\n}\n\n/**\n * Default implementation for status message. Only added when menu is open.\n * Will specify if there are results in the list, and if so, how many,\n * and what keys are relevant.\n *\n * @param {Object} param the downshift state and other relevant properties\n * @return {String} the a11y status message\n */\nfunction getA11yStatusMessage(_ref2) {\n  var isOpen = _ref2.isOpen,\n    resultCount = _ref2.resultCount,\n    previousResultCount = _ref2.previousResultCount;\n  if (!isOpen) {\n    return '';\n  }\n  if (!resultCount) {\n    return 'No results are available.';\n  }\n  if (resultCount !== previousResultCount) {\n    return resultCount + \" result\" + (resultCount === 1 ? ' is' : 's are') + \" available, use up and down arrow keys to navigate. Press Enter key to select.\";\n  }\n  return '';\n}\n\n/**\n * Takes an argument and if it's an array, returns the first item in the array\n * otherwise returns the argument\n * @param {*} arg the maybe-array\n * @param {*} defaultValue the value if arg is falsey not defined\n * @return {*} the arg or it's first item\n */\nfunction unwrapArray(arg, defaultValue) {\n  arg = Array.isArray(arg) ? /* istanbul ignore next (preact) */arg[0] : arg;\n  if (!arg && defaultValue) {\n    return defaultValue;\n  } else {\n    return arg;\n  }\n}\n\n/**\n * @param {Object} element (P)react element\n * @return {Boolean} whether it's a DOM element\n */\nfunction isDOMElement(element) {\n\n  // then we assume this is react\n  return typeof element.type === 'string';\n}\n\n/**\n * @param {Object} element (P)react element\n * @return {Object} the props\n */\nfunction getElementProps(element) {\n  return element.props;\n}\n\n/**\n * Throws a helpful error message for required properties. Useful\n * to be used as a default in destructuring or object params.\n * @param {String} fnName the function name\n * @param {String} propName the prop name\n */\nfunction requiredProp(fnName, propName) {\n  // eslint-disable-next-line no-console\n  console.error(\"The property \\\"\" + propName + \"\\\" is required in \\\"\" + fnName + \"\\\"\");\n}\nvar stateKeys = (/* unused pure expression or super */ null && (['highlightedIndex', 'inputValue', 'isOpen', 'selectedItem', 'type']));\n/**\n * @param {Object} state the state object\n * @return {Object} state that is relevant to downshift\n */\nfunction pickState(state) {\n  if (state === void 0) {\n    state = {};\n  }\n  var result = {};\n  stateKeys.forEach(function (k) {\n    if (state.hasOwnProperty(k)) {\n      result[k] = state[k];\n    }\n  });\n  return result;\n}\n\n/**\n * This will perform a shallow merge of the given state object\n * with the state coming from props\n * (for the controlled component scenario)\n * This is used in state updater functions so they're referencing\n * the right state regardless of where it comes from.\n *\n * @param {Object} state The state of the component/hook.\n * @param {Object} props The props that may contain controlled values.\n * @returns {Object} The merged controlled state.\n */\nfunction getState(state, props) {\n  if (!state || !props) {\n    return state;\n  }\n  return Object.keys(state).reduce(function (prevState, key) {\n    prevState[key] = isControlledProp(props, key) ? props[key] : state[key];\n    return prevState;\n  }, {});\n}\n\n/**\n * This determines whether a prop is a \"controlled prop\" meaning it is\n * state which is controlled by the outside of this component rather\n * than within this component.\n *\n * @param {Object} props The props that may contain controlled values.\n * @param {String} key the key to check\n * @return {Boolean} whether it is a controlled controlled prop\n */\nfunction isControlledProp(props, key) {\n  return props[key] !== undefined;\n}\n\n/**\n * Normalizes the 'key' property of a KeyboardEvent in IE/Edge\n * @param {Object} event a keyboardEvent object\n * @return {String} keyboard key\n */\nfunction normalizeArrowKey(event) {\n  var key = event.key,\n    keyCode = event.keyCode;\n  /* istanbul ignore next (ie) */\n  if (keyCode >= 37 && keyCode <= 40 && key.indexOf('Arrow') !== 0) {\n    return \"Arrow\" + key;\n  }\n  return key;\n}\n\n/**\n * Simple check if the value passed is object literal\n * @param {*} obj any things\n * @return {Boolean} whether it's object literal\n */\nfunction isPlainObject(obj) {\n  return Object.prototype.toString.call(obj) === '[object Object]';\n}\n\n/**\n * Returns the next non-disabled highlightedIndex value.\n *\n * @param {number} start The current highlightedIndex.\n * @param {number} offset The offset from the current highlightedIndex to start searching.\n * @param {unknown[]} items The items array.\n * @param {(item: unknown, index: number) => boolean} isItemDisabled Function that tells if an item is disabled or not.\n * @param {boolean?} circular If the search reaches the end, if it can search again starting from the other end.\n * @returns {number} The next highlightedIndex.\n */\nfunction getHighlightedIndex(start, offset, items, isItemDisabled, circular) {\n  if (circular === void 0) {\n    circular = false;\n  }\n  var count = items.length;\n  if (count === 0) {\n    return -1;\n  }\n  var itemsLastIndex = count - 1;\n  if (typeof start !== 'number' || start < 0 || start > itemsLastIndex) {\n    start = offset > 0 ? -1 : itemsLastIndex + 1;\n  }\n  var current = start + offset;\n  if (current < 0) {\n    current = circular ? itemsLastIndex : 0;\n  } else if (current > itemsLastIndex) {\n    current = circular ? 0 : itemsLastIndex;\n  }\n  var highlightedIndex = getNonDisabledIndex(current, offset < 0, items, isItemDisabled, circular);\n  if (highlightedIndex === -1) {\n    return start >= count ? -1 : start;\n  }\n  return highlightedIndex;\n}\n\n/**\n * Returns the next non-disabled highlightedIndex value.\n *\n * @param {number} start The current highlightedIndex.\n * @param {boolean} backwards If true, it will search backwards from the start.\n * @param {unknown[]} items The items array.\n * @param {(item: unknown, index: number) => boolean} isItemDisabled Function that tells if an item is disabled or not.\n * @param {boolean} circular If the search reaches the end, if it can search again starting from the other end.\n * @returns {number} The next non-disabled index.\n */\nfunction getNonDisabledIndex(start, backwards, items, isItemDisabled, circular) {\n  if (circular === void 0) {\n    circular = false;\n  }\n  var count = items.length;\n  if (backwards) {\n    for (var index = start; index >= 0; index--) {\n      if (!isItemDisabled(items[index], index)) {\n        return index;\n      }\n    }\n  } else {\n    for (var _index = start; _index < count; _index++) {\n      if (!isItemDisabled(items[_index], _index)) {\n        return _index;\n      }\n    }\n  }\n  if (circular) {\n    return getNonDisabledIndex(backwards ? count - 1 : 0, backwards, items, isItemDisabled);\n  }\n  return -1;\n}\n\n/**\n * Checks if event target is within the downshift elements.\n *\n * @param {EventTarget} target Target to check.\n * @param {HTMLElement[]} downshiftElements The elements that form downshift (list, toggle button etc).\n * @param {Window} environment The window context where downshift renders.\n * @param {boolean} checkActiveElement Whether to also check activeElement.\n *\n * @returns {boolean} Whether or not the target is within downshift elements.\n */\nfunction targetWithinDownshift(target, downshiftElements, environment, checkActiveElement) {\n  if (checkActiveElement === void 0) {\n    checkActiveElement = true;\n  }\n  return environment && downshiftElements.some(function (contextNode) {\n    return contextNode && (isOrContainsNode(contextNode, target, environment) || checkActiveElement && isOrContainsNode(contextNode, environment.document.activeElement, environment));\n  });\n}\n\n// eslint-disable-next-line import/no-mutable-exports\nvar validateControlledUnchanged = (/* unused pure expression or super */ null && (noop));\n/* istanbul ignore next */\nif (false) {}\n\nvar cleanupStatus = debounce(function (documentProp) {\n  getStatusDiv(documentProp).textContent = '';\n}, 500);\n\n/**\n * Get the status node or create it if it does not already exist.\n * @param {Object} documentProp document passed by the user.\n * @return {HTMLElement} the status node.\n */\nfunction getStatusDiv(documentProp) {\n  var statusDiv = documentProp.getElementById('a11y-status-message');\n  if (statusDiv) {\n    return statusDiv;\n  }\n  statusDiv = documentProp.createElement('div');\n  statusDiv.setAttribute('id', 'a11y-status-message');\n  statusDiv.setAttribute('role', 'status');\n  statusDiv.setAttribute('aria-live', 'polite');\n  statusDiv.setAttribute('aria-relevant', 'additions text');\n  Object.assign(statusDiv.style, {\n    border: '0',\n    clip: 'rect(0 0 0 0)',\n    height: '1px',\n    margin: '-1px',\n    overflow: 'hidden',\n    padding: '0',\n    position: 'absolute',\n    width: '1px'\n  });\n  documentProp.body.appendChild(statusDiv);\n  return statusDiv;\n}\n\n/**\n * @param {String} status the status message\n * @param {Object} documentProp document passed by the user.\n */\nfunction setStatus(status, documentProp) {\n  if (!status || !documentProp) {\n    return;\n  }\n  var div = getStatusDiv(documentProp);\n  div.textContent = status;\n  cleanupStatus(documentProp);\n}\n\n/**\n * Removes the status element from the DOM\n * @param {Document} documentProp \n */\nfunction cleanupStatusDiv(documentProp) {\n  var statusDiv = documentProp == null ? void 0 : documentProp.getElementById('a11y-status-message');\n  if (statusDiv) {\n    statusDiv.remove();\n  }\n}\n\nvar unknown =  false ? 0 : 0;\nvar mouseUp =  false ? 0 : 1;\nvar itemMouseEnter =  false ? 0 : 2;\nvar keyDownArrowUp =  false ? 0 : 3;\nvar keyDownArrowDown =  false ? 0 : 4;\nvar keyDownEscape =  false ? 0 : 5;\nvar keyDownEnter =  false ? 0 : 6;\nvar keyDownHome =  false ? 0 : 7;\nvar keyDownEnd =  false ? 0 : 8;\nvar clickItem =  false ? 0 : 9;\nvar blurInput =  false ? 0 : 10;\nvar changeInput =  false ? 0 : 11;\nvar keyDownSpaceButton =  false ? 0 : 12;\nvar clickButton =  false ? 0 : 13;\nvar blurButton =  false ? 0 : 14;\nvar controlledPropUpdatedSelectedItem =  false ? 0 : 15;\nvar touchEnd =  false ? 0 : 16;\n\nvar stateChangeTypes$3 = /*#__PURE__*/Object.freeze({\n  __proto__: null,\n  blurButton: blurButton,\n  blurInput: blurInput,\n  changeInput: changeInput,\n  clickButton: clickButton,\n  clickItem: clickItem,\n  controlledPropUpdatedSelectedItem: controlledPropUpdatedSelectedItem,\n  itemMouseEnter: itemMouseEnter,\n  keyDownArrowDown: keyDownArrowDown,\n  keyDownArrowUp: keyDownArrowUp,\n  keyDownEnd: keyDownEnd,\n  keyDownEnter: keyDownEnter,\n  keyDownEscape: keyDownEscape,\n  keyDownHome: keyDownHome,\n  keyDownSpaceButton: keyDownSpaceButton,\n  mouseUp: mouseUp,\n  touchEnd: touchEnd,\n  unknown: unknown\n});\n\nvar _excluded$3 = (/* unused pure expression or super */ null && ([\"refKey\", \"ref\"])),\n  _excluded2$3 = (/* unused pure expression or super */ null && ([\"onClick\", \"onPress\", \"onKeyDown\", \"onKeyUp\", \"onBlur\"])),\n  _excluded3$2 = (/* unused pure expression or super */ null && ([\"onKeyDown\", \"onBlur\", \"onChange\", \"onInput\", \"onChangeText\"])),\n  _excluded4$2 = (/* unused pure expression or super */ null && ([\"refKey\", \"ref\"])),\n  _excluded5 = (/* unused pure expression or super */ null && ([\"onMouseMove\", \"onMouseDown\", \"onClick\", \"onPress\", \"index\", \"item\"]));\nvar Downshift = /*#__PURE__*/(/* unused pure expression or super */ null && (function () {\n  var Downshift = /*#__PURE__*/function (_Component) {\n    function Downshift(_props) {\n      var _this;\n      _this = _Component.call(this, _props) || this;\n      // fancy destructuring + defaults + aliases\n      // this basically says each value of state should either be set to\n      // the initial value or the default value if the initial value is not provided\n      _this.id = _this.props.id || \"downshift-\" + generateId();\n      _this.menuId = _this.props.menuId || _this.id + \"-menu\";\n      _this.labelId = _this.props.labelId || _this.id + \"-label\";\n      _this.inputId = _this.props.inputId || _this.id + \"-input\";\n      _this.getItemId = _this.props.getItemId || function (index) {\n        return _this.id + \"-item-\" + index;\n      };\n      _this.items = [];\n      // itemCount can be changed asynchronously\n      // from within downshift (so it can't come from a prop)\n      // this is why we store it as an instance and use\n      // getItemCount rather than just use items.length\n      // (to support windowing + async)\n      _this.itemCount = null;\n      _this.previousResultCount = 0;\n      _this.timeoutIds = [];\n      /**\n       * @param {Function} fn the function to call after the time\n       * @param {Number} time the time to wait\n       */\n      _this.internalSetTimeout = function (fn, time) {\n        var id = setTimeout(function () {\n          _this.timeoutIds = _this.timeoutIds.filter(function (i) {\n            return i !== id;\n          });\n          fn();\n        }, time);\n        _this.timeoutIds.push(id);\n      };\n      _this.setItemCount = function (count) {\n        _this.itemCount = count;\n      };\n      _this.unsetItemCount = function () {\n        _this.itemCount = null;\n      };\n      _this.isItemDisabled = function (_item, index) {\n        var currentElementNode = _this.getItemNodeFromIndex(index);\n        return currentElementNode && currentElementNode.hasAttribute('disabled');\n      };\n      _this.setHighlightedIndex = function (highlightedIndex, otherStateToSet) {\n        if (highlightedIndex === void 0) {\n          highlightedIndex = _this.props.defaultHighlightedIndex;\n        }\n        if (otherStateToSet === void 0) {\n          otherStateToSet = {};\n        }\n        otherStateToSet = pickState(otherStateToSet);\n        _this.internalSetState(_extends({\n          highlightedIndex: highlightedIndex\n        }, otherStateToSet));\n      };\n      _this.clearSelection = function (cb) {\n        _this.internalSetState({\n          selectedItem: null,\n          inputValue: '',\n          highlightedIndex: _this.props.defaultHighlightedIndex,\n          isOpen: _this.props.defaultIsOpen\n        }, cb);\n      };\n      _this.selectItem = function (item, otherStateToSet, cb) {\n        otherStateToSet = pickState(otherStateToSet);\n        _this.internalSetState(_extends({\n          isOpen: _this.props.defaultIsOpen,\n          highlightedIndex: _this.props.defaultHighlightedIndex,\n          selectedItem: item,\n          inputValue: _this.props.itemToString(item)\n        }, otherStateToSet), cb);\n      };\n      _this.selectItemAtIndex = function (itemIndex, otherStateToSet, cb) {\n        var item = _this.items[itemIndex];\n        if (item == null) {\n          return;\n        }\n        _this.selectItem(item, otherStateToSet, cb);\n      };\n      _this.selectHighlightedItem = function (otherStateToSet, cb) {\n        return _this.selectItemAtIndex(_this.getState().highlightedIndex, otherStateToSet, cb);\n      };\n      // any piece of our state can live in two places:\n      // 1. Uncontrolled: it's internal (this.state)\n      //    We will call this.setState to update that state\n      // 2. Controlled: it's external (this.props)\n      //    We will call this.props.onStateChange to update that state\n      //\n      // In addition, we'll call this.props.onChange if the\n      // selectedItem is changed.\n      _this.internalSetState = function (stateToSet, cb) {\n        var isItemSelected, onChangeArg;\n        var onStateChangeArg = {};\n        var isStateToSetFunction = typeof stateToSet === 'function';\n\n        // we want to call `onInputValueChange` before the `setState` call\n        // so someone controlling the `inputValue` state gets notified of\n        // the input change as soon as possible. This avoids issues with\n        // preserving the cursor position.\n        // See https://github.com/downshift-js/downshift/issues/217 for more info.\n        if (!isStateToSetFunction && stateToSet.hasOwnProperty('inputValue')) {\n          _this.props.onInputValueChange(stateToSet.inputValue, _extends({}, _this.getStateAndHelpers(), stateToSet));\n        }\n        return _this.setState(function (state) {\n          var _newStateToSet;\n          state = _this.getState(state);\n          var newStateToSet = isStateToSetFunction ? stateToSet(state) : stateToSet;\n\n          // Your own function that could modify the state that will be set.\n          newStateToSet = _this.props.stateReducer(state, newStateToSet);\n\n          // checks if an item is selected, regardless of if it's different from\n          // what was selected before\n          // used to determine if onSelect and onChange callbacks should be called\n          isItemSelected = newStateToSet.hasOwnProperty('selectedItem');\n          // this keeps track of the object we want to call with setState\n          var nextState = {};\n          // we need to call on change if the outside world is controlling any of our state\n          // and we're trying to update that state. OR if the selection has changed and we're\n          // trying to update the selection\n          if (isItemSelected && newStateToSet.selectedItem !== state.selectedItem) {\n            onChangeArg = newStateToSet.selectedItem;\n          }\n          (_newStateToSet = newStateToSet).type || (_newStateToSet.type = unknown);\n          Object.keys(newStateToSet).forEach(function (key) {\n            // onStateChangeArg should only have the state that is\n            // actually changing\n            if (state[key] !== newStateToSet[key]) {\n              onStateChangeArg[key] = newStateToSet[key];\n            }\n            // the type is useful for the onStateChangeArg\n            // but we don't actually want to set it in internal state.\n            // this is an undocumented feature for now... Not all internalSetState\n            // calls support it and I'm not certain we want them to yet.\n            // But it enables users controlling the isOpen state to know when\n            // the isOpen state changes due to mouseup events which is quite handy.\n            if (key === 'type') {\n              return;\n            }\n            newStateToSet[key];\n            // if it's coming from props, then we don't care to set it internally\n            if (!isControlledProp(_this.props, key)) {\n              nextState[key] = newStateToSet[key];\n            }\n          });\n\n          // if stateToSet is a function, then we weren't able to call onInputValueChange\n          // earlier, so we'll call it now that we know what the inputValue state will be.\n          if (isStateToSetFunction && newStateToSet.hasOwnProperty('inputValue')) {\n            _this.props.onInputValueChange(newStateToSet.inputValue, _extends({}, _this.getStateAndHelpers(), newStateToSet));\n          }\n          return nextState;\n        }, function () {\n          // call the provided callback if it's a function\n          cbToCb(cb)();\n\n          // only call the onStateChange and onChange callbacks if\n          // we have relevant information to pass them.\n          var hasMoreStateThanType = Object.keys(onStateChangeArg).length > 1;\n          if (hasMoreStateThanType) {\n            _this.props.onStateChange(onStateChangeArg, _this.getStateAndHelpers());\n          }\n          if (isItemSelected) {\n            _this.props.onSelect(stateToSet.selectedItem, _this.getStateAndHelpers());\n          }\n          if (onChangeArg !== undefined) {\n            _this.props.onChange(onChangeArg, _this.getStateAndHelpers());\n          }\n          // this is currently undocumented and therefore subject to change\n          // We'll try to not break it, but just be warned.\n          _this.props.onUserAction(onStateChangeArg, _this.getStateAndHelpers());\n        });\n      };\n      //////////////////////////// ROOT\n      _this.rootRef = function (node) {\n        return _this._rootNode = node;\n      };\n      _this.getRootProps = function (_temp, _temp2) {\n        var _extends2;\n        var _ref = _temp === void 0 ? {} : _temp,\n          _ref$refKey = _ref.refKey,\n          refKey = _ref$refKey === void 0 ? 'ref' : _ref$refKey,\n          ref = _ref.ref,\n          rest = _objectWithoutPropertiesLoose(_ref, _excluded$3);\n        var _ref2 = _temp2 === void 0 ? {} : _temp2,\n          _ref2$suppressRefErro = _ref2.suppressRefError,\n          suppressRefError = _ref2$suppressRefErro === void 0 ? false : _ref2$suppressRefErro;\n        // this is used in the render to know whether the user has called getRootProps.\n        // It uses that to know whether to apply the props automatically\n        _this.getRootProps.called = true;\n        _this.getRootProps.refKey = refKey;\n        _this.getRootProps.suppressRefError = suppressRefError;\n        var _this$getState = _this.getState(),\n          isOpen = _this$getState.isOpen;\n        return _extends((_extends2 = {}, _extends2[refKey] = handleRefs(ref, _this.rootRef), _extends2.role = 'combobox', _extends2['aria-expanded'] = isOpen, _extends2['aria-haspopup'] = 'listbox', _extends2['aria-owns'] = isOpen ? _this.menuId : undefined, _extends2['aria-labelledby'] = _this.labelId, _extends2), rest);\n      };\n      //\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\ ROOT\n      _this.keyDownHandlers = {\n        ArrowDown: function ArrowDown(event) {\n          var _this2 = this;\n          event.preventDefault();\n          if (this.getState().isOpen) {\n            var amount = event.shiftKey ? 5 : 1;\n            this.moveHighlightedIndex(amount, {\n              type: keyDownArrowDown\n            });\n          } else {\n            this.internalSetState({\n              isOpen: true,\n              type: keyDownArrowDown\n            }, function () {\n              var itemCount = _this2.getItemCount();\n              if (itemCount > 0) {\n                var _this2$getState = _this2.getState(),\n                  highlightedIndex = _this2$getState.highlightedIndex;\n                var nextHighlightedIndex = getHighlightedIndex(highlightedIndex, 1, {\n                  length: itemCount\n                }, _this2.isItemDisabled, true);\n                _this2.setHighlightedIndex(nextHighlightedIndex, {\n                  type: keyDownArrowDown\n                });\n              }\n            });\n          }\n        },\n        ArrowUp: function ArrowUp(event) {\n          var _this3 = this;\n          event.preventDefault();\n          if (this.getState().isOpen) {\n            var amount = event.shiftKey ? -5 : -1;\n            this.moveHighlightedIndex(amount, {\n              type: keyDownArrowUp\n            });\n          } else {\n            this.internalSetState({\n              isOpen: true,\n              type: keyDownArrowUp\n            }, function () {\n              var itemCount = _this3.getItemCount();\n              if (itemCount > 0) {\n                var _this3$getState = _this3.getState(),\n                  highlightedIndex = _this3$getState.highlightedIndex;\n                var nextHighlightedIndex = getHighlightedIndex(highlightedIndex, -1, {\n                  length: itemCount\n                }, _this3.isItemDisabled, true);\n                _this3.setHighlightedIndex(nextHighlightedIndex, {\n                  type: keyDownArrowUp\n                });\n              }\n            });\n          }\n        },\n        Enter: function Enter(event) {\n          if (event.which === 229) {\n            return;\n          }\n          var _this$getState2 = this.getState(),\n            isOpen = _this$getState2.isOpen,\n            highlightedIndex = _this$getState2.highlightedIndex;\n          if (isOpen && highlightedIndex != null) {\n            event.preventDefault();\n            var item = this.items[highlightedIndex];\n            var itemNode = this.getItemNodeFromIndex(highlightedIndex);\n            if (item == null || itemNode && itemNode.hasAttribute('disabled')) {\n              return;\n            }\n            this.selectHighlightedItem({\n              type: keyDownEnter\n            });\n          }\n        },\n        Escape: function Escape(event) {\n          event.preventDefault();\n          this.reset(_extends({\n            type: keyDownEscape\n          }, !this.state.isOpen && {\n            selectedItem: null,\n            inputValue: ''\n          }));\n        }\n      };\n      //////////////////////////// BUTTON\n      _this.buttonKeyDownHandlers = _extends({}, _this.keyDownHandlers, {\n        ' ': function _(event) {\n          event.preventDefault();\n          this.toggleMenu({\n            type: keyDownSpaceButton\n          });\n        }\n      });\n      _this.inputKeyDownHandlers = _extends({}, _this.keyDownHandlers, {\n        Home: function Home(event) {\n          var _this$getState3 = this.getState(),\n            isOpen = _this$getState3.isOpen;\n          if (!isOpen) {\n            return;\n          }\n          event.preventDefault();\n          var itemCount = this.getItemCount();\n          if (itemCount <= 0 || !isOpen) {\n            return;\n          }\n\n          // get next non-disabled starting downwards from 0 if that's disabled.\n          var newHighlightedIndex = getNonDisabledIndex(0, false, {\n            length: itemCount\n          }, this.isItemDisabled);\n          this.setHighlightedIndex(newHighlightedIndex, {\n            type: keyDownHome\n          });\n        },\n        End: function End(event) {\n          var _this$getState4 = this.getState(),\n            isOpen = _this$getState4.isOpen;\n          if (!isOpen) {\n            return;\n          }\n          event.preventDefault();\n          var itemCount = this.getItemCount();\n          if (itemCount <= 0 || !isOpen) {\n            return;\n          }\n\n          // get next non-disabled starting upwards from last index if that's disabled.\n          var newHighlightedIndex = getNonDisabledIndex(itemCount - 1, true, {\n            length: itemCount\n          }, this.isItemDisabled);\n          this.setHighlightedIndex(newHighlightedIndex, {\n            type: keyDownEnd\n          });\n        }\n      });\n      _this.getToggleButtonProps = function (_temp3) {\n        var _ref3 = _temp3 === void 0 ? {} : _temp3,\n          onClick = _ref3.onClick;\n          _ref3.onPress;\n          var onKeyDown = _ref3.onKeyDown,\n          onKeyUp = _ref3.onKeyUp,\n          onBlur = _ref3.onBlur,\n          rest = _objectWithoutPropertiesLoose(_ref3, _excluded2$3);\n        var _this$getState5 = _this.getState(),\n          isOpen = _this$getState5.isOpen;\n        var enabledEventHandlers = {\n          onClick: callAllEventHandlers(onClick, _this.buttonHandleClick),\n          onKeyDown: callAllEventHandlers(onKeyDown, _this.buttonHandleKeyDown),\n          onKeyUp: callAllEventHandlers(onKeyUp, _this.buttonHandleKeyUp),\n          onBlur: callAllEventHandlers(onBlur, _this.buttonHandleBlur)\n        };\n        var eventHandlers = rest.disabled ? {} : enabledEventHandlers;\n        return _extends({\n          type: 'button',\n          role: 'button',\n          'aria-label': isOpen ? 'close menu' : 'open menu',\n          'aria-haspopup': true,\n          'data-toggle': true\n        }, eventHandlers, rest);\n      };\n      _this.buttonHandleKeyUp = function (event) {\n        // Prevent click event from emitting in Firefox\n        event.preventDefault();\n      };\n      _this.buttonHandleKeyDown = function (event) {\n        var key = normalizeArrowKey(event);\n        if (_this.buttonKeyDownHandlers[key]) {\n          _this.buttonKeyDownHandlers[key].call(_this, event);\n        }\n      };\n      _this.buttonHandleClick = function (event) {\n        event.preventDefault();\n        // handle odd case for Safari and Firefox which\n        // don't give the button the focus properly.\n        /* istanbul ignore if (can't reasonably test this) */\n        if (_this.props.environment) {\n          var _this$props$environme = _this.props.environment.document,\n            body = _this$props$environme.body,\n            activeElement = _this$props$environme.activeElement;\n          if (body && body === activeElement) {\n            event.target.focus();\n          }\n        }\n        // to simplify testing components that use downshift, we'll not wrap this in a setTimeout\n        // if the NODE_ENV is test. With the proper build system, this should be dead code eliminated\n        // when building for production and should therefore have no impact on production code.\n        if (false) {} else {\n          // Ensure that toggle of menu occurs after the potential blur event in iOS\n          _this.internalSetTimeout(function () {\n            return _this.toggleMenu({\n              type: clickButton\n            });\n          });\n        }\n      };\n      _this.buttonHandleBlur = function (event) {\n        var blurTarget = event.target; // Save blur target for comparison with activeElement later\n        // Need setTimeout, so that when the user presses Tab, the activeElement is the next focused element, not body element\n        _this.internalSetTimeout(function () {\n          if (_this.isMouseDown || !_this.props.environment) {\n            return;\n          }\n          var activeElement = _this.props.environment.document.activeElement;\n          if ((activeElement == null || activeElement.id !== _this.inputId) && activeElement !== blurTarget // Do nothing if we refocus the same element again (to solve issue in Safari on iOS)\n          ) {\n            _this.reset({\n              type: blurButton\n            });\n          }\n        });\n      };\n      //\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\ BUTTON\n      /////////////////////////////// LABEL\n      _this.getLabelProps = function (props) {\n        return _extends({\n          htmlFor: _this.inputId,\n          id: _this.labelId\n        }, props);\n      };\n      //\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\ LABEL\n      /////////////////////////////// INPUT\n      _this.getInputProps = function (_temp4) {\n        var _ref4 = _temp4 === void 0 ? {} : _temp4,\n          onKeyDown = _ref4.onKeyDown,\n          onBlur = _ref4.onBlur,\n          onChange = _ref4.onChange,\n          onInput = _ref4.onInput;\n          _ref4.onChangeText;\n          var rest = _objectWithoutPropertiesLoose(_ref4, _excluded3$2);\n        var onChangeKey;\n        var eventHandlers = {};\n\n        /* istanbul ignore next (preact) */\n        {\n          onChangeKey = 'onChange';\n        }\n        var _this$getState6 = _this.getState(),\n          inputValue = _this$getState6.inputValue,\n          isOpen = _this$getState6.isOpen,\n          highlightedIndex = _this$getState6.highlightedIndex;\n        if (!rest.disabled) {\n          var _eventHandlers;\n          eventHandlers = (_eventHandlers = {}, _eventHandlers[onChangeKey] = callAllEventHandlers(onChange, onInput, _this.inputHandleChange), _eventHandlers.onKeyDown = callAllEventHandlers(onKeyDown, _this.inputHandleKeyDown), _eventHandlers.onBlur = callAllEventHandlers(onBlur, _this.inputHandleBlur), _eventHandlers);\n        }\n        return _extends({\n          'aria-autocomplete': 'list',\n          'aria-activedescendant': isOpen && typeof highlightedIndex === 'number' && highlightedIndex >= 0 ? _this.getItemId(highlightedIndex) : undefined,\n          'aria-controls': isOpen ? _this.menuId : undefined,\n          'aria-labelledby': rest && rest['aria-label'] ? undefined : _this.labelId,\n          // https://developer.mozilla.org/en-US/docs/Web/Security/Securing_your_site/Turning_off_form_autocompletion\n          // revert back since autocomplete=\"nope\" is ignored on latest Chrome and Opera\n          autoComplete: 'off',\n          value: inputValue,\n          id: _this.inputId\n        }, eventHandlers, rest);\n      };\n      _this.inputHandleKeyDown = function (event) {\n        var key = normalizeArrowKey(event);\n        if (key && _this.inputKeyDownHandlers[key]) {\n          _this.inputKeyDownHandlers[key].call(_this, event);\n        }\n      };\n      _this.inputHandleChange = function (event) {\n        _this.internalSetState({\n          type: changeInput,\n          isOpen: true,\n          inputValue: event.target.value,\n          highlightedIndex: _this.props.defaultHighlightedIndex\n        });\n      };\n      _this.inputHandleBlur = function () {\n        // Need setTimeout, so that when the user presses Tab, the activeElement is the next focused element, not the body element\n        _this.internalSetTimeout(function () {\n          var _activeElement$datase;\n          if (_this.isMouseDown || !_this.props.environment) {\n            return;\n          }\n          var activeElement = _this.props.environment.document.activeElement;\n          var downshiftButtonIsActive = (activeElement == null || (_activeElement$datase = activeElement.dataset) == null ? void 0 : _activeElement$datase.toggle) && _this._rootNode && _this._rootNode.contains(activeElement);\n          if (!downshiftButtonIsActive) {\n            _this.reset({\n              type: blurInput\n            });\n          }\n        });\n      };\n      //\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\ INPUT\n      /////////////////////////////// MENU\n      _this.menuRef = function (node) {\n        _this._menuNode = node;\n      };\n      _this.getMenuProps = function (_temp5, _temp6) {\n        var _extends3;\n        var _ref5 = _temp5 === void 0 ? {} : _temp5,\n          _ref5$refKey = _ref5.refKey,\n          refKey = _ref5$refKey === void 0 ? 'ref' : _ref5$refKey,\n          ref = _ref5.ref,\n          props = _objectWithoutPropertiesLoose(_ref5, _excluded4$2);\n        var _ref6 = _temp6 === void 0 ? {} : _temp6,\n          _ref6$suppressRefErro = _ref6.suppressRefError,\n          suppressRefError = _ref6$suppressRefErro === void 0 ? false : _ref6$suppressRefErro;\n        _this.getMenuProps.called = true;\n        _this.getMenuProps.refKey = refKey;\n        _this.getMenuProps.suppressRefError = suppressRefError;\n        return _extends((_extends3 = {}, _extends3[refKey] = handleRefs(ref, _this.menuRef), _extends3.role = 'listbox', _extends3['aria-labelledby'] = props && props['aria-label'] ? undefined : _this.labelId, _extends3.id = _this.menuId, _extends3), props);\n      };\n      //\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\ MENU\n      /////////////////////////////// ITEM\n      _this.getItemProps = function (_temp7) {\n        var _enabledEventHandlers;\n        var _ref7 = _temp7 === void 0 ? {} : _temp7,\n          onMouseMove = _ref7.onMouseMove,\n          onMouseDown = _ref7.onMouseDown,\n          onClick = _ref7.onClick;\n          _ref7.onPress;\n          var index = _ref7.index,\n          _ref7$item = _ref7.item,\n          item = _ref7$item === void 0 ?  true ? /* istanbul ignore next */undefined : 0 : _ref7$item,\n          rest = _objectWithoutPropertiesLoose(_ref7, _excluded5);\n        if (index === undefined) {\n          _this.items.push(item);\n          index = _this.items.indexOf(item);\n        } else {\n          _this.items[index] = item;\n        }\n        var onSelectKey = 'onClick';\n        var customClickHandler = onClick;\n        var enabledEventHandlers = (_enabledEventHandlers = {\n          // onMouseMove is used over onMouseEnter here. onMouseMove\n          // is only triggered on actual mouse movement while onMouseEnter\n          // can fire on DOM changes, interrupting keyboard navigation\n          onMouseMove: callAllEventHandlers(onMouseMove, function () {\n            if (index === _this.getState().highlightedIndex) {\n              return;\n            }\n            _this.setHighlightedIndex(index, {\n              type: itemMouseEnter\n            });\n\n            // We never want to manually scroll when changing state based\n            // on `onMouseMove` because we will be moving the element out\n            // from under the user which is currently scrolling/moving the\n            // cursor\n            _this.avoidScrolling = true;\n            _this.internalSetTimeout(function () {\n              return _this.avoidScrolling = false;\n            }, 250);\n          }),\n          onMouseDown: callAllEventHandlers(onMouseDown, function (event) {\n            // This prevents the activeElement from being changed\n            // to the item so it can remain with the current activeElement\n            // which is a more common use case.\n            event.preventDefault();\n          })\n        }, _enabledEventHandlers[onSelectKey] = callAllEventHandlers(customClickHandler, function () {\n          _this.selectItemAtIndex(index, {\n            type: clickItem\n          });\n        }), _enabledEventHandlers);\n\n        // Passing down the onMouseDown handler to prevent redirect\n        // of the activeElement if clicking on disabled items\n        var eventHandlers = rest.disabled ? {\n          onMouseDown: enabledEventHandlers.onMouseDown\n        } : enabledEventHandlers;\n        return _extends({\n          id: _this.getItemId(index),\n          role: 'option',\n          'aria-selected': _this.getState().highlightedIndex === index\n        }, eventHandlers, rest);\n      };\n      //\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\ ITEM\n      _this.clearItems = function () {\n        _this.items = [];\n      };\n      _this.reset = function (otherStateToSet, cb) {\n        if (otherStateToSet === void 0) {\n          otherStateToSet = {};\n        }\n        otherStateToSet = pickState(otherStateToSet);\n        _this.internalSetState(function (_ref8) {\n          var selectedItem = _ref8.selectedItem;\n          return _extends({\n            isOpen: _this.props.defaultIsOpen,\n            highlightedIndex: _this.props.defaultHighlightedIndex,\n            inputValue: _this.props.itemToString(selectedItem)\n          }, otherStateToSet);\n        }, cb);\n      };\n      _this.toggleMenu = function (otherStateToSet, cb) {\n        if (otherStateToSet === void 0) {\n          otherStateToSet = {};\n        }\n        otherStateToSet = pickState(otherStateToSet);\n        _this.internalSetState(function (_ref9) {\n          var isOpen = _ref9.isOpen;\n          return _extends({\n            isOpen: !isOpen\n          }, isOpen && {\n            highlightedIndex: _this.props.defaultHighlightedIndex\n          }, otherStateToSet);\n        }, function () {\n          var _this$getState7 = _this.getState(),\n            isOpen = _this$getState7.isOpen,\n            highlightedIndex = _this$getState7.highlightedIndex;\n          if (isOpen) {\n            if (_this.getItemCount() > 0 && typeof highlightedIndex === 'number') {\n              _this.setHighlightedIndex(highlightedIndex, otherStateToSet);\n            }\n          }\n          cbToCb(cb)();\n        });\n      };\n      _this.openMenu = function (cb) {\n        _this.internalSetState({\n          isOpen: true\n        }, cb);\n      };\n      _this.closeMenu = function (cb) {\n        _this.internalSetState({\n          isOpen: false\n        }, cb);\n      };\n      _this.updateStatus = debounce(function () {\n        var _this$props;\n        if (!((_this$props = _this.props) != null && (_this$props = _this$props.environment) != null && _this$props.document)) {\n          return;\n        }\n        var state = _this.getState();\n        var item = _this.items[state.highlightedIndex];\n        var resultCount = _this.getItemCount();\n        var status = _this.props.getA11yStatusMessage(_extends({\n          itemToString: _this.props.itemToString,\n          previousResultCount: _this.previousResultCount,\n          resultCount: resultCount,\n          highlightedItem: item\n        }, state));\n        _this.previousResultCount = resultCount;\n        setStatus(status, _this.props.environment.document);\n      }, 200);\n      var _this$props2 = _this.props,\n        defaultHighlightedIndex = _this$props2.defaultHighlightedIndex,\n        _this$props2$initialH = _this$props2.initialHighlightedIndex,\n        _highlightedIndex = _this$props2$initialH === void 0 ? defaultHighlightedIndex : _this$props2$initialH,\n        defaultIsOpen = _this$props2.defaultIsOpen,\n        _this$props2$initialI = _this$props2.initialIsOpen,\n        _isOpen = _this$props2$initialI === void 0 ? defaultIsOpen : _this$props2$initialI,\n        _this$props2$initialI2 = _this$props2.initialInputValue,\n        _inputValue = _this$props2$initialI2 === void 0 ? '' : _this$props2$initialI2,\n        _this$props2$initialS = _this$props2.initialSelectedItem,\n        _selectedItem = _this$props2$initialS === void 0 ? null : _this$props2$initialS;\n      var _state = _this.getState({\n        highlightedIndex: _highlightedIndex,\n        isOpen: _isOpen,\n        inputValue: _inputValue,\n        selectedItem: _selectedItem\n      });\n      if (_state.selectedItem != null && _this.props.initialInputValue === undefined) {\n        _state.inputValue = _this.props.itemToString(_state.selectedItem);\n      }\n      _this.state = _state;\n      return _this;\n    }\n    _inheritsLoose(Downshift, _Component);\n    var _proto = Downshift.prototype;\n    /**\n     * Clear all running timeouts\n     */\n    _proto.internalClearTimeouts = function internalClearTimeouts() {\n      this.timeoutIds.forEach(function (id) {\n        clearTimeout(id);\n      });\n      this.timeoutIds = [];\n    }\n\n    /**\n     * Gets the state based on internal state or props\n     * If a state value is passed via props, then that\n     * is the value given, otherwise it's retrieved from\n     * stateToMerge\n     *\n     * @param {Object} stateToMerge defaults to this.state\n     * @return {Object} the state\n     */;\n    _proto.getState = function getState$1(stateToMerge) {\n      if (stateToMerge === void 0) {\n        stateToMerge = this.state;\n      }\n      return getState(stateToMerge, this.props);\n    };\n    _proto.getItemCount = function getItemCount() {\n      // things read better this way. They're in priority order:\n      // 1. `this.itemCount`\n      // 2. `this.props.itemCount`\n      // 3. `this.items.length`\n      var itemCount = this.items.length;\n      if (this.itemCount != null) {\n        itemCount = this.itemCount;\n      } else if (this.props.itemCount !== undefined) {\n        itemCount = this.props.itemCount;\n      }\n      return itemCount;\n    };\n    _proto.getItemNodeFromIndex = function getItemNodeFromIndex(index) {\n      return this.props.environment ? this.props.environment.document.getElementById(this.getItemId(index)) : null;\n    };\n    _proto.scrollHighlightedItemIntoView = function scrollHighlightedItemIntoView() {\n      /* istanbul ignore else (react-native) */\n      {\n        var node = this.getItemNodeFromIndex(this.getState().highlightedIndex);\n        this.props.scrollIntoView(node, this._menuNode);\n      }\n    };\n    _proto.moveHighlightedIndex = function moveHighlightedIndex(amount, otherStateToSet) {\n      var itemCount = this.getItemCount();\n      var _this$getState8 = this.getState(),\n        highlightedIndex = _this$getState8.highlightedIndex;\n      if (itemCount > 0) {\n        var nextHighlightedIndex = getHighlightedIndex(highlightedIndex, amount, {\n          length: itemCount\n        }, this.isItemDisabled, true);\n        this.setHighlightedIndex(nextHighlightedIndex, otherStateToSet);\n      }\n    };\n    _proto.getStateAndHelpers = function getStateAndHelpers() {\n      var _this$getState9 = this.getState(),\n        highlightedIndex = _this$getState9.highlightedIndex,\n        inputValue = _this$getState9.inputValue,\n        selectedItem = _this$getState9.selectedItem,\n        isOpen = _this$getState9.isOpen;\n      var itemToString = this.props.itemToString;\n      var id = this.id;\n      var getRootProps = this.getRootProps,\n        getToggleButtonProps = this.getToggleButtonProps,\n        getLabelProps = this.getLabelProps,\n        getMenuProps = this.getMenuProps,\n        getInputProps = this.getInputProps,\n        getItemProps = this.getItemProps,\n        openMenu = this.openMenu,\n        closeMenu = this.closeMenu,\n        toggleMenu = this.toggleMenu,\n        selectItem = this.selectItem,\n        selectItemAtIndex = this.selectItemAtIndex,\n        selectHighlightedItem = this.selectHighlightedItem,\n        setHighlightedIndex = this.setHighlightedIndex,\n        clearSelection = this.clearSelection,\n        clearItems = this.clearItems,\n        reset = this.reset,\n        setItemCount = this.setItemCount,\n        unsetItemCount = this.unsetItemCount,\n        setState = this.internalSetState;\n      return {\n        // prop getters\n        getRootProps: getRootProps,\n        getToggleButtonProps: getToggleButtonProps,\n        getLabelProps: getLabelProps,\n        getMenuProps: getMenuProps,\n        getInputProps: getInputProps,\n        getItemProps: getItemProps,\n        // actions\n        reset: reset,\n        openMenu: openMenu,\n        closeMenu: closeMenu,\n        toggleMenu: toggleMenu,\n        selectItem: selectItem,\n        selectItemAtIndex: selectItemAtIndex,\n        selectHighlightedItem: selectHighlightedItem,\n        setHighlightedIndex: setHighlightedIndex,\n        clearSelection: clearSelection,\n        clearItems: clearItems,\n        setItemCount: setItemCount,\n        unsetItemCount: unsetItemCount,\n        setState: setState,\n        // props\n        itemToString: itemToString,\n        // derived\n        id: id,\n        // state\n        highlightedIndex: highlightedIndex,\n        inputValue: inputValue,\n        isOpen: isOpen,\n        selectedItem: selectedItem\n      };\n    };\n    _proto.componentDidMount = function componentDidMount() {\n      var _this4 = this;\n      /* istanbul ignore if (react-native) */\n      if (false) {}\n\n      /* istanbul ignore if (react-native or SSR) */\n      if (!this.props.environment) {\n        this.cleanup = function () {\n          _this4.internalClearTimeouts();\n        };\n      } else {\n        // this.isMouseDown helps us track whether the mouse is currently held down.\n        // This is useful when the user clicks on an item in the list, but holds the mouse\n        // down long enough for the list to disappear (because the blur event fires on the input)\n        // this.isMouseDown is used in the blur handler on the input to determine whether the blur event should\n        // trigger hiding the menu.\n        var onMouseDown = function onMouseDown() {\n          _this4.isMouseDown = true;\n        };\n        var onMouseUp = function onMouseUp(event) {\n          _this4.isMouseDown = false;\n          // if the target element or the activeElement is within a downshift node\n          // then we don't want to reset downshift\n          var contextWithinDownshift = targetWithinDownshift(event.target, [_this4._rootNode, _this4._menuNode], _this4.props.environment);\n          if (!contextWithinDownshift && _this4.getState().isOpen) {\n            _this4.reset({\n              type: mouseUp\n            }, function () {\n              return _this4.props.onOuterClick(_this4.getStateAndHelpers());\n            });\n          }\n        };\n        // Touching an element in iOS gives focus and hover states, but touching out of\n        // the element will remove hover, and persist the focus state, resulting in the\n        // blur event not being triggered.\n        // this.isTouchMove helps us track whether the user is tapping or swiping on a touch screen.\n        // If the user taps outside of Downshift, the component should be reset,\n        // but not if the user is swiping\n        var onTouchStart = function onTouchStart() {\n          _this4.isTouchMove = false;\n        };\n        var onTouchMove = function onTouchMove() {\n          _this4.isTouchMove = true;\n        };\n        var onTouchEnd = function onTouchEnd(event) {\n          var contextWithinDownshift = targetWithinDownshift(event.target, [_this4._rootNode, _this4._menuNode], _this4.props.environment, false);\n          if (!_this4.isTouchMove && !contextWithinDownshift && _this4.getState().isOpen) {\n            _this4.reset({\n              type: touchEnd\n            }, function () {\n              return _this4.props.onOuterClick(_this4.getStateAndHelpers());\n            });\n          }\n        };\n        var environment = this.props.environment;\n        environment.addEventListener('mousedown', onMouseDown);\n        environment.addEventListener('mouseup', onMouseUp);\n        environment.addEventListener('touchstart', onTouchStart);\n        environment.addEventListener('touchmove', onTouchMove);\n        environment.addEventListener('touchend', onTouchEnd);\n        this.cleanup = function () {\n          _this4.internalClearTimeouts();\n          _this4.updateStatus.cancel();\n          environment.removeEventListener('mousedown', onMouseDown);\n          environment.removeEventListener('mouseup', onMouseUp);\n          environment.removeEventListener('touchstart', onTouchStart);\n          environment.removeEventListener('touchmove', onTouchMove);\n          environment.removeEventListener('touchend', onTouchEnd);\n        };\n      }\n    };\n    _proto.shouldScroll = function shouldScroll(prevState, prevProps) {\n      var _ref10 = this.props.highlightedIndex === undefined ? this.getState() : this.props,\n        currentHighlightedIndex = _ref10.highlightedIndex;\n      var _ref11 = prevProps.highlightedIndex === undefined ? prevState : prevProps,\n        prevHighlightedIndex = _ref11.highlightedIndex;\n      var scrollWhenOpen = currentHighlightedIndex && this.getState().isOpen && !prevState.isOpen;\n      var scrollWhenNavigating = currentHighlightedIndex !== prevHighlightedIndex;\n      return scrollWhenOpen || scrollWhenNavigating;\n    };\n    _proto.componentDidUpdate = function componentDidUpdate(prevProps, prevState) {\n      if (false) {}\n      if (isControlledProp(this.props, 'selectedItem') && this.props.selectedItemChanged(prevProps.selectedItem, this.props.selectedItem)) {\n        this.internalSetState({\n          type: controlledPropUpdatedSelectedItem,\n          inputValue: this.props.itemToString(this.props.selectedItem)\n        });\n      }\n      if (!this.avoidScrolling && this.shouldScroll(prevState, prevProps)) {\n        this.scrollHighlightedItemIntoView();\n      }\n\n      /* istanbul ignore else (react-native) */\n      {\n        this.updateStatus();\n      }\n    };\n    _proto.componentWillUnmount = function componentWillUnmount() {\n      this.cleanup(); // avoids memory leak\n    };\n    _proto.render = function render() {\n      var children = unwrapArray(this.props.children, noop);\n      // because the items are rerendered every time we call the children\n      // we clear this out each render and it will be populated again as\n      // getItemProps is called.\n      this.clearItems();\n      // we reset this so we know whether the user calls getRootProps during\n      // this render. If they do then we don't need to do anything,\n      // if they don't then we need to clone the element they return and\n      // apply the props for them.\n      this.getRootProps.called = false;\n      this.getRootProps.refKey = undefined;\n      this.getRootProps.suppressRefError = undefined;\n      // we do something similar for getMenuProps\n      this.getMenuProps.called = false;\n      this.getMenuProps.refKey = undefined;\n      this.getMenuProps.suppressRefError = undefined;\n      // we do something similar for getLabelProps\n      this.getLabelProps.called = false;\n      // and something similar for getInputProps\n      this.getInputProps.called = false;\n      var element = unwrapArray(children(this.getStateAndHelpers()));\n      if (!element) {\n        return null;\n      }\n      if (this.getRootProps.called || this.props.suppressRefError) {\n        if (false) {}\n        return element;\n      } else if (isDOMElement(element)) {\n        // they didn't apply the root props, but we can clone\n        // this and apply the props ourselves\n        return /*#__PURE__*/cloneElement(element, this.getRootProps(getElementProps(element)));\n      }\n\n      /* istanbul ignore else */\n      if (false) {}\n\n      /* istanbul ignore next */\n      return undefined;\n    };\n    return Downshift;\n  }(Component);\n  Downshift.defaultProps = {\n    defaultHighlightedIndex: null,\n    defaultIsOpen: false,\n    getA11yStatusMessage: getA11yStatusMessage,\n    itemToString: function itemToString(i) {\n      if (i == null) {\n        return '';\n      }\n      if (false) {}\n      return String(i);\n    },\n    onStateChange: noop,\n    onInputValueChange: noop,\n    onUserAction: noop,\n    onChange: noop,\n    onSelect: noop,\n    onOuterClick: noop,\n    selectedItemChanged: function selectedItemChanged(prevItem, item) {\n      return prevItem !== item;\n    },\n    environment: /* istanbul ignore next (ssr) */\n    typeof window === 'undefined' || false ? undefined : window,\n    stateReducer: function stateReducer(state, stateToSet) {\n      return stateToSet;\n    },\n    suppressRefError: false,\n    scrollIntoView: scrollIntoView\n  };\n  Downshift.stateChangeTypes = stateChangeTypes$3;\n  return Downshift;\n}()));\n false ? 0 : void 0;\nvar Downshift$1 = (/* unused pure expression or super */ null && (Downshift));\nfunction validateGetMenuPropsCalledCorrectly(node, _ref12) {\n  var refKey = _ref12.refKey;\n  if (!node) {\n    // eslint-disable-next-line no-console\n    console.error(\"downshift: The ref prop \\\"\" + refKey + \"\\\" from getMenuProps was not applied correctly on your menu element.\");\n  }\n}\nfunction validateGetRootPropsCalledCorrectly(element, _ref13) {\n  var refKey = _ref13.refKey;\n  var refKeySpecified = refKey !== 'ref';\n  var isComposite = !isDOMElement(element);\n  if (isComposite && !refKeySpecified && !isForwardRef(element)) {\n    // eslint-disable-next-line no-console\n    console.error('downshift: You returned a non-DOM element. You must specify a refKey in getRootProps');\n  } else if (!isComposite && refKeySpecified) {\n    // eslint-disable-next-line no-console\n    console.error(\"downshift: You returned a DOM element. You should not specify a refKey in getRootProps. You specified \\\"\" + refKey + \"\\\"\");\n  }\n  if (!isForwardRef(element) && !getElementProps(element)[refKey]) {\n    // eslint-disable-next-line no-console\n    console.error(\"downshift: You must apply the ref prop \\\"\" + refKey + \"\\\" from getRootProps onto your root element.\");\n  }\n}\n\nvar dropdownDefaultStateValues = {\n  highlightedIndex: -1,\n  isOpen: false,\n  selectedItem: null,\n  inputValue: ''\n};\nfunction callOnChangeProps(action, state, newState) {\n  var props = action.props,\n    type = action.type;\n  var changes = {};\n  Object.keys(state).forEach(function (key) {\n    invokeOnChangeHandler(key, action, state, newState);\n    if (newState[key] !== state[key]) {\n      changes[key] = newState[key];\n    }\n  });\n  if (props.onStateChange && Object.keys(changes).length) {\n    props.onStateChange((0,esm_extends/* default */.A)({\n      type: type\n    }, changes));\n  }\n}\nfunction invokeOnChangeHandler(key, action, state, newState) {\n  var props = action.props,\n    type = action.type;\n  var handler = \"on\" + capitalizeString(key) + \"Change\";\n  if (props[handler] && newState[key] !== undefined && newState[key] !== state[key]) {\n    props[handler]((0,esm_extends/* default */.A)({\n      type: type\n    }, newState));\n  }\n}\n\n/**\n * Default state reducer that returns the changes.\n *\n * @param {Object} s state.\n * @param {Object} a action with changes.\n * @returns {Object} changes.\n */\nfunction stateReducer(s, a) {\n  return a.changes;\n}\n\n/**\n * Debounced call for updating the a11y message.\n */\nvar updateA11yStatus = debounce(function (status, document) {\n  setStatus(status, document);\n}, 200);\n\n// istanbul ignore next\nvar useIsomorphicLayoutEffect = typeof window !== 'undefined' && typeof window.document !== 'undefined' && typeof window.document.createElement !== 'undefined' ? react.useLayoutEffect : react.useEffect;\n\n// istanbul ignore next\nvar useElementIds =  true // Avoid conditional useId call\n? function useElementIds(_ref) {\n  var id = _ref.id,\n    labelId = _ref.labelId,\n    menuId = _ref.menuId,\n    getItemId = _ref.getItemId,\n    toggleButtonId = _ref.toggleButtonId,\n    inputId = _ref.inputId;\n  // Avoid conditional useId call\n  var reactId = \"downshift-\" + react.useId();\n  if (!id) {\n    id = reactId;\n  }\n  var elementIdsRef = (0,react.useRef)({\n    labelId: labelId || id + \"-label\",\n    menuId: menuId || id + \"-menu\",\n    getItemId: getItemId || function (index) {\n      return id + \"-item-\" + index;\n    },\n    toggleButtonId: toggleButtonId || id + \"-toggle-button\",\n    inputId: inputId || id + \"-input\"\n  });\n  return elementIdsRef.current;\n} : function useElementIds(_ref2) {\n  var _ref2$id = _ref2.id,\n    id = _ref2$id === void 0 ? \"downshift-\" + generateId() : _ref2$id,\n    labelId = _ref2.labelId,\n    menuId = _ref2.menuId,\n    getItemId = _ref2.getItemId,\n    toggleButtonId = _ref2.toggleButtonId,\n    inputId = _ref2.inputId;\n  var elementIdsRef = (0,react.useRef)({\n    labelId: labelId || id + \"-label\",\n    menuId: menuId || id + \"-menu\",\n    getItemId: getItemId || function (index) {\n      return id + \"-item-\" + index;\n    },\n    toggleButtonId: toggleButtonId || id + \"-toggle-button\",\n    inputId: inputId || id + \"-input\"\n  });\n  return elementIdsRef.current;\n};\nfunction getItemAndIndex(itemProp, indexProp, items, errorMessage) {\n  var item, index;\n  if (itemProp === undefined) {\n    if (indexProp === undefined) {\n      throw new Error(errorMessage);\n    }\n    item = items[indexProp];\n    index = indexProp;\n  } else {\n    index = indexProp === undefined ? items.indexOf(itemProp) : indexProp;\n    item = itemProp;\n  }\n  return [item, index];\n}\nfunction isAcceptedCharacterKey(key) {\n  return /^\\S{1}$/.test(key);\n}\nfunction capitalizeString(string) {\n  return \"\" + string.slice(0, 1).toUpperCase() + string.slice(1);\n}\nfunction useLatestRef(val) {\n  var ref = (0,react.useRef)(val);\n  // technically this is not \"concurrent mode safe\" because we're manipulating\n  // the value during render (so it's not idempotent). However, the places this\n  // hook is used is to support memoizing callbacks which will be called\n  // *during* render, so we need the latest values *during* render.\n  // If not for this, then we'd probably want to use useLayoutEffect instead.\n  ref.current = val;\n  return ref;\n}\n\n/**\n * Computes the controlled state using a the previous state, props,\n * two reducers, one from downshift and an optional one from the user.\n * Also calls the onChange handlers for state values that have changed.\n *\n * @param {Function} reducer Reducer function from downshift.\n * @param {Object} props The hook props, also passed to createInitialState.\n * @param {Function} createInitialState Function that returns the initial state.\n * @param {Function} isStateEqual Function that checks if a previous state is equal to the next.\n * @returns {Array} An array with the state and an action dispatcher.\n */\nfunction useEnhancedReducer(reducer, props, createInitialState, isStateEqual) {\n  var prevStateRef = (0,react.useRef)();\n  var actionRef = (0,react.useRef)();\n  var enhancedReducer = (0,react.useCallback)(function (state, action) {\n    actionRef.current = action;\n    state = getState(state, action.props);\n    var changes = reducer(state, action);\n    var newState = action.props.stateReducer(state, (0,esm_extends/* default */.A)({}, action, {\n      changes: changes\n    }));\n    return newState;\n  }, [reducer]);\n  var _useReducer = (0,react.useReducer)(enhancedReducer, props, createInitialState),\n    state = _useReducer[0],\n    dispatch = _useReducer[1];\n  var propsRef = useLatestRef(props);\n  var dispatchWithProps = (0,react.useCallback)(function (action) {\n    return dispatch((0,esm_extends/* default */.A)({\n      props: propsRef.current\n    }, action));\n  }, [propsRef]);\n  var action = actionRef.current;\n  (0,react.useEffect)(function () {\n    var prevState = getState(prevStateRef.current, action == null ? void 0 : action.props);\n    var shouldCallOnChangeProps = action && prevStateRef.current && !isStateEqual(prevState, state);\n    if (shouldCallOnChangeProps) {\n      callOnChangeProps(action, prevState, state);\n    }\n    prevStateRef.current = state;\n  }, [state, action, isStateEqual]);\n  return [state, dispatchWithProps];\n}\n\n/**\n * Wraps the useEnhancedReducer and applies the controlled prop values before\n * returning the new state.\n *\n * @param {Function} reducer Reducer function from downshift.\n * @param {Object} props The hook props, also passed to createInitialState.\n * @param {Function} createInitialState Function that returns the initial state.\n * @param {Function} isStateEqual Function that checks if a previous state is equal to the next.\n * @returns {Array} An array with the state and an action dispatcher.\n */\nfunction useControlledReducer$1(reducer, props, createInitialState, isStateEqual) {\n  var _useEnhancedReducer = useEnhancedReducer(reducer, props, createInitialState, isStateEqual),\n    state = _useEnhancedReducer[0],\n    dispatch = _useEnhancedReducer[1];\n  return [getState(state, props), dispatch];\n}\nvar defaultProps$3 = {\n  itemToString: function itemToString(item) {\n    return item ? String(item) : '';\n  },\n  itemToKey: function itemToKey(item) {\n    return item;\n  },\n  stateReducer: stateReducer,\n  scrollIntoView: scrollIntoView,\n  environment: /* istanbul ignore next (ssr) */\n  typeof window === 'undefined' || false ? undefined : window\n};\nfunction getDefaultValue$1(props, propKey, defaultStateValues) {\n  if (defaultStateValues === void 0) {\n    defaultStateValues = dropdownDefaultStateValues;\n  }\n  var defaultValue = props[\"default\" + capitalizeString(propKey)];\n  if (defaultValue !== undefined) {\n    return defaultValue;\n  }\n  return defaultStateValues[propKey];\n}\nfunction getInitialValue$1(props, propKey, defaultStateValues) {\n  if (defaultStateValues === void 0) {\n    defaultStateValues = dropdownDefaultStateValues;\n  }\n  var value = props[propKey];\n  if (value !== undefined) {\n    return value;\n  }\n  var initialValue = props[\"initial\" + capitalizeString(propKey)];\n  if (initialValue !== undefined) {\n    return initialValue;\n  }\n  return getDefaultValue$1(props, propKey, defaultStateValues);\n}\nfunction getInitialState$2(props) {\n  var selectedItem = getInitialValue$1(props, 'selectedItem');\n  var isOpen = getInitialValue$1(props, 'isOpen');\n  var highlightedIndex = getInitialHighlightedIndex(props);\n  var inputValue = getInitialValue$1(props, 'inputValue');\n  return {\n    highlightedIndex: highlightedIndex < 0 && selectedItem && isOpen ? props.items.findIndex(function (item) {\n      return props.itemToKey(item) === props.itemToKey(selectedItem);\n    }) : highlightedIndex,\n    isOpen: isOpen,\n    selectedItem: selectedItem,\n    inputValue: inputValue\n  };\n}\nfunction getHighlightedIndexOnOpen(props, state, offset) {\n  var items = props.items,\n    initialHighlightedIndex = props.initialHighlightedIndex,\n    defaultHighlightedIndex = props.defaultHighlightedIndex,\n    isItemDisabled = props.isItemDisabled,\n    itemToKey = props.itemToKey;\n  var selectedItem = state.selectedItem,\n    highlightedIndex = state.highlightedIndex;\n  if (items.length === 0) {\n    return -1;\n  }\n\n  // initialHighlightedIndex will give value to highlightedIndex on initial state only.\n  if (initialHighlightedIndex !== undefined && highlightedIndex === initialHighlightedIndex && !isItemDisabled(items[initialHighlightedIndex], initialHighlightedIndex)) {\n    return initialHighlightedIndex;\n  }\n  if (defaultHighlightedIndex !== undefined && !isItemDisabled(items[defaultHighlightedIndex], defaultHighlightedIndex)) {\n    return defaultHighlightedIndex;\n  }\n  if (selectedItem) {\n    return items.findIndex(function (item) {\n      return itemToKey(selectedItem) === itemToKey(item);\n    });\n  }\n  if (offset < 0 && !isItemDisabled(items[items.length - 1], items.length - 1)) {\n    return items.length - 1;\n  }\n  if (offset > 0 && !isItemDisabled(items[0], 0)) {\n    return 0;\n  }\n  return -1;\n}\n/**\n * Tracks mouse and touch events, such as mouseDown, touchMove and touchEnd.\n *\n * @param {Window} environment The environment to add the event listeners to, for instance window.\n * @param {() => void} handleBlur The function that is called if mouseDown or touchEnd occured outside the downshiftElements.\n * @param {Array<{current: HTMLElement}>} downshiftElementsRefs The refs for the elements that should not trigger a blur action from mouseDown or touchEnd.\n * @returns {{isMouseDown: boolean, isTouchMove: boolean, isTouchEnd: boolean}} The mouse and touch events information, if any of are happening.\n */\nfunction useMouseAndTouchTracker(environment, handleBlur, downshiftElementsRefs) {\n  var mouseAndTouchTrackersRef = (0,react.useRef)({\n    isMouseDown: false,\n    isTouchMove: false,\n    isTouchEnd: false\n  });\n  (0,react.useEffect)(function () {\n    if (!environment) {\n      return noop;\n    }\n    var downshiftElements = downshiftElementsRefs.map(function (ref) {\n      return ref.current;\n    });\n    function onMouseDown() {\n      mouseAndTouchTrackersRef.current.isTouchEnd = false; // reset this one.\n      mouseAndTouchTrackersRef.current.isMouseDown = true;\n    }\n    function onMouseUp(event) {\n      mouseAndTouchTrackersRef.current.isMouseDown = false;\n      if (!targetWithinDownshift(event.target, downshiftElements, environment)) {\n        handleBlur();\n      }\n    }\n    function onTouchStart() {\n      mouseAndTouchTrackersRef.current.isTouchEnd = false;\n      mouseAndTouchTrackersRef.current.isTouchMove = false;\n    }\n    function onTouchMove() {\n      mouseAndTouchTrackersRef.current.isTouchMove = true;\n    }\n    function onTouchEnd(event) {\n      mouseAndTouchTrackersRef.current.isTouchEnd = true;\n      if (!mouseAndTouchTrackersRef.current.isTouchMove && !targetWithinDownshift(event.target, downshiftElements, environment, false)) {\n        handleBlur();\n      }\n    }\n    environment.addEventListener('mousedown', onMouseDown);\n    environment.addEventListener('mouseup', onMouseUp);\n    environment.addEventListener('touchstart', onTouchStart);\n    environment.addEventListener('touchmove', onTouchMove);\n    environment.addEventListener('touchend', onTouchEnd);\n    return function cleanup() {\n      environment.removeEventListener('mousedown', onMouseDown);\n      environment.removeEventListener('mouseup', onMouseUp);\n      environment.removeEventListener('touchstart', onTouchStart);\n      environment.removeEventListener('touchmove', onTouchMove);\n      environment.removeEventListener('touchend', onTouchEnd);\n    };\n  }, [downshiftElementsRefs, environment, handleBlur]);\n  return mouseAndTouchTrackersRef.current;\n}\n\n/* istanbul ignore next */\n// eslint-disable-next-line import/no-mutable-exports\nvar useGetterPropsCalledChecker = function useGetterPropsCalledChecker() {\n  return noop;\n};\n/**\n * Custom hook that checks if getter props are called correctly.\n *\n * @param  {...any} propKeys Getter prop names to be handled.\n * @returns {Function} Setter function called inside getter props to set call information.\n */\n/* istanbul ignore next */\nif (false) {}\n\n/**\n * Adds an a11y aria live status message if getA11yStatusMessage is passed.\n * @param {(options: Object) => string} getA11yStatusMessage The function that builds the status message.\n * @param {Object} options The options to be passed to getA11yStatusMessage if called.\n * @param {Array<unknown>} dependencyArray The dependency array that triggers the status message setter via useEffect.\n * @param {{document: Document}} environment The environment object containing the document.\n */\nfunction useA11yMessageStatus(getA11yStatusMessage, options, dependencyArray, environment) {\n  if (environment === void 0) {\n    environment = {};\n  }\n  var document = environment.document;\n  var isInitialMount = useIsInitialMount();\n\n  // Adds an a11y aria live status message if getA11yStatusMessage is passed.\n  (0,react.useEffect)(function () {\n    if (!getA11yStatusMessage || isInitialMount || false || !document) {\n      return;\n    }\n    var status = getA11yStatusMessage(options);\n    updateA11yStatus(status, document);\n\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, dependencyArray);\n\n  // Cleanup the status message container.\n  (0,react.useEffect)(function () {\n    return function () {\n      updateA11yStatus.cancel();\n      cleanupStatusDiv(document);\n    };\n  }, [document]);\n}\nfunction useScrollIntoView(_ref3) {\n  var highlightedIndex = _ref3.highlightedIndex,\n    isOpen = _ref3.isOpen,\n    itemRefs = _ref3.itemRefs,\n    getItemNodeFromIndex = _ref3.getItemNodeFromIndex,\n    menuElement = _ref3.menuElement,\n    scrollIntoViewProp = _ref3.scrollIntoView;\n  // used not to scroll on highlight by mouse.\n  var shouldScrollRef = (0,react.useRef)(true);\n  // Scroll on highlighted item if change comes from keyboard.\n  useIsomorphicLayoutEffect(function () {\n    if (highlightedIndex < 0 || !isOpen || !Object.keys(itemRefs.current).length) {\n      return;\n    }\n    if (shouldScrollRef.current === false) {\n      shouldScrollRef.current = true;\n    } else {\n      scrollIntoViewProp(getItemNodeFromIndex(highlightedIndex), menuElement);\n    }\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [highlightedIndex]);\n  return shouldScrollRef;\n}\n\n// eslint-disable-next-line import/no-mutable-exports\nvar useControlPropsValidator = noop;\n/* istanbul ignore next */\nif (false) {}\n\n/**\n * Handles selection on Enter / Alt + ArrowUp. Closes the menu and resets the highlighted index, unless there is a highlighted.\n * In that case, selects the item and resets to defaults for open state and highlighted idex.\n * @param {Object} props The useCombobox props.\n * @param {number} highlightedIndex The index from the state.\n * @param {boolean} inputValue Also return the input value for state.\n * @returns The changes for the state.\n */\nfunction getChangesOnSelection(props, highlightedIndex, inputValue) {\n  var _props$items;\n  if (inputValue === void 0) {\n    inputValue = true;\n  }\n  var shouldSelect = ((_props$items = props.items) == null ? void 0 : _props$items.length) && highlightedIndex >= 0;\n  return (0,esm_extends/* default */.A)({\n    isOpen: false,\n    highlightedIndex: -1\n  }, shouldSelect && (0,esm_extends/* default */.A)({\n    selectedItem: props.items[highlightedIndex],\n    isOpen: getDefaultValue$1(props, 'isOpen'),\n    highlightedIndex: getDefaultValue$1(props, 'highlightedIndex')\n  }, inputValue && {\n    inputValue: props.itemToString(props.items[highlightedIndex])\n  }));\n}\n\n/**\n * Check if a state is equal for dropdowns, by comparing isOpen, inputValue, highlightedIndex and selected item.\n * Used by useSelect and useCombobox.\n *\n * @param {Object} prevState\n * @param {Object} newState\n * @returns {boolean} Wheather the states are deeply equal.\n */\nfunction isDropdownsStateEqual(prevState, newState) {\n  return prevState.isOpen === newState.isOpen && prevState.inputValue === newState.inputValue && prevState.highlightedIndex === newState.highlightedIndex && prevState.selectedItem === newState.selectedItem;\n}\n\n/**\n * Tracks if it's the first render.\n */\nfunction useIsInitialMount() {\n  var isInitialMountRef = react.useRef(true);\n  react.useEffect(function () {\n    isInitialMountRef.current = false;\n    return function () {\n      isInitialMountRef.current = true;\n    };\n  }, []);\n  return isInitialMountRef.current;\n}\n\n/**\n * Returns the new highlightedIndex based on the defaultHighlightedIndex prop, if it's not disabled.\n *\n * @param {Object} props Props from useCombobox or useSelect.\n * @returns {number} The highlighted index.\n */\nfunction getDefaultHighlightedIndex(props) {\n  var highlightedIndex = getDefaultValue$1(props, 'highlightedIndex');\n  if (highlightedIndex > -1 && props.isItemDisabled(props.items[highlightedIndex], highlightedIndex)) {\n    return -1;\n  }\n  return highlightedIndex;\n}\n\n/**\n * Returns the new highlightedIndex based on the initialHighlightedIndex prop, if not disabled.\n *\n * @param {Object} props Props from useCombobox or useSelect.\n * @returns {number} The highlighted index.\n */\nfunction getInitialHighlightedIndex(props) {\n  var highlightedIndex = getInitialValue$1(props, 'highlightedIndex');\n  if (highlightedIndex > -1 && props.isItemDisabled(props.items[highlightedIndex], highlightedIndex)) {\n    return -1;\n  }\n  return highlightedIndex;\n}\n\n// Shared between all exports.\nvar commonPropTypes = {\n  environment: prop_types_default().shape({\n    addEventListener: (prop_types_default()).func.isRequired,\n    removeEventListener: (prop_types_default()).func.isRequired,\n    document: prop_types_default().shape({\n      createElement: (prop_types_default()).func.isRequired,\n      getElementById: (prop_types_default()).func.isRequired,\n      activeElement: (prop_types_default()).any.isRequired,\n      body: (prop_types_default()).any.isRequired\n    }).isRequired,\n    Node: (prop_types_default()).func.isRequired\n  }),\n  itemToString: (prop_types_default()).func,\n  itemToKey: (prop_types_default()).func,\n  stateReducer: (prop_types_default()).func\n};\n\n// Shared between useSelect, useCombobox, Downshift.\nvar commonDropdownPropTypes = (0,esm_extends/* default */.A)({}, commonPropTypes, {\n  getA11yStatusMessage: (prop_types_default()).func,\n  highlightedIndex: (prop_types_default()).number,\n  defaultHighlightedIndex: (prop_types_default()).number,\n  initialHighlightedIndex: (prop_types_default()).number,\n  isOpen: (prop_types_default()).bool,\n  defaultIsOpen: (prop_types_default()).bool,\n  initialIsOpen: (prop_types_default()).bool,\n  selectedItem: (prop_types_default()).any,\n  initialSelectedItem: (prop_types_default()).any,\n  defaultSelectedItem: (prop_types_default()).any,\n  id: (prop_types_default()).string,\n  labelId: (prop_types_default()).string,\n  menuId: (prop_types_default()).string,\n  getItemId: (prop_types_default()).func,\n  toggleButtonId: (prop_types_default()).string,\n  onSelectedItemChange: (prop_types_default()).func,\n  onHighlightedIndexChange: (prop_types_default()).func,\n  onStateChange: (prop_types_default()).func,\n  onIsOpenChange: (prop_types_default()).func,\n  scrollIntoView: (prop_types_default()).func\n});\n\nfunction downshiftCommonReducer(state, action, stateChangeTypes) {\n  var type = action.type,\n    props = action.props;\n  var changes;\n  switch (type) {\n    case stateChangeTypes.ItemMouseMove:\n      changes = {\n        highlightedIndex: action.disabled ? -1 : action.index\n      };\n      break;\n    case stateChangeTypes.MenuMouseLeave:\n      changes = {\n        highlightedIndex: -1\n      };\n      break;\n    case stateChangeTypes.ToggleButtonClick:\n    case stateChangeTypes.FunctionToggleMenu:\n      changes = {\n        isOpen: !state.isOpen,\n        highlightedIndex: state.isOpen ? -1 : getHighlightedIndexOnOpen(props, state, 0)\n      };\n      break;\n    case stateChangeTypes.FunctionOpenMenu:\n      changes = {\n        isOpen: true,\n        highlightedIndex: getHighlightedIndexOnOpen(props, state, 0)\n      };\n      break;\n    case stateChangeTypes.FunctionCloseMenu:\n      changes = {\n        isOpen: false\n      };\n      break;\n    case stateChangeTypes.FunctionSetHighlightedIndex:\n      changes = {\n        highlightedIndex: props.isItemDisabled(props.items[action.highlightedIndex], action.highlightedIndex) ? -1 : action.highlightedIndex\n      };\n      break;\n    case stateChangeTypes.FunctionSetInputValue:\n      changes = {\n        inputValue: action.inputValue\n      };\n      break;\n    case stateChangeTypes.FunctionReset:\n      changes = {\n        highlightedIndex: getDefaultHighlightedIndex(props),\n        isOpen: getDefaultValue$1(props, 'isOpen'),\n        selectedItem: getDefaultValue$1(props, 'selectedItem'),\n        inputValue: getDefaultValue$1(props, 'inputValue')\n      };\n      break;\n    default:\n      throw new Error('Reducer called without proper action type.');\n  }\n  return (0,esm_extends/* default */.A)({}, state, changes);\n}\n/* eslint-enable complexity */\n\nfunction getItemIndexByCharacterKey(_a) {\n    var keysSoFar = _a.keysSoFar, highlightedIndex = _a.highlightedIndex, items = _a.items, itemToString = _a.itemToString, isItemDisabled = _a.isItemDisabled;\n    var lowerCasedKeysSoFar = keysSoFar.toLowerCase();\n    for (var index = 0; index < items.length; index++) {\n        // if we already have a search query in progress, we also consider the current highlighted item.\n        var offsetIndex = (index + highlightedIndex + (keysSoFar.length < 2 ? 1 : 0)) % items.length;\n        var item = items[offsetIndex];\n        if (item !== undefined &&\n            itemToString(item).toLowerCase().startsWith(lowerCasedKeysSoFar) &&\n            !isItemDisabled(item, offsetIndex)) {\n            return offsetIndex;\n        }\n    }\n    return highlightedIndex;\n}\nvar propTypes$2 = (0,tslib_es6/* __assign */.Cl)((0,tslib_es6/* __assign */.Cl)({}, commonDropdownPropTypes), { items: (prop_types_default()).array.isRequired, isItemDisabled: (prop_types_default()).func });\nvar defaultProps$2 = (0,tslib_es6/* __assign */.Cl)((0,tslib_es6/* __assign */.Cl)({}, defaultProps$3), { isItemDisabled: function () {\n        return false;\n    } });\n// eslint-disable-next-line import/no-mutable-exports\nvar validatePropTypes$2 = noop;\n/* istanbul ignore next */\nif (false) {}\n\nvar ToggleButtonClick$1 =  false ? 0 : 0;\nvar ToggleButtonKeyDownArrowDown =  false ? 0 : 1;\nvar ToggleButtonKeyDownArrowUp =  false ? 0 : 2;\nvar ToggleButtonKeyDownCharacter =  false ? 0 : 3;\nvar ToggleButtonKeyDownEscape =  false ? 0 : 4;\nvar ToggleButtonKeyDownHome =  false ? 0 : 5;\nvar ToggleButtonKeyDownEnd =  false ? 0 : 6;\nvar ToggleButtonKeyDownEnter =  false ? 0 : 7;\nvar ToggleButtonKeyDownSpaceButton =  false ? 0 : 8;\nvar ToggleButtonKeyDownPageUp =  false ? 0 : 9;\nvar ToggleButtonKeyDownPageDown =  false ? 0 : 10;\nvar ToggleButtonBlur =  false ? 0 : 11;\nvar MenuMouseLeave$1 =  false ? 0 : 12;\nvar ItemMouseMove$1 =  false ? 0 : 13;\nvar ItemClick$1 =  false ? 0 : 14;\nvar FunctionToggleMenu$1 =  false ? 0 : 15;\nvar FunctionOpenMenu$1 =  false ? 0 : 16;\nvar FunctionCloseMenu$1 =  false ? 0 : 17;\nvar FunctionSetHighlightedIndex$1 =  false ? 0 : 18;\nvar FunctionSelectItem$1 =  false ? 0 : 19;\nvar FunctionSetInputValue$1 =  false ? 0 : 20;\nvar FunctionReset$2 =  false ? 0 : 21;\n\nvar stateChangeTypes$2 = /*#__PURE__*/Object.freeze({\n  __proto__: null,\n  FunctionCloseMenu: FunctionCloseMenu$1,\n  FunctionOpenMenu: FunctionOpenMenu$1,\n  FunctionReset: FunctionReset$2,\n  FunctionSelectItem: FunctionSelectItem$1,\n  FunctionSetHighlightedIndex: FunctionSetHighlightedIndex$1,\n  FunctionSetInputValue: FunctionSetInputValue$1,\n  FunctionToggleMenu: FunctionToggleMenu$1,\n  ItemClick: ItemClick$1,\n  ItemMouseMove: ItemMouseMove$1,\n  MenuMouseLeave: MenuMouseLeave$1,\n  ToggleButtonBlur: ToggleButtonBlur,\n  ToggleButtonClick: ToggleButtonClick$1,\n  ToggleButtonKeyDownArrowDown: ToggleButtonKeyDownArrowDown,\n  ToggleButtonKeyDownArrowUp: ToggleButtonKeyDownArrowUp,\n  ToggleButtonKeyDownCharacter: ToggleButtonKeyDownCharacter,\n  ToggleButtonKeyDownEnd: ToggleButtonKeyDownEnd,\n  ToggleButtonKeyDownEnter: ToggleButtonKeyDownEnter,\n  ToggleButtonKeyDownEscape: ToggleButtonKeyDownEscape,\n  ToggleButtonKeyDownHome: ToggleButtonKeyDownHome,\n  ToggleButtonKeyDownPageDown: ToggleButtonKeyDownPageDown,\n  ToggleButtonKeyDownPageUp: ToggleButtonKeyDownPageUp,\n  ToggleButtonKeyDownSpaceButton: ToggleButtonKeyDownSpaceButton\n});\n\n/* eslint-disable complexity */\nfunction downshiftSelectReducer(state, action) {\n  var _props$items;\n  var type = action.type,\n    props = action.props,\n    altKey = action.altKey;\n  var changes;\n  switch (type) {\n    case ItemClick$1:\n      changes = {\n        isOpen: getDefaultValue$1(props, 'isOpen'),\n        highlightedIndex: getDefaultHighlightedIndex(props),\n        selectedItem: props.items[action.index]\n      };\n      break;\n    case ToggleButtonKeyDownCharacter:\n      {\n        var lowercasedKey = action.key;\n        var inputValue = \"\" + state.inputValue + lowercasedKey;\n        var prevHighlightedIndex = !state.isOpen && state.selectedItem ? props.items.findIndex(function (item) {\n          return props.itemToKey(item) === props.itemToKey(state.selectedItem);\n        }) : state.highlightedIndex;\n        var highlightedIndex = getItemIndexByCharacterKey({\n          keysSoFar: inputValue,\n          highlightedIndex: prevHighlightedIndex,\n          items: props.items,\n          itemToString: props.itemToString,\n          isItemDisabled: props.isItemDisabled\n        });\n        changes = {\n          inputValue: inputValue,\n          highlightedIndex: highlightedIndex,\n          isOpen: true\n        };\n      }\n      break;\n    case ToggleButtonKeyDownArrowDown:\n      {\n        var _highlightedIndex = state.isOpen ? getHighlightedIndex(state.highlightedIndex, 1, props.items, props.isItemDisabled) : altKey && state.selectedItem == null ? -1 : getHighlightedIndexOnOpen(props, state, 1);\n        changes = {\n          highlightedIndex: _highlightedIndex,\n          isOpen: true\n        };\n      }\n      break;\n    case ToggleButtonKeyDownArrowUp:\n      if (state.isOpen && altKey) {\n        changes = getChangesOnSelection(props, state.highlightedIndex, false);\n      } else {\n        var _highlightedIndex2 = state.isOpen ? getHighlightedIndex(state.highlightedIndex, -1, props.items, props.isItemDisabled) : getHighlightedIndexOnOpen(props, state, -1);\n        changes = {\n          highlightedIndex: _highlightedIndex2,\n          isOpen: true\n        };\n      }\n      break;\n    // only triggered when menu is open.\n    case ToggleButtonKeyDownEnter:\n    case ToggleButtonKeyDownSpaceButton:\n      changes = getChangesOnSelection(props, state.highlightedIndex, false);\n      break;\n    case ToggleButtonKeyDownHome:\n      changes = {\n        highlightedIndex: getNonDisabledIndex(0, false, props.items, props.isItemDisabled),\n        isOpen: true\n      };\n      break;\n    case ToggleButtonKeyDownEnd:\n      changes = {\n        highlightedIndex: getNonDisabledIndex(props.items.length - 1, true, props.items, props.isItemDisabled),\n        isOpen: true\n      };\n      break;\n    case ToggleButtonKeyDownPageUp:\n      changes = {\n        highlightedIndex: getHighlightedIndex(state.highlightedIndex, -10, props.items, props.isItemDisabled)\n      };\n      break;\n    case ToggleButtonKeyDownPageDown:\n      changes = {\n        highlightedIndex: getHighlightedIndex(state.highlightedIndex, 10, props.items, props.isItemDisabled)\n      };\n      break;\n    case ToggleButtonKeyDownEscape:\n      changes = {\n        isOpen: false,\n        highlightedIndex: -1\n      };\n      break;\n    case ToggleButtonBlur:\n      changes = (0,esm_extends/* default */.A)({\n        isOpen: false,\n        highlightedIndex: -1\n      }, state.highlightedIndex >= 0 && ((_props$items = props.items) == null ? void 0 : _props$items.length) && {\n        selectedItem: props.items[state.highlightedIndex]\n      });\n      break;\n    case FunctionSelectItem$1:\n      changes = {\n        selectedItem: action.selectedItem\n      };\n      break;\n    default:\n      return downshiftCommonReducer(state, action, stateChangeTypes$2);\n  }\n  return (0,esm_extends/* default */.A)({}, state, changes);\n}\n/* eslint-enable complexity */\n\nvar _excluded$2 = [\"onClick\"],\n  _excluded2$2 = [\"onMouseLeave\", \"refKey\", \"ref\"],\n  _excluded3$1 = [\"onBlur\", \"onClick\", \"onPress\", \"onKeyDown\", \"refKey\", \"ref\"],\n  _excluded4$1 = [\"item\", \"index\", \"onMouseMove\", \"onClick\", \"onMouseDown\", \"onPress\", \"refKey\", \"disabled\", \"ref\"];\nuseSelect.stateChangeTypes = stateChangeTypes$2;\nfunction useSelect(userProps) {\n  if (userProps === void 0) {\n    userProps = {};\n  }\n  validatePropTypes$2(userProps, useSelect);\n  // Props defaults and destructuring.\n  var props = (0,esm_extends/* default */.A)({}, defaultProps$2, userProps);\n  var scrollIntoView = props.scrollIntoView,\n    environment = props.environment,\n    getA11yStatusMessage = props.getA11yStatusMessage;\n  // Initial state depending on controlled props.\n  var _useControlledReducer = useControlledReducer$1(downshiftSelectReducer, props, getInitialState$2, isDropdownsStateEqual),\n    state = _useControlledReducer[0],\n    dispatch = _useControlledReducer[1];\n  var isOpen = state.isOpen,\n    highlightedIndex = state.highlightedIndex,\n    selectedItem = state.selectedItem,\n    inputValue = state.inputValue;\n  // Element efs.\n  var toggleButtonRef = (0,react.useRef)(null);\n  var menuRef = (0,react.useRef)(null);\n  var itemRefs = (0,react.useRef)({});\n\n  // used to keep the inputValue clearTimeout object between renders.\n  var clearTimeoutRef = (0,react.useRef)(null);\n  // prevent id re-generation between renders.\n  var elementIds = useElementIds(props);\n  // utility callback to get item element.\n  var latest = useLatestRef({\n    state: state,\n    props: props\n  });\n\n  // Some utils.\n  var getItemNodeFromIndex = (0,react.useCallback)(function (index) {\n    return itemRefs.current[elementIds.getItemId(index)];\n  }, [elementIds]);\n\n  // Effects.\n  // Adds an a11y aria live status message if getA11yStatusMessage is passed.\n  useA11yMessageStatus(getA11yStatusMessage, state, [isOpen, highlightedIndex, selectedItem, inputValue], environment);\n  // Scroll on highlighted item if change comes from keyboard.\n  var shouldScrollRef = useScrollIntoView({\n    menuElement: menuRef.current,\n    highlightedIndex: highlightedIndex,\n    isOpen: isOpen,\n    itemRefs: itemRefs,\n    scrollIntoView: scrollIntoView,\n    getItemNodeFromIndex: getItemNodeFromIndex\n  });\n  // Sets cleanup for the keysSoFar callback, debounded after 500ms.\n  (0,react.useEffect)(function () {\n    // init the clean function here as we need access to dispatch.\n    clearTimeoutRef.current = debounce(function (outerDispatch) {\n      outerDispatch({\n        type: FunctionSetInputValue$1,\n        inputValue: ''\n      });\n    }, 500);\n\n    // Cancel any pending debounced calls on mount\n    return function () {\n      clearTimeoutRef.current.cancel();\n    };\n  }, []);\n  // Invokes the keysSoFar callback set up above.\n  (0,react.useEffect)(function () {\n    if (!inputValue) {\n      return;\n    }\n    clearTimeoutRef.current(dispatch);\n  }, [dispatch, inputValue]);\n  useControlPropsValidator({\n    props: props,\n    state: state\n  });\n  // Focus the toggle button on first render if required.\n  (0,react.useEffect)(function () {\n    var focusOnOpen = getInitialValue$1(props, 'isOpen');\n    if (focusOnOpen && toggleButtonRef.current) {\n      toggleButtonRef.current.focus();\n    }\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, []);\n  var mouseAndTouchTrackers = useMouseAndTouchTracker(environment, (0,react.useCallback)(function handleBlur() {\n    if (latest.current.state.isOpen) {\n      dispatch({\n        type: ToggleButtonBlur\n      });\n    }\n  }, [dispatch, latest]), (0,react.useMemo)(function () {\n    return [menuRef, toggleButtonRef];\n  }, [menuRef.current, toggleButtonRef.current]));\n  var setGetterPropCallInfo = useGetterPropsCalledChecker('getMenuProps', 'getToggleButtonProps');\n  // Reset itemRefs on close.\n  (0,react.useEffect)(function () {\n    if (!isOpen) {\n      itemRefs.current = {};\n    }\n  }, [isOpen]);\n\n  // Event handler functions.\n  var toggleButtonKeyDownHandlers = (0,react.useMemo)(function () {\n    return {\n      ArrowDown: function ArrowDown(event) {\n        event.preventDefault();\n        dispatch({\n          type: ToggleButtonKeyDownArrowDown,\n          altKey: event.altKey\n        });\n      },\n      ArrowUp: function ArrowUp(event) {\n        event.preventDefault();\n        dispatch({\n          type: ToggleButtonKeyDownArrowUp,\n          altKey: event.altKey\n        });\n      },\n      Home: function Home(event) {\n        event.preventDefault();\n        dispatch({\n          type: ToggleButtonKeyDownHome\n        });\n      },\n      End: function End(event) {\n        event.preventDefault();\n        dispatch({\n          type: ToggleButtonKeyDownEnd\n        });\n      },\n      Escape: function Escape() {\n        if (latest.current.state.isOpen) {\n          dispatch({\n            type: ToggleButtonKeyDownEscape\n          });\n        }\n      },\n      Enter: function Enter(event) {\n        event.preventDefault();\n        dispatch({\n          type: latest.current.state.isOpen ? ToggleButtonKeyDownEnter : ToggleButtonClick$1\n        });\n      },\n      PageUp: function PageUp(event) {\n        if (latest.current.state.isOpen) {\n          event.preventDefault();\n          dispatch({\n            type: ToggleButtonKeyDownPageUp\n          });\n        }\n      },\n      PageDown: function PageDown(event) {\n        if (latest.current.state.isOpen) {\n          event.preventDefault();\n          dispatch({\n            type: ToggleButtonKeyDownPageDown\n          });\n        }\n      },\n      ' ': function _(event) {\n        event.preventDefault();\n        var currentState = latest.current.state;\n        if (!currentState.isOpen) {\n          dispatch({\n            type: ToggleButtonClick$1\n          });\n          return;\n        }\n        if (currentState.inputValue) {\n          dispatch({\n            type: ToggleButtonKeyDownCharacter,\n            key: ' '\n          });\n        } else {\n          dispatch({\n            type: ToggleButtonKeyDownSpaceButton\n          });\n        }\n      }\n    };\n  }, [dispatch, latest]);\n\n  // Action functions.\n  var toggleMenu = (0,react.useCallback)(function () {\n    dispatch({\n      type: FunctionToggleMenu$1\n    });\n  }, [dispatch]);\n  var closeMenu = (0,react.useCallback)(function () {\n    dispatch({\n      type: FunctionCloseMenu$1\n    });\n  }, [dispatch]);\n  var openMenu = (0,react.useCallback)(function () {\n    dispatch({\n      type: FunctionOpenMenu$1\n    });\n  }, [dispatch]);\n  var setHighlightedIndex = (0,react.useCallback)(function (newHighlightedIndex) {\n    dispatch({\n      type: FunctionSetHighlightedIndex$1,\n      highlightedIndex: newHighlightedIndex\n    });\n  }, [dispatch]);\n  var selectItem = (0,react.useCallback)(function (newSelectedItem) {\n    dispatch({\n      type: FunctionSelectItem$1,\n      selectedItem: newSelectedItem\n    });\n  }, [dispatch]);\n  var reset = (0,react.useCallback)(function () {\n    dispatch({\n      type: FunctionReset$2\n    });\n  }, [dispatch]);\n  var setInputValue = (0,react.useCallback)(function (newInputValue) {\n    dispatch({\n      type: FunctionSetInputValue$1,\n      inputValue: newInputValue\n    });\n  }, [dispatch]);\n  // Getter functions.\n  var getLabelProps = (0,react.useCallback)(function (_temp) {\n    var _ref = _temp === void 0 ? {} : _temp,\n      onClick = _ref.onClick,\n      labelProps = (0,objectWithoutPropertiesLoose/* default */.A)(_ref, _excluded$2);\n    var labelHandleClick = function labelHandleClick() {\n      var _toggleButtonRef$curr;\n      (_toggleButtonRef$curr = toggleButtonRef.current) == null || _toggleButtonRef$curr.focus();\n    };\n    return (0,esm_extends/* default */.A)({\n      id: elementIds.labelId,\n      htmlFor: elementIds.toggleButtonId,\n      onClick: callAllEventHandlers(onClick, labelHandleClick)\n    }, labelProps);\n  }, [elementIds]);\n  var getMenuProps = (0,react.useCallback)(function (_temp2, _temp3) {\n    var _extends2;\n    var _ref2 = _temp2 === void 0 ? {} : _temp2,\n      onMouseLeave = _ref2.onMouseLeave,\n      _ref2$refKey = _ref2.refKey,\n      refKey = _ref2$refKey === void 0 ? 'ref' : _ref2$refKey,\n      ref = _ref2.ref,\n      rest = (0,objectWithoutPropertiesLoose/* default */.A)(_ref2, _excluded2$2);\n    var _ref3 = _temp3 === void 0 ? {} : _temp3,\n      _ref3$suppressRefErro = _ref3.suppressRefError,\n      suppressRefError = _ref3$suppressRefErro === void 0 ? false : _ref3$suppressRefErro;\n    var menuHandleMouseLeave = function menuHandleMouseLeave() {\n      dispatch({\n        type: MenuMouseLeave$1\n      });\n    };\n    setGetterPropCallInfo('getMenuProps', suppressRefError, refKey, menuRef);\n    return (0,esm_extends/* default */.A)((_extends2 = {}, _extends2[refKey] = handleRefs(ref, function (menuNode) {\n      menuRef.current = menuNode;\n    }), _extends2.id = elementIds.menuId, _extends2.role = 'listbox', _extends2['aria-labelledby'] = rest && rest['aria-label'] ? undefined : \"\" + elementIds.labelId, _extends2.onMouseLeave = callAllEventHandlers(onMouseLeave, menuHandleMouseLeave), _extends2), rest);\n  }, [dispatch, setGetterPropCallInfo, elementIds]);\n  var getToggleButtonProps = (0,react.useCallback)(function (_temp4, _temp5) {\n    var _extends3;\n    var _ref4 = _temp4 === void 0 ? {} : _temp4,\n      onBlur = _ref4.onBlur,\n      onClick = _ref4.onClick;\n      _ref4.onPress;\n      var onKeyDown = _ref4.onKeyDown,\n      _ref4$refKey = _ref4.refKey,\n      refKey = _ref4$refKey === void 0 ? 'ref' : _ref4$refKey,\n      ref = _ref4.ref,\n      rest = (0,objectWithoutPropertiesLoose/* default */.A)(_ref4, _excluded3$1);\n    var _ref5 = _temp5 === void 0 ? {} : _temp5,\n      _ref5$suppressRefErro = _ref5.suppressRefError,\n      suppressRefError = _ref5$suppressRefErro === void 0 ? false : _ref5$suppressRefErro;\n    var latestState = latest.current.state;\n    var toggleButtonHandleClick = function toggleButtonHandleClick() {\n      dispatch({\n        type: ToggleButtonClick$1\n      });\n    };\n    var toggleButtonHandleBlur = function toggleButtonHandleBlur() {\n      if (latestState.isOpen && !mouseAndTouchTrackers.isMouseDown) {\n        dispatch({\n          type: ToggleButtonBlur\n        });\n      }\n    };\n    var toggleButtonHandleKeyDown = function toggleButtonHandleKeyDown(event) {\n      var key = normalizeArrowKey(event);\n      if (key && toggleButtonKeyDownHandlers[key]) {\n        toggleButtonKeyDownHandlers[key](event);\n      } else if (isAcceptedCharacterKey(key)) {\n        dispatch({\n          type: ToggleButtonKeyDownCharacter,\n          key: key\n        });\n      }\n    };\n    var toggleProps = (0,esm_extends/* default */.A)((_extends3 = {}, _extends3[refKey] = handleRefs(ref, function (toggleButtonNode) {\n      toggleButtonRef.current = toggleButtonNode;\n    }), _extends3['aria-activedescendant'] = latestState.isOpen && latestState.highlightedIndex > -1 ? elementIds.getItemId(latestState.highlightedIndex) : '', _extends3['aria-controls'] = elementIds.menuId, _extends3['aria-expanded'] = latest.current.state.isOpen, _extends3['aria-haspopup'] = 'listbox', _extends3['aria-labelledby'] = rest && rest['aria-label'] ? undefined : \"\" + elementIds.labelId, _extends3.id = elementIds.toggleButtonId, _extends3.role = 'combobox', _extends3.tabIndex = 0, _extends3.onBlur = callAllEventHandlers(onBlur, toggleButtonHandleBlur), _extends3), rest);\n    if (!rest.disabled) {\n      /* istanbul ignore if (react-native) */\n      {\n        toggleProps.onClick = callAllEventHandlers(onClick, toggleButtonHandleClick);\n        toggleProps.onKeyDown = callAllEventHandlers(onKeyDown, toggleButtonHandleKeyDown);\n      }\n    }\n    setGetterPropCallInfo('getToggleButtonProps', suppressRefError, refKey, toggleButtonRef);\n    return toggleProps;\n  }, [dispatch, elementIds, latest, mouseAndTouchTrackers, setGetterPropCallInfo, toggleButtonKeyDownHandlers]);\n  var getItemProps = (0,react.useCallback)(function (_temp6) {\n    var _extends4;\n    var _ref6 = _temp6 === void 0 ? {} : _temp6,\n      itemProp = _ref6.item,\n      indexProp = _ref6.index,\n      onMouseMove = _ref6.onMouseMove,\n      onClick = _ref6.onClick,\n      onMouseDown = _ref6.onMouseDown;\n      _ref6.onPress;\n      var _ref6$refKey = _ref6.refKey,\n      refKey = _ref6$refKey === void 0 ? 'ref' : _ref6$refKey,\n      disabledProp = _ref6.disabled,\n      ref = _ref6.ref,\n      rest = (0,objectWithoutPropertiesLoose/* default */.A)(_ref6, _excluded4$1);\n    if (disabledProp !== undefined) {\n      console.warn('Passing \"disabled\" as an argument to getItemProps is not supported anymore. Please use the isItemDisabled prop from useSelect.');\n    }\n    var _latest$current = latest.current,\n      latestState = _latest$current.state,\n      latestProps = _latest$current.props;\n    var _getItemAndIndex = getItemAndIndex(itemProp, indexProp, latestProps.items, 'Pass either item or index to getItemProps!'),\n      item = _getItemAndIndex[0],\n      index = _getItemAndIndex[1];\n    var disabled = latestProps.isItemDisabled(item, index);\n    var itemHandleMouseMove = function itemHandleMouseMove() {\n      if (mouseAndTouchTrackers.isTouchEnd || index === latestState.highlightedIndex) {\n        return;\n      }\n      shouldScrollRef.current = false;\n      dispatch({\n        type: ItemMouseMove$1,\n        index: index,\n        disabled: disabled\n      });\n    };\n    var itemHandleClick = function itemHandleClick() {\n      dispatch({\n        type: ItemClick$1,\n        index: index\n      });\n    };\n    var itemHandleMouseDown = function itemHandleMouseDown(e) {\n      return e.preventDefault();\n    }; // keep focus on the toggle after item click select.\n\n    var itemProps = (0,esm_extends/* default */.A)((_extends4 = {}, _extends4[refKey] = handleRefs(ref, function (itemNode) {\n      if (itemNode) {\n        itemRefs.current[elementIds.getItemId(index)] = itemNode;\n      }\n    }), _extends4['aria-disabled'] = disabled, _extends4['aria-selected'] = item === latestState.selectedItem, _extends4.id = elementIds.getItemId(index), _extends4.role = 'option', _extends4), rest);\n    if (!disabled) {\n      /* istanbul ignore next (react-native) */\n      {\n        itemProps.onClick = callAllEventHandlers(onClick, itemHandleClick);\n      }\n    }\n    itemProps.onMouseMove = callAllEventHandlers(onMouseMove, itemHandleMouseMove);\n    itemProps.onMouseDown = callAllEventHandlers(onMouseDown, itemHandleMouseDown);\n    return itemProps;\n  }, [latest, elementIds, mouseAndTouchTrackers, shouldScrollRef, dispatch]);\n  return {\n    // prop getters.\n    getToggleButtonProps: getToggleButtonProps,\n    getLabelProps: getLabelProps,\n    getMenuProps: getMenuProps,\n    getItemProps: getItemProps,\n    // actions.\n    toggleMenu: toggleMenu,\n    openMenu: openMenu,\n    closeMenu: closeMenu,\n    setHighlightedIndex: setHighlightedIndex,\n    selectItem: selectItem,\n    reset: reset,\n    setInputValue: setInputValue,\n    // state.\n    highlightedIndex: highlightedIndex,\n    isOpen: isOpen,\n    selectedItem: selectedItem,\n    inputValue: inputValue\n  };\n}\n\nvar InputKeyDownArrowDown =  false ? 0 : 0;\nvar InputKeyDownArrowUp =  false ? 0 : 1;\nvar InputKeyDownEscape =  false ? 0 : 2;\nvar InputKeyDownHome =  false ? 0 : 3;\nvar InputKeyDownEnd =  false ? 0 : 4;\nvar InputKeyDownPageUp =  false ? 0 : 5;\nvar InputKeyDownPageDown =  false ? 0 : 6;\nvar InputKeyDownEnter =  false ? 0 : 7;\nvar InputChange =  false ? 0 : 8;\nvar InputBlur =  false ? 0 : 9;\nvar InputClick =  false ? 0 : 10;\nvar MenuMouseLeave =  false ? 0 : 11;\nvar ItemMouseMove =  false ? 0 : 12;\nvar ItemClick =  false ? 0 : 13;\nvar ToggleButtonClick =  false ? 0 : 14;\nvar FunctionToggleMenu =  false ? 0 : 15;\nvar FunctionOpenMenu =  false ? 0 : 16;\nvar FunctionCloseMenu =  false ? 0 : 17;\nvar FunctionSetHighlightedIndex =  false ? 0 : 18;\nvar FunctionSelectItem =  false ? 0 : 19;\nvar FunctionSetInputValue =  false ? 0 : 20;\nvar FunctionReset$1 =  false ? 0 : 21;\nvar ControlledPropUpdatedSelectedItem =  false ? 0 : 22;\n\nvar stateChangeTypes$1 = /*#__PURE__*/Object.freeze({\n  __proto__: null,\n  ControlledPropUpdatedSelectedItem: ControlledPropUpdatedSelectedItem,\n  FunctionCloseMenu: FunctionCloseMenu,\n  FunctionOpenMenu: FunctionOpenMenu,\n  FunctionReset: FunctionReset$1,\n  FunctionSelectItem: FunctionSelectItem,\n  FunctionSetHighlightedIndex: FunctionSetHighlightedIndex,\n  FunctionSetInputValue: FunctionSetInputValue,\n  FunctionToggleMenu: FunctionToggleMenu,\n  InputBlur: InputBlur,\n  InputChange: InputChange,\n  InputClick: InputClick,\n  InputKeyDownArrowDown: InputKeyDownArrowDown,\n  InputKeyDownArrowUp: InputKeyDownArrowUp,\n  InputKeyDownEnd: InputKeyDownEnd,\n  InputKeyDownEnter: InputKeyDownEnter,\n  InputKeyDownEscape: InputKeyDownEscape,\n  InputKeyDownHome: InputKeyDownHome,\n  InputKeyDownPageDown: InputKeyDownPageDown,\n  InputKeyDownPageUp: InputKeyDownPageUp,\n  ItemClick: ItemClick,\n  ItemMouseMove: ItemMouseMove,\n  MenuMouseLeave: MenuMouseLeave,\n  ToggleButtonClick: ToggleButtonClick\n});\n\nfunction getInitialState$1(props) {\n  var initialState = getInitialState$2(props);\n  var selectedItem = initialState.selectedItem;\n  var inputValue = initialState.inputValue;\n  if (inputValue === '' && selectedItem && props.defaultInputValue === undefined && props.initialInputValue === undefined && props.inputValue === undefined) {\n    inputValue = props.itemToString(selectedItem);\n  }\n  return (0,esm_extends/* default */.A)({}, initialState, {\n    inputValue: inputValue\n  });\n}\nvar propTypes$1 = (0,esm_extends/* default */.A)({}, commonDropdownPropTypes, {\n  items: (prop_types_default()).array.isRequired,\n  isItemDisabled: (prop_types_default()).func,\n  inputValue: (prop_types_default()).string,\n  defaultInputValue: (prop_types_default()).string,\n  initialInputValue: (prop_types_default()).string,\n  inputId: (prop_types_default()).string,\n  onInputValueChange: (prop_types_default()).func\n});\n\n/**\n * The useCombobox version of useControlledReducer, which also\n * checks if the controlled prop selectedItem changed between\n * renders. If so, it will also update inputValue with its\n * string equivalent. It uses the common useEnhancedReducer to\n * compute the rest of the state.\n *\n * @param {Function} reducer Reducer function from downshift.\n * @param {Object} props The hook props, also passed to createInitialState.\n * @param {Function} createInitialState Function that returns the initial state.\n * @param {Function} isStateEqual Function that checks if a previous state is equal to the next.\n * @returns {Array} An array with the state and an action dispatcher.\n */\nfunction useControlledReducer(reducer, props, createInitialState, isStateEqual) {\n  var previousSelectedItemRef = (0,react.useRef)();\n  var _useEnhancedReducer = useEnhancedReducer(reducer, props, createInitialState, isStateEqual),\n    state = _useEnhancedReducer[0],\n    dispatch = _useEnhancedReducer[1];\n  var isInitialMount = useIsInitialMount();\n  (0,react.useEffect)(function () {\n    if (!isControlledProp(props, 'selectedItem')) {\n      return;\n    }\n    if (!isInitialMount // on first mount we already have the proper inputValue for a initial selected item.\n    ) {\n      var shouldCallDispatch = props.itemToKey(props.selectedItem) !== props.itemToKey(previousSelectedItemRef.current);\n      if (shouldCallDispatch) {\n        dispatch({\n          type: ControlledPropUpdatedSelectedItem,\n          inputValue: props.itemToString(props.selectedItem)\n        });\n      }\n    }\n    previousSelectedItemRef.current = state.selectedItem === previousSelectedItemRef.current ? props.selectedItem : state.selectedItem;\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [state.selectedItem, props.selectedItem]);\n  return [getState(state, props), dispatch];\n}\n\n// eslint-disable-next-line import/no-mutable-exports\nvar validatePropTypes$1 = noop;\n/* istanbul ignore next */\nif (false) {}\nvar defaultProps$1 = (0,esm_extends/* default */.A)({}, defaultProps$3, {\n  isItemDisabled: function isItemDisabled() {\n    return false;\n  }\n});\n\n/* eslint-disable complexity */\nfunction downshiftUseComboboxReducer(state, action) {\n  var _props$items;\n  var type = action.type,\n    props = action.props,\n    altKey = action.altKey;\n  var changes;\n  switch (type) {\n    case ItemClick:\n      changes = {\n        isOpen: getDefaultValue$1(props, 'isOpen'),\n        highlightedIndex: getDefaultHighlightedIndex(props),\n        selectedItem: props.items[action.index],\n        inputValue: props.itemToString(props.items[action.index])\n      };\n      break;\n    case InputKeyDownArrowDown:\n      if (state.isOpen) {\n        changes = {\n          highlightedIndex: getHighlightedIndex(state.highlightedIndex, 1, props.items, props.isItemDisabled, true)\n        };\n      } else {\n        changes = {\n          highlightedIndex: altKey && state.selectedItem == null ? -1 : getHighlightedIndexOnOpen(props, state, 1),\n          isOpen: props.items.length >= 0\n        };\n      }\n      break;\n    case InputKeyDownArrowUp:\n      if (state.isOpen) {\n        if (altKey) {\n          changes = getChangesOnSelection(props, state.highlightedIndex);\n        } else {\n          changes = {\n            highlightedIndex: getHighlightedIndex(state.highlightedIndex, -1, props.items, props.isItemDisabled, true)\n          };\n        }\n      } else {\n        changes = {\n          highlightedIndex: getHighlightedIndexOnOpen(props, state, -1),\n          isOpen: props.items.length >= 0\n        };\n      }\n      break;\n    case InputKeyDownEnter:\n      changes = getChangesOnSelection(props, state.highlightedIndex);\n      break;\n    case InputKeyDownEscape:\n      changes = (0,esm_extends/* default */.A)({\n        isOpen: false,\n        highlightedIndex: -1\n      }, !state.isOpen && {\n        selectedItem: null,\n        inputValue: ''\n      });\n      break;\n    case InputKeyDownPageUp:\n      changes = {\n        highlightedIndex: getHighlightedIndex(state.highlightedIndex, -10, props.items, props.isItemDisabled, true)\n      };\n      break;\n    case InputKeyDownPageDown:\n      changes = {\n        highlightedIndex: getHighlightedIndex(state.highlightedIndex, 10, props.items, props.isItemDisabled, true)\n      };\n      break;\n    case InputKeyDownHome:\n      changes = {\n        highlightedIndex: getNonDisabledIndex(0, false, props.items, props.isItemDisabled)\n      };\n      break;\n    case InputKeyDownEnd:\n      changes = {\n        highlightedIndex: getNonDisabledIndex(props.items.length - 1, true, props.items, props.isItemDisabled)\n      };\n      break;\n    case InputBlur:\n      changes = (0,esm_extends/* default */.A)({\n        isOpen: false,\n        highlightedIndex: -1\n      }, state.highlightedIndex >= 0 && ((_props$items = props.items) == null ? void 0 : _props$items.length) && action.selectItem && {\n        selectedItem: props.items[state.highlightedIndex],\n        inputValue: props.itemToString(props.items[state.highlightedIndex])\n      });\n      break;\n    case InputChange:\n      changes = {\n        isOpen: true,\n        highlightedIndex: getDefaultHighlightedIndex(props),\n        inputValue: action.inputValue\n      };\n      break;\n    case InputClick:\n      changes = {\n        isOpen: !state.isOpen,\n        highlightedIndex: state.isOpen ? -1 : getHighlightedIndexOnOpen(props, state, 0)\n      };\n      break;\n    case FunctionSelectItem:\n      changes = {\n        selectedItem: action.selectedItem,\n        inputValue: props.itemToString(action.selectedItem)\n      };\n      break;\n    case ControlledPropUpdatedSelectedItem:\n      changes = {\n        inputValue: action.inputValue\n      };\n      break;\n    default:\n      return downshiftCommonReducer(state, action, stateChangeTypes$1);\n  }\n  return (0,esm_extends/* default */.A)({}, state, changes);\n}\n/* eslint-enable complexity */\n\nvar _excluded$1 = [\"onMouseLeave\", \"refKey\", \"ref\"],\n  _excluded2$1 = [\"item\", \"index\", \"refKey\", \"ref\", \"onMouseMove\", \"onMouseDown\", \"onClick\", \"onPress\", \"disabled\"],\n  _excluded3 = [\"onClick\", \"onPress\", \"refKey\", \"ref\"],\n  _excluded4 = [\"onKeyDown\", \"onChange\", \"onInput\", \"onBlur\", \"onChangeText\", \"onClick\", \"refKey\", \"ref\"];\nuseCombobox.stateChangeTypes = stateChangeTypes$1;\nfunction useCombobox(userProps) {\n  if (userProps === void 0) {\n    userProps = {};\n  }\n  validatePropTypes$1(userProps, useCombobox);\n  // Props defaults and destructuring.\n  var props = (0,esm_extends/* default */.A)({}, defaultProps$1, userProps);\n  var items = props.items,\n    scrollIntoView = props.scrollIntoView,\n    environment = props.environment,\n    getA11yStatusMessage = props.getA11yStatusMessage;\n  // Initial state depending on controlled props.\n  var _useControlledReducer = useControlledReducer(downshiftUseComboboxReducer, props, getInitialState$1, isDropdownsStateEqual),\n    state = _useControlledReducer[0],\n    dispatch = _useControlledReducer[1];\n  var isOpen = state.isOpen,\n    highlightedIndex = state.highlightedIndex,\n    selectedItem = state.selectedItem,\n    inputValue = state.inputValue;\n\n  // Element refs.\n  var menuRef = (0,react.useRef)(null);\n  var itemRefs = (0,react.useRef)({});\n  var inputRef = (0,react.useRef)(null);\n  var toggleButtonRef = (0,react.useRef)(null);\n  var isInitialMount = useIsInitialMount();\n\n  // prevent id re-generation between renders.\n  var elementIds = useElementIds(props);\n  // used to keep track of how many items we had on previous cycle.\n  var previousResultCountRef = (0,react.useRef)();\n  // utility callback to get item element.\n  var latest = useLatestRef({\n    state: state,\n    props: props\n  });\n  var getItemNodeFromIndex = (0,react.useCallback)(function (index) {\n    return itemRefs.current[elementIds.getItemId(index)];\n  }, [elementIds]);\n\n  // Effects.\n  // Adds an a11y aria live status message if getA11yStatusMessage is passed.\n  useA11yMessageStatus(getA11yStatusMessage, state, [isOpen, highlightedIndex, selectedItem, inputValue], environment);\n  // Scroll on highlighted item if change comes from keyboard.\n  var shouldScrollRef = useScrollIntoView({\n    menuElement: menuRef.current,\n    highlightedIndex: highlightedIndex,\n    isOpen: isOpen,\n    itemRefs: itemRefs,\n    scrollIntoView: scrollIntoView,\n    getItemNodeFromIndex: getItemNodeFromIndex\n  });\n  useControlPropsValidator({\n    props: props,\n    state: state\n  });\n  // Focus the input on first render if required.\n  (0,react.useEffect)(function () {\n    var focusOnOpen = getInitialValue$1(props, 'isOpen');\n    if (focusOnOpen && inputRef.current) {\n      inputRef.current.focus();\n    }\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, []);\n  (0,react.useEffect)(function () {\n    if (!isInitialMount) {\n      previousResultCountRef.current = items.length;\n    }\n  });\n  var mouseAndTouchTrackers = useMouseAndTouchTracker(environment, (0,react.useCallback)(function handleBlur() {\n    if (latest.current.state.isOpen) {\n      dispatch({\n        type: InputBlur,\n        selectItem: false\n      });\n    }\n  }, [dispatch, latest]), (0,react.useMemo)(function () {\n    return [menuRef, toggleButtonRef, inputRef];\n  }, [menuRef.current, toggleButtonRef.current, inputRef.current]));\n  var setGetterPropCallInfo = useGetterPropsCalledChecker('getInputProps', 'getMenuProps');\n  // Reset itemRefs on close.\n  (0,react.useEffect)(function () {\n    if (!isOpen) {\n      itemRefs.current = {};\n    }\n  }, [isOpen]);\n  // Reset itemRefs on close.\n  (0,react.useEffect)(function () {\n    var _inputRef$current;\n    if (!isOpen || !(environment != null && environment.document) || !(inputRef != null && (_inputRef$current = inputRef.current) != null && _inputRef$current.focus)) {\n      return;\n    }\n    if (environment.document.activeElement !== inputRef.current) {\n      inputRef.current.focus();\n    }\n  }, [isOpen, environment]);\n\n  /* Event handler functions */\n  var inputKeyDownHandlers = (0,react.useMemo)(function () {\n    return {\n      ArrowDown: function ArrowDown(event) {\n        event.preventDefault();\n        dispatch({\n          type: InputKeyDownArrowDown,\n          altKey: event.altKey\n        });\n      },\n      ArrowUp: function ArrowUp(event) {\n        event.preventDefault();\n        dispatch({\n          type: InputKeyDownArrowUp,\n          altKey: event.altKey\n        });\n      },\n      Home: function Home(event) {\n        if (!latest.current.state.isOpen) {\n          return;\n        }\n        event.preventDefault();\n        dispatch({\n          type: InputKeyDownHome\n        });\n      },\n      End: function End(event) {\n        if (!latest.current.state.isOpen) {\n          return;\n        }\n        event.preventDefault();\n        dispatch({\n          type: InputKeyDownEnd\n        });\n      },\n      Escape: function Escape(event) {\n        var latestState = latest.current.state;\n        if (latestState.isOpen || latestState.inputValue || latestState.selectedItem || latestState.highlightedIndex > -1) {\n          event.preventDefault();\n          dispatch({\n            type: InputKeyDownEscape\n          });\n        }\n      },\n      Enter: function Enter(event) {\n        var latestState = latest.current.state;\n        // if closed or no highlighted index, do nothing.\n        if (!latestState.isOpen || event.which === 229 // if IME composing, wait for next Enter keydown event.\n        ) {\n          return;\n        }\n        event.preventDefault();\n        dispatch({\n          type: InputKeyDownEnter\n        });\n      },\n      PageUp: function PageUp(event) {\n        if (latest.current.state.isOpen) {\n          event.preventDefault();\n          dispatch({\n            type: InputKeyDownPageUp\n          });\n        }\n      },\n      PageDown: function PageDown(event) {\n        if (latest.current.state.isOpen) {\n          event.preventDefault();\n          dispatch({\n            type: InputKeyDownPageDown\n          });\n        }\n      }\n    };\n  }, [dispatch, latest]);\n\n  // Getter props.\n  var getLabelProps = (0,react.useCallback)(function (labelProps) {\n    return (0,esm_extends/* default */.A)({\n      id: elementIds.labelId,\n      htmlFor: elementIds.inputId\n    }, labelProps);\n  }, [elementIds]);\n  var getMenuProps = (0,react.useCallback)(function (_temp, _temp2) {\n    var _extends2;\n    var _ref = _temp === void 0 ? {} : _temp,\n      onMouseLeave = _ref.onMouseLeave,\n      _ref$refKey = _ref.refKey,\n      refKey = _ref$refKey === void 0 ? 'ref' : _ref$refKey,\n      ref = _ref.ref,\n      rest = (0,objectWithoutPropertiesLoose/* default */.A)(_ref, _excluded$1);\n    var _ref2 = _temp2 === void 0 ? {} : _temp2,\n      _ref2$suppressRefErro = _ref2.suppressRefError,\n      suppressRefError = _ref2$suppressRefErro === void 0 ? false : _ref2$suppressRefErro;\n    setGetterPropCallInfo('getMenuProps', suppressRefError, refKey, menuRef);\n    return (0,esm_extends/* default */.A)((_extends2 = {}, _extends2[refKey] = handleRefs(ref, function (menuNode) {\n      menuRef.current = menuNode;\n    }), _extends2.id = elementIds.menuId, _extends2.role = 'listbox', _extends2['aria-labelledby'] = rest && rest['aria-label'] ? undefined : \"\" + elementIds.labelId, _extends2.onMouseLeave = callAllEventHandlers(onMouseLeave, function () {\n      dispatch({\n        type: MenuMouseLeave\n      });\n    }), _extends2), rest);\n  }, [dispatch, setGetterPropCallInfo, elementIds]);\n  var getItemProps = (0,react.useCallback)(function (_temp3) {\n    var _extends3, _ref4;\n    var _ref3 = _temp3 === void 0 ? {} : _temp3,\n      itemProp = _ref3.item,\n      indexProp = _ref3.index,\n      _ref3$refKey = _ref3.refKey,\n      refKey = _ref3$refKey === void 0 ? 'ref' : _ref3$refKey,\n      ref = _ref3.ref,\n      onMouseMove = _ref3.onMouseMove,\n      onMouseDown = _ref3.onMouseDown,\n      onClick = _ref3.onClick;\n      _ref3.onPress;\n      var disabledProp = _ref3.disabled,\n      rest = (0,objectWithoutPropertiesLoose/* default */.A)(_ref3, _excluded2$1);\n    if (disabledProp !== undefined) {\n      console.warn('Passing \"disabled\" as an argument to getItemProps is not supported anymore. Please use the isItemDisabled prop from useCombobox.');\n    }\n    var _latest$current = latest.current,\n      latestProps = _latest$current.props,\n      latestState = _latest$current.state;\n    var _getItemAndIndex = getItemAndIndex(itemProp, indexProp, latestProps.items, 'Pass either item or index to getItemProps!'),\n      item = _getItemAndIndex[0],\n      index = _getItemAndIndex[1];\n    var disabled = latestProps.isItemDisabled(item, index);\n    var onSelectKey = 'onClick';\n    var customClickHandler = onClick;\n    var itemHandleMouseMove = function itemHandleMouseMove() {\n      if (mouseAndTouchTrackers.isTouchEnd || index === latestState.highlightedIndex) {\n        return;\n      }\n      shouldScrollRef.current = false;\n      dispatch({\n        type: ItemMouseMove,\n        index: index,\n        disabled: disabled\n      });\n    };\n    var itemHandleClick = function itemHandleClick() {\n      dispatch({\n        type: ItemClick,\n        index: index\n      });\n    };\n    var itemHandleMouseDown = function itemHandleMouseDown(e) {\n      return e.preventDefault();\n    }; // keep focus on the input after item click select.\n\n    return (0,esm_extends/* default */.A)((_extends3 = {}, _extends3[refKey] = handleRefs(ref, function (itemNode) {\n      if (itemNode) {\n        itemRefs.current[elementIds.getItemId(index)] = itemNode;\n      }\n    }), _extends3['aria-disabled'] = disabled, _extends3['aria-selected'] = index === latestState.highlightedIndex, _extends3.id = elementIds.getItemId(index), _extends3.role = 'option', _extends3), !disabled && (_ref4 = {}, _ref4[onSelectKey] = callAllEventHandlers(customClickHandler, itemHandleClick), _ref4), {\n      onMouseMove: callAllEventHandlers(onMouseMove, itemHandleMouseMove),\n      onMouseDown: callAllEventHandlers(onMouseDown, itemHandleMouseDown)\n    }, rest);\n  }, [dispatch, elementIds, latest, mouseAndTouchTrackers, shouldScrollRef]);\n  var getToggleButtonProps = (0,react.useCallback)(function (_temp4) {\n    var _extends4;\n    var _ref5 = _temp4 === void 0 ? {} : _temp4,\n      onClick = _ref5.onClick;\n      _ref5.onPress;\n      var _ref5$refKey = _ref5.refKey,\n      refKey = _ref5$refKey === void 0 ? 'ref' : _ref5$refKey,\n      ref = _ref5.ref,\n      rest = (0,objectWithoutPropertiesLoose/* default */.A)(_ref5, _excluded3);\n    var latestState = latest.current.state;\n    var toggleButtonHandleClick = function toggleButtonHandleClick() {\n      dispatch({\n        type: ToggleButtonClick\n      });\n    };\n    return (0,esm_extends/* default */.A)((_extends4 = {}, _extends4[refKey] = handleRefs(ref, function (toggleButtonNode) {\n      toggleButtonRef.current = toggleButtonNode;\n    }), _extends4['aria-controls'] = elementIds.menuId, _extends4['aria-expanded'] = latestState.isOpen, _extends4.id = elementIds.toggleButtonId, _extends4.tabIndex = -1, _extends4), !rest.disabled && (0,esm_extends/* default */.A)({}, {\n      onClick: callAllEventHandlers(onClick, toggleButtonHandleClick)\n    }), rest);\n  }, [dispatch, latest, elementIds]);\n  var getInputProps = (0,react.useCallback)(function (_temp5, _temp6) {\n    var _extends5;\n    var _ref6 = _temp5 === void 0 ? {} : _temp5,\n      onKeyDown = _ref6.onKeyDown,\n      onChange = _ref6.onChange,\n      onInput = _ref6.onInput,\n      onBlur = _ref6.onBlur;\n      _ref6.onChangeText;\n      var onClick = _ref6.onClick,\n      _ref6$refKey = _ref6.refKey,\n      refKey = _ref6$refKey === void 0 ? 'ref' : _ref6$refKey,\n      ref = _ref6.ref,\n      rest = (0,objectWithoutPropertiesLoose/* default */.A)(_ref6, _excluded4);\n    var _ref7 = _temp6 === void 0 ? {} : _temp6,\n      _ref7$suppressRefErro = _ref7.suppressRefError,\n      suppressRefError = _ref7$suppressRefErro === void 0 ? false : _ref7$suppressRefErro;\n    setGetterPropCallInfo('getInputProps', suppressRefError, refKey, inputRef);\n    var latestState = latest.current.state;\n    var inputHandleKeyDown = function inputHandleKeyDown(event) {\n      var key = normalizeArrowKey(event);\n      if (key && inputKeyDownHandlers[key]) {\n        inputKeyDownHandlers[key](event);\n      }\n    };\n    var inputHandleChange = function inputHandleChange(event) {\n      dispatch({\n        type: InputChange,\n        inputValue: event.target.value\n      });\n    };\n    var inputHandleBlur = function inputHandleBlur(event) {\n      /* istanbul ignore else */\n      if (environment != null && environment.document && latestState.isOpen && !mouseAndTouchTrackers.isMouseDown) {\n        var isBlurByTabChange = event.relatedTarget === null && environment.document.activeElement !== environment.document.body;\n        dispatch({\n          type: InputBlur,\n          selectItem: !isBlurByTabChange\n        });\n      }\n    };\n    var inputHandleClick = function inputHandleClick() {\n      dispatch({\n        type: InputClick\n      });\n    };\n\n    /* istanbul ignore next (preact) */\n    var onChangeKey = 'onChange';\n    var eventHandlers = {};\n    if (!rest.disabled) {\n      var _eventHandlers;\n      eventHandlers = (_eventHandlers = {}, _eventHandlers[onChangeKey] = callAllEventHandlers(onChange, onInput, inputHandleChange), _eventHandlers.onKeyDown = callAllEventHandlers(onKeyDown, inputHandleKeyDown), _eventHandlers.onBlur = callAllEventHandlers(onBlur, inputHandleBlur), _eventHandlers.onClick = callAllEventHandlers(onClick, inputHandleClick), _eventHandlers);\n    }\n    return (0,esm_extends/* default */.A)((_extends5 = {}, _extends5[refKey] = handleRefs(ref, function (inputNode) {\n      inputRef.current = inputNode;\n    }), _extends5['aria-activedescendant'] = latestState.isOpen && latestState.highlightedIndex > -1 ? elementIds.getItemId(latestState.highlightedIndex) : '', _extends5['aria-autocomplete'] = 'list', _extends5['aria-controls'] = elementIds.menuId, _extends5['aria-expanded'] = latestState.isOpen, _extends5['aria-labelledby'] = rest && rest['aria-label'] ? undefined : elementIds.labelId, _extends5.autoComplete = 'off', _extends5.id = elementIds.inputId, _extends5.role = 'combobox', _extends5.value = latestState.inputValue, _extends5), eventHandlers, rest);\n  }, [dispatch, elementIds, environment, inputKeyDownHandlers, latest, mouseAndTouchTrackers, setGetterPropCallInfo]);\n\n  // returns\n  var toggleMenu = (0,react.useCallback)(function () {\n    dispatch({\n      type: FunctionToggleMenu\n    });\n  }, [dispatch]);\n  var closeMenu = (0,react.useCallback)(function () {\n    dispatch({\n      type: FunctionCloseMenu\n    });\n  }, [dispatch]);\n  var openMenu = (0,react.useCallback)(function () {\n    dispatch({\n      type: FunctionOpenMenu\n    });\n  }, [dispatch]);\n  var setHighlightedIndex = (0,react.useCallback)(function (newHighlightedIndex) {\n    dispatch({\n      type: FunctionSetHighlightedIndex,\n      highlightedIndex: newHighlightedIndex\n    });\n  }, [dispatch]);\n  var selectItem = (0,react.useCallback)(function (newSelectedItem) {\n    dispatch({\n      type: FunctionSelectItem,\n      selectedItem: newSelectedItem\n    });\n  }, [dispatch]);\n  var setInputValue = (0,react.useCallback)(function (newInputValue) {\n    dispatch({\n      type: FunctionSetInputValue,\n      inputValue: newInputValue\n    });\n  }, [dispatch]);\n  var reset = (0,react.useCallback)(function () {\n    dispatch({\n      type: FunctionReset$1\n    });\n  }, [dispatch]);\n  return {\n    // prop getters.\n    getItemProps: getItemProps,\n    getLabelProps: getLabelProps,\n    getMenuProps: getMenuProps,\n    getInputProps: getInputProps,\n    getToggleButtonProps: getToggleButtonProps,\n    // actions.\n    toggleMenu: toggleMenu,\n    openMenu: openMenu,\n    closeMenu: closeMenu,\n    setHighlightedIndex: setHighlightedIndex,\n    setInputValue: setInputValue,\n    selectItem: selectItem,\n    reset: reset,\n    // state.\n    highlightedIndex: highlightedIndex,\n    isOpen: isOpen,\n    selectedItem: selectedItem,\n    inputValue: inputValue\n  };\n}\n\nvar defaultStateValues = {\n  activeIndex: -1,\n  selectedItems: []\n};\n\n/**\n * Returns the initial value for a state key in the following order:\n * 1. controlled prop, 2. initial prop, 3. default prop, 4. default\n * value from Downshift.\n *\n * @param {Object} props Props passed to the hook.\n * @param {string} propKey Props key to generate the value for.\n * @returns {any} The initial value for that prop.\n */\nfunction getInitialValue(props, propKey) {\n  return getInitialValue$1(props, propKey, defaultStateValues);\n}\n\n/**\n * Returns the default value for a state key in the following order:\n * 1. controlled prop, 2. default prop, 3. default value from Downshift.\n *\n * @param {Object} props Props passed to the hook.\n * @param {string} propKey Props key to generate the value for.\n * @returns {any} The initial value for that prop.\n */\nfunction getDefaultValue(props, propKey) {\n  return getDefaultValue$1(props, propKey, defaultStateValues);\n}\n\n/**\n * Gets the initial state based on the provided props. It uses initial, default\n * and controlled props related to state in order to compute the initial value.\n *\n * @param {Object} props Props passed to the hook.\n * @returns {Object} The initial state.\n */\nfunction getInitialState(props) {\n  var activeIndex = getInitialValue(props, 'activeIndex');\n  var selectedItems = getInitialValue(props, 'selectedItems');\n  return {\n    activeIndex: activeIndex,\n    selectedItems: selectedItems\n  };\n}\n\n/**\n * Returns true if dropdown keydown operation is permitted. Should not be\n * allowed on keydown with modifier keys (ctrl, alt, shift, meta), on\n * input element with text content that is either highlighted or selection\n * cursor is not at the starting position.\n *\n * @param {KeyboardEvent} event The event from keydown.\n * @returns {boolean} Whether the operation is allowed.\n */\nfunction isKeyDownOperationPermitted(event) {\n  if (event.shiftKey || event.metaKey || event.ctrlKey || event.altKey) {\n    return false;\n  }\n  var element = event.target;\n  if (element instanceof HTMLInputElement &&\n  // if element is a text input\n  element.value !== '' && (\n  // and we have text in it\n  // and cursor is either not at the start or is currently highlighting text.\n  element.selectionStart !== 0 || element.selectionEnd !== 0)) {\n    return false;\n  }\n  return true;\n}\n\n/**\n * Check if a state is equal for taglist, by comparing active index and selected items.\n * Used by useSelect and useCombobox.\n *\n * @param {Object} prevState\n * @param {Object} newState\n * @returns {boolean} Wheather the states are deeply equal.\n */\nfunction isStateEqual(prevState, newState) {\n  return prevState.selectedItems === newState.selectedItems && prevState.activeIndex === newState.activeIndex;\n}\nvar propTypes = {\n  stateReducer: commonPropTypes.stateReducer,\n  itemToKey: commonPropTypes.itemToKey,\n  environment: commonPropTypes.environment,\n  selectedItems: (prop_types_default()).array,\n  initialSelectedItems: (prop_types_default()).array,\n  defaultSelectedItems: (prop_types_default()).array,\n  getA11yStatusMessage: (prop_types_default()).func,\n  activeIndex: (prop_types_default()).number,\n  initialActiveIndex: (prop_types_default()).number,\n  defaultActiveIndex: (prop_types_default()).number,\n  onActiveIndexChange: (prop_types_default()).func,\n  onSelectedItemsChange: (prop_types_default()).func,\n  keyNavigationNext: (prop_types_default()).string,\n  keyNavigationPrevious: (prop_types_default()).string\n};\nvar defaultProps = {\n  itemToKey: defaultProps$3.itemToKey,\n  stateReducer: defaultProps$3.stateReducer,\n  environment: defaultProps$3.environment,\n  keyNavigationNext: 'ArrowRight',\n  keyNavigationPrevious: 'ArrowLeft'\n};\n\n// eslint-disable-next-line import/no-mutable-exports\nvar validatePropTypes = noop;\n/* istanbul ignore next */\nif (false) {}\n\nvar SelectedItemClick =  false ? 0 : 0;\nvar SelectedItemKeyDownDelete =  false ? 0 : 1;\nvar SelectedItemKeyDownBackspace =  false ? 0 : 2;\nvar SelectedItemKeyDownNavigationNext =  false ? 0 : 3;\nvar SelectedItemKeyDownNavigationPrevious =  false ? 0 : 4;\nvar DropdownKeyDownNavigationPrevious =  false ? 0 : 5;\nvar DropdownKeyDownBackspace =  false ? 0 : 6;\nvar DropdownClick =  false ? 0 : 7;\nvar FunctionAddSelectedItem =  false ? 0 : 8;\nvar FunctionRemoveSelectedItem =  false ? 0 : 9;\nvar FunctionSetSelectedItems =  false ? 0 : 10;\nvar FunctionSetActiveIndex =  false ? 0 : 11;\nvar FunctionReset =  false ? 0 : 12;\n\nvar stateChangeTypes = /*#__PURE__*/Object.freeze({\n  __proto__: null,\n  DropdownClick: DropdownClick,\n  DropdownKeyDownBackspace: DropdownKeyDownBackspace,\n  DropdownKeyDownNavigationPrevious: DropdownKeyDownNavigationPrevious,\n  FunctionAddSelectedItem: FunctionAddSelectedItem,\n  FunctionRemoveSelectedItem: FunctionRemoveSelectedItem,\n  FunctionReset: FunctionReset,\n  FunctionSetActiveIndex: FunctionSetActiveIndex,\n  FunctionSetSelectedItems: FunctionSetSelectedItems,\n  SelectedItemClick: SelectedItemClick,\n  SelectedItemKeyDownBackspace: SelectedItemKeyDownBackspace,\n  SelectedItemKeyDownDelete: SelectedItemKeyDownDelete,\n  SelectedItemKeyDownNavigationNext: SelectedItemKeyDownNavigationNext,\n  SelectedItemKeyDownNavigationPrevious: SelectedItemKeyDownNavigationPrevious\n});\n\n/* eslint-disable complexity */\nfunction downshiftMultipleSelectionReducer(state, action) {\n  var type = action.type,\n    index = action.index,\n    props = action.props,\n    selectedItem = action.selectedItem;\n  var activeIndex = state.activeIndex,\n    selectedItems = state.selectedItems;\n  var changes;\n  switch (type) {\n    case SelectedItemClick:\n      changes = {\n        activeIndex: index\n      };\n      break;\n    case SelectedItemKeyDownNavigationPrevious:\n      changes = {\n        activeIndex: activeIndex - 1 < 0 ? 0 : activeIndex - 1\n      };\n      break;\n    case SelectedItemKeyDownNavigationNext:\n      changes = {\n        activeIndex: activeIndex + 1 >= selectedItems.length ? -1 : activeIndex + 1\n      };\n      break;\n    case SelectedItemKeyDownBackspace:\n    case SelectedItemKeyDownDelete:\n      {\n        if (activeIndex < 0) {\n          break;\n        }\n        var newActiveIndex = activeIndex;\n        if (selectedItems.length === 1) {\n          newActiveIndex = -1;\n        } else if (activeIndex === selectedItems.length - 1) {\n          newActiveIndex = selectedItems.length - 2;\n        }\n        changes = (0,esm_extends/* default */.A)({\n          selectedItems: [].concat(selectedItems.slice(0, activeIndex), selectedItems.slice(activeIndex + 1))\n        }, {\n          activeIndex: newActiveIndex\n        });\n        break;\n      }\n    case DropdownKeyDownNavigationPrevious:\n      changes = {\n        activeIndex: selectedItems.length - 1\n      };\n      break;\n    case DropdownKeyDownBackspace:\n      changes = {\n        selectedItems: selectedItems.slice(0, selectedItems.length - 1)\n      };\n      break;\n    case FunctionAddSelectedItem:\n      changes = {\n        selectedItems: [].concat(selectedItems, [selectedItem])\n      };\n      break;\n    case DropdownClick:\n      changes = {\n        activeIndex: -1\n      };\n      break;\n    case FunctionRemoveSelectedItem:\n      {\n        var _newActiveIndex = activeIndex;\n        var selectedItemIndex = selectedItems.findIndex(function (item) {\n          return props.itemToKey(item) === props.itemToKey(selectedItem);\n        });\n        if (selectedItemIndex < 0) {\n          break;\n        }\n        if (selectedItems.length === 1) {\n          _newActiveIndex = -1;\n        } else if (selectedItemIndex === selectedItems.length - 1) {\n          _newActiveIndex = selectedItems.length - 2;\n        }\n        changes = {\n          selectedItems: [].concat(selectedItems.slice(0, selectedItemIndex), selectedItems.slice(selectedItemIndex + 1)),\n          activeIndex: _newActiveIndex\n        };\n        break;\n      }\n    case FunctionSetSelectedItems:\n      {\n        var newSelectedItems = action.selectedItems;\n        changes = {\n          selectedItems: newSelectedItems\n        };\n        break;\n      }\n    case FunctionSetActiveIndex:\n      {\n        var _newActiveIndex2 = action.activeIndex;\n        changes = {\n          activeIndex: _newActiveIndex2\n        };\n        break;\n      }\n    case FunctionReset:\n      changes = {\n        activeIndex: getDefaultValue(props, 'activeIndex'),\n        selectedItems: getDefaultValue(props, 'selectedItems')\n      };\n      break;\n    default:\n      throw new Error('Reducer called without proper action type.');\n  }\n  return (0,esm_extends/* default */.A)({}, state, changes);\n}\n\nvar _excluded = [\"refKey\", \"ref\", \"onClick\", \"onKeyDown\", \"selectedItem\", \"index\"],\n  _excluded2 = [\"refKey\", \"ref\", \"onKeyDown\", \"onClick\", \"preventKeyAction\"];\nuseMultipleSelection.stateChangeTypes = stateChangeTypes;\nfunction useMultipleSelection(userProps) {\n  if (userProps === void 0) {\n    userProps = {};\n  }\n  validatePropTypes(userProps, useMultipleSelection);\n  // Props defaults and destructuring.\n  var props = (0,esm_extends/* default */.A)({}, defaultProps, userProps);\n  var getA11yStatusMessage = props.getA11yStatusMessage,\n    environment = props.environment,\n    keyNavigationNext = props.keyNavigationNext,\n    keyNavigationPrevious = props.keyNavigationPrevious;\n\n  // Reducer init.\n  var _useControlledReducer = useControlledReducer$1(downshiftMultipleSelectionReducer, props, getInitialState, isStateEqual),\n    state = _useControlledReducer[0],\n    dispatch = _useControlledReducer[1];\n  var activeIndex = state.activeIndex,\n    selectedItems = state.selectedItems;\n\n  // Refs.\n  var isInitialMount = useIsInitialMount();\n  var dropdownRef = (0,react.useRef)(null);\n  var selectedItemRefs = (0,react.useRef)();\n  selectedItemRefs.current = [];\n  var latest = useLatestRef({\n    state: state,\n    props: props\n  });\n\n  // Effects.\n  // Adds an a11y aria live status message if getA11yStatusMessage is passed.\n  useA11yMessageStatus(getA11yStatusMessage, state, [activeIndex, selectedItems], environment);\n  // Sets focus on active item.\n  (0,react.useEffect)(function () {\n    if (isInitialMount) {\n      return;\n    }\n    if (activeIndex === -1 && dropdownRef.current) {\n      dropdownRef.current.focus();\n    } else if (selectedItemRefs.current[activeIndex]) {\n      selectedItemRefs.current[activeIndex].focus();\n    }\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [activeIndex]);\n  useControlPropsValidator({\n    props: props,\n    state: state\n  });\n  var setGetterPropCallInfo = useGetterPropsCalledChecker('getDropdownProps');\n\n  // Event handler functions.\n  var selectedItemKeyDownHandlers = (0,react.useMemo)(function () {\n    var _ref;\n    return _ref = {}, _ref[keyNavigationPrevious] = function () {\n      dispatch({\n        type: SelectedItemKeyDownNavigationPrevious\n      });\n    }, _ref[keyNavigationNext] = function () {\n      dispatch({\n        type: SelectedItemKeyDownNavigationNext\n      });\n    }, _ref.Delete = function Delete() {\n      dispatch({\n        type: SelectedItemKeyDownDelete\n      });\n    }, _ref.Backspace = function Backspace() {\n      dispatch({\n        type: SelectedItemKeyDownBackspace\n      });\n    }, _ref;\n  }, [dispatch, keyNavigationNext, keyNavigationPrevious]);\n  var dropdownKeyDownHandlers = (0,react.useMemo)(function () {\n    var _ref2;\n    return _ref2 = {}, _ref2[keyNavigationPrevious] = function (event) {\n      if (isKeyDownOperationPermitted(event)) {\n        dispatch({\n          type: DropdownKeyDownNavigationPrevious\n        });\n      }\n    }, _ref2.Backspace = function Backspace(event) {\n      if (isKeyDownOperationPermitted(event)) {\n        dispatch({\n          type: DropdownKeyDownBackspace\n        });\n      }\n    }, _ref2;\n  }, [dispatch, keyNavigationPrevious]);\n\n  // Getter props.\n  var getSelectedItemProps = (0,react.useCallback)(function (_temp) {\n    var _extends2;\n    var _ref3 = _temp === void 0 ? {} : _temp,\n      _ref3$refKey = _ref3.refKey,\n      refKey = _ref3$refKey === void 0 ? 'ref' : _ref3$refKey,\n      ref = _ref3.ref,\n      onClick = _ref3.onClick,\n      onKeyDown = _ref3.onKeyDown,\n      selectedItemProp = _ref3.selectedItem,\n      indexProp = _ref3.index,\n      rest = (0,objectWithoutPropertiesLoose/* default */.A)(_ref3, _excluded);\n    var latestState = latest.current.state;\n    var _getItemAndIndex = getItemAndIndex(selectedItemProp, indexProp, latestState.selectedItems, 'Pass either item or index to getSelectedItemProps!'),\n      index = _getItemAndIndex[1];\n    var isFocusable = index > -1 && index === latestState.activeIndex;\n    var selectedItemHandleClick = function selectedItemHandleClick() {\n      dispatch({\n        type: SelectedItemClick,\n        index: index\n      });\n    };\n    var selectedItemHandleKeyDown = function selectedItemHandleKeyDown(event) {\n      var key = normalizeArrowKey(event);\n      if (key && selectedItemKeyDownHandlers[key]) {\n        selectedItemKeyDownHandlers[key](event);\n      }\n    };\n    return (0,esm_extends/* default */.A)((_extends2 = {}, _extends2[refKey] = handleRefs(ref, function (selectedItemNode) {\n      if (selectedItemNode) {\n        selectedItemRefs.current.push(selectedItemNode);\n      }\n    }), _extends2.tabIndex = isFocusable ? 0 : -1, _extends2.onClick = callAllEventHandlers(onClick, selectedItemHandleClick), _extends2.onKeyDown = callAllEventHandlers(onKeyDown, selectedItemHandleKeyDown), _extends2), rest);\n  }, [dispatch, latest, selectedItemKeyDownHandlers]);\n  var getDropdownProps = (0,react.useCallback)(function (_temp2, _temp3) {\n    var _extends3;\n    var _ref4 = _temp2 === void 0 ? {} : _temp2,\n      _ref4$refKey = _ref4.refKey,\n      refKey = _ref4$refKey === void 0 ? 'ref' : _ref4$refKey,\n      ref = _ref4.ref,\n      onKeyDown = _ref4.onKeyDown,\n      onClick = _ref4.onClick,\n      _ref4$preventKeyActio = _ref4.preventKeyAction,\n      preventKeyAction = _ref4$preventKeyActio === void 0 ? false : _ref4$preventKeyActio,\n      rest = (0,objectWithoutPropertiesLoose/* default */.A)(_ref4, _excluded2);\n    var _ref5 = _temp3 === void 0 ? {} : _temp3,\n      _ref5$suppressRefErro = _ref5.suppressRefError,\n      suppressRefError = _ref5$suppressRefErro === void 0 ? false : _ref5$suppressRefErro;\n    setGetterPropCallInfo('getDropdownProps', suppressRefError, refKey, dropdownRef);\n    var dropdownHandleKeyDown = function dropdownHandleKeyDown(event) {\n      var key = normalizeArrowKey(event);\n      if (key && dropdownKeyDownHandlers[key]) {\n        dropdownKeyDownHandlers[key](event);\n      }\n    };\n    var dropdownHandleClick = function dropdownHandleClick() {\n      dispatch({\n        type: DropdownClick\n      });\n    };\n    return (0,esm_extends/* default */.A)((_extends3 = {}, _extends3[refKey] = handleRefs(ref, function (dropdownNode) {\n      if (dropdownNode) {\n        dropdownRef.current = dropdownNode;\n      }\n    }), _extends3), !preventKeyAction && {\n      onKeyDown: callAllEventHandlers(onKeyDown, dropdownHandleKeyDown),\n      onClick: callAllEventHandlers(onClick, dropdownHandleClick)\n    }, rest);\n  }, [dispatch, dropdownKeyDownHandlers, setGetterPropCallInfo]);\n\n  // returns\n  var addSelectedItem = (0,react.useCallback)(function (selectedItem) {\n    dispatch({\n      type: FunctionAddSelectedItem,\n      selectedItem: selectedItem\n    });\n  }, [dispatch]);\n  var removeSelectedItem = (0,react.useCallback)(function (selectedItem) {\n    dispatch({\n      type: FunctionRemoveSelectedItem,\n      selectedItem: selectedItem\n    });\n  }, [dispatch]);\n  var setSelectedItems = (0,react.useCallback)(function (newSelectedItems) {\n    dispatch({\n      type: FunctionSetSelectedItems,\n      selectedItems: newSelectedItems\n    });\n  }, [dispatch]);\n  var setActiveIndex = (0,react.useCallback)(function (newActiveIndex) {\n    dispatch({\n      type: FunctionSetActiveIndex,\n      activeIndex: newActiveIndex\n    });\n  }, [dispatch]);\n  var reset = (0,react.useCallback)(function () {\n    dispatch({\n      type: FunctionReset\n    });\n  }, [dispatch]);\n  return {\n    getSelectedItemProps: getSelectedItemProps,\n    getDropdownProps: getDropdownProps,\n    addSelectedItem: addSelectedItem,\n    removeSelectedItem: removeSelectedItem,\n    setSelectedItems: setSelectedItems,\n    setActiveIndex: setActiveIndex,\n    reset: reset,\n    selectedItems: selectedItems,\n    activeIndex: activeIndex\n  };\n}\n\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9ub2RlX21vZHVsZXMvZG93bnNoaWZ0L2Rpc3QvZG93bnNoaWZ0LmVzbS5qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFBQTs7Ozs7QUNBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFjQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUtBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFPQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFNQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFJQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBOENBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUF1Q0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQWdCQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFLQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFLQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFLQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSIsInNvdXJjZXMiOlsid2VicGFjazovL0Bmb2xpby9zdHJpcGVzLWNvbXBvbmVudHMvLi9ub2RlX21vZHVsZXMvY29tcHV0ZS1zY3JvbGwtaW50by12aWV3L2Rpc3QvaW5kZXguanM/N2ZkZCIsIndlYnBhY2s6Ly9AZm9saW8vc3RyaXBlcy1jb21wb25lbnRzLy4vbm9kZV9tb2R1bGVzL2Rvd25zaGlmdC9kaXN0L2Rvd25zaGlmdC5lc20uanM/MzNjZSJdLCJzb3VyY2VzQ29udGVudCI6WyJjb25zdCB0PXQ9Plwib2JqZWN0XCI9PXR5cGVvZiB0JiZudWxsIT10JiYxPT09dC5ub2RlVHlwZSxlPSh0LGUpPT4oIWV8fFwiaGlkZGVuXCIhPT10KSYmKFwidmlzaWJsZVwiIT09dCYmXCJjbGlwXCIhPT10KSxuPSh0LG4pPT57aWYodC5jbGllbnRIZWlnaHQ8dC5zY3JvbGxIZWlnaHR8fHQuY2xpZW50V2lkdGg8dC5zY3JvbGxXaWR0aCl7Y29uc3Qgbz1nZXRDb21wdXRlZFN0eWxlKHQsbnVsbCk7cmV0dXJuIGUoby5vdmVyZmxvd1ksbil8fGUoby5vdmVyZmxvd1gsbil8fCh0PT57Y29uc3QgZT0odD0+e2lmKCF0Lm93bmVyRG9jdW1lbnR8fCF0Lm93bmVyRG9jdW1lbnQuZGVmYXVsdFZpZXcpcmV0dXJuIG51bGw7dHJ5e3JldHVybiB0Lm93bmVyRG9jdW1lbnQuZGVmYXVsdFZpZXcuZnJhbWVFbGVtZW50fWNhdGNoKHQpe3JldHVybiBudWxsfX0pKHQpO3JldHVybiEhZSYmKGUuY2xpZW50SGVpZ2h0PHQuc2Nyb2xsSGVpZ2h0fHxlLmNsaWVudFdpZHRoPHQuc2Nyb2xsV2lkdGgpfSkodCl9cmV0dXJuITF9LG89KHQsZSxuLG8sbCxyLGkscyk9PnI8dCYmaT5lfHxyPnQmJmk8ZT8wOnI8PXQmJnM8PW58fGk+PWUmJnM+PW4/ci10LW86aT5lJiZzPG58fHI8dCYmcz5uP2ktZStsOjAsbD10PT57Y29uc3QgZT10LnBhcmVudEVsZW1lbnQ7cmV0dXJuIG51bGw9PWU/dC5nZXRSb290Tm9kZSgpLmhvc3R8fG51bGw6ZX0scj0oZSxyKT0+e3ZhciBpLHMsZCxoO2lmKFwidW5kZWZpbmVkXCI9PXR5cGVvZiBkb2N1bWVudClyZXR1cm5bXTtjb25zdHtzY3JvbGxNb2RlOmMsYmxvY2s6ZixpbmxpbmU6dSxib3VuZGFyeTphLHNraXBPdmVyZmxvd0hpZGRlbkVsZW1lbnRzOmd9PXIscD1cImZ1bmN0aW9uXCI9PXR5cGVvZiBhP2E6dD0+dCE9PWE7aWYoIXQoZSkpdGhyb3cgbmV3IFR5cGVFcnJvcihcIkludmFsaWQgdGFyZ2V0XCIpO2NvbnN0IG09ZG9jdW1lbnQuc2Nyb2xsaW5nRWxlbWVudHx8ZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LHc9W107bGV0IFc9ZTtmb3IoO3QoVykmJnAoVyk7KXtpZihXPWwoVyksVz09PW0pe3cucHVzaChXKTticmVha31udWxsIT1XJiZXPT09ZG9jdW1lbnQuYm9keSYmbihXKSYmIW4oZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50KXx8bnVsbCE9VyYmbihXLGcpJiZ3LnB1c2goVyl9Y29uc3QgYj1udWxsIT0ocz1udWxsPT0oaT13aW5kb3cudmlzdWFsVmlld3BvcnQpP3ZvaWQgMDppLndpZHRoKT9zOmlubmVyV2lkdGgsSD1udWxsIT0oaD1udWxsPT0oZD13aW5kb3cudmlzdWFsVmlld3BvcnQpP3ZvaWQgMDpkLmhlaWdodCk/aDppbm5lckhlaWdodCx7c2Nyb2xsWDp5LHNjcm9sbFk6TX09d2luZG93LHtoZWlnaHQ6dix3aWR0aDpFLHRvcDp4LHJpZ2h0OkMsYm90dG9tOkksbGVmdDpSfT1lLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLHt0b3A6VCxyaWdodDpCLGJvdHRvbTpGLGxlZnQ6Vn09KHQ9Pntjb25zdCBlPXdpbmRvdy5nZXRDb21wdXRlZFN0eWxlKHQpO3JldHVybnt0b3A6cGFyc2VGbG9hdChlLnNjcm9sbE1hcmdpblRvcCl8fDAscmlnaHQ6cGFyc2VGbG9hdChlLnNjcm9sbE1hcmdpblJpZ2h0KXx8MCxib3R0b206cGFyc2VGbG9hdChlLnNjcm9sbE1hcmdpbkJvdHRvbSl8fDAsbGVmdDpwYXJzZUZsb2F0KGUuc2Nyb2xsTWFyZ2luTGVmdCl8fDB9fSkoZSk7bGV0IGs9XCJzdGFydFwiPT09Znx8XCJuZWFyZXN0XCI9PT1mP3gtVDpcImVuZFwiPT09Zj9JK0Y6eCt2LzItVCtGLEQ9XCJjZW50ZXJcIj09PXU/UitFLzItVitCOlwiZW5kXCI9PT11P0MrQjpSLVY7Y29uc3QgTD1bXTtmb3IobGV0IHQ9MDt0PHcubGVuZ3RoO3QrKyl7Y29uc3QgZT13W3RdLHtoZWlnaHQ6bCx3aWR0aDpyLHRvcDppLHJpZ2h0OnMsYm90dG9tOmQsbGVmdDpofT1lLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpO2lmKFwiaWYtbmVlZGVkXCI9PT1jJiZ4Pj0wJiZSPj0wJiZJPD1IJiZDPD1iJiYoZT09PW0mJiFuKGUpfHx4Pj1pJiZJPD1kJiZSPj1oJiZDPD1zKSlyZXR1cm4gTDtjb25zdCBhPWdldENvbXB1dGVkU3R5bGUoZSksZz1wYXJzZUludChhLmJvcmRlckxlZnRXaWR0aCwxMCkscD1wYXJzZUludChhLmJvcmRlclRvcFdpZHRoLDEwKSxXPXBhcnNlSW50KGEuYm9yZGVyUmlnaHRXaWR0aCwxMCksVD1wYXJzZUludChhLmJvcmRlckJvdHRvbVdpZHRoLDEwKTtsZXQgQj0wLEY9MDtjb25zdCBWPVwib2Zmc2V0V2lkdGhcImluIGU/ZS5vZmZzZXRXaWR0aC1lLmNsaWVudFdpZHRoLWctVzowLFM9XCJvZmZzZXRIZWlnaHRcImluIGU/ZS5vZmZzZXRIZWlnaHQtZS5jbGllbnRIZWlnaHQtcC1UOjAsWD1cIm9mZnNldFdpZHRoXCJpbiBlPzA9PT1lLm9mZnNldFdpZHRoPzA6ci9lLm9mZnNldFdpZHRoOjAsWT1cIm9mZnNldEhlaWdodFwiaW4gZT8wPT09ZS5vZmZzZXRIZWlnaHQ/MDpsL2Uub2Zmc2V0SGVpZ2h0OjA7aWYobT09PWUpQj1cInN0YXJ0XCI9PT1mP2s6XCJlbmRcIj09PWY/ay1IOlwibmVhcmVzdFwiPT09Zj9vKE0sTStILEgscCxULE0rayxNK2srdix2KTprLUgvMixGPVwic3RhcnRcIj09PXU/RDpcImNlbnRlclwiPT09dT9ELWIvMjpcImVuZFwiPT09dT9ELWI6byh5LHkrYixiLGcsVyx5K0QseStEK0UsRSksQj1NYXRoLm1heCgwLEIrTSksRj1NYXRoLm1heCgwLEYreSk7ZWxzZXtCPVwic3RhcnRcIj09PWY/ay1pLXA6XCJlbmRcIj09PWY/ay1kK1QrUzpcIm5lYXJlc3RcIj09PWY/byhpLGQsbCxwLFQrUyxrLGsrdix2KTprLShpK2wvMikrUy8yLEY9XCJzdGFydFwiPT09dT9ELWgtZzpcImNlbnRlclwiPT09dT9ELShoK3IvMikrVi8yOlwiZW5kXCI9PT11P0QtcytXK1Y6byhoLHMscixnLFcrVixELEQrRSxFKTtjb25zdHtzY3JvbGxMZWZ0OnQsc2Nyb2xsVG9wOm59PWU7Qj0wPT09WT8wOk1hdGgubWF4KDAsTWF0aC5taW4obitCL1ksZS5zY3JvbGxIZWlnaHQtbC9ZK1MpKSxGPTA9PT1YPzA6TWF0aC5tYXgoMCxNYXRoLm1pbih0K0YvWCxlLnNjcm9sbFdpZHRoLXIvWCtWKSksays9bi1CLEQrPXQtRn1MLnB1c2goe2VsOmUsdG9wOkIsbGVmdDpGfSl9cmV0dXJuIEx9O2V4cG9ydHtyIGFzIGNvbXB1dGV9Oy8vIyBzb3VyY2VNYXBwaW5nVVJMPWluZGV4LmpzLm1hcFxuIiwiaW1wb3J0IF9vYmplY3RXaXRob3V0UHJvcGVydGllc0xvb3NlIGZyb20gJ0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL29iamVjdFdpdGhvdXRQcm9wZXJ0aWVzTG9vc2UnO1xuaW1wb3J0IF9leHRlbmRzIGZyb20gJ0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL2V4dGVuZHMnO1xuaW1wb3J0IF9pbmhlcml0c0xvb3NlIGZyb20gJ0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL2luaGVyaXRzTG9vc2UnO1xuaW1wb3J0IFByb3BUeXBlcyBmcm9tICdwcm9wLXR5cGVzJztcbmltcG9ydCBSZWFjdCwgeyBjbG9uZUVsZW1lbnQsIENvbXBvbmVudCwgdXNlUmVmLCB1c2VFZmZlY3QsIHVzZUxheW91dEVmZmVjdCwgdXNlQ2FsbGJhY2ssIHVzZVJlZHVjZXIsIHVzZU1lbW8gfSBmcm9tICdyZWFjdCc7XG5pbXBvcnQgeyBpc0ZvcndhcmRSZWYgfSBmcm9tICdyZWFjdC1pcyc7XG5pbXBvcnQgeyBjb21wdXRlIH0gZnJvbSAnY29tcHV0ZS1zY3JvbGwtaW50by12aWV3JztcbmltcG9ydCB7IF9fYXNzaWduIH0gZnJvbSAndHNsaWInO1xuXG52YXIgaWRDb3VudGVyID0gMDtcblxuLyoqXG4gKiBBY2NlcHRzIGEgcGFyYW1ldGVyIGFuZCByZXR1cm5zIGl0IGlmIGl0J3MgYSBmdW5jdGlvblxuICogb3IgYSBub29wIGZ1bmN0aW9uIGlmIGl0J3Mgbm90LiBUaGlzIGFsbG93cyB1cyB0b1xuICogYWNjZXB0IGEgY2FsbGJhY2ssIGJ1dCBub3Qgd29ycnkgYWJvdXQgaXQgaWYgaXQncyBub3RcbiAqIHBhc3NlZC5cbiAqIEBwYXJhbSB7RnVuY3Rpb259IGNiIHRoZSBjYWxsYmFja1xuICogQHJldHVybiB7RnVuY3Rpb259IGEgZnVuY3Rpb25cbiAqL1xuZnVuY3Rpb24gY2JUb0NiKGNiKSB7XG4gIHJldHVybiB0eXBlb2YgY2IgPT09ICdmdW5jdGlvbicgPyBjYiA6IG5vb3A7XG59XG5mdW5jdGlvbiBub29wKCkge31cblxuLyoqXG4gKiBTY3JvbGwgbm9kZSBpbnRvIHZpZXcgaWYgbmVjZXNzYXJ5XG4gKiBAcGFyYW0ge0hUTUxFbGVtZW50fSBub2RlIHRoZSBlbGVtZW50IHRoYXQgc2hvdWxkIHNjcm9sbCBpbnRvIHZpZXdcbiAqIEBwYXJhbSB7SFRNTEVsZW1lbnR9IG1lbnVOb2RlIHRoZSBtZW51IGVsZW1lbnQgb2YgdGhlIGNvbXBvbmVudFxuICovXG5mdW5jdGlvbiBzY3JvbGxJbnRvVmlldyhub2RlLCBtZW51Tm9kZSkge1xuICBpZiAoIW5vZGUpIHtcbiAgICByZXR1cm47XG4gIH1cbiAgdmFyIGFjdGlvbnMgPSBjb21wdXRlKG5vZGUsIHtcbiAgICBib3VuZGFyeTogbWVudU5vZGUsXG4gICAgYmxvY2s6ICduZWFyZXN0JyxcbiAgICBzY3JvbGxNb2RlOiAnaWYtbmVlZGVkJ1xuICB9KTtcbiAgYWN0aW9ucy5mb3JFYWNoKGZ1bmN0aW9uIChfcmVmKSB7XG4gICAgdmFyIGVsID0gX3JlZi5lbCxcbiAgICAgIHRvcCA9IF9yZWYudG9wLFxuICAgICAgbGVmdCA9IF9yZWYubGVmdDtcbiAgICBlbC5zY3JvbGxUb3AgPSB0b3A7XG4gICAgZWwuc2Nyb2xsTGVmdCA9IGxlZnQ7XG4gIH0pO1xufVxuXG4vKipcbiAqIEBwYXJhbSB7SFRNTEVsZW1lbnR9IHBhcmVudCB0aGUgcGFyZW50IG5vZGVcbiAqIEBwYXJhbSB7SFRNTEVsZW1lbnR9IGNoaWxkIHRoZSBjaGlsZCBub2RlXG4gKiBAcGFyYW0ge1dpbmRvd30gZW52aXJvbm1lbnQgVGhlIHdpbmRvdyBjb250ZXh0IHdoZXJlIGRvd25zaGlmdCByZW5kZXJzLlxuICogQHJldHVybiB7Qm9vbGVhbn0gd2hldGhlciB0aGUgcGFyZW50IGlzIHRoZSBjaGlsZCBvciB0aGUgY2hpbGQgaXMgaW4gdGhlIHBhcmVudFxuICovXG5mdW5jdGlvbiBpc09yQ29udGFpbnNOb2RlKHBhcmVudCwgY2hpbGQsIGVudmlyb25tZW50KSB7XG4gIHZhciByZXN1bHQgPSBwYXJlbnQgPT09IGNoaWxkIHx8IGNoaWxkIGluc3RhbmNlb2YgZW52aXJvbm1lbnQuTm9kZSAmJiBwYXJlbnQuY29udGFpbnMgJiYgcGFyZW50LmNvbnRhaW5zKGNoaWxkKTtcbiAgcmV0dXJuIHJlc3VsdDtcbn1cblxuLyoqXG4gKiBTaW1wbGUgZGVib3VuY2UgaW1wbGVtZW50YXRpb24uIFdpbGwgY2FsbCB0aGUgZ2l2ZW5cbiAqIGZ1bmN0aW9uIG9uY2UgYWZ0ZXIgdGhlIHRpbWUgZ2l2ZW4gaGFzIHBhc3NlZCBzaW5jZVxuICogaXQgd2FzIGxhc3QgY2FsbGVkLlxuICogQHBhcmFtIHtGdW5jdGlvbn0gZm4gdGhlIGZ1bmN0aW9uIHRvIGNhbGwgYWZ0ZXIgdGhlIHRpbWVcbiAqIEBwYXJhbSB7TnVtYmVyfSB0aW1lIHRoZSB0aW1lIHRvIHdhaXRcbiAqIEByZXR1cm4ge0Z1bmN0aW9ufSB0aGUgZGVib3VuY2VkIGZ1bmN0aW9uXG4gKi9cbmZ1bmN0aW9uIGRlYm91bmNlKGZuLCB0aW1lKSB7XG4gIHZhciB0aW1lb3V0SWQ7XG4gIGZ1bmN0aW9uIGNhbmNlbCgpIHtcbiAgICBpZiAodGltZW91dElkKSB7XG4gICAgICBjbGVhclRpbWVvdXQodGltZW91dElkKTtcbiAgICB9XG4gIH1cbiAgZnVuY3Rpb24gd3JhcHBlcigpIHtcbiAgICBmb3IgKHZhciBfbGVuID0gYXJndW1lbnRzLmxlbmd0aCwgYXJncyA9IG5ldyBBcnJheShfbGVuKSwgX2tleSA9IDA7IF9rZXkgPCBfbGVuOyBfa2V5KyspIHtcbiAgICAgIGFyZ3NbX2tleV0gPSBhcmd1bWVudHNbX2tleV07XG4gICAgfVxuICAgIGNhbmNlbCgpO1xuICAgIHRpbWVvdXRJZCA9IHNldFRpbWVvdXQoZnVuY3Rpb24gKCkge1xuICAgICAgdGltZW91dElkID0gbnVsbDtcbiAgICAgIGZuLmFwcGx5KHZvaWQgMCwgYXJncyk7XG4gICAgfSwgdGltZSk7XG4gIH1cbiAgd3JhcHBlci5jYW5jZWwgPSBjYW5jZWw7XG4gIHJldHVybiB3cmFwcGVyO1xufVxuXG4vKipcbiAqIFRoaXMgaXMgaW50ZW5kZWQgdG8gYmUgdXNlZCB0byBjb21wb3NlIGV2ZW50IGhhbmRsZXJzLlxuICogVGhleSBhcmUgZXhlY3V0ZWQgaW4gb3JkZXIgdW50aWwgb25lIG9mIHRoZW0gc2V0c1xuICogYGV2ZW50LnByZXZlbnREb3duc2hpZnREZWZhdWx0ID0gdHJ1ZWAuXG4gKiBAcGFyYW0gey4uLkZ1bmN0aW9ufSBmbnMgdGhlIGV2ZW50IGhhbmRsZXIgZnVuY3Rpb25zXG4gKiBAcmV0dXJuIHtGdW5jdGlvbn0gdGhlIGV2ZW50IGhhbmRsZXIgdG8gYWRkIHRvIGFuIGVsZW1lbnRcbiAqL1xuZnVuY3Rpb24gY2FsbEFsbEV2ZW50SGFuZGxlcnMoKSB7XG4gIGZvciAodmFyIF9sZW4yID0gYXJndW1lbnRzLmxlbmd0aCwgZm5zID0gbmV3IEFycmF5KF9sZW4yKSwgX2tleTIgPSAwOyBfa2V5MiA8IF9sZW4yOyBfa2V5MisrKSB7XG4gICAgZm5zW19rZXkyXSA9IGFyZ3VtZW50c1tfa2V5Ml07XG4gIH1cbiAgcmV0dXJuIGZ1bmN0aW9uIChldmVudCkge1xuICAgIGZvciAodmFyIF9sZW4zID0gYXJndW1lbnRzLmxlbmd0aCwgYXJncyA9IG5ldyBBcnJheShfbGVuMyA+IDEgPyBfbGVuMyAtIDEgOiAwKSwgX2tleTMgPSAxOyBfa2V5MyA8IF9sZW4zOyBfa2V5MysrKSB7XG4gICAgICBhcmdzW19rZXkzIC0gMV0gPSBhcmd1bWVudHNbX2tleTNdO1xuICAgIH1cbiAgICByZXR1cm4gZm5zLnNvbWUoZnVuY3Rpb24gKGZuKSB7XG4gICAgICBpZiAoZm4pIHtcbiAgICAgICAgZm4uYXBwbHkodm9pZCAwLCBbZXZlbnRdLmNvbmNhdChhcmdzKSk7XG4gICAgICB9XG4gICAgICByZXR1cm4gZXZlbnQucHJldmVudERvd25zaGlmdERlZmF1bHQgfHwgZXZlbnQuaGFzT3duUHJvcGVydHkoJ25hdGl2ZUV2ZW50JykgJiYgZXZlbnQubmF0aXZlRXZlbnQucHJldmVudERvd25zaGlmdERlZmF1bHQ7XG4gICAgfSk7XG4gIH07XG59XG5mdW5jdGlvbiBoYW5kbGVSZWZzKCkge1xuICBmb3IgKHZhciBfbGVuNCA9IGFyZ3VtZW50cy5sZW5ndGgsIHJlZnMgPSBuZXcgQXJyYXkoX2xlbjQpLCBfa2V5NCA9IDA7IF9rZXk0IDwgX2xlbjQ7IF9rZXk0KyspIHtcbiAgICByZWZzW19rZXk0XSA9IGFyZ3VtZW50c1tfa2V5NF07XG4gIH1cbiAgcmV0dXJuIGZ1bmN0aW9uIChub2RlKSB7XG4gICAgcmVmcy5mb3JFYWNoKGZ1bmN0aW9uIChyZWYpIHtcbiAgICAgIGlmICh0eXBlb2YgcmVmID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgIHJlZihub2RlKTtcbiAgICAgIH0gZWxzZSBpZiAocmVmKSB7XG4gICAgICAgIHJlZi5jdXJyZW50ID0gbm9kZTtcbiAgICAgIH1cbiAgICB9KTtcbiAgfTtcbn1cblxuLyoqXG4gKiBUaGlzIGdlbmVyYXRlcyBhIHVuaXF1ZSBJRCBmb3IgYW4gaW5zdGFuY2Ugb2YgRG93bnNoaWZ0XG4gKiBAcmV0dXJuIHtTdHJpbmd9IHRoZSB1bmlxdWUgSURcbiAqL1xuZnVuY3Rpb24gZ2VuZXJhdGVJZCgpIHtcbiAgcmV0dXJuIFN0cmluZyhpZENvdW50ZXIrKyk7XG59XG5cbi8qKlxuICogUmVzZXRzIGlkQ291bnRlciB0byAwLiBVc2VkIGZvciBTU1IuXG4gKi9cbmZ1bmN0aW9uIHJlc2V0SWRDb3VudGVyKCkge1xuICAvLyBpc3RhbmJ1bCBpZ25vcmUgbmV4dFxuICBpZiAoJ3VzZUlkJyBpbiBSZWFjdCkge1xuICAgIGNvbnNvbGUud2FybihcIkl0IGlzIG5vdCBuZWNlc3NhcnkgdG8gY2FsbCByZXNldElkQ291bnRlciB3aGVuIHVzaW5nIFJlYWN0IDE4K1wiKTtcbiAgICByZXR1cm47XG4gIH1cbiAgaWRDb3VudGVyID0gMDtcbn1cblxuLyoqXG4gKiBEZWZhdWx0IGltcGxlbWVudGF0aW9uIGZvciBzdGF0dXMgbWVzc2FnZS4gT25seSBhZGRlZCB3aGVuIG1lbnUgaXMgb3Blbi5cbiAqIFdpbGwgc3BlY2lmeSBpZiB0aGVyZSBhcmUgcmVzdWx0cyBpbiB0aGUgbGlzdCwgYW5kIGlmIHNvLCBob3cgbWFueSxcbiAqIGFuZCB3aGF0IGtleXMgYXJlIHJlbGV2YW50LlxuICpcbiAqIEBwYXJhbSB7T2JqZWN0fSBwYXJhbSB0aGUgZG93bnNoaWZ0IHN0YXRlIGFuZCBvdGhlciByZWxldmFudCBwcm9wZXJ0aWVzXG4gKiBAcmV0dXJuIHtTdHJpbmd9IHRoZSBhMTF5IHN0YXR1cyBtZXNzYWdlXG4gKi9cbmZ1bmN0aW9uIGdldEExMXlTdGF0dXNNZXNzYWdlKF9yZWYyKSB7XG4gIHZhciBpc09wZW4gPSBfcmVmMi5pc09wZW4sXG4gICAgcmVzdWx0Q291bnQgPSBfcmVmMi5yZXN1bHRDb3VudCxcbiAgICBwcmV2aW91c1Jlc3VsdENvdW50ID0gX3JlZjIucHJldmlvdXNSZXN1bHRDb3VudDtcbiAgaWYgKCFpc09wZW4pIHtcbiAgICByZXR1cm4gJyc7XG4gIH1cbiAgaWYgKCFyZXN1bHRDb3VudCkge1xuICAgIHJldHVybiAnTm8gcmVzdWx0cyBhcmUgYXZhaWxhYmxlLic7XG4gIH1cbiAgaWYgKHJlc3VsdENvdW50ICE9PSBwcmV2aW91c1Jlc3VsdENvdW50KSB7XG4gICAgcmV0dXJuIHJlc3VsdENvdW50ICsgXCIgcmVzdWx0XCIgKyAocmVzdWx0Q291bnQgPT09IDEgPyAnIGlzJyA6ICdzIGFyZScpICsgXCIgYXZhaWxhYmxlLCB1c2UgdXAgYW5kIGRvd24gYXJyb3cga2V5cyB0byBuYXZpZ2F0ZS4gUHJlc3MgRW50ZXIga2V5IHRvIHNlbGVjdC5cIjtcbiAgfVxuICByZXR1cm4gJyc7XG59XG5cbi8qKlxuICogVGFrZXMgYW4gYXJndW1lbnQgYW5kIGlmIGl0J3MgYW4gYXJyYXksIHJldHVybnMgdGhlIGZpcnN0IGl0ZW0gaW4gdGhlIGFycmF5XG4gKiBvdGhlcndpc2UgcmV0dXJucyB0aGUgYXJndW1lbnRcbiAqIEBwYXJhbSB7Kn0gYXJnIHRoZSBtYXliZS1hcnJheVxuICogQHBhcmFtIHsqfSBkZWZhdWx0VmFsdWUgdGhlIHZhbHVlIGlmIGFyZyBpcyBmYWxzZXkgbm90IGRlZmluZWRcbiAqIEByZXR1cm4geyp9IHRoZSBhcmcgb3IgaXQncyBmaXJzdCBpdGVtXG4gKi9cbmZ1bmN0aW9uIHVud3JhcEFycmF5KGFyZywgZGVmYXVsdFZhbHVlKSB7XG4gIGFyZyA9IEFycmF5LmlzQXJyYXkoYXJnKSA/IC8qIGlzdGFuYnVsIGlnbm9yZSBuZXh0IChwcmVhY3QpICovYXJnWzBdIDogYXJnO1xuICBpZiAoIWFyZyAmJiBkZWZhdWx0VmFsdWUpIHtcbiAgICByZXR1cm4gZGVmYXVsdFZhbHVlO1xuICB9IGVsc2Uge1xuICAgIHJldHVybiBhcmc7XG4gIH1cbn1cblxuLyoqXG4gKiBAcGFyYW0ge09iamVjdH0gZWxlbWVudCAoUClyZWFjdCBlbGVtZW50XG4gKiBAcmV0dXJuIHtCb29sZWFufSB3aGV0aGVyIGl0J3MgYSBET00gZWxlbWVudFxuICovXG5mdW5jdGlvbiBpc0RPTUVsZW1lbnQoZWxlbWVudCkge1xuXG4gIC8vIHRoZW4gd2UgYXNzdW1lIHRoaXMgaXMgcmVhY3RcbiAgcmV0dXJuIHR5cGVvZiBlbGVtZW50LnR5cGUgPT09ICdzdHJpbmcnO1xufVxuXG4vKipcbiAqIEBwYXJhbSB7T2JqZWN0fSBlbGVtZW50IChQKXJlYWN0IGVsZW1lbnRcbiAqIEByZXR1cm4ge09iamVjdH0gdGhlIHByb3BzXG4gKi9cbmZ1bmN0aW9uIGdldEVsZW1lbnRQcm9wcyhlbGVtZW50KSB7XG4gIHJldHVybiBlbGVtZW50LnByb3BzO1xufVxuXG4vKipcbiAqIFRocm93cyBhIGhlbHBmdWwgZXJyb3IgbWVzc2FnZSBmb3IgcmVxdWlyZWQgcHJvcGVydGllcy4gVXNlZnVsXG4gKiB0byBiZSB1c2VkIGFzIGEgZGVmYXVsdCBpbiBkZXN0cnVjdHVyaW5nIG9yIG9iamVjdCBwYXJhbXMuXG4gKiBAcGFyYW0ge1N0cmluZ30gZm5OYW1lIHRoZSBmdW5jdGlvbiBuYW1lXG4gKiBAcGFyYW0ge1N0cmluZ30gcHJvcE5hbWUgdGhlIHByb3AgbmFtZVxuICovXG5mdW5jdGlvbiByZXF1aXJlZFByb3AoZm5OYW1lLCBwcm9wTmFtZSkge1xuICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm8tY29uc29sZVxuICBjb25zb2xlLmVycm9yKFwiVGhlIHByb3BlcnR5IFxcXCJcIiArIHByb3BOYW1lICsgXCJcXFwiIGlzIHJlcXVpcmVkIGluIFxcXCJcIiArIGZuTmFtZSArIFwiXFxcIlwiKTtcbn1cbnZhciBzdGF0ZUtleXMgPSBbJ2hpZ2hsaWdodGVkSW5kZXgnLCAnaW5wdXRWYWx1ZScsICdpc09wZW4nLCAnc2VsZWN0ZWRJdGVtJywgJ3R5cGUnXTtcbi8qKlxuICogQHBhcmFtIHtPYmplY3R9IHN0YXRlIHRoZSBzdGF0ZSBvYmplY3RcbiAqIEByZXR1cm4ge09iamVjdH0gc3RhdGUgdGhhdCBpcyByZWxldmFudCB0byBkb3duc2hpZnRcbiAqL1xuZnVuY3Rpb24gcGlja1N0YXRlKHN0YXRlKSB7XG4gIGlmIChzdGF0ZSA9PT0gdm9pZCAwKSB7XG4gICAgc3RhdGUgPSB7fTtcbiAgfVxuICB2YXIgcmVzdWx0ID0ge307XG4gIHN0YXRlS2V5cy5mb3JFYWNoKGZ1bmN0aW9uIChrKSB7XG4gICAgaWYgKHN0YXRlLmhhc093blByb3BlcnR5KGspKSB7XG4gICAgICByZXN1bHRba10gPSBzdGF0ZVtrXTtcbiAgICB9XG4gIH0pO1xuICByZXR1cm4gcmVzdWx0O1xufVxuXG4vKipcbiAqIFRoaXMgd2lsbCBwZXJmb3JtIGEgc2hhbGxvdyBtZXJnZSBvZiB0aGUgZ2l2ZW4gc3RhdGUgb2JqZWN0XG4gKiB3aXRoIHRoZSBzdGF0ZSBjb21pbmcgZnJvbSBwcm9wc1xuICogKGZvciB0aGUgY29udHJvbGxlZCBjb21wb25lbnQgc2NlbmFyaW8pXG4gKiBUaGlzIGlzIHVzZWQgaW4gc3RhdGUgdXBkYXRlciBmdW5jdGlvbnMgc28gdGhleSdyZSByZWZlcmVuY2luZ1xuICogdGhlIHJpZ2h0IHN0YXRlIHJlZ2FyZGxlc3Mgb2Ygd2hlcmUgaXQgY29tZXMgZnJvbS5cbiAqXG4gKiBAcGFyYW0ge09iamVjdH0gc3RhdGUgVGhlIHN0YXRlIG9mIHRoZSBjb21wb25lbnQvaG9vay5cbiAqIEBwYXJhbSB7T2JqZWN0fSBwcm9wcyBUaGUgcHJvcHMgdGhhdCBtYXkgY29udGFpbiBjb250cm9sbGVkIHZhbHVlcy5cbiAqIEByZXR1cm5zIHtPYmplY3R9IFRoZSBtZXJnZWQgY29udHJvbGxlZCBzdGF0ZS5cbiAqL1xuZnVuY3Rpb24gZ2V0U3RhdGUoc3RhdGUsIHByb3BzKSB7XG4gIGlmICghc3RhdGUgfHwgIXByb3BzKSB7XG4gICAgcmV0dXJuIHN0YXRlO1xuICB9XG4gIHJldHVybiBPYmplY3Qua2V5cyhzdGF0ZSkucmVkdWNlKGZ1bmN0aW9uIChwcmV2U3RhdGUsIGtleSkge1xuICAgIHByZXZTdGF0ZVtrZXldID0gaXNDb250cm9sbGVkUHJvcChwcm9wcywga2V5KSA/IHByb3BzW2tleV0gOiBzdGF0ZVtrZXldO1xuICAgIHJldHVybiBwcmV2U3RhdGU7XG4gIH0sIHt9KTtcbn1cblxuLyoqXG4gKiBUaGlzIGRldGVybWluZXMgd2hldGhlciBhIHByb3AgaXMgYSBcImNvbnRyb2xsZWQgcHJvcFwiIG1lYW5pbmcgaXQgaXNcbiAqIHN0YXRlIHdoaWNoIGlzIGNvbnRyb2xsZWQgYnkgdGhlIG91dHNpZGUgb2YgdGhpcyBjb21wb25lbnQgcmF0aGVyXG4gKiB0aGFuIHdpdGhpbiB0aGlzIGNvbXBvbmVudC5cbiAqXG4gKiBAcGFyYW0ge09iamVjdH0gcHJvcHMgVGhlIHByb3BzIHRoYXQgbWF5IGNvbnRhaW4gY29udHJvbGxlZCB2YWx1ZXMuXG4gKiBAcGFyYW0ge1N0cmluZ30ga2V5IHRoZSBrZXkgdG8gY2hlY2tcbiAqIEByZXR1cm4ge0Jvb2xlYW59IHdoZXRoZXIgaXQgaXMgYSBjb250cm9sbGVkIGNvbnRyb2xsZWQgcHJvcFxuICovXG5mdW5jdGlvbiBpc0NvbnRyb2xsZWRQcm9wKHByb3BzLCBrZXkpIHtcbiAgcmV0dXJuIHByb3BzW2tleV0gIT09IHVuZGVmaW5lZDtcbn1cblxuLyoqXG4gKiBOb3JtYWxpemVzIHRoZSAna2V5JyBwcm9wZXJ0eSBvZiBhIEtleWJvYXJkRXZlbnQgaW4gSUUvRWRnZVxuICogQHBhcmFtIHtPYmplY3R9IGV2ZW50IGEga2V5Ym9hcmRFdmVudCBvYmplY3RcbiAqIEByZXR1cm4ge1N0cmluZ30ga2V5Ym9hcmQga2V5XG4gKi9cbmZ1bmN0aW9uIG5vcm1hbGl6ZUFycm93S2V5KGV2ZW50KSB7XG4gIHZhciBrZXkgPSBldmVudC5rZXksXG4gICAga2V5Q29kZSA9IGV2ZW50LmtleUNvZGU7XG4gIC8qIGlzdGFuYnVsIGlnbm9yZSBuZXh0IChpZSkgKi9cbiAgaWYgKGtleUNvZGUgPj0gMzcgJiYga2V5Q29kZSA8PSA0MCAmJiBrZXkuaW5kZXhPZignQXJyb3cnKSAhPT0gMCkge1xuICAgIHJldHVybiBcIkFycm93XCIgKyBrZXk7XG4gIH1cbiAgcmV0dXJuIGtleTtcbn1cblxuLyoqXG4gKiBTaW1wbGUgY2hlY2sgaWYgdGhlIHZhbHVlIHBhc3NlZCBpcyBvYmplY3QgbGl0ZXJhbFxuICogQHBhcmFtIHsqfSBvYmogYW55IHRoaW5nc1xuICogQHJldHVybiB7Qm9vbGVhbn0gd2hldGhlciBpdCdzIG9iamVjdCBsaXRlcmFsXG4gKi9cbmZ1bmN0aW9uIGlzUGxhaW5PYmplY3Qob2JqKSB7XG4gIHJldHVybiBPYmplY3QucHJvdG90eXBlLnRvU3RyaW5nLmNhbGwob2JqKSA9PT0gJ1tvYmplY3QgT2JqZWN0XSc7XG59XG5cbi8qKlxuICogUmV0dXJucyB0aGUgbmV4dCBub24tZGlzYWJsZWQgaGlnaGxpZ2h0ZWRJbmRleCB2YWx1ZS5cbiAqXG4gKiBAcGFyYW0ge251bWJlcn0gc3RhcnQgVGhlIGN1cnJlbnQgaGlnaGxpZ2h0ZWRJbmRleC5cbiAqIEBwYXJhbSB7bnVtYmVyfSBvZmZzZXQgVGhlIG9mZnNldCBmcm9tIHRoZSBjdXJyZW50IGhpZ2hsaWdodGVkSW5kZXggdG8gc3RhcnQgc2VhcmNoaW5nLlxuICogQHBhcmFtIHt1bmtub3duW119IGl0ZW1zIFRoZSBpdGVtcyBhcnJheS5cbiAqIEBwYXJhbSB7KGl0ZW06IHVua25vd24sIGluZGV4OiBudW1iZXIpID0+IGJvb2xlYW59IGlzSXRlbURpc2FibGVkIEZ1bmN0aW9uIHRoYXQgdGVsbHMgaWYgYW4gaXRlbSBpcyBkaXNhYmxlZCBvciBub3QuXG4gKiBAcGFyYW0ge2Jvb2xlYW4/fSBjaXJjdWxhciBJZiB0aGUgc2VhcmNoIHJlYWNoZXMgdGhlIGVuZCwgaWYgaXQgY2FuIHNlYXJjaCBhZ2FpbiBzdGFydGluZyBmcm9tIHRoZSBvdGhlciBlbmQuXG4gKiBAcmV0dXJucyB7bnVtYmVyfSBUaGUgbmV4dCBoaWdobGlnaHRlZEluZGV4LlxuICovXG5mdW5jdGlvbiBnZXRIaWdobGlnaHRlZEluZGV4KHN0YXJ0LCBvZmZzZXQsIGl0ZW1zLCBpc0l0ZW1EaXNhYmxlZCwgY2lyY3VsYXIpIHtcbiAgaWYgKGNpcmN1bGFyID09PSB2b2lkIDApIHtcbiAgICBjaXJjdWxhciA9IGZhbHNlO1xuICB9XG4gIHZhciBjb3VudCA9IGl0ZW1zLmxlbmd0aDtcbiAgaWYgKGNvdW50ID09PSAwKSB7XG4gICAgcmV0dXJuIC0xO1xuICB9XG4gIHZhciBpdGVtc0xhc3RJbmRleCA9IGNvdW50IC0gMTtcbiAgaWYgKHR5cGVvZiBzdGFydCAhPT0gJ251bWJlcicgfHwgc3RhcnQgPCAwIHx8IHN0YXJ0ID4gaXRlbXNMYXN0SW5kZXgpIHtcbiAgICBzdGFydCA9IG9mZnNldCA+IDAgPyAtMSA6IGl0ZW1zTGFzdEluZGV4ICsgMTtcbiAgfVxuICB2YXIgY3VycmVudCA9IHN0YXJ0ICsgb2Zmc2V0O1xuICBpZiAoY3VycmVudCA8IDApIHtcbiAgICBjdXJyZW50ID0gY2lyY3VsYXIgPyBpdGVtc0xhc3RJbmRleCA6IDA7XG4gIH0gZWxzZSBpZiAoY3VycmVudCA+IGl0ZW1zTGFzdEluZGV4KSB7XG4gICAgY3VycmVudCA9IGNpcmN1bGFyID8gMCA6IGl0ZW1zTGFzdEluZGV4O1xuICB9XG4gIHZhciBoaWdobGlnaHRlZEluZGV4ID0gZ2V0Tm9uRGlzYWJsZWRJbmRleChjdXJyZW50LCBvZmZzZXQgPCAwLCBpdGVtcywgaXNJdGVtRGlzYWJsZWQsIGNpcmN1bGFyKTtcbiAgaWYgKGhpZ2hsaWdodGVkSW5kZXggPT09IC0xKSB7XG4gICAgcmV0dXJuIHN0YXJ0ID49IGNvdW50ID8gLTEgOiBzdGFydDtcbiAgfVxuICByZXR1cm4gaGlnaGxpZ2h0ZWRJbmRleDtcbn1cblxuLyoqXG4gKiBSZXR1cm5zIHRoZSBuZXh0IG5vbi1kaXNhYmxlZCBoaWdobGlnaHRlZEluZGV4IHZhbHVlLlxuICpcbiAqIEBwYXJhbSB7bnVtYmVyfSBzdGFydCBUaGUgY3VycmVudCBoaWdobGlnaHRlZEluZGV4LlxuICogQHBhcmFtIHtib29sZWFufSBiYWNrd2FyZHMgSWYgdHJ1ZSwgaXQgd2lsbCBzZWFyY2ggYmFja3dhcmRzIGZyb20gdGhlIHN0YXJ0LlxuICogQHBhcmFtIHt1bmtub3duW119IGl0ZW1zIFRoZSBpdGVtcyBhcnJheS5cbiAqIEBwYXJhbSB7KGl0ZW06IHVua25vd24sIGluZGV4OiBudW1iZXIpID0+IGJvb2xlYW59IGlzSXRlbURpc2FibGVkIEZ1bmN0aW9uIHRoYXQgdGVsbHMgaWYgYW4gaXRlbSBpcyBkaXNhYmxlZCBvciBub3QuXG4gKiBAcGFyYW0ge2Jvb2xlYW59IGNpcmN1bGFyIElmIHRoZSBzZWFyY2ggcmVhY2hlcyB0aGUgZW5kLCBpZiBpdCBjYW4gc2VhcmNoIGFnYWluIHN0YXJ0aW5nIGZyb20gdGhlIG90aGVyIGVuZC5cbiAqIEByZXR1cm5zIHtudW1iZXJ9IFRoZSBuZXh0IG5vbi1kaXNhYmxlZCBpbmRleC5cbiAqL1xuZnVuY3Rpb24gZ2V0Tm9uRGlzYWJsZWRJbmRleChzdGFydCwgYmFja3dhcmRzLCBpdGVtcywgaXNJdGVtRGlzYWJsZWQsIGNpcmN1bGFyKSB7XG4gIGlmIChjaXJjdWxhciA9PT0gdm9pZCAwKSB7XG4gICAgY2lyY3VsYXIgPSBmYWxzZTtcbiAgfVxuICB2YXIgY291bnQgPSBpdGVtcy5sZW5ndGg7XG4gIGlmIChiYWNrd2FyZHMpIHtcbiAgICBmb3IgKHZhciBpbmRleCA9IHN0YXJ0OyBpbmRleCA+PSAwOyBpbmRleC0tKSB7XG4gICAgICBpZiAoIWlzSXRlbURpc2FibGVkKGl0ZW1zW2luZGV4XSwgaW5kZXgpKSB7XG4gICAgICAgIHJldHVybiBpbmRleDtcbiAgICAgIH1cbiAgICB9XG4gIH0gZWxzZSB7XG4gICAgZm9yICh2YXIgX2luZGV4ID0gc3RhcnQ7IF9pbmRleCA8IGNvdW50OyBfaW5kZXgrKykge1xuICAgICAgaWYgKCFpc0l0ZW1EaXNhYmxlZChpdGVtc1tfaW5kZXhdLCBfaW5kZXgpKSB7XG4gICAgICAgIHJldHVybiBfaW5kZXg7XG4gICAgICB9XG4gICAgfVxuICB9XG4gIGlmIChjaXJjdWxhcikge1xuICAgIHJldHVybiBnZXROb25EaXNhYmxlZEluZGV4KGJhY2t3YXJkcyA/IGNvdW50IC0gMSA6IDAsIGJhY2t3YXJkcywgaXRlbXMsIGlzSXRlbURpc2FibGVkKTtcbiAgfVxuICByZXR1cm4gLTE7XG59XG5cbi8qKlxuICogQ2hlY2tzIGlmIGV2ZW50IHRhcmdldCBpcyB3aXRoaW4gdGhlIGRvd25zaGlmdCBlbGVtZW50cy5cbiAqXG4gKiBAcGFyYW0ge0V2ZW50VGFyZ2V0fSB0YXJnZXQgVGFyZ2V0IHRvIGNoZWNrLlxuICogQHBhcmFtIHtIVE1MRWxlbWVudFtdfSBkb3duc2hpZnRFbGVtZW50cyBUaGUgZWxlbWVudHMgdGhhdCBmb3JtIGRvd25zaGlmdCAobGlzdCwgdG9nZ2xlIGJ1dHRvbiBldGMpLlxuICogQHBhcmFtIHtXaW5kb3d9IGVudmlyb25tZW50IFRoZSB3aW5kb3cgY29udGV4dCB3aGVyZSBkb3duc2hpZnQgcmVuZGVycy5cbiAqIEBwYXJhbSB7Ym9vbGVhbn0gY2hlY2tBY3RpdmVFbGVtZW50IFdoZXRoZXIgdG8gYWxzbyBjaGVjayBhY3RpdmVFbGVtZW50LlxuICpcbiAqIEByZXR1cm5zIHtib29sZWFufSBXaGV0aGVyIG9yIG5vdCB0aGUgdGFyZ2V0IGlzIHdpdGhpbiBkb3duc2hpZnQgZWxlbWVudHMuXG4gKi9cbmZ1bmN0aW9uIHRhcmdldFdpdGhpbkRvd25zaGlmdCh0YXJnZXQsIGRvd25zaGlmdEVsZW1lbnRzLCBlbnZpcm9ubWVudCwgY2hlY2tBY3RpdmVFbGVtZW50KSB7XG4gIGlmIChjaGVja0FjdGl2ZUVsZW1lbnQgPT09IHZvaWQgMCkge1xuICAgIGNoZWNrQWN0aXZlRWxlbWVudCA9IHRydWU7XG4gIH1cbiAgcmV0dXJuIGVudmlyb25tZW50ICYmIGRvd25zaGlmdEVsZW1lbnRzLnNvbWUoZnVuY3Rpb24gKGNvbnRleHROb2RlKSB7XG4gICAgcmV0dXJuIGNvbnRleHROb2RlICYmIChpc09yQ29udGFpbnNOb2RlKGNvbnRleHROb2RlLCB0YXJnZXQsIGVudmlyb25tZW50KSB8fCBjaGVja0FjdGl2ZUVsZW1lbnQgJiYgaXNPckNvbnRhaW5zTm9kZShjb250ZXh0Tm9kZSwgZW52aXJvbm1lbnQuZG9jdW1lbnQuYWN0aXZlRWxlbWVudCwgZW52aXJvbm1lbnQpKTtcbiAgfSk7XG59XG5cbi8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBpbXBvcnQvbm8tbXV0YWJsZS1leHBvcnRzXG52YXIgdmFsaWRhdGVDb250cm9sbGVkVW5jaGFuZ2VkID0gbm9vcDtcbi8qIGlzdGFuYnVsIGlnbm9yZSBuZXh0ICovXG5pZiAocHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09ICdwcm9kdWN0aW9uJykge1xuICB2YWxpZGF0ZUNvbnRyb2xsZWRVbmNoYW5nZWQgPSBmdW5jdGlvbiB2YWxpZGF0ZUNvbnRyb2xsZWRVbmNoYW5nZWQoc3RhdGUsIHByZXZQcm9wcywgbmV4dFByb3BzKSB7XG4gICAgdmFyIHdhcm5pbmdEZXNjcmlwdGlvbiA9IFwiVGhpcyBwcm9wIHNob3VsZCBub3Qgc3dpdGNoIGZyb20gY29udHJvbGxlZCB0byB1bmNvbnRyb2xsZWQgKG9yIHZpY2UgdmVyc2EpLiBEZWNpZGUgYmV0d2VlbiB1c2luZyBhIGNvbnRyb2xsZWQgb3IgdW5jb250cm9sbGVkIERvd25zaGlmdCBlbGVtZW50IGZvciB0aGUgbGlmZXRpbWUgb2YgdGhlIGNvbXBvbmVudC4gTW9yZSBpbmZvOiBodHRwczovL2dpdGh1Yi5jb20vZG93bnNoaWZ0LWpzL2Rvd25zaGlmdCNjb250cm9sLXByb3BzXCI7XG4gICAgT2JqZWN0LmtleXMoc3RhdGUpLmZvckVhY2goZnVuY3Rpb24gKHByb3BLZXkpIHtcbiAgICAgIGlmIChwcmV2UHJvcHNbcHJvcEtleV0gIT09IHVuZGVmaW5lZCAmJiBuZXh0UHJvcHNbcHJvcEtleV0gPT09IHVuZGVmaW5lZCkge1xuICAgICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm8tY29uc29sZVxuICAgICAgICBjb25zb2xlLmVycm9yKFwiZG93bnNoaWZ0OiBBIGNvbXBvbmVudCBoYXMgY2hhbmdlZCB0aGUgY29udHJvbGxlZCBwcm9wIFxcXCJcIiArIHByb3BLZXkgKyBcIlxcXCIgdG8gYmUgdW5jb250cm9sbGVkLiBcIiArIHdhcm5pbmdEZXNjcmlwdGlvbik7XG4gICAgICB9IGVsc2UgaWYgKHByZXZQcm9wc1twcm9wS2V5XSA9PT0gdW5kZWZpbmVkICYmIG5leHRQcm9wc1twcm9wS2V5XSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBuby1jb25zb2xlXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoXCJkb3duc2hpZnQ6IEEgY29tcG9uZW50IGhhcyBjaGFuZ2VkIHRoZSB1bmNvbnRyb2xsZWQgcHJvcCBcXFwiXCIgKyBwcm9wS2V5ICsgXCJcXFwiIHRvIGJlIGNvbnRyb2xsZWQuIFwiICsgd2FybmluZ0Rlc2NyaXB0aW9uKTtcbiAgICAgIH1cbiAgICB9KTtcbiAgfTtcbn1cblxudmFyIGNsZWFudXBTdGF0dXMgPSBkZWJvdW5jZShmdW5jdGlvbiAoZG9jdW1lbnRQcm9wKSB7XG4gIGdldFN0YXR1c0Rpdihkb2N1bWVudFByb3ApLnRleHRDb250ZW50ID0gJyc7XG59LCA1MDApO1xuXG4vKipcbiAqIEdldCB0aGUgc3RhdHVzIG5vZGUgb3IgY3JlYXRlIGl0IGlmIGl0IGRvZXMgbm90IGFscmVhZHkgZXhpc3QuXG4gKiBAcGFyYW0ge09iamVjdH0gZG9jdW1lbnRQcm9wIGRvY3VtZW50IHBhc3NlZCBieSB0aGUgdXNlci5cbiAqIEByZXR1cm4ge0hUTUxFbGVtZW50fSB0aGUgc3RhdHVzIG5vZGUuXG4gKi9cbmZ1bmN0aW9uIGdldFN0YXR1c0Rpdihkb2N1bWVudFByb3ApIHtcbiAgdmFyIHN0YXR1c0RpdiA9IGRvY3VtZW50UHJvcC5nZXRFbGVtZW50QnlJZCgnYTExeS1zdGF0dXMtbWVzc2FnZScpO1xuICBpZiAoc3RhdHVzRGl2KSB7XG4gICAgcmV0dXJuIHN0YXR1c0RpdjtcbiAgfVxuICBzdGF0dXNEaXYgPSBkb2N1bWVudFByb3AuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gIHN0YXR1c0Rpdi5zZXRBdHRyaWJ1dGUoJ2lkJywgJ2ExMXktc3RhdHVzLW1lc3NhZ2UnKTtcbiAgc3RhdHVzRGl2LnNldEF0dHJpYnV0ZSgncm9sZScsICdzdGF0dXMnKTtcbiAgc3RhdHVzRGl2LnNldEF0dHJpYnV0ZSgnYXJpYS1saXZlJywgJ3BvbGl0ZScpO1xuICBzdGF0dXNEaXYuc2V0QXR0cmlidXRlKCdhcmlhLXJlbGV2YW50JywgJ2FkZGl0aW9ucyB0ZXh0Jyk7XG4gIE9iamVjdC5hc3NpZ24oc3RhdHVzRGl2LnN0eWxlLCB7XG4gICAgYm9yZGVyOiAnMCcsXG4gICAgY2xpcDogJ3JlY3QoMCAwIDAgMCknLFxuICAgIGhlaWdodDogJzFweCcsXG4gICAgbWFyZ2luOiAnLTFweCcsXG4gICAgb3ZlcmZsb3c6ICdoaWRkZW4nLFxuICAgIHBhZGRpbmc6ICcwJyxcbiAgICBwb3NpdGlvbjogJ2Fic29sdXRlJyxcbiAgICB3aWR0aDogJzFweCdcbiAgfSk7XG4gIGRvY3VtZW50UHJvcC5ib2R5LmFwcGVuZENoaWxkKHN0YXR1c0Rpdik7XG4gIHJldHVybiBzdGF0dXNEaXY7XG59XG5cbi8qKlxuICogQHBhcmFtIHtTdHJpbmd9IHN0YXR1cyB0aGUgc3RhdHVzIG1lc3NhZ2VcbiAqIEBwYXJhbSB7T2JqZWN0fSBkb2N1bWVudFByb3AgZG9jdW1lbnQgcGFzc2VkIGJ5IHRoZSB1c2VyLlxuICovXG5mdW5jdGlvbiBzZXRTdGF0dXMoc3RhdHVzLCBkb2N1bWVudFByb3ApIHtcbiAgaWYgKCFzdGF0dXMgfHwgIWRvY3VtZW50UHJvcCkge1xuICAgIHJldHVybjtcbiAgfVxuICB2YXIgZGl2ID0gZ2V0U3RhdHVzRGl2KGRvY3VtZW50UHJvcCk7XG4gIGRpdi50ZXh0Q29udGVudCA9IHN0YXR1cztcbiAgY2xlYW51cFN0YXR1cyhkb2N1bWVudFByb3ApO1xufVxuXG4vKipcbiAqIFJlbW92ZXMgdGhlIHN0YXR1cyBlbGVtZW50IGZyb20gdGhlIERPTVxuICogQHBhcmFtIHtEb2N1bWVudH0gZG9jdW1lbnRQcm9wIFxuICovXG5mdW5jdGlvbiBjbGVhbnVwU3RhdHVzRGl2KGRvY3VtZW50UHJvcCkge1xuICB2YXIgc3RhdHVzRGl2ID0gZG9jdW1lbnRQcm9wID09IG51bGwgPyB2b2lkIDAgOiBkb2N1bWVudFByb3AuZ2V0RWxlbWVudEJ5SWQoJ2ExMXktc3RhdHVzLW1lc3NhZ2UnKTtcbiAgaWYgKHN0YXR1c0Rpdikge1xuICAgIHN0YXR1c0Rpdi5yZW1vdmUoKTtcbiAgfVxufVxuXG52YXIgdW5rbm93biA9IHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSBcInByb2R1Y3Rpb25cIiA/ICdfX2F1dG9jb21wbGV0ZV91bmtub3duX18nIDogMDtcbnZhciBtb3VzZVVwID0gcHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09IFwicHJvZHVjdGlvblwiID8gJ19fYXV0b2NvbXBsZXRlX21vdXNldXBfXycgOiAxO1xudmFyIGl0ZW1Nb3VzZUVudGVyID0gcHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09IFwicHJvZHVjdGlvblwiID8gJ19fYXV0b2NvbXBsZXRlX2l0ZW1fbW91c2VlbnRlcl9fJyA6IDI7XG52YXIga2V5RG93bkFycm93VXAgPSBwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gXCJwcm9kdWN0aW9uXCIgPyAnX19hdXRvY29tcGxldGVfa2V5ZG93bl9hcnJvd191cF9fJyA6IDM7XG52YXIga2V5RG93bkFycm93RG93biA9IHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSBcInByb2R1Y3Rpb25cIiA/ICdfX2F1dG9jb21wbGV0ZV9rZXlkb3duX2Fycm93X2Rvd25fXycgOiA0O1xudmFyIGtleURvd25Fc2NhcGUgPSBwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gXCJwcm9kdWN0aW9uXCIgPyAnX19hdXRvY29tcGxldGVfa2V5ZG93bl9lc2NhcGVfXycgOiA1O1xudmFyIGtleURvd25FbnRlciA9IHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSBcInByb2R1Y3Rpb25cIiA/ICdfX2F1dG9jb21wbGV0ZV9rZXlkb3duX2VudGVyX18nIDogNjtcbnZhciBrZXlEb3duSG9tZSA9IHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSBcInByb2R1Y3Rpb25cIiA/ICdfX2F1dG9jb21wbGV0ZV9rZXlkb3duX2hvbWVfXycgOiA3O1xudmFyIGtleURvd25FbmQgPSBwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gXCJwcm9kdWN0aW9uXCIgPyAnX19hdXRvY29tcGxldGVfa2V5ZG93bl9lbmRfXycgOiA4O1xudmFyIGNsaWNrSXRlbSA9IHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSBcInByb2R1Y3Rpb25cIiA/ICdfX2F1dG9jb21wbGV0ZV9jbGlja19pdGVtX18nIDogOTtcbnZhciBibHVySW5wdXQgPSBwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gXCJwcm9kdWN0aW9uXCIgPyAnX19hdXRvY29tcGxldGVfYmx1cl9pbnB1dF9fJyA6IDEwO1xudmFyIGNoYW5nZUlucHV0ID0gcHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09IFwicHJvZHVjdGlvblwiID8gJ19fYXV0b2NvbXBsZXRlX2NoYW5nZV9pbnB1dF9fJyA6IDExO1xudmFyIGtleURvd25TcGFjZUJ1dHRvbiA9IHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSBcInByb2R1Y3Rpb25cIiA/ICdfX2F1dG9jb21wbGV0ZV9rZXlkb3duX3NwYWNlX2J1dHRvbl9fJyA6IDEyO1xudmFyIGNsaWNrQnV0dG9uID0gcHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09IFwicHJvZHVjdGlvblwiID8gJ19fYXV0b2NvbXBsZXRlX2NsaWNrX2J1dHRvbl9fJyA6IDEzO1xudmFyIGJsdXJCdXR0b24gPSBwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gXCJwcm9kdWN0aW9uXCIgPyAnX19hdXRvY29tcGxldGVfYmx1cl9idXR0b25fXycgOiAxNDtcbnZhciBjb250cm9sbGVkUHJvcFVwZGF0ZWRTZWxlY3RlZEl0ZW0gPSBwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gXCJwcm9kdWN0aW9uXCIgPyAnX19hdXRvY29tcGxldGVfY29udHJvbGxlZF9wcm9wX3VwZGF0ZWRfc2VsZWN0ZWRfaXRlbV9fJyA6IDE1O1xudmFyIHRvdWNoRW5kID0gcHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09IFwicHJvZHVjdGlvblwiID8gJ19fYXV0b2NvbXBsZXRlX3RvdWNoZW5kX18nIDogMTY7XG5cbnZhciBzdGF0ZUNoYW5nZVR5cGVzJDMgPSAvKiNfX1BVUkVfXyovT2JqZWN0LmZyZWV6ZSh7XG4gIF9fcHJvdG9fXzogbnVsbCxcbiAgYmx1ckJ1dHRvbjogYmx1ckJ1dHRvbixcbiAgYmx1cklucHV0OiBibHVySW5wdXQsXG4gIGNoYW5nZUlucHV0OiBjaGFuZ2VJbnB1dCxcbiAgY2xpY2tCdXR0b246IGNsaWNrQnV0dG9uLFxuICBjbGlja0l0ZW06IGNsaWNrSXRlbSxcbiAgY29udHJvbGxlZFByb3BVcGRhdGVkU2VsZWN0ZWRJdGVtOiBjb250cm9sbGVkUHJvcFVwZGF0ZWRTZWxlY3RlZEl0ZW0sXG4gIGl0ZW1Nb3VzZUVudGVyOiBpdGVtTW91c2VFbnRlcixcbiAga2V5RG93bkFycm93RG93bjoga2V5RG93bkFycm93RG93bixcbiAga2V5RG93bkFycm93VXA6IGtleURvd25BcnJvd1VwLFxuICBrZXlEb3duRW5kOiBrZXlEb3duRW5kLFxuICBrZXlEb3duRW50ZXI6IGtleURvd25FbnRlcixcbiAga2V5RG93bkVzY2FwZToga2V5RG93bkVzY2FwZSxcbiAga2V5RG93bkhvbWU6IGtleURvd25Ib21lLFxuICBrZXlEb3duU3BhY2VCdXR0b246IGtleURvd25TcGFjZUJ1dHRvbixcbiAgbW91c2VVcDogbW91c2VVcCxcbiAgdG91Y2hFbmQ6IHRvdWNoRW5kLFxuICB1bmtub3duOiB1bmtub3duXG59KTtcblxudmFyIF9leGNsdWRlZCQzID0gW1wicmVmS2V5XCIsIFwicmVmXCJdLFxuICBfZXhjbHVkZWQyJDMgPSBbXCJvbkNsaWNrXCIsIFwib25QcmVzc1wiLCBcIm9uS2V5RG93blwiLCBcIm9uS2V5VXBcIiwgXCJvbkJsdXJcIl0sXG4gIF9leGNsdWRlZDMkMiA9IFtcIm9uS2V5RG93blwiLCBcIm9uQmx1clwiLCBcIm9uQ2hhbmdlXCIsIFwib25JbnB1dFwiLCBcIm9uQ2hhbmdlVGV4dFwiXSxcbiAgX2V4Y2x1ZGVkNCQyID0gW1wicmVmS2V5XCIsIFwicmVmXCJdLFxuICBfZXhjbHVkZWQ1ID0gW1wib25Nb3VzZU1vdmVcIiwgXCJvbk1vdXNlRG93blwiLCBcIm9uQ2xpY2tcIiwgXCJvblByZXNzXCIsIFwiaW5kZXhcIiwgXCJpdGVtXCJdO1xudmFyIERvd25zaGlmdCA9IC8qI19fUFVSRV9fKi9mdW5jdGlvbiAoKSB7XG4gIHZhciBEb3duc2hpZnQgPSAvKiNfX1BVUkVfXyovZnVuY3Rpb24gKF9Db21wb25lbnQpIHtcbiAgICBmdW5jdGlvbiBEb3duc2hpZnQoX3Byb3BzKSB7XG4gICAgICB2YXIgX3RoaXM7XG4gICAgICBfdGhpcyA9IF9Db21wb25lbnQuY2FsbCh0aGlzLCBfcHJvcHMpIHx8IHRoaXM7XG4gICAgICAvLyBmYW5jeSBkZXN0cnVjdHVyaW5nICsgZGVmYXVsdHMgKyBhbGlhc2VzXG4gICAgICAvLyB0aGlzIGJhc2ljYWxseSBzYXlzIGVhY2ggdmFsdWUgb2Ygc3RhdGUgc2hvdWxkIGVpdGhlciBiZSBzZXQgdG9cbiAgICAgIC8vIHRoZSBpbml0aWFsIHZhbHVlIG9yIHRoZSBkZWZhdWx0IHZhbHVlIGlmIHRoZSBpbml0aWFsIHZhbHVlIGlzIG5vdCBwcm92aWRlZFxuICAgICAgX3RoaXMuaWQgPSBfdGhpcy5wcm9wcy5pZCB8fCBcImRvd25zaGlmdC1cIiArIGdlbmVyYXRlSWQoKTtcbiAgICAgIF90aGlzLm1lbnVJZCA9IF90aGlzLnByb3BzLm1lbnVJZCB8fCBfdGhpcy5pZCArIFwiLW1lbnVcIjtcbiAgICAgIF90aGlzLmxhYmVsSWQgPSBfdGhpcy5wcm9wcy5sYWJlbElkIHx8IF90aGlzLmlkICsgXCItbGFiZWxcIjtcbiAgICAgIF90aGlzLmlucHV0SWQgPSBfdGhpcy5wcm9wcy5pbnB1dElkIHx8IF90aGlzLmlkICsgXCItaW5wdXRcIjtcbiAgICAgIF90aGlzLmdldEl0ZW1JZCA9IF90aGlzLnByb3BzLmdldEl0ZW1JZCB8fCBmdW5jdGlvbiAoaW5kZXgpIHtcbiAgICAgICAgcmV0dXJuIF90aGlzLmlkICsgXCItaXRlbS1cIiArIGluZGV4O1xuICAgICAgfTtcbiAgICAgIF90aGlzLml0ZW1zID0gW107XG4gICAgICAvLyBpdGVtQ291bnQgY2FuIGJlIGNoYW5nZWQgYXN5bmNocm9ub3VzbHlcbiAgICAgIC8vIGZyb20gd2l0aGluIGRvd25zaGlmdCAoc28gaXQgY2FuJ3QgY29tZSBmcm9tIGEgcHJvcClcbiAgICAgIC8vIHRoaXMgaXMgd2h5IHdlIHN0b3JlIGl0IGFzIGFuIGluc3RhbmNlIGFuZCB1c2VcbiAgICAgIC8vIGdldEl0ZW1Db3VudCByYXRoZXIgdGhhbiBqdXN0IHVzZSBpdGVtcy5sZW5ndGhcbiAgICAgIC8vICh0byBzdXBwb3J0IHdpbmRvd2luZyArIGFzeW5jKVxuICAgICAgX3RoaXMuaXRlbUNvdW50ID0gbnVsbDtcbiAgICAgIF90aGlzLnByZXZpb3VzUmVzdWx0Q291bnQgPSAwO1xuICAgICAgX3RoaXMudGltZW91dElkcyA9IFtdO1xuICAgICAgLyoqXG4gICAgICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBmbiB0aGUgZnVuY3Rpb24gdG8gY2FsbCBhZnRlciB0aGUgdGltZVxuICAgICAgICogQHBhcmFtIHtOdW1iZXJ9IHRpbWUgdGhlIHRpbWUgdG8gd2FpdFxuICAgICAgICovXG4gICAgICBfdGhpcy5pbnRlcm5hbFNldFRpbWVvdXQgPSBmdW5jdGlvbiAoZm4sIHRpbWUpIHtcbiAgICAgICAgdmFyIGlkID0gc2V0VGltZW91dChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgX3RoaXMudGltZW91dElkcyA9IF90aGlzLnRpbWVvdXRJZHMuZmlsdGVyKGZ1bmN0aW9uIChpKSB7XG4gICAgICAgICAgICByZXR1cm4gaSAhPT0gaWQ7XG4gICAgICAgICAgfSk7XG4gICAgICAgICAgZm4oKTtcbiAgICAgICAgfSwgdGltZSk7XG4gICAgICAgIF90aGlzLnRpbWVvdXRJZHMucHVzaChpZCk7XG4gICAgICB9O1xuICAgICAgX3RoaXMuc2V0SXRlbUNvdW50ID0gZnVuY3Rpb24gKGNvdW50KSB7XG4gICAgICAgIF90aGlzLml0ZW1Db3VudCA9IGNvdW50O1xuICAgICAgfTtcbiAgICAgIF90aGlzLnVuc2V0SXRlbUNvdW50ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBfdGhpcy5pdGVtQ291bnQgPSBudWxsO1xuICAgICAgfTtcbiAgICAgIF90aGlzLmlzSXRlbURpc2FibGVkID0gZnVuY3Rpb24gKF9pdGVtLCBpbmRleCkge1xuICAgICAgICB2YXIgY3VycmVudEVsZW1lbnROb2RlID0gX3RoaXMuZ2V0SXRlbU5vZGVGcm9tSW5kZXgoaW5kZXgpO1xuICAgICAgICByZXR1cm4gY3VycmVudEVsZW1lbnROb2RlICYmIGN1cnJlbnRFbGVtZW50Tm9kZS5oYXNBdHRyaWJ1dGUoJ2Rpc2FibGVkJyk7XG4gICAgICB9O1xuICAgICAgX3RoaXMuc2V0SGlnaGxpZ2h0ZWRJbmRleCA9IGZ1bmN0aW9uIChoaWdobGlnaHRlZEluZGV4LCBvdGhlclN0YXRlVG9TZXQpIHtcbiAgICAgICAgaWYgKGhpZ2hsaWdodGVkSW5kZXggPT09IHZvaWQgMCkge1xuICAgICAgICAgIGhpZ2hsaWdodGVkSW5kZXggPSBfdGhpcy5wcm9wcy5kZWZhdWx0SGlnaGxpZ2h0ZWRJbmRleDtcbiAgICAgICAgfVxuICAgICAgICBpZiAob3RoZXJTdGF0ZVRvU2V0ID09PSB2b2lkIDApIHtcbiAgICAgICAgICBvdGhlclN0YXRlVG9TZXQgPSB7fTtcbiAgICAgICAgfVxuICAgICAgICBvdGhlclN0YXRlVG9TZXQgPSBwaWNrU3RhdGUob3RoZXJTdGF0ZVRvU2V0KTtcbiAgICAgICAgX3RoaXMuaW50ZXJuYWxTZXRTdGF0ZShfZXh0ZW5kcyh7XG4gICAgICAgICAgaGlnaGxpZ2h0ZWRJbmRleDogaGlnaGxpZ2h0ZWRJbmRleFxuICAgICAgICB9LCBvdGhlclN0YXRlVG9TZXQpKTtcbiAgICAgIH07XG4gICAgICBfdGhpcy5jbGVhclNlbGVjdGlvbiA9IGZ1bmN0aW9uIChjYikge1xuICAgICAgICBfdGhpcy5pbnRlcm5hbFNldFN0YXRlKHtcbiAgICAgICAgICBzZWxlY3RlZEl0ZW06IG51bGwsXG4gICAgICAgICAgaW5wdXRWYWx1ZTogJycsXG4gICAgICAgICAgaGlnaGxpZ2h0ZWRJbmRleDogX3RoaXMucHJvcHMuZGVmYXVsdEhpZ2hsaWdodGVkSW5kZXgsXG4gICAgICAgICAgaXNPcGVuOiBfdGhpcy5wcm9wcy5kZWZhdWx0SXNPcGVuXG4gICAgICAgIH0sIGNiKTtcbiAgICAgIH07XG4gICAgICBfdGhpcy5zZWxlY3RJdGVtID0gZnVuY3Rpb24gKGl0ZW0sIG90aGVyU3RhdGVUb1NldCwgY2IpIHtcbiAgICAgICAgb3RoZXJTdGF0ZVRvU2V0ID0gcGlja1N0YXRlKG90aGVyU3RhdGVUb1NldCk7XG4gICAgICAgIF90aGlzLmludGVybmFsU2V0U3RhdGUoX2V4dGVuZHMoe1xuICAgICAgICAgIGlzT3BlbjogX3RoaXMucHJvcHMuZGVmYXVsdElzT3BlbixcbiAgICAgICAgICBoaWdobGlnaHRlZEluZGV4OiBfdGhpcy5wcm9wcy5kZWZhdWx0SGlnaGxpZ2h0ZWRJbmRleCxcbiAgICAgICAgICBzZWxlY3RlZEl0ZW06IGl0ZW0sXG4gICAgICAgICAgaW5wdXRWYWx1ZTogX3RoaXMucHJvcHMuaXRlbVRvU3RyaW5nKGl0ZW0pXG4gICAgICAgIH0sIG90aGVyU3RhdGVUb1NldCksIGNiKTtcbiAgICAgIH07XG4gICAgICBfdGhpcy5zZWxlY3RJdGVtQXRJbmRleCA9IGZ1bmN0aW9uIChpdGVtSW5kZXgsIG90aGVyU3RhdGVUb1NldCwgY2IpIHtcbiAgICAgICAgdmFyIGl0ZW0gPSBfdGhpcy5pdGVtc1tpdGVtSW5kZXhdO1xuICAgICAgICBpZiAoaXRlbSA9PSBudWxsKSB7XG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIF90aGlzLnNlbGVjdEl0ZW0oaXRlbSwgb3RoZXJTdGF0ZVRvU2V0LCBjYik7XG4gICAgICB9O1xuICAgICAgX3RoaXMuc2VsZWN0SGlnaGxpZ2h0ZWRJdGVtID0gZnVuY3Rpb24gKG90aGVyU3RhdGVUb1NldCwgY2IpIHtcbiAgICAgICAgcmV0dXJuIF90aGlzLnNlbGVjdEl0ZW1BdEluZGV4KF90aGlzLmdldFN0YXRlKCkuaGlnaGxpZ2h0ZWRJbmRleCwgb3RoZXJTdGF0ZVRvU2V0LCBjYik7XG4gICAgICB9O1xuICAgICAgLy8gYW55IHBpZWNlIG9mIG91ciBzdGF0ZSBjYW4gbGl2ZSBpbiB0d28gcGxhY2VzOlxuICAgICAgLy8gMS4gVW5jb250cm9sbGVkOiBpdCdzIGludGVybmFsICh0aGlzLnN0YXRlKVxuICAgICAgLy8gICAgV2Ugd2lsbCBjYWxsIHRoaXMuc2V0U3RhdGUgdG8gdXBkYXRlIHRoYXQgc3RhdGVcbiAgICAgIC8vIDIuIENvbnRyb2xsZWQ6IGl0J3MgZXh0ZXJuYWwgKHRoaXMucHJvcHMpXG4gICAgICAvLyAgICBXZSB3aWxsIGNhbGwgdGhpcy5wcm9wcy5vblN0YXRlQ2hhbmdlIHRvIHVwZGF0ZSB0aGF0IHN0YXRlXG4gICAgICAvL1xuICAgICAgLy8gSW4gYWRkaXRpb24sIHdlJ2xsIGNhbGwgdGhpcy5wcm9wcy5vbkNoYW5nZSBpZiB0aGVcbiAgICAgIC8vIHNlbGVjdGVkSXRlbSBpcyBjaGFuZ2VkLlxuICAgICAgX3RoaXMuaW50ZXJuYWxTZXRTdGF0ZSA9IGZ1bmN0aW9uIChzdGF0ZVRvU2V0LCBjYikge1xuICAgICAgICB2YXIgaXNJdGVtU2VsZWN0ZWQsIG9uQ2hhbmdlQXJnO1xuICAgICAgICB2YXIgb25TdGF0ZUNoYW5nZUFyZyA9IHt9O1xuICAgICAgICB2YXIgaXNTdGF0ZVRvU2V0RnVuY3Rpb24gPSB0eXBlb2Ygc3RhdGVUb1NldCA9PT0gJ2Z1bmN0aW9uJztcblxuICAgICAgICAvLyB3ZSB3YW50IHRvIGNhbGwgYG9uSW5wdXRWYWx1ZUNoYW5nZWAgYmVmb3JlIHRoZSBgc2V0U3RhdGVgIGNhbGxcbiAgICAgICAgLy8gc28gc29tZW9uZSBjb250cm9sbGluZyB0aGUgYGlucHV0VmFsdWVgIHN0YXRlIGdldHMgbm90aWZpZWQgb2ZcbiAgICAgICAgLy8gdGhlIGlucHV0IGNoYW5nZSBhcyBzb29uIGFzIHBvc3NpYmxlLiBUaGlzIGF2b2lkcyBpc3N1ZXMgd2l0aFxuICAgICAgICAvLyBwcmVzZXJ2aW5nIHRoZSBjdXJzb3IgcG9zaXRpb24uXG4gICAgICAgIC8vIFNlZSBodHRwczovL2dpdGh1Yi5jb20vZG93bnNoaWZ0LWpzL2Rvd25zaGlmdC9pc3N1ZXMvMjE3IGZvciBtb3JlIGluZm8uXG4gICAgICAgIGlmICghaXNTdGF0ZVRvU2V0RnVuY3Rpb24gJiYgc3RhdGVUb1NldC5oYXNPd25Qcm9wZXJ0eSgnaW5wdXRWYWx1ZScpKSB7XG4gICAgICAgICAgX3RoaXMucHJvcHMub25JbnB1dFZhbHVlQ2hhbmdlKHN0YXRlVG9TZXQuaW5wdXRWYWx1ZSwgX2V4dGVuZHMoe30sIF90aGlzLmdldFN0YXRlQW5kSGVscGVycygpLCBzdGF0ZVRvU2V0KSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIF90aGlzLnNldFN0YXRlKGZ1bmN0aW9uIChzdGF0ZSkge1xuICAgICAgICAgIHZhciBfbmV3U3RhdGVUb1NldDtcbiAgICAgICAgICBzdGF0ZSA9IF90aGlzLmdldFN0YXRlKHN0YXRlKTtcbiAgICAgICAgICB2YXIgbmV3U3RhdGVUb1NldCA9IGlzU3RhdGVUb1NldEZ1bmN0aW9uID8gc3RhdGVUb1NldChzdGF0ZSkgOiBzdGF0ZVRvU2V0O1xuXG4gICAgICAgICAgLy8gWW91ciBvd24gZnVuY3Rpb24gdGhhdCBjb3VsZCBtb2RpZnkgdGhlIHN0YXRlIHRoYXQgd2lsbCBiZSBzZXQuXG4gICAgICAgICAgbmV3U3RhdGVUb1NldCA9IF90aGlzLnByb3BzLnN0YXRlUmVkdWNlcihzdGF0ZSwgbmV3U3RhdGVUb1NldCk7XG5cbiAgICAgICAgICAvLyBjaGVja3MgaWYgYW4gaXRlbSBpcyBzZWxlY3RlZCwgcmVnYXJkbGVzcyBvZiBpZiBpdCdzIGRpZmZlcmVudCBmcm9tXG4gICAgICAgICAgLy8gd2hhdCB3YXMgc2VsZWN0ZWQgYmVmb3JlXG4gICAgICAgICAgLy8gdXNlZCB0byBkZXRlcm1pbmUgaWYgb25TZWxlY3QgYW5kIG9uQ2hhbmdlIGNhbGxiYWNrcyBzaG91bGQgYmUgY2FsbGVkXG4gICAgICAgICAgaXNJdGVtU2VsZWN0ZWQgPSBuZXdTdGF0ZVRvU2V0Lmhhc093blByb3BlcnR5KCdzZWxlY3RlZEl0ZW0nKTtcbiAgICAgICAgICAvLyB0aGlzIGtlZXBzIHRyYWNrIG9mIHRoZSBvYmplY3Qgd2Ugd2FudCB0byBjYWxsIHdpdGggc2V0U3RhdGVcbiAgICAgICAgICB2YXIgbmV4dFN0YXRlID0ge307XG4gICAgICAgICAgLy8gd2UgbmVlZCB0byBjYWxsIG9uIGNoYW5nZSBpZiB0aGUgb3V0c2lkZSB3b3JsZCBpcyBjb250cm9sbGluZyBhbnkgb2Ygb3VyIHN0YXRlXG4gICAgICAgICAgLy8gYW5kIHdlJ3JlIHRyeWluZyB0byB1cGRhdGUgdGhhdCBzdGF0ZS4gT1IgaWYgdGhlIHNlbGVjdGlvbiBoYXMgY2hhbmdlZCBhbmQgd2UncmVcbiAgICAgICAgICAvLyB0cnlpbmcgdG8gdXBkYXRlIHRoZSBzZWxlY3Rpb25cbiAgICAgICAgICBpZiAoaXNJdGVtU2VsZWN0ZWQgJiYgbmV3U3RhdGVUb1NldC5zZWxlY3RlZEl0ZW0gIT09IHN0YXRlLnNlbGVjdGVkSXRlbSkge1xuICAgICAgICAgICAgb25DaGFuZ2VBcmcgPSBuZXdTdGF0ZVRvU2V0LnNlbGVjdGVkSXRlbTtcbiAgICAgICAgICB9XG4gICAgICAgICAgKF9uZXdTdGF0ZVRvU2V0ID0gbmV3U3RhdGVUb1NldCkudHlwZSB8fCAoX25ld1N0YXRlVG9TZXQudHlwZSA9IHVua25vd24pO1xuICAgICAgICAgIE9iamVjdC5rZXlzKG5ld1N0YXRlVG9TZXQpLmZvckVhY2goZnVuY3Rpb24gKGtleSkge1xuICAgICAgICAgICAgLy8gb25TdGF0ZUNoYW5nZUFyZyBzaG91bGQgb25seSBoYXZlIHRoZSBzdGF0ZSB0aGF0IGlzXG4gICAgICAgICAgICAvLyBhY3R1YWxseSBjaGFuZ2luZ1xuICAgICAgICAgICAgaWYgKHN0YXRlW2tleV0gIT09IG5ld1N0YXRlVG9TZXRba2V5XSkge1xuICAgICAgICAgICAgICBvblN0YXRlQ2hhbmdlQXJnW2tleV0gPSBuZXdTdGF0ZVRvU2V0W2tleV07XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAvLyB0aGUgdHlwZSBpcyB1c2VmdWwgZm9yIHRoZSBvblN0YXRlQ2hhbmdlQXJnXG4gICAgICAgICAgICAvLyBidXQgd2UgZG9uJ3QgYWN0dWFsbHkgd2FudCB0byBzZXQgaXQgaW4gaW50ZXJuYWwgc3RhdGUuXG4gICAgICAgICAgICAvLyB0aGlzIGlzIGFuIHVuZG9jdW1lbnRlZCBmZWF0dXJlIGZvciBub3cuLi4gTm90IGFsbCBpbnRlcm5hbFNldFN0YXRlXG4gICAgICAgICAgICAvLyBjYWxscyBzdXBwb3J0IGl0IGFuZCBJJ20gbm90IGNlcnRhaW4gd2Ugd2FudCB0aGVtIHRvIHlldC5cbiAgICAgICAgICAgIC8vIEJ1dCBpdCBlbmFibGVzIHVzZXJzIGNvbnRyb2xsaW5nIHRoZSBpc09wZW4gc3RhdGUgdG8ga25vdyB3aGVuXG4gICAgICAgICAgICAvLyB0aGUgaXNPcGVuIHN0YXRlIGNoYW5nZXMgZHVlIHRvIG1vdXNldXAgZXZlbnRzIHdoaWNoIGlzIHF1aXRlIGhhbmR5LlxuICAgICAgICAgICAgaWYgKGtleSA9PT0gJ3R5cGUnKSB7XG4gICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIG5ld1N0YXRlVG9TZXRba2V5XTtcbiAgICAgICAgICAgIC8vIGlmIGl0J3MgY29taW5nIGZyb20gcHJvcHMsIHRoZW4gd2UgZG9uJ3QgY2FyZSB0byBzZXQgaXQgaW50ZXJuYWxseVxuICAgICAgICAgICAgaWYgKCFpc0NvbnRyb2xsZWRQcm9wKF90aGlzLnByb3BzLCBrZXkpKSB7XG4gICAgICAgICAgICAgIG5leHRTdGF0ZVtrZXldID0gbmV3U3RhdGVUb1NldFtrZXldO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgLy8gaWYgc3RhdGVUb1NldCBpcyBhIGZ1bmN0aW9uLCB0aGVuIHdlIHdlcmVuJ3QgYWJsZSB0byBjYWxsIG9uSW5wdXRWYWx1ZUNoYW5nZVxuICAgICAgICAgIC8vIGVhcmxpZXIsIHNvIHdlJ2xsIGNhbGwgaXQgbm93IHRoYXQgd2Uga25vdyB3aGF0IHRoZSBpbnB1dFZhbHVlIHN0YXRlIHdpbGwgYmUuXG4gICAgICAgICAgaWYgKGlzU3RhdGVUb1NldEZ1bmN0aW9uICYmIG5ld1N0YXRlVG9TZXQuaGFzT3duUHJvcGVydHkoJ2lucHV0VmFsdWUnKSkge1xuICAgICAgICAgICAgX3RoaXMucHJvcHMub25JbnB1dFZhbHVlQ2hhbmdlKG5ld1N0YXRlVG9TZXQuaW5wdXRWYWx1ZSwgX2V4dGVuZHMoe30sIF90aGlzLmdldFN0YXRlQW5kSGVscGVycygpLCBuZXdTdGF0ZVRvU2V0KSk7XG4gICAgICAgICAgfVxuICAgICAgICAgIHJldHVybiBuZXh0U3RhdGU7XG4gICAgICAgIH0sIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAvLyBjYWxsIHRoZSBwcm92aWRlZCBjYWxsYmFjayBpZiBpdCdzIGEgZnVuY3Rpb25cbiAgICAgICAgICBjYlRvQ2IoY2IpKCk7XG5cbiAgICAgICAgICAvLyBvbmx5IGNhbGwgdGhlIG9uU3RhdGVDaGFuZ2UgYW5kIG9uQ2hhbmdlIGNhbGxiYWNrcyBpZlxuICAgICAgICAgIC8vIHdlIGhhdmUgcmVsZXZhbnQgaW5mb3JtYXRpb24gdG8gcGFzcyB0aGVtLlxuICAgICAgICAgIHZhciBoYXNNb3JlU3RhdGVUaGFuVHlwZSA9IE9iamVjdC5rZXlzKG9uU3RhdGVDaGFuZ2VBcmcpLmxlbmd0aCA+IDE7XG4gICAgICAgICAgaWYgKGhhc01vcmVTdGF0ZVRoYW5UeXBlKSB7XG4gICAgICAgICAgICBfdGhpcy5wcm9wcy5vblN0YXRlQ2hhbmdlKG9uU3RhdGVDaGFuZ2VBcmcsIF90aGlzLmdldFN0YXRlQW5kSGVscGVycygpKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgaWYgKGlzSXRlbVNlbGVjdGVkKSB7XG4gICAgICAgICAgICBfdGhpcy5wcm9wcy5vblNlbGVjdChzdGF0ZVRvU2V0LnNlbGVjdGVkSXRlbSwgX3RoaXMuZ2V0U3RhdGVBbmRIZWxwZXJzKCkpO1xuICAgICAgICAgIH1cbiAgICAgICAgICBpZiAob25DaGFuZ2VBcmcgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgX3RoaXMucHJvcHMub25DaGFuZ2Uob25DaGFuZ2VBcmcsIF90aGlzLmdldFN0YXRlQW5kSGVscGVycygpKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgLy8gdGhpcyBpcyBjdXJyZW50bHkgdW5kb2N1bWVudGVkIGFuZCB0aGVyZWZvcmUgc3ViamVjdCB0byBjaGFuZ2VcbiAgICAgICAgICAvLyBXZSdsbCB0cnkgdG8gbm90IGJyZWFrIGl0LCBidXQganVzdCBiZSB3YXJuZWQuXG4gICAgICAgICAgX3RoaXMucHJvcHMub25Vc2VyQWN0aW9uKG9uU3RhdGVDaGFuZ2VBcmcsIF90aGlzLmdldFN0YXRlQW5kSGVscGVycygpKTtcbiAgICAgICAgfSk7XG4gICAgICB9O1xuICAgICAgLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLyBST09UXG4gICAgICBfdGhpcy5yb290UmVmID0gZnVuY3Rpb24gKG5vZGUpIHtcbiAgICAgICAgcmV0dXJuIF90aGlzLl9yb290Tm9kZSA9IG5vZGU7XG4gICAgICB9O1xuICAgICAgX3RoaXMuZ2V0Um9vdFByb3BzID0gZnVuY3Rpb24gKF90ZW1wLCBfdGVtcDIpIHtcbiAgICAgICAgdmFyIF9leHRlbmRzMjtcbiAgICAgICAgdmFyIF9yZWYgPSBfdGVtcCA9PT0gdm9pZCAwID8ge30gOiBfdGVtcCxcbiAgICAgICAgICBfcmVmJHJlZktleSA9IF9yZWYucmVmS2V5LFxuICAgICAgICAgIHJlZktleSA9IF9yZWYkcmVmS2V5ID09PSB2b2lkIDAgPyAncmVmJyA6IF9yZWYkcmVmS2V5LFxuICAgICAgICAgIHJlZiA9IF9yZWYucmVmLFxuICAgICAgICAgIHJlc3QgPSBfb2JqZWN0V2l0aG91dFByb3BlcnRpZXNMb29zZShfcmVmLCBfZXhjbHVkZWQkMyk7XG4gICAgICAgIHZhciBfcmVmMiA9IF90ZW1wMiA9PT0gdm9pZCAwID8ge30gOiBfdGVtcDIsXG4gICAgICAgICAgX3JlZjIkc3VwcHJlc3NSZWZFcnJvID0gX3JlZjIuc3VwcHJlc3NSZWZFcnJvcixcbiAgICAgICAgICBzdXBwcmVzc1JlZkVycm9yID0gX3JlZjIkc3VwcHJlc3NSZWZFcnJvID09PSB2b2lkIDAgPyBmYWxzZSA6IF9yZWYyJHN1cHByZXNzUmVmRXJybztcbiAgICAgICAgLy8gdGhpcyBpcyB1c2VkIGluIHRoZSByZW5kZXIgdG8ga25vdyB3aGV0aGVyIHRoZSB1c2VyIGhhcyBjYWxsZWQgZ2V0Um9vdFByb3BzLlxuICAgICAgICAvLyBJdCB1c2VzIHRoYXQgdG8ga25vdyB3aGV0aGVyIHRvIGFwcGx5IHRoZSBwcm9wcyBhdXRvbWF0aWNhbGx5XG4gICAgICAgIF90aGlzLmdldFJvb3RQcm9wcy5jYWxsZWQgPSB0cnVlO1xuICAgICAgICBfdGhpcy5nZXRSb290UHJvcHMucmVmS2V5ID0gcmVmS2V5O1xuICAgICAgICBfdGhpcy5nZXRSb290UHJvcHMuc3VwcHJlc3NSZWZFcnJvciA9IHN1cHByZXNzUmVmRXJyb3I7XG4gICAgICAgIHZhciBfdGhpcyRnZXRTdGF0ZSA9IF90aGlzLmdldFN0YXRlKCksXG4gICAgICAgICAgaXNPcGVuID0gX3RoaXMkZ2V0U3RhdGUuaXNPcGVuO1xuICAgICAgICByZXR1cm4gX2V4dGVuZHMoKF9leHRlbmRzMiA9IHt9LCBfZXh0ZW5kczJbcmVmS2V5XSA9IGhhbmRsZVJlZnMocmVmLCBfdGhpcy5yb290UmVmKSwgX2V4dGVuZHMyLnJvbGUgPSAnY29tYm9ib3gnLCBfZXh0ZW5kczJbJ2FyaWEtZXhwYW5kZWQnXSA9IGlzT3BlbiwgX2V4dGVuZHMyWydhcmlhLWhhc3BvcHVwJ10gPSAnbGlzdGJveCcsIF9leHRlbmRzMlsnYXJpYS1vd25zJ10gPSBpc09wZW4gPyBfdGhpcy5tZW51SWQgOiB1bmRlZmluZWQsIF9leHRlbmRzMlsnYXJpYS1sYWJlbGxlZGJ5J10gPSBfdGhpcy5sYWJlbElkLCBfZXh0ZW5kczIpLCByZXN0KTtcbiAgICAgIH07XG4gICAgICAvL1xcXFxcXFxcXFxcXFxcXFxcXFxcXFxcXFxcXFxcXFxcXFxcXFxcXFxcXFxcXFxcXFxcXFwgUk9PVFxuICAgICAgX3RoaXMua2V5RG93bkhhbmRsZXJzID0ge1xuICAgICAgICBBcnJvd0Rvd246IGZ1bmN0aW9uIEFycm93RG93bihldmVudCkge1xuICAgICAgICAgIHZhciBfdGhpczIgPSB0aGlzO1xuICAgICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgaWYgKHRoaXMuZ2V0U3RhdGUoKS5pc09wZW4pIHtcbiAgICAgICAgICAgIHZhciBhbW91bnQgPSBldmVudC5zaGlmdEtleSA/IDUgOiAxO1xuICAgICAgICAgICAgdGhpcy5tb3ZlSGlnaGxpZ2h0ZWRJbmRleChhbW91bnQsIHtcbiAgICAgICAgICAgICAgdHlwZToga2V5RG93bkFycm93RG93blxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMuaW50ZXJuYWxTZXRTdGF0ZSh7XG4gICAgICAgICAgICAgIGlzT3BlbjogdHJ1ZSxcbiAgICAgICAgICAgICAgdHlwZToga2V5RG93bkFycm93RG93blxuICAgICAgICAgICAgfSwgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICB2YXIgaXRlbUNvdW50ID0gX3RoaXMyLmdldEl0ZW1Db3VudCgpO1xuICAgICAgICAgICAgICBpZiAoaXRlbUNvdW50ID4gMCkge1xuICAgICAgICAgICAgICAgIHZhciBfdGhpczIkZ2V0U3RhdGUgPSBfdGhpczIuZ2V0U3RhdGUoKSxcbiAgICAgICAgICAgICAgICAgIGhpZ2hsaWdodGVkSW5kZXggPSBfdGhpczIkZ2V0U3RhdGUuaGlnaGxpZ2h0ZWRJbmRleDtcbiAgICAgICAgICAgICAgICB2YXIgbmV4dEhpZ2hsaWdodGVkSW5kZXggPSBnZXRIaWdobGlnaHRlZEluZGV4KGhpZ2hsaWdodGVkSW5kZXgsIDEsIHtcbiAgICAgICAgICAgICAgICAgIGxlbmd0aDogaXRlbUNvdW50XG4gICAgICAgICAgICAgICAgfSwgX3RoaXMyLmlzSXRlbURpc2FibGVkLCB0cnVlKTtcbiAgICAgICAgICAgICAgICBfdGhpczIuc2V0SGlnaGxpZ2h0ZWRJbmRleChuZXh0SGlnaGxpZ2h0ZWRJbmRleCwge1xuICAgICAgICAgICAgICAgICAgdHlwZToga2V5RG93bkFycm93RG93blxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIEFycm93VXA6IGZ1bmN0aW9uIEFycm93VXAoZXZlbnQpIHtcbiAgICAgICAgICB2YXIgX3RoaXMzID0gdGhpcztcbiAgICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgIGlmICh0aGlzLmdldFN0YXRlKCkuaXNPcGVuKSB7XG4gICAgICAgICAgICB2YXIgYW1vdW50ID0gZXZlbnQuc2hpZnRLZXkgPyAtNSA6IC0xO1xuICAgICAgICAgICAgdGhpcy5tb3ZlSGlnaGxpZ2h0ZWRJbmRleChhbW91bnQsIHtcbiAgICAgICAgICAgICAgdHlwZToga2V5RG93bkFycm93VXBcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB0aGlzLmludGVybmFsU2V0U3RhdGUoe1xuICAgICAgICAgICAgICBpc09wZW46IHRydWUsXG4gICAgICAgICAgICAgIHR5cGU6IGtleURvd25BcnJvd1VwXG4gICAgICAgICAgICB9LCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgIHZhciBpdGVtQ291bnQgPSBfdGhpczMuZ2V0SXRlbUNvdW50KCk7XG4gICAgICAgICAgICAgIGlmIChpdGVtQ291bnQgPiAwKSB7XG4gICAgICAgICAgICAgICAgdmFyIF90aGlzMyRnZXRTdGF0ZSA9IF90aGlzMy5nZXRTdGF0ZSgpLFxuICAgICAgICAgICAgICAgICAgaGlnaGxpZ2h0ZWRJbmRleCA9IF90aGlzMyRnZXRTdGF0ZS5oaWdobGlnaHRlZEluZGV4O1xuICAgICAgICAgICAgICAgIHZhciBuZXh0SGlnaGxpZ2h0ZWRJbmRleCA9IGdldEhpZ2hsaWdodGVkSW5kZXgoaGlnaGxpZ2h0ZWRJbmRleCwgLTEsIHtcbiAgICAgICAgICAgICAgICAgIGxlbmd0aDogaXRlbUNvdW50XG4gICAgICAgICAgICAgICAgfSwgX3RoaXMzLmlzSXRlbURpc2FibGVkLCB0cnVlKTtcbiAgICAgICAgICAgICAgICBfdGhpczMuc2V0SGlnaGxpZ2h0ZWRJbmRleChuZXh0SGlnaGxpZ2h0ZWRJbmRleCwge1xuICAgICAgICAgICAgICAgICAgdHlwZToga2V5RG93bkFycm93VXBcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICBFbnRlcjogZnVuY3Rpb24gRW50ZXIoZXZlbnQpIHtcbiAgICAgICAgICBpZiAoZXZlbnQud2hpY2ggPT09IDIyOSkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgIH1cbiAgICAgICAgICB2YXIgX3RoaXMkZ2V0U3RhdGUyID0gdGhpcy5nZXRTdGF0ZSgpLFxuICAgICAgICAgICAgaXNPcGVuID0gX3RoaXMkZ2V0U3RhdGUyLmlzT3BlbixcbiAgICAgICAgICAgIGhpZ2hsaWdodGVkSW5kZXggPSBfdGhpcyRnZXRTdGF0ZTIuaGlnaGxpZ2h0ZWRJbmRleDtcbiAgICAgICAgICBpZiAoaXNPcGVuICYmIGhpZ2hsaWdodGVkSW5kZXggIT0gbnVsbCkge1xuICAgICAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICAgIHZhciBpdGVtID0gdGhpcy5pdGVtc1toaWdobGlnaHRlZEluZGV4XTtcbiAgICAgICAgICAgIHZhciBpdGVtTm9kZSA9IHRoaXMuZ2V0SXRlbU5vZGVGcm9tSW5kZXgoaGlnaGxpZ2h0ZWRJbmRleCk7XG4gICAgICAgICAgICBpZiAoaXRlbSA9PSBudWxsIHx8IGl0ZW1Ob2RlICYmIGl0ZW1Ob2RlLmhhc0F0dHJpYnV0ZSgnZGlzYWJsZWQnKSkge1xuICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLnNlbGVjdEhpZ2hsaWdodGVkSXRlbSh7XG4gICAgICAgICAgICAgIHR5cGU6IGtleURvd25FbnRlclxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICBFc2NhcGU6IGZ1bmN0aW9uIEVzY2FwZShldmVudCkge1xuICAgICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgdGhpcy5yZXNldChfZXh0ZW5kcyh7XG4gICAgICAgICAgICB0eXBlOiBrZXlEb3duRXNjYXBlXG4gICAgICAgICAgfSwgIXRoaXMuc3RhdGUuaXNPcGVuICYmIHtcbiAgICAgICAgICAgIHNlbGVjdGVkSXRlbTogbnVsbCxcbiAgICAgICAgICAgIGlucHV0VmFsdWU6ICcnXG4gICAgICAgICAgfSkpO1xuICAgICAgICB9XG4gICAgICB9O1xuICAgICAgLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLyBCVVRUT05cbiAgICAgIF90aGlzLmJ1dHRvbktleURvd25IYW5kbGVycyA9IF9leHRlbmRzKHt9LCBfdGhpcy5rZXlEb3duSGFuZGxlcnMsIHtcbiAgICAgICAgJyAnOiBmdW5jdGlvbiBfKGV2ZW50KSB7XG4gICAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICB0aGlzLnRvZ2dsZU1lbnUoe1xuICAgICAgICAgICAgdHlwZToga2V5RG93blNwYWNlQnV0dG9uXG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgICAgX3RoaXMuaW5wdXRLZXlEb3duSGFuZGxlcnMgPSBfZXh0ZW5kcyh7fSwgX3RoaXMua2V5RG93bkhhbmRsZXJzLCB7XG4gICAgICAgIEhvbWU6IGZ1bmN0aW9uIEhvbWUoZXZlbnQpIHtcbiAgICAgICAgICB2YXIgX3RoaXMkZ2V0U3RhdGUzID0gdGhpcy5nZXRTdGF0ZSgpLFxuICAgICAgICAgICAgaXNPcGVuID0gX3RoaXMkZ2V0U3RhdGUzLmlzT3BlbjtcbiAgICAgICAgICBpZiAoIWlzT3Blbikge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgIH1cbiAgICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgIHZhciBpdGVtQ291bnQgPSB0aGlzLmdldEl0ZW1Db3VudCgpO1xuICAgICAgICAgIGlmIChpdGVtQ291bnQgPD0gMCB8fCAhaXNPcGVuKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgLy8gZ2V0IG5leHQgbm9uLWRpc2FibGVkIHN0YXJ0aW5nIGRvd253YXJkcyBmcm9tIDAgaWYgdGhhdCdzIGRpc2FibGVkLlxuICAgICAgICAgIHZhciBuZXdIaWdobGlnaHRlZEluZGV4ID0gZ2V0Tm9uRGlzYWJsZWRJbmRleCgwLCBmYWxzZSwge1xuICAgICAgICAgICAgbGVuZ3RoOiBpdGVtQ291bnRcbiAgICAgICAgICB9LCB0aGlzLmlzSXRlbURpc2FibGVkKTtcbiAgICAgICAgICB0aGlzLnNldEhpZ2hsaWdodGVkSW5kZXgobmV3SGlnaGxpZ2h0ZWRJbmRleCwge1xuICAgICAgICAgICAgdHlwZToga2V5RG93bkhvbWVcbiAgICAgICAgICB9KTtcbiAgICAgICAgfSxcbiAgICAgICAgRW5kOiBmdW5jdGlvbiBFbmQoZXZlbnQpIHtcbiAgICAgICAgICB2YXIgX3RoaXMkZ2V0U3RhdGU0ID0gdGhpcy5nZXRTdGF0ZSgpLFxuICAgICAgICAgICAgaXNPcGVuID0gX3RoaXMkZ2V0U3RhdGU0LmlzT3BlbjtcbiAgICAgICAgICBpZiAoIWlzT3Blbikge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgIH1cbiAgICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgIHZhciBpdGVtQ291bnQgPSB0aGlzLmdldEl0ZW1Db3VudCgpO1xuICAgICAgICAgIGlmIChpdGVtQ291bnQgPD0gMCB8fCAhaXNPcGVuKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgLy8gZ2V0IG5leHQgbm9uLWRpc2FibGVkIHN0YXJ0aW5nIHVwd2FyZHMgZnJvbSBsYXN0IGluZGV4IGlmIHRoYXQncyBkaXNhYmxlZC5cbiAgICAgICAgICB2YXIgbmV3SGlnaGxpZ2h0ZWRJbmRleCA9IGdldE5vbkRpc2FibGVkSW5kZXgoaXRlbUNvdW50IC0gMSwgdHJ1ZSwge1xuICAgICAgICAgICAgbGVuZ3RoOiBpdGVtQ291bnRcbiAgICAgICAgICB9LCB0aGlzLmlzSXRlbURpc2FibGVkKTtcbiAgICAgICAgICB0aGlzLnNldEhpZ2hsaWdodGVkSW5kZXgobmV3SGlnaGxpZ2h0ZWRJbmRleCwge1xuICAgICAgICAgICAgdHlwZToga2V5RG93bkVuZFxuICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICAgIF90aGlzLmdldFRvZ2dsZUJ1dHRvblByb3BzID0gZnVuY3Rpb24gKF90ZW1wMykge1xuICAgICAgICB2YXIgX3JlZjMgPSBfdGVtcDMgPT09IHZvaWQgMCA/IHt9IDogX3RlbXAzLFxuICAgICAgICAgIG9uQ2xpY2sgPSBfcmVmMy5vbkNsaWNrO1xuICAgICAgICAgIF9yZWYzLm9uUHJlc3M7XG4gICAgICAgICAgdmFyIG9uS2V5RG93biA9IF9yZWYzLm9uS2V5RG93bixcbiAgICAgICAgICBvbktleVVwID0gX3JlZjMub25LZXlVcCxcbiAgICAgICAgICBvbkJsdXIgPSBfcmVmMy5vbkJsdXIsXG4gICAgICAgICAgcmVzdCA9IF9vYmplY3RXaXRob3V0UHJvcGVydGllc0xvb3NlKF9yZWYzLCBfZXhjbHVkZWQyJDMpO1xuICAgICAgICB2YXIgX3RoaXMkZ2V0U3RhdGU1ID0gX3RoaXMuZ2V0U3RhdGUoKSxcbiAgICAgICAgICBpc09wZW4gPSBfdGhpcyRnZXRTdGF0ZTUuaXNPcGVuO1xuICAgICAgICB2YXIgZW5hYmxlZEV2ZW50SGFuZGxlcnMgPSB7XG4gICAgICAgICAgb25DbGljazogY2FsbEFsbEV2ZW50SGFuZGxlcnMob25DbGljaywgX3RoaXMuYnV0dG9uSGFuZGxlQ2xpY2spLFxuICAgICAgICAgIG9uS2V5RG93bjogY2FsbEFsbEV2ZW50SGFuZGxlcnMob25LZXlEb3duLCBfdGhpcy5idXR0b25IYW5kbGVLZXlEb3duKSxcbiAgICAgICAgICBvbktleVVwOiBjYWxsQWxsRXZlbnRIYW5kbGVycyhvbktleVVwLCBfdGhpcy5idXR0b25IYW5kbGVLZXlVcCksXG4gICAgICAgICAgb25CbHVyOiBjYWxsQWxsRXZlbnRIYW5kbGVycyhvbkJsdXIsIF90aGlzLmJ1dHRvbkhhbmRsZUJsdXIpXG4gICAgICAgIH07XG4gICAgICAgIHZhciBldmVudEhhbmRsZXJzID0gcmVzdC5kaXNhYmxlZCA/IHt9IDogZW5hYmxlZEV2ZW50SGFuZGxlcnM7XG4gICAgICAgIHJldHVybiBfZXh0ZW5kcyh7XG4gICAgICAgICAgdHlwZTogJ2J1dHRvbicsXG4gICAgICAgICAgcm9sZTogJ2J1dHRvbicsXG4gICAgICAgICAgJ2FyaWEtbGFiZWwnOiBpc09wZW4gPyAnY2xvc2UgbWVudScgOiAnb3BlbiBtZW51JyxcbiAgICAgICAgICAnYXJpYS1oYXNwb3B1cCc6IHRydWUsXG4gICAgICAgICAgJ2RhdGEtdG9nZ2xlJzogdHJ1ZVxuICAgICAgICB9LCBldmVudEhhbmRsZXJzLCByZXN0KTtcbiAgICAgIH07XG4gICAgICBfdGhpcy5idXR0b25IYW5kbGVLZXlVcCA9IGZ1bmN0aW9uIChldmVudCkge1xuICAgICAgICAvLyBQcmV2ZW50IGNsaWNrIGV2ZW50IGZyb20gZW1pdHRpbmcgaW4gRmlyZWZveFxuICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgfTtcbiAgICAgIF90aGlzLmJ1dHRvbkhhbmRsZUtleURvd24gPSBmdW5jdGlvbiAoZXZlbnQpIHtcbiAgICAgICAgdmFyIGtleSA9IG5vcm1hbGl6ZUFycm93S2V5KGV2ZW50KTtcbiAgICAgICAgaWYgKF90aGlzLmJ1dHRvbktleURvd25IYW5kbGVyc1trZXldKSB7XG4gICAgICAgICAgX3RoaXMuYnV0dG9uS2V5RG93bkhhbmRsZXJzW2tleV0uY2FsbChfdGhpcywgZXZlbnQpO1xuICAgICAgICB9XG4gICAgICB9O1xuICAgICAgX3RoaXMuYnV0dG9uSGFuZGxlQ2xpY2sgPSBmdW5jdGlvbiAoZXZlbnQpIHtcbiAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgLy8gaGFuZGxlIG9kZCBjYXNlIGZvciBTYWZhcmkgYW5kIEZpcmVmb3ggd2hpY2hcbiAgICAgICAgLy8gZG9uJ3QgZ2l2ZSB0aGUgYnV0dG9uIHRoZSBmb2N1cyBwcm9wZXJseS5cbiAgICAgICAgLyogaXN0YW5idWwgaWdub3JlIGlmIChjYW4ndCByZWFzb25hYmx5IHRlc3QgdGhpcykgKi9cbiAgICAgICAgaWYgKF90aGlzLnByb3BzLmVudmlyb25tZW50KSB7XG4gICAgICAgICAgdmFyIF90aGlzJHByb3BzJGVudmlyb25tZSA9IF90aGlzLnByb3BzLmVudmlyb25tZW50LmRvY3VtZW50LFxuICAgICAgICAgICAgYm9keSA9IF90aGlzJHByb3BzJGVudmlyb25tZS5ib2R5LFxuICAgICAgICAgICAgYWN0aXZlRWxlbWVudCA9IF90aGlzJHByb3BzJGVudmlyb25tZS5hY3RpdmVFbGVtZW50O1xuICAgICAgICAgIGlmIChib2R5ICYmIGJvZHkgPT09IGFjdGl2ZUVsZW1lbnQpIHtcbiAgICAgICAgICAgIGV2ZW50LnRhcmdldC5mb2N1cygpO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICAvLyB0byBzaW1wbGlmeSB0ZXN0aW5nIGNvbXBvbmVudHMgdGhhdCB1c2UgZG93bnNoaWZ0LCB3ZSdsbCBub3Qgd3JhcCB0aGlzIGluIGEgc2V0VGltZW91dFxuICAgICAgICAvLyBpZiB0aGUgTk9ERV9FTlYgaXMgdGVzdC4gV2l0aCB0aGUgcHJvcGVyIGJ1aWxkIHN5c3RlbSwgdGhpcyBzaG91bGQgYmUgZGVhZCBjb2RlIGVsaW1pbmF0ZWRcbiAgICAgICAgLy8gd2hlbiBidWlsZGluZyBmb3IgcHJvZHVjdGlvbiBhbmQgc2hvdWxkIHRoZXJlZm9yZSBoYXZlIG5vIGltcGFjdCBvbiBwcm9kdWN0aW9uIGNvZGUuXG4gICAgICAgIGlmIChwcm9jZXNzLmVudi5OT0RFX0VOViA9PT0gJ3Rlc3QnKSB7XG4gICAgICAgICAgX3RoaXMudG9nZ2xlTWVudSh7XG4gICAgICAgICAgICB0eXBlOiBjbGlja0J1dHRvblxuICAgICAgICAgIH0pO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIC8vIEVuc3VyZSB0aGF0IHRvZ2dsZSBvZiBtZW51IG9jY3VycyBhZnRlciB0aGUgcG90ZW50aWFsIGJsdXIgZXZlbnQgaW4gaU9TXG4gICAgICAgICAgX3RoaXMuaW50ZXJuYWxTZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiBfdGhpcy50b2dnbGVNZW51KHtcbiAgICAgICAgICAgICAgdHlwZTogY2xpY2tCdXR0b25cbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICB9O1xuICAgICAgX3RoaXMuYnV0dG9uSGFuZGxlQmx1ciA9IGZ1bmN0aW9uIChldmVudCkge1xuICAgICAgICB2YXIgYmx1clRhcmdldCA9IGV2ZW50LnRhcmdldDsgLy8gU2F2ZSBibHVyIHRhcmdldCBmb3IgY29tcGFyaXNvbiB3aXRoIGFjdGl2ZUVsZW1lbnQgbGF0ZXJcbiAgICAgICAgLy8gTmVlZCBzZXRUaW1lb3V0LCBzbyB0aGF0IHdoZW4gdGhlIHVzZXIgcHJlc3NlcyBUYWIsIHRoZSBhY3RpdmVFbGVtZW50IGlzIHRoZSBuZXh0IGZvY3VzZWQgZWxlbWVudCwgbm90IGJvZHkgZWxlbWVudFxuICAgICAgICBfdGhpcy5pbnRlcm5hbFNldFRpbWVvdXQoZnVuY3Rpb24gKCkge1xuICAgICAgICAgIGlmIChfdGhpcy5pc01vdXNlRG93biB8fCAhX3RoaXMucHJvcHMuZW52aXJvbm1lbnQpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICB9XG4gICAgICAgICAgdmFyIGFjdGl2ZUVsZW1lbnQgPSBfdGhpcy5wcm9wcy5lbnZpcm9ubWVudC5kb2N1bWVudC5hY3RpdmVFbGVtZW50O1xuICAgICAgICAgIGlmICgoYWN0aXZlRWxlbWVudCA9PSBudWxsIHx8IGFjdGl2ZUVsZW1lbnQuaWQgIT09IF90aGlzLmlucHV0SWQpICYmIGFjdGl2ZUVsZW1lbnQgIT09IGJsdXJUYXJnZXQgLy8gRG8gbm90aGluZyBpZiB3ZSByZWZvY3VzIHRoZSBzYW1lIGVsZW1lbnQgYWdhaW4gKHRvIHNvbHZlIGlzc3VlIGluIFNhZmFyaSBvbiBpT1MpXG4gICAgICAgICAgKSB7XG4gICAgICAgICAgICBfdGhpcy5yZXNldCh7XG4gICAgICAgICAgICAgIHR5cGU6IGJsdXJCdXR0b25cbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICB9O1xuICAgICAgLy9cXFxcXFxcXFxcXFxcXFxcXFxcXFxcXFxcXFxcXFxcXFxcXFxcXFxcXFxcXFxcXFxcXFxcXFxcXFxcIEJVVFRPTlxuICAgICAgLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLyBMQUJFTFxuICAgICAgX3RoaXMuZ2V0TGFiZWxQcm9wcyA9IGZ1bmN0aW9uIChwcm9wcykge1xuICAgICAgICByZXR1cm4gX2V4dGVuZHMoe1xuICAgICAgICAgIGh0bWxGb3I6IF90aGlzLmlucHV0SWQsXG4gICAgICAgICAgaWQ6IF90aGlzLmxhYmVsSWRcbiAgICAgICAgfSwgcHJvcHMpO1xuICAgICAgfTtcbiAgICAgIC8vXFxcXFxcXFxcXFxcXFxcXFxcXFxcXFxcXFxcXFxcXFxcXFxcXFxcXFxcXFxcXFxcXFxcXFxcXFxcXCBMQUJFTFxuICAgICAgLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLyBJTlBVVFxuICAgICAgX3RoaXMuZ2V0SW5wdXRQcm9wcyA9IGZ1bmN0aW9uIChfdGVtcDQpIHtcbiAgICAgICAgdmFyIF9yZWY0ID0gX3RlbXA0ID09PSB2b2lkIDAgPyB7fSA6IF90ZW1wNCxcbiAgICAgICAgICBvbktleURvd24gPSBfcmVmNC5vbktleURvd24sXG4gICAgICAgICAgb25CbHVyID0gX3JlZjQub25CbHVyLFxuICAgICAgICAgIG9uQ2hhbmdlID0gX3JlZjQub25DaGFuZ2UsXG4gICAgICAgICAgb25JbnB1dCA9IF9yZWY0Lm9uSW5wdXQ7XG4gICAgICAgICAgX3JlZjQub25DaGFuZ2VUZXh0O1xuICAgICAgICAgIHZhciByZXN0ID0gX29iamVjdFdpdGhvdXRQcm9wZXJ0aWVzTG9vc2UoX3JlZjQsIF9leGNsdWRlZDMkMik7XG4gICAgICAgIHZhciBvbkNoYW5nZUtleTtcbiAgICAgICAgdmFyIGV2ZW50SGFuZGxlcnMgPSB7fTtcblxuICAgICAgICAvKiBpc3RhbmJ1bCBpZ25vcmUgbmV4dCAocHJlYWN0KSAqL1xuICAgICAgICB7XG4gICAgICAgICAgb25DaGFuZ2VLZXkgPSAnb25DaGFuZ2UnO1xuICAgICAgICB9XG4gICAgICAgIHZhciBfdGhpcyRnZXRTdGF0ZTYgPSBfdGhpcy5nZXRTdGF0ZSgpLFxuICAgICAgICAgIGlucHV0VmFsdWUgPSBfdGhpcyRnZXRTdGF0ZTYuaW5wdXRWYWx1ZSxcbiAgICAgICAgICBpc09wZW4gPSBfdGhpcyRnZXRTdGF0ZTYuaXNPcGVuLFxuICAgICAgICAgIGhpZ2hsaWdodGVkSW5kZXggPSBfdGhpcyRnZXRTdGF0ZTYuaGlnaGxpZ2h0ZWRJbmRleDtcbiAgICAgICAgaWYgKCFyZXN0LmRpc2FibGVkKSB7XG4gICAgICAgICAgdmFyIF9ldmVudEhhbmRsZXJzO1xuICAgICAgICAgIGV2ZW50SGFuZGxlcnMgPSAoX2V2ZW50SGFuZGxlcnMgPSB7fSwgX2V2ZW50SGFuZGxlcnNbb25DaGFuZ2VLZXldID0gY2FsbEFsbEV2ZW50SGFuZGxlcnMob25DaGFuZ2UsIG9uSW5wdXQsIF90aGlzLmlucHV0SGFuZGxlQ2hhbmdlKSwgX2V2ZW50SGFuZGxlcnMub25LZXlEb3duID0gY2FsbEFsbEV2ZW50SGFuZGxlcnMob25LZXlEb3duLCBfdGhpcy5pbnB1dEhhbmRsZUtleURvd24pLCBfZXZlbnRIYW5kbGVycy5vbkJsdXIgPSBjYWxsQWxsRXZlbnRIYW5kbGVycyhvbkJsdXIsIF90aGlzLmlucHV0SGFuZGxlQmx1ciksIF9ldmVudEhhbmRsZXJzKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gX2V4dGVuZHMoe1xuICAgICAgICAgICdhcmlhLWF1dG9jb21wbGV0ZSc6ICdsaXN0JyxcbiAgICAgICAgICAnYXJpYS1hY3RpdmVkZXNjZW5kYW50JzogaXNPcGVuICYmIHR5cGVvZiBoaWdobGlnaHRlZEluZGV4ID09PSAnbnVtYmVyJyAmJiBoaWdobGlnaHRlZEluZGV4ID49IDAgPyBfdGhpcy5nZXRJdGVtSWQoaGlnaGxpZ2h0ZWRJbmRleCkgOiB1bmRlZmluZWQsXG4gICAgICAgICAgJ2FyaWEtY29udHJvbHMnOiBpc09wZW4gPyBfdGhpcy5tZW51SWQgOiB1bmRlZmluZWQsXG4gICAgICAgICAgJ2FyaWEtbGFiZWxsZWRieSc6IHJlc3QgJiYgcmVzdFsnYXJpYS1sYWJlbCddID8gdW5kZWZpbmVkIDogX3RoaXMubGFiZWxJZCxcbiAgICAgICAgICAvLyBodHRwczovL2RldmVsb3Blci5tb3ppbGxhLm9yZy9lbi1VUy9kb2NzL1dlYi9TZWN1cml0eS9TZWN1cmluZ195b3VyX3NpdGUvVHVybmluZ19vZmZfZm9ybV9hdXRvY29tcGxldGlvblxuICAgICAgICAgIC8vIHJldmVydCBiYWNrIHNpbmNlIGF1dG9jb21wbGV0ZT1cIm5vcGVcIiBpcyBpZ25vcmVkIG9uIGxhdGVzdCBDaHJvbWUgYW5kIE9wZXJhXG4gICAgICAgICAgYXV0b0NvbXBsZXRlOiAnb2ZmJyxcbiAgICAgICAgICB2YWx1ZTogaW5wdXRWYWx1ZSxcbiAgICAgICAgICBpZDogX3RoaXMuaW5wdXRJZFxuICAgICAgICB9LCBldmVudEhhbmRsZXJzLCByZXN0KTtcbiAgICAgIH07XG4gICAgICBfdGhpcy5pbnB1dEhhbmRsZUtleURvd24gPSBmdW5jdGlvbiAoZXZlbnQpIHtcbiAgICAgICAgdmFyIGtleSA9IG5vcm1hbGl6ZUFycm93S2V5KGV2ZW50KTtcbiAgICAgICAgaWYgKGtleSAmJiBfdGhpcy5pbnB1dEtleURvd25IYW5kbGVyc1trZXldKSB7XG4gICAgICAgICAgX3RoaXMuaW5wdXRLZXlEb3duSGFuZGxlcnNba2V5XS5jYWxsKF90aGlzLCBldmVudCk7XG4gICAgICAgIH1cbiAgICAgIH07XG4gICAgICBfdGhpcy5pbnB1dEhhbmRsZUNoYW5nZSA9IGZ1bmN0aW9uIChldmVudCkge1xuICAgICAgICBfdGhpcy5pbnRlcm5hbFNldFN0YXRlKHtcbiAgICAgICAgICB0eXBlOiBjaGFuZ2VJbnB1dCxcbiAgICAgICAgICBpc09wZW46IHRydWUsXG4gICAgICAgICAgaW5wdXRWYWx1ZTogZXZlbnQudGFyZ2V0LnZhbHVlLFxuICAgICAgICAgIGhpZ2hsaWdodGVkSW5kZXg6IF90aGlzLnByb3BzLmRlZmF1bHRIaWdobGlnaHRlZEluZGV4XG4gICAgICAgIH0pO1xuICAgICAgfTtcbiAgICAgIF90aGlzLmlucHV0SGFuZGxlQmx1ciA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgLy8gTmVlZCBzZXRUaW1lb3V0LCBzbyB0aGF0IHdoZW4gdGhlIHVzZXIgcHJlc3NlcyBUYWIsIHRoZSBhY3RpdmVFbGVtZW50IGlzIHRoZSBuZXh0IGZvY3VzZWQgZWxlbWVudCwgbm90IHRoZSBib2R5IGVsZW1lbnRcbiAgICAgICAgX3RoaXMuaW50ZXJuYWxTZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICB2YXIgX2FjdGl2ZUVsZW1lbnQkZGF0YXNlO1xuICAgICAgICAgIGlmIChfdGhpcy5pc01vdXNlRG93biB8fCAhX3RoaXMucHJvcHMuZW52aXJvbm1lbnQpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICB9XG4gICAgICAgICAgdmFyIGFjdGl2ZUVsZW1lbnQgPSBfdGhpcy5wcm9wcy5lbnZpcm9ubWVudC5kb2N1bWVudC5hY3RpdmVFbGVtZW50O1xuICAgICAgICAgIHZhciBkb3duc2hpZnRCdXR0b25Jc0FjdGl2ZSA9IChhY3RpdmVFbGVtZW50ID09IG51bGwgfHwgKF9hY3RpdmVFbGVtZW50JGRhdGFzZSA9IGFjdGl2ZUVsZW1lbnQuZGF0YXNldCkgPT0gbnVsbCA/IHZvaWQgMCA6IF9hY3RpdmVFbGVtZW50JGRhdGFzZS50b2dnbGUpICYmIF90aGlzLl9yb290Tm9kZSAmJiBfdGhpcy5fcm9vdE5vZGUuY29udGFpbnMoYWN0aXZlRWxlbWVudCk7XG4gICAgICAgICAgaWYgKCFkb3duc2hpZnRCdXR0b25Jc0FjdGl2ZSkge1xuICAgICAgICAgICAgX3RoaXMucmVzZXQoe1xuICAgICAgICAgICAgICB0eXBlOiBibHVySW5wdXRcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICB9O1xuICAgICAgLy9cXFxcXFxcXFxcXFxcXFxcXFxcXFxcXFxcXFxcXFxcXFxcXFxcXFxcXFxcXFxcXFxcXFxcXFxcXFxcIElOUFVUXG4gICAgICAvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vIE1FTlVcbiAgICAgIF90aGlzLm1lbnVSZWYgPSBmdW5jdGlvbiAobm9kZSkge1xuICAgICAgICBfdGhpcy5fbWVudU5vZGUgPSBub2RlO1xuICAgICAgfTtcbiAgICAgIF90aGlzLmdldE1lbnVQcm9wcyA9IGZ1bmN0aW9uIChfdGVtcDUsIF90ZW1wNikge1xuICAgICAgICB2YXIgX2V4dGVuZHMzO1xuICAgICAgICB2YXIgX3JlZjUgPSBfdGVtcDUgPT09IHZvaWQgMCA/IHt9IDogX3RlbXA1LFxuICAgICAgICAgIF9yZWY1JHJlZktleSA9IF9yZWY1LnJlZktleSxcbiAgICAgICAgICByZWZLZXkgPSBfcmVmNSRyZWZLZXkgPT09IHZvaWQgMCA/ICdyZWYnIDogX3JlZjUkcmVmS2V5LFxuICAgICAgICAgIHJlZiA9IF9yZWY1LnJlZixcbiAgICAgICAgICBwcm9wcyA9IF9vYmplY3RXaXRob3V0UHJvcGVydGllc0xvb3NlKF9yZWY1LCBfZXhjbHVkZWQ0JDIpO1xuICAgICAgICB2YXIgX3JlZjYgPSBfdGVtcDYgPT09IHZvaWQgMCA/IHt9IDogX3RlbXA2LFxuICAgICAgICAgIF9yZWY2JHN1cHByZXNzUmVmRXJybyA9IF9yZWY2LnN1cHByZXNzUmVmRXJyb3IsXG4gICAgICAgICAgc3VwcHJlc3NSZWZFcnJvciA9IF9yZWY2JHN1cHByZXNzUmVmRXJybyA9PT0gdm9pZCAwID8gZmFsc2UgOiBfcmVmNiRzdXBwcmVzc1JlZkVycm87XG4gICAgICAgIF90aGlzLmdldE1lbnVQcm9wcy5jYWxsZWQgPSB0cnVlO1xuICAgICAgICBfdGhpcy5nZXRNZW51UHJvcHMucmVmS2V5ID0gcmVmS2V5O1xuICAgICAgICBfdGhpcy5nZXRNZW51UHJvcHMuc3VwcHJlc3NSZWZFcnJvciA9IHN1cHByZXNzUmVmRXJyb3I7XG4gICAgICAgIHJldHVybiBfZXh0ZW5kcygoX2V4dGVuZHMzID0ge30sIF9leHRlbmRzM1tyZWZLZXldID0gaGFuZGxlUmVmcyhyZWYsIF90aGlzLm1lbnVSZWYpLCBfZXh0ZW5kczMucm9sZSA9ICdsaXN0Ym94JywgX2V4dGVuZHMzWydhcmlhLWxhYmVsbGVkYnknXSA9IHByb3BzICYmIHByb3BzWydhcmlhLWxhYmVsJ10gPyB1bmRlZmluZWQgOiBfdGhpcy5sYWJlbElkLCBfZXh0ZW5kczMuaWQgPSBfdGhpcy5tZW51SWQsIF9leHRlbmRzMyksIHByb3BzKTtcbiAgICAgIH07XG4gICAgICAvL1xcXFxcXFxcXFxcXFxcXFxcXFxcXFxcXFxcXFxcXFxcXFxcXFxcXFxcXFxcXFxcXFxcXFxcXFxcXFwgTUVOVVxuICAgICAgLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLyBJVEVNXG4gICAgICBfdGhpcy5nZXRJdGVtUHJvcHMgPSBmdW5jdGlvbiAoX3RlbXA3KSB7XG4gICAgICAgIHZhciBfZW5hYmxlZEV2ZW50SGFuZGxlcnM7XG4gICAgICAgIHZhciBfcmVmNyA9IF90ZW1wNyA9PT0gdm9pZCAwID8ge30gOiBfdGVtcDcsXG4gICAgICAgICAgb25Nb3VzZU1vdmUgPSBfcmVmNy5vbk1vdXNlTW92ZSxcbiAgICAgICAgICBvbk1vdXNlRG93biA9IF9yZWY3Lm9uTW91c2VEb3duLFxuICAgICAgICAgIG9uQ2xpY2sgPSBfcmVmNy5vbkNsaWNrO1xuICAgICAgICAgIF9yZWY3Lm9uUHJlc3M7XG4gICAgICAgICAgdmFyIGluZGV4ID0gX3JlZjcuaW5kZXgsXG4gICAgICAgICAgX3JlZjckaXRlbSA9IF9yZWY3Lml0ZW0sXG4gICAgICAgICAgaXRlbSA9IF9yZWY3JGl0ZW0gPT09IHZvaWQgMCA/IHByb2Nlc3MuZW52Lk5PREVfRU5WID09PSAncHJvZHVjdGlvbicgPyAvKiBpc3RhbmJ1bCBpZ25vcmUgbmV4dCAqL3VuZGVmaW5lZCA6IHJlcXVpcmVkUHJvcCgnZ2V0SXRlbVByb3BzJywgJ2l0ZW0nKSA6IF9yZWY3JGl0ZW0sXG4gICAgICAgICAgcmVzdCA9IF9vYmplY3RXaXRob3V0UHJvcGVydGllc0xvb3NlKF9yZWY3LCBfZXhjbHVkZWQ1KTtcbiAgICAgICAgaWYgKGluZGV4ID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICBfdGhpcy5pdGVtcy5wdXNoKGl0ZW0pO1xuICAgICAgICAgIGluZGV4ID0gX3RoaXMuaXRlbXMuaW5kZXhPZihpdGVtKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBfdGhpcy5pdGVtc1tpbmRleF0gPSBpdGVtO1xuICAgICAgICB9XG4gICAgICAgIHZhciBvblNlbGVjdEtleSA9ICdvbkNsaWNrJztcbiAgICAgICAgdmFyIGN1c3RvbUNsaWNrSGFuZGxlciA9IG9uQ2xpY2s7XG4gICAgICAgIHZhciBlbmFibGVkRXZlbnRIYW5kbGVycyA9IChfZW5hYmxlZEV2ZW50SGFuZGxlcnMgPSB7XG4gICAgICAgICAgLy8gb25Nb3VzZU1vdmUgaXMgdXNlZCBvdmVyIG9uTW91c2VFbnRlciBoZXJlLiBvbk1vdXNlTW92ZVxuICAgICAgICAgIC8vIGlzIG9ubHkgdHJpZ2dlcmVkIG9uIGFjdHVhbCBtb3VzZSBtb3ZlbWVudCB3aGlsZSBvbk1vdXNlRW50ZXJcbiAgICAgICAgICAvLyBjYW4gZmlyZSBvbiBET00gY2hhbmdlcywgaW50ZXJydXB0aW5nIGtleWJvYXJkIG5hdmlnYXRpb25cbiAgICAgICAgICBvbk1vdXNlTW92ZTogY2FsbEFsbEV2ZW50SGFuZGxlcnMob25Nb3VzZU1vdmUsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIGlmIChpbmRleCA9PT0gX3RoaXMuZ2V0U3RhdGUoKS5oaWdobGlnaHRlZEluZGV4KSB7XG4gICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIF90aGlzLnNldEhpZ2hsaWdodGVkSW5kZXgoaW5kZXgsIHtcbiAgICAgICAgICAgICAgdHlwZTogaXRlbU1vdXNlRW50ZXJcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAvLyBXZSBuZXZlciB3YW50IHRvIG1hbnVhbGx5IHNjcm9sbCB3aGVuIGNoYW5naW5nIHN0YXRlIGJhc2VkXG4gICAgICAgICAgICAvLyBvbiBgb25Nb3VzZU1vdmVgIGJlY2F1c2Ugd2Ugd2lsbCBiZSBtb3ZpbmcgdGhlIGVsZW1lbnQgb3V0XG4gICAgICAgICAgICAvLyBmcm9tIHVuZGVyIHRoZSB1c2VyIHdoaWNoIGlzIGN1cnJlbnRseSBzY3JvbGxpbmcvbW92aW5nIHRoZVxuICAgICAgICAgICAgLy8gY3Vyc29yXG4gICAgICAgICAgICBfdGhpcy5hdm9pZFNjcm9sbGluZyA9IHRydWU7XG4gICAgICAgICAgICBfdGhpcy5pbnRlcm5hbFNldFRpbWVvdXQoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICByZXR1cm4gX3RoaXMuYXZvaWRTY3JvbGxpbmcgPSBmYWxzZTtcbiAgICAgICAgICAgIH0sIDI1MCk7XG4gICAgICAgICAgfSksXG4gICAgICAgICAgb25Nb3VzZURvd246IGNhbGxBbGxFdmVudEhhbmRsZXJzKG9uTW91c2VEb3duLCBmdW5jdGlvbiAoZXZlbnQpIHtcbiAgICAgICAgICAgIC8vIFRoaXMgcHJldmVudHMgdGhlIGFjdGl2ZUVsZW1lbnQgZnJvbSBiZWluZyBjaGFuZ2VkXG4gICAgICAgICAgICAvLyB0byB0aGUgaXRlbSBzbyBpdCBjYW4gcmVtYWluIHdpdGggdGhlIGN1cnJlbnQgYWN0aXZlRWxlbWVudFxuICAgICAgICAgICAgLy8gd2hpY2ggaXMgYSBtb3JlIGNvbW1vbiB1c2UgY2FzZS5cbiAgICAgICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgfSlcbiAgICAgICAgfSwgX2VuYWJsZWRFdmVudEhhbmRsZXJzW29uU2VsZWN0S2V5XSA9IGNhbGxBbGxFdmVudEhhbmRsZXJzKGN1c3RvbUNsaWNrSGFuZGxlciwgZnVuY3Rpb24gKCkge1xuICAgICAgICAgIF90aGlzLnNlbGVjdEl0ZW1BdEluZGV4KGluZGV4LCB7XG4gICAgICAgICAgICB0eXBlOiBjbGlja0l0ZW1cbiAgICAgICAgICB9KTtcbiAgICAgICAgfSksIF9lbmFibGVkRXZlbnRIYW5kbGVycyk7XG5cbiAgICAgICAgLy8gUGFzc2luZyBkb3duIHRoZSBvbk1vdXNlRG93biBoYW5kbGVyIHRvIHByZXZlbnQgcmVkaXJlY3RcbiAgICAgICAgLy8gb2YgdGhlIGFjdGl2ZUVsZW1lbnQgaWYgY2xpY2tpbmcgb24gZGlzYWJsZWQgaXRlbXNcbiAgICAgICAgdmFyIGV2ZW50SGFuZGxlcnMgPSByZXN0LmRpc2FibGVkID8ge1xuICAgICAgICAgIG9uTW91c2VEb3duOiBlbmFibGVkRXZlbnRIYW5kbGVycy5vbk1vdXNlRG93blxuICAgICAgICB9IDogZW5hYmxlZEV2ZW50SGFuZGxlcnM7XG4gICAgICAgIHJldHVybiBfZXh0ZW5kcyh7XG4gICAgICAgICAgaWQ6IF90aGlzLmdldEl0ZW1JZChpbmRleCksXG4gICAgICAgICAgcm9sZTogJ29wdGlvbicsXG4gICAgICAgICAgJ2FyaWEtc2VsZWN0ZWQnOiBfdGhpcy5nZXRTdGF0ZSgpLmhpZ2hsaWdodGVkSW5kZXggPT09IGluZGV4XG4gICAgICAgIH0sIGV2ZW50SGFuZGxlcnMsIHJlc3QpO1xuICAgICAgfTtcbiAgICAgIC8vXFxcXFxcXFxcXFxcXFxcXFxcXFxcXFxcXFxcXFxcXFxcXFxcXFxcXFxcXFxcXFxcXFxcXFxcXFxcXCBJVEVNXG4gICAgICBfdGhpcy5jbGVhckl0ZW1zID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBfdGhpcy5pdGVtcyA9IFtdO1xuICAgICAgfTtcbiAgICAgIF90aGlzLnJlc2V0ID0gZnVuY3Rpb24gKG90aGVyU3RhdGVUb1NldCwgY2IpIHtcbiAgICAgICAgaWYgKG90aGVyU3RhdGVUb1NldCA9PT0gdm9pZCAwKSB7XG4gICAgICAgICAgb3RoZXJTdGF0ZVRvU2V0ID0ge307XG4gICAgICAgIH1cbiAgICAgICAgb3RoZXJTdGF0ZVRvU2V0ID0gcGlja1N0YXRlKG90aGVyU3RhdGVUb1NldCk7XG4gICAgICAgIF90aGlzLmludGVybmFsU2V0U3RhdGUoZnVuY3Rpb24gKF9yZWY4KSB7XG4gICAgICAgICAgdmFyIHNlbGVjdGVkSXRlbSA9IF9yZWY4LnNlbGVjdGVkSXRlbTtcbiAgICAgICAgICByZXR1cm4gX2V4dGVuZHMoe1xuICAgICAgICAgICAgaXNPcGVuOiBfdGhpcy5wcm9wcy5kZWZhdWx0SXNPcGVuLFxuICAgICAgICAgICAgaGlnaGxpZ2h0ZWRJbmRleDogX3RoaXMucHJvcHMuZGVmYXVsdEhpZ2hsaWdodGVkSW5kZXgsXG4gICAgICAgICAgICBpbnB1dFZhbHVlOiBfdGhpcy5wcm9wcy5pdGVtVG9TdHJpbmcoc2VsZWN0ZWRJdGVtKVxuICAgICAgICAgIH0sIG90aGVyU3RhdGVUb1NldCk7XG4gICAgICAgIH0sIGNiKTtcbiAgICAgIH07XG4gICAgICBfdGhpcy50b2dnbGVNZW51ID0gZnVuY3Rpb24gKG90aGVyU3RhdGVUb1NldCwgY2IpIHtcbiAgICAgICAgaWYgKG90aGVyU3RhdGVUb1NldCA9PT0gdm9pZCAwKSB7XG4gICAgICAgICAgb3RoZXJTdGF0ZVRvU2V0ID0ge307XG4gICAgICAgIH1cbiAgICAgICAgb3RoZXJTdGF0ZVRvU2V0ID0gcGlja1N0YXRlKG90aGVyU3RhdGVUb1NldCk7XG4gICAgICAgIF90aGlzLmludGVybmFsU2V0U3RhdGUoZnVuY3Rpb24gKF9yZWY5KSB7XG4gICAgICAgICAgdmFyIGlzT3BlbiA9IF9yZWY5LmlzT3BlbjtcbiAgICAgICAgICByZXR1cm4gX2V4dGVuZHMoe1xuICAgICAgICAgICAgaXNPcGVuOiAhaXNPcGVuXG4gICAgICAgICAgfSwgaXNPcGVuICYmIHtcbiAgICAgICAgICAgIGhpZ2hsaWdodGVkSW5kZXg6IF90aGlzLnByb3BzLmRlZmF1bHRIaWdobGlnaHRlZEluZGV4XG4gICAgICAgICAgfSwgb3RoZXJTdGF0ZVRvU2V0KTtcbiAgICAgICAgfSwgZnVuY3Rpb24gKCkge1xuICAgICAgICAgIHZhciBfdGhpcyRnZXRTdGF0ZTcgPSBfdGhpcy5nZXRTdGF0ZSgpLFxuICAgICAgICAgICAgaXNPcGVuID0gX3RoaXMkZ2V0U3RhdGU3LmlzT3BlbixcbiAgICAgICAgICAgIGhpZ2hsaWdodGVkSW5kZXggPSBfdGhpcyRnZXRTdGF0ZTcuaGlnaGxpZ2h0ZWRJbmRleDtcbiAgICAgICAgICBpZiAoaXNPcGVuKSB7XG4gICAgICAgICAgICBpZiAoX3RoaXMuZ2V0SXRlbUNvdW50KCkgPiAwICYmIHR5cGVvZiBoaWdobGlnaHRlZEluZGV4ID09PSAnbnVtYmVyJykge1xuICAgICAgICAgICAgICBfdGhpcy5zZXRIaWdobGlnaHRlZEluZGV4KGhpZ2hsaWdodGVkSW5kZXgsIG90aGVyU3RhdGVUb1NldCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICAgIGNiVG9DYihjYikoKTtcbiAgICAgICAgfSk7XG4gICAgICB9O1xuICAgICAgX3RoaXMub3Blbk1lbnUgPSBmdW5jdGlvbiAoY2IpIHtcbiAgICAgICAgX3RoaXMuaW50ZXJuYWxTZXRTdGF0ZSh7XG4gICAgICAgICAgaXNPcGVuOiB0cnVlXG4gICAgICAgIH0sIGNiKTtcbiAgICAgIH07XG4gICAgICBfdGhpcy5jbG9zZU1lbnUgPSBmdW5jdGlvbiAoY2IpIHtcbiAgICAgICAgX3RoaXMuaW50ZXJuYWxTZXRTdGF0ZSh7XG4gICAgICAgICAgaXNPcGVuOiBmYWxzZVxuICAgICAgICB9LCBjYik7XG4gICAgICB9O1xuICAgICAgX3RoaXMudXBkYXRlU3RhdHVzID0gZGVib3VuY2UoZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgX3RoaXMkcHJvcHM7XG4gICAgICAgIGlmICghKChfdGhpcyRwcm9wcyA9IF90aGlzLnByb3BzKSAhPSBudWxsICYmIChfdGhpcyRwcm9wcyA9IF90aGlzJHByb3BzLmVudmlyb25tZW50KSAhPSBudWxsICYmIF90aGlzJHByb3BzLmRvY3VtZW50KSkge1xuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICB2YXIgc3RhdGUgPSBfdGhpcy5nZXRTdGF0ZSgpO1xuICAgICAgICB2YXIgaXRlbSA9IF90aGlzLml0ZW1zW3N0YXRlLmhpZ2hsaWdodGVkSW5kZXhdO1xuICAgICAgICB2YXIgcmVzdWx0Q291bnQgPSBfdGhpcy5nZXRJdGVtQ291bnQoKTtcbiAgICAgICAgdmFyIHN0YXR1cyA9IF90aGlzLnByb3BzLmdldEExMXlTdGF0dXNNZXNzYWdlKF9leHRlbmRzKHtcbiAgICAgICAgICBpdGVtVG9TdHJpbmc6IF90aGlzLnByb3BzLml0ZW1Ub1N0cmluZyxcbiAgICAgICAgICBwcmV2aW91c1Jlc3VsdENvdW50OiBfdGhpcy5wcmV2aW91c1Jlc3VsdENvdW50LFxuICAgICAgICAgIHJlc3VsdENvdW50OiByZXN1bHRDb3VudCxcbiAgICAgICAgICBoaWdobGlnaHRlZEl0ZW06IGl0ZW1cbiAgICAgICAgfSwgc3RhdGUpKTtcbiAgICAgICAgX3RoaXMucHJldmlvdXNSZXN1bHRDb3VudCA9IHJlc3VsdENvdW50O1xuICAgICAgICBzZXRTdGF0dXMoc3RhdHVzLCBfdGhpcy5wcm9wcy5lbnZpcm9ubWVudC5kb2N1bWVudCk7XG4gICAgICB9LCAyMDApO1xuICAgICAgdmFyIF90aGlzJHByb3BzMiA9IF90aGlzLnByb3BzLFxuICAgICAgICBkZWZhdWx0SGlnaGxpZ2h0ZWRJbmRleCA9IF90aGlzJHByb3BzMi5kZWZhdWx0SGlnaGxpZ2h0ZWRJbmRleCxcbiAgICAgICAgX3RoaXMkcHJvcHMyJGluaXRpYWxIID0gX3RoaXMkcHJvcHMyLmluaXRpYWxIaWdobGlnaHRlZEluZGV4LFxuICAgICAgICBfaGlnaGxpZ2h0ZWRJbmRleCA9IF90aGlzJHByb3BzMiRpbml0aWFsSCA9PT0gdm9pZCAwID8gZGVmYXVsdEhpZ2hsaWdodGVkSW5kZXggOiBfdGhpcyRwcm9wczIkaW5pdGlhbEgsXG4gICAgICAgIGRlZmF1bHRJc09wZW4gPSBfdGhpcyRwcm9wczIuZGVmYXVsdElzT3BlbixcbiAgICAgICAgX3RoaXMkcHJvcHMyJGluaXRpYWxJID0gX3RoaXMkcHJvcHMyLmluaXRpYWxJc09wZW4sXG4gICAgICAgIF9pc09wZW4gPSBfdGhpcyRwcm9wczIkaW5pdGlhbEkgPT09IHZvaWQgMCA/IGRlZmF1bHRJc09wZW4gOiBfdGhpcyRwcm9wczIkaW5pdGlhbEksXG4gICAgICAgIF90aGlzJHByb3BzMiRpbml0aWFsSTIgPSBfdGhpcyRwcm9wczIuaW5pdGlhbElucHV0VmFsdWUsXG4gICAgICAgIF9pbnB1dFZhbHVlID0gX3RoaXMkcHJvcHMyJGluaXRpYWxJMiA9PT0gdm9pZCAwID8gJycgOiBfdGhpcyRwcm9wczIkaW5pdGlhbEkyLFxuICAgICAgICBfdGhpcyRwcm9wczIkaW5pdGlhbFMgPSBfdGhpcyRwcm9wczIuaW5pdGlhbFNlbGVjdGVkSXRlbSxcbiAgICAgICAgX3NlbGVjdGVkSXRlbSA9IF90aGlzJHByb3BzMiRpbml0aWFsUyA9PT0gdm9pZCAwID8gbnVsbCA6IF90aGlzJHByb3BzMiRpbml0aWFsUztcbiAgICAgIHZhciBfc3RhdGUgPSBfdGhpcy5nZXRTdGF0ZSh7XG4gICAgICAgIGhpZ2hsaWdodGVkSW5kZXg6IF9oaWdobGlnaHRlZEluZGV4LFxuICAgICAgICBpc09wZW46IF9pc09wZW4sXG4gICAgICAgIGlucHV0VmFsdWU6IF9pbnB1dFZhbHVlLFxuICAgICAgICBzZWxlY3RlZEl0ZW06IF9zZWxlY3RlZEl0ZW1cbiAgICAgIH0pO1xuICAgICAgaWYgKF9zdGF0ZS5zZWxlY3RlZEl0ZW0gIT0gbnVsbCAmJiBfdGhpcy5wcm9wcy5pbml0aWFsSW5wdXRWYWx1ZSA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgIF9zdGF0ZS5pbnB1dFZhbHVlID0gX3RoaXMucHJvcHMuaXRlbVRvU3RyaW5nKF9zdGF0ZS5zZWxlY3RlZEl0ZW0pO1xuICAgICAgfVxuICAgICAgX3RoaXMuc3RhdGUgPSBfc3RhdGU7XG4gICAgICByZXR1cm4gX3RoaXM7XG4gICAgfVxuICAgIF9pbmhlcml0c0xvb3NlKERvd25zaGlmdCwgX0NvbXBvbmVudCk7XG4gICAgdmFyIF9wcm90byA9IERvd25zaGlmdC5wcm90b3R5cGU7XG4gICAgLyoqXG4gICAgICogQ2xlYXIgYWxsIHJ1bm5pbmcgdGltZW91dHNcbiAgICAgKi9cbiAgICBfcHJvdG8uaW50ZXJuYWxDbGVhclRpbWVvdXRzID0gZnVuY3Rpb24gaW50ZXJuYWxDbGVhclRpbWVvdXRzKCkge1xuICAgICAgdGhpcy50aW1lb3V0SWRzLmZvckVhY2goZnVuY3Rpb24gKGlkKSB7XG4gICAgICAgIGNsZWFyVGltZW91dChpZCk7XG4gICAgICB9KTtcbiAgICAgIHRoaXMudGltZW91dElkcyA9IFtdO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEdldHMgdGhlIHN0YXRlIGJhc2VkIG9uIGludGVybmFsIHN0YXRlIG9yIHByb3BzXG4gICAgICogSWYgYSBzdGF0ZSB2YWx1ZSBpcyBwYXNzZWQgdmlhIHByb3BzLCB0aGVuIHRoYXRcbiAgICAgKiBpcyB0aGUgdmFsdWUgZ2l2ZW4sIG90aGVyd2lzZSBpdCdzIHJldHJpZXZlZCBmcm9tXG4gICAgICogc3RhdGVUb01lcmdlXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge09iamVjdH0gc3RhdGVUb01lcmdlIGRlZmF1bHRzIHRvIHRoaXMuc3RhdGVcbiAgICAgKiBAcmV0dXJuIHtPYmplY3R9IHRoZSBzdGF0ZVxuICAgICAqLztcbiAgICBfcHJvdG8uZ2V0U3RhdGUgPSBmdW5jdGlvbiBnZXRTdGF0ZSQxKHN0YXRlVG9NZXJnZSkge1xuICAgICAgaWYgKHN0YXRlVG9NZXJnZSA9PT0gdm9pZCAwKSB7XG4gICAgICAgIHN0YXRlVG9NZXJnZSA9IHRoaXMuc3RhdGU7XG4gICAgICB9XG4gICAgICByZXR1cm4gZ2V0U3RhdGUoc3RhdGVUb01lcmdlLCB0aGlzLnByb3BzKTtcbiAgICB9O1xuICAgIF9wcm90by5nZXRJdGVtQ291bnQgPSBmdW5jdGlvbiBnZXRJdGVtQ291bnQoKSB7XG4gICAgICAvLyB0aGluZ3MgcmVhZCBiZXR0ZXIgdGhpcyB3YXkuIFRoZXkncmUgaW4gcHJpb3JpdHkgb3JkZXI6XG4gICAgICAvLyAxLiBgdGhpcy5pdGVtQ291bnRgXG4gICAgICAvLyAyLiBgdGhpcy5wcm9wcy5pdGVtQ291bnRgXG4gICAgICAvLyAzLiBgdGhpcy5pdGVtcy5sZW5ndGhgXG4gICAgICB2YXIgaXRlbUNvdW50ID0gdGhpcy5pdGVtcy5sZW5ndGg7XG4gICAgICBpZiAodGhpcy5pdGVtQ291bnQgIT0gbnVsbCkge1xuICAgICAgICBpdGVtQ291bnQgPSB0aGlzLml0ZW1Db3VudDtcbiAgICAgIH0gZWxzZSBpZiAodGhpcy5wcm9wcy5pdGVtQ291bnQgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICBpdGVtQ291bnQgPSB0aGlzLnByb3BzLml0ZW1Db3VudDtcbiAgICAgIH1cbiAgICAgIHJldHVybiBpdGVtQ291bnQ7XG4gICAgfTtcbiAgICBfcHJvdG8uZ2V0SXRlbU5vZGVGcm9tSW5kZXggPSBmdW5jdGlvbiBnZXRJdGVtTm9kZUZyb21JbmRleChpbmRleCkge1xuICAgICAgcmV0dXJuIHRoaXMucHJvcHMuZW52aXJvbm1lbnQgPyB0aGlzLnByb3BzLmVudmlyb25tZW50LmRvY3VtZW50LmdldEVsZW1lbnRCeUlkKHRoaXMuZ2V0SXRlbUlkKGluZGV4KSkgOiBudWxsO1xuICAgIH07XG4gICAgX3Byb3RvLnNjcm9sbEhpZ2hsaWdodGVkSXRlbUludG9WaWV3ID0gZnVuY3Rpb24gc2Nyb2xsSGlnaGxpZ2h0ZWRJdGVtSW50b1ZpZXcoKSB7XG4gICAgICAvKiBpc3RhbmJ1bCBpZ25vcmUgZWxzZSAocmVhY3QtbmF0aXZlKSAqL1xuICAgICAge1xuICAgICAgICB2YXIgbm9kZSA9IHRoaXMuZ2V0SXRlbU5vZGVGcm9tSW5kZXgodGhpcy5nZXRTdGF0ZSgpLmhpZ2hsaWdodGVkSW5kZXgpO1xuICAgICAgICB0aGlzLnByb3BzLnNjcm9sbEludG9WaWV3KG5vZGUsIHRoaXMuX21lbnVOb2RlKTtcbiAgICAgIH1cbiAgICB9O1xuICAgIF9wcm90by5tb3ZlSGlnaGxpZ2h0ZWRJbmRleCA9IGZ1bmN0aW9uIG1vdmVIaWdobGlnaHRlZEluZGV4KGFtb3VudCwgb3RoZXJTdGF0ZVRvU2V0KSB7XG4gICAgICB2YXIgaXRlbUNvdW50ID0gdGhpcy5nZXRJdGVtQ291bnQoKTtcbiAgICAgIHZhciBfdGhpcyRnZXRTdGF0ZTggPSB0aGlzLmdldFN0YXRlKCksXG4gICAgICAgIGhpZ2hsaWdodGVkSW5kZXggPSBfdGhpcyRnZXRTdGF0ZTguaGlnaGxpZ2h0ZWRJbmRleDtcbiAgICAgIGlmIChpdGVtQ291bnQgPiAwKSB7XG4gICAgICAgIHZhciBuZXh0SGlnaGxpZ2h0ZWRJbmRleCA9IGdldEhpZ2hsaWdodGVkSW5kZXgoaGlnaGxpZ2h0ZWRJbmRleCwgYW1vdW50LCB7XG4gICAgICAgICAgbGVuZ3RoOiBpdGVtQ291bnRcbiAgICAgICAgfSwgdGhpcy5pc0l0ZW1EaXNhYmxlZCwgdHJ1ZSk7XG4gICAgICAgIHRoaXMuc2V0SGlnaGxpZ2h0ZWRJbmRleChuZXh0SGlnaGxpZ2h0ZWRJbmRleCwgb3RoZXJTdGF0ZVRvU2V0KTtcbiAgICAgIH1cbiAgICB9O1xuICAgIF9wcm90by5nZXRTdGF0ZUFuZEhlbHBlcnMgPSBmdW5jdGlvbiBnZXRTdGF0ZUFuZEhlbHBlcnMoKSB7XG4gICAgICB2YXIgX3RoaXMkZ2V0U3RhdGU5ID0gdGhpcy5nZXRTdGF0ZSgpLFxuICAgICAgICBoaWdobGlnaHRlZEluZGV4ID0gX3RoaXMkZ2V0U3RhdGU5LmhpZ2hsaWdodGVkSW5kZXgsXG4gICAgICAgIGlucHV0VmFsdWUgPSBfdGhpcyRnZXRTdGF0ZTkuaW5wdXRWYWx1ZSxcbiAgICAgICAgc2VsZWN0ZWRJdGVtID0gX3RoaXMkZ2V0U3RhdGU5LnNlbGVjdGVkSXRlbSxcbiAgICAgICAgaXNPcGVuID0gX3RoaXMkZ2V0U3RhdGU5LmlzT3BlbjtcbiAgICAgIHZhciBpdGVtVG9TdHJpbmcgPSB0aGlzLnByb3BzLml0ZW1Ub1N0cmluZztcbiAgICAgIHZhciBpZCA9IHRoaXMuaWQ7XG4gICAgICB2YXIgZ2V0Um9vdFByb3BzID0gdGhpcy5nZXRSb290UHJvcHMsXG4gICAgICAgIGdldFRvZ2dsZUJ1dHRvblByb3BzID0gdGhpcy5nZXRUb2dnbGVCdXR0b25Qcm9wcyxcbiAgICAgICAgZ2V0TGFiZWxQcm9wcyA9IHRoaXMuZ2V0TGFiZWxQcm9wcyxcbiAgICAgICAgZ2V0TWVudVByb3BzID0gdGhpcy5nZXRNZW51UHJvcHMsXG4gICAgICAgIGdldElucHV0UHJvcHMgPSB0aGlzLmdldElucHV0UHJvcHMsXG4gICAgICAgIGdldEl0ZW1Qcm9wcyA9IHRoaXMuZ2V0SXRlbVByb3BzLFxuICAgICAgICBvcGVuTWVudSA9IHRoaXMub3Blbk1lbnUsXG4gICAgICAgIGNsb3NlTWVudSA9IHRoaXMuY2xvc2VNZW51LFxuICAgICAgICB0b2dnbGVNZW51ID0gdGhpcy50b2dnbGVNZW51LFxuICAgICAgICBzZWxlY3RJdGVtID0gdGhpcy5zZWxlY3RJdGVtLFxuICAgICAgICBzZWxlY3RJdGVtQXRJbmRleCA9IHRoaXMuc2VsZWN0SXRlbUF0SW5kZXgsXG4gICAgICAgIHNlbGVjdEhpZ2hsaWdodGVkSXRlbSA9IHRoaXMuc2VsZWN0SGlnaGxpZ2h0ZWRJdGVtLFxuICAgICAgICBzZXRIaWdobGlnaHRlZEluZGV4ID0gdGhpcy5zZXRIaWdobGlnaHRlZEluZGV4LFxuICAgICAgICBjbGVhclNlbGVjdGlvbiA9IHRoaXMuY2xlYXJTZWxlY3Rpb24sXG4gICAgICAgIGNsZWFySXRlbXMgPSB0aGlzLmNsZWFySXRlbXMsXG4gICAgICAgIHJlc2V0ID0gdGhpcy5yZXNldCxcbiAgICAgICAgc2V0SXRlbUNvdW50ID0gdGhpcy5zZXRJdGVtQ291bnQsXG4gICAgICAgIHVuc2V0SXRlbUNvdW50ID0gdGhpcy51bnNldEl0ZW1Db3VudCxcbiAgICAgICAgc2V0U3RhdGUgPSB0aGlzLmludGVybmFsU2V0U3RhdGU7XG4gICAgICByZXR1cm4ge1xuICAgICAgICAvLyBwcm9wIGdldHRlcnNcbiAgICAgICAgZ2V0Um9vdFByb3BzOiBnZXRSb290UHJvcHMsXG4gICAgICAgIGdldFRvZ2dsZUJ1dHRvblByb3BzOiBnZXRUb2dnbGVCdXR0b25Qcm9wcyxcbiAgICAgICAgZ2V0TGFiZWxQcm9wczogZ2V0TGFiZWxQcm9wcyxcbiAgICAgICAgZ2V0TWVudVByb3BzOiBnZXRNZW51UHJvcHMsXG4gICAgICAgIGdldElucHV0UHJvcHM6IGdldElucHV0UHJvcHMsXG4gICAgICAgIGdldEl0ZW1Qcm9wczogZ2V0SXRlbVByb3BzLFxuICAgICAgICAvLyBhY3Rpb25zXG4gICAgICAgIHJlc2V0OiByZXNldCxcbiAgICAgICAgb3Blbk1lbnU6IG9wZW5NZW51LFxuICAgICAgICBjbG9zZU1lbnU6IGNsb3NlTWVudSxcbiAgICAgICAgdG9nZ2xlTWVudTogdG9nZ2xlTWVudSxcbiAgICAgICAgc2VsZWN0SXRlbTogc2VsZWN0SXRlbSxcbiAgICAgICAgc2VsZWN0SXRlbUF0SW5kZXg6IHNlbGVjdEl0ZW1BdEluZGV4LFxuICAgICAgICBzZWxlY3RIaWdobGlnaHRlZEl0ZW06IHNlbGVjdEhpZ2hsaWdodGVkSXRlbSxcbiAgICAgICAgc2V0SGlnaGxpZ2h0ZWRJbmRleDogc2V0SGlnaGxpZ2h0ZWRJbmRleCxcbiAgICAgICAgY2xlYXJTZWxlY3Rpb246IGNsZWFyU2VsZWN0aW9uLFxuICAgICAgICBjbGVhckl0ZW1zOiBjbGVhckl0ZW1zLFxuICAgICAgICBzZXRJdGVtQ291bnQ6IHNldEl0ZW1Db3VudCxcbiAgICAgICAgdW5zZXRJdGVtQ291bnQ6IHVuc2V0SXRlbUNvdW50LFxuICAgICAgICBzZXRTdGF0ZTogc2V0U3RhdGUsXG4gICAgICAgIC8vIHByb3BzXG4gICAgICAgIGl0ZW1Ub1N0cmluZzogaXRlbVRvU3RyaW5nLFxuICAgICAgICAvLyBkZXJpdmVkXG4gICAgICAgIGlkOiBpZCxcbiAgICAgICAgLy8gc3RhdGVcbiAgICAgICAgaGlnaGxpZ2h0ZWRJbmRleDogaGlnaGxpZ2h0ZWRJbmRleCxcbiAgICAgICAgaW5wdXRWYWx1ZTogaW5wdXRWYWx1ZSxcbiAgICAgICAgaXNPcGVuOiBpc09wZW4sXG4gICAgICAgIHNlbGVjdGVkSXRlbTogc2VsZWN0ZWRJdGVtXG4gICAgICB9O1xuICAgIH07XG4gICAgX3Byb3RvLmNvbXBvbmVudERpZE1vdW50ID0gZnVuY3Rpb24gY29tcG9uZW50RGlkTW91bnQoKSB7XG4gICAgICB2YXIgX3RoaXM0ID0gdGhpcztcbiAgICAgIC8qIGlzdGFuYnVsIGlnbm9yZSBpZiAocmVhY3QtbmF0aXZlKSAqL1xuICAgICAgaWYgKHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSAncHJvZHVjdGlvbicgJiYgIWZhbHNlICYmIHRoaXMuZ2V0TWVudVByb3BzLmNhbGxlZCAmJiAhdGhpcy5nZXRNZW51UHJvcHMuc3VwcHJlc3NSZWZFcnJvcikge1xuICAgICAgICB2YWxpZGF0ZUdldE1lbnVQcm9wc0NhbGxlZENvcnJlY3RseSh0aGlzLl9tZW51Tm9kZSwgdGhpcy5nZXRNZW51UHJvcHMpO1xuICAgICAgfVxuXG4gICAgICAvKiBpc3RhbmJ1bCBpZ25vcmUgaWYgKHJlYWN0LW5hdGl2ZSBvciBTU1IpICovXG4gICAgICBpZiAoIXRoaXMucHJvcHMuZW52aXJvbm1lbnQpIHtcbiAgICAgICAgdGhpcy5jbGVhbnVwID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgIF90aGlzNC5pbnRlcm5hbENsZWFyVGltZW91dHMoKTtcbiAgICAgICAgfTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIC8vIHRoaXMuaXNNb3VzZURvd24gaGVscHMgdXMgdHJhY2sgd2hldGhlciB0aGUgbW91c2UgaXMgY3VycmVudGx5IGhlbGQgZG93bi5cbiAgICAgICAgLy8gVGhpcyBpcyB1c2VmdWwgd2hlbiB0aGUgdXNlciBjbGlja3Mgb24gYW4gaXRlbSBpbiB0aGUgbGlzdCwgYnV0IGhvbGRzIHRoZSBtb3VzZVxuICAgICAgICAvLyBkb3duIGxvbmcgZW5vdWdoIGZvciB0aGUgbGlzdCB0byBkaXNhcHBlYXIgKGJlY2F1c2UgdGhlIGJsdXIgZXZlbnQgZmlyZXMgb24gdGhlIGlucHV0KVxuICAgICAgICAvLyB0aGlzLmlzTW91c2VEb3duIGlzIHVzZWQgaW4gdGhlIGJsdXIgaGFuZGxlciBvbiB0aGUgaW5wdXQgdG8gZGV0ZXJtaW5lIHdoZXRoZXIgdGhlIGJsdXIgZXZlbnQgc2hvdWxkXG4gICAgICAgIC8vIHRyaWdnZXIgaGlkaW5nIHRoZSBtZW51LlxuICAgICAgICB2YXIgb25Nb3VzZURvd24gPSBmdW5jdGlvbiBvbk1vdXNlRG93bigpIHtcbiAgICAgICAgICBfdGhpczQuaXNNb3VzZURvd24gPSB0cnVlO1xuICAgICAgICB9O1xuICAgICAgICB2YXIgb25Nb3VzZVVwID0gZnVuY3Rpb24gb25Nb3VzZVVwKGV2ZW50KSB7XG4gICAgICAgICAgX3RoaXM0LmlzTW91c2VEb3duID0gZmFsc2U7XG4gICAgICAgICAgLy8gaWYgdGhlIHRhcmdldCBlbGVtZW50IG9yIHRoZSBhY3RpdmVFbGVtZW50IGlzIHdpdGhpbiBhIGRvd25zaGlmdCBub2RlXG4gICAgICAgICAgLy8gdGhlbiB3ZSBkb24ndCB3YW50IHRvIHJlc2V0IGRvd25zaGlmdFxuICAgICAgICAgIHZhciBjb250ZXh0V2l0aGluRG93bnNoaWZ0ID0gdGFyZ2V0V2l0aGluRG93bnNoaWZ0KGV2ZW50LnRhcmdldCwgW190aGlzNC5fcm9vdE5vZGUsIF90aGlzNC5fbWVudU5vZGVdLCBfdGhpczQucHJvcHMuZW52aXJvbm1lbnQpO1xuICAgICAgICAgIGlmICghY29udGV4dFdpdGhpbkRvd25zaGlmdCAmJiBfdGhpczQuZ2V0U3RhdGUoKS5pc09wZW4pIHtcbiAgICAgICAgICAgIF90aGlzNC5yZXNldCh7XG4gICAgICAgICAgICAgIHR5cGU6IG1vdXNlVXBcbiAgICAgICAgICAgIH0sIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgcmV0dXJuIF90aGlzNC5wcm9wcy5vbk91dGVyQ2xpY2soX3RoaXM0LmdldFN0YXRlQW5kSGVscGVycygpKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgICAgLy8gVG91Y2hpbmcgYW4gZWxlbWVudCBpbiBpT1MgZ2l2ZXMgZm9jdXMgYW5kIGhvdmVyIHN0YXRlcywgYnV0IHRvdWNoaW5nIG91dCBvZlxuICAgICAgICAvLyB0aGUgZWxlbWVudCB3aWxsIHJlbW92ZSBob3ZlciwgYW5kIHBlcnNpc3QgdGhlIGZvY3VzIHN0YXRlLCByZXN1bHRpbmcgaW4gdGhlXG4gICAgICAgIC8vIGJsdXIgZXZlbnQgbm90IGJlaW5nIHRyaWdnZXJlZC5cbiAgICAgICAgLy8gdGhpcy5pc1RvdWNoTW92ZSBoZWxwcyB1cyB0cmFjayB3aGV0aGVyIHRoZSB1c2VyIGlzIHRhcHBpbmcgb3Igc3dpcGluZyBvbiBhIHRvdWNoIHNjcmVlbi5cbiAgICAgICAgLy8gSWYgdGhlIHVzZXIgdGFwcyBvdXRzaWRlIG9mIERvd25zaGlmdCwgdGhlIGNvbXBvbmVudCBzaG91bGQgYmUgcmVzZXQsXG4gICAgICAgIC8vIGJ1dCBub3QgaWYgdGhlIHVzZXIgaXMgc3dpcGluZ1xuICAgICAgICB2YXIgb25Ub3VjaFN0YXJ0ID0gZnVuY3Rpb24gb25Ub3VjaFN0YXJ0KCkge1xuICAgICAgICAgIF90aGlzNC5pc1RvdWNoTW92ZSA9IGZhbHNlO1xuICAgICAgICB9O1xuICAgICAgICB2YXIgb25Ub3VjaE1vdmUgPSBmdW5jdGlvbiBvblRvdWNoTW92ZSgpIHtcbiAgICAgICAgICBfdGhpczQuaXNUb3VjaE1vdmUgPSB0cnVlO1xuICAgICAgICB9O1xuICAgICAgICB2YXIgb25Ub3VjaEVuZCA9IGZ1bmN0aW9uIG9uVG91Y2hFbmQoZXZlbnQpIHtcbiAgICAgICAgICB2YXIgY29udGV4dFdpdGhpbkRvd25zaGlmdCA9IHRhcmdldFdpdGhpbkRvd25zaGlmdChldmVudC50YXJnZXQsIFtfdGhpczQuX3Jvb3ROb2RlLCBfdGhpczQuX21lbnVOb2RlXSwgX3RoaXM0LnByb3BzLmVudmlyb25tZW50LCBmYWxzZSk7XG4gICAgICAgICAgaWYgKCFfdGhpczQuaXNUb3VjaE1vdmUgJiYgIWNvbnRleHRXaXRoaW5Eb3duc2hpZnQgJiYgX3RoaXM0LmdldFN0YXRlKCkuaXNPcGVuKSB7XG4gICAgICAgICAgICBfdGhpczQucmVzZXQoe1xuICAgICAgICAgICAgICB0eXBlOiB0b3VjaEVuZFxuICAgICAgICAgICAgfSwgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICByZXR1cm4gX3RoaXM0LnByb3BzLm9uT3V0ZXJDbGljayhfdGhpczQuZ2V0U3RhdGVBbmRIZWxwZXJzKCkpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgICB2YXIgZW52aXJvbm1lbnQgPSB0aGlzLnByb3BzLmVudmlyb25tZW50O1xuICAgICAgICBlbnZpcm9ubWVudC5hZGRFdmVudExpc3RlbmVyKCdtb3VzZWRvd24nLCBvbk1vdXNlRG93bik7XG4gICAgICAgIGVudmlyb25tZW50LmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNldXAnLCBvbk1vdXNlVXApO1xuICAgICAgICBlbnZpcm9ubWVudC5hZGRFdmVudExpc3RlbmVyKCd0b3VjaHN0YXJ0Jywgb25Ub3VjaFN0YXJ0KTtcbiAgICAgICAgZW52aXJvbm1lbnQuYWRkRXZlbnRMaXN0ZW5lcigndG91Y2htb3ZlJywgb25Ub3VjaE1vdmUpO1xuICAgICAgICBlbnZpcm9ubWVudC5hZGRFdmVudExpc3RlbmVyKCd0b3VjaGVuZCcsIG9uVG91Y2hFbmQpO1xuICAgICAgICB0aGlzLmNsZWFudXAgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgX3RoaXM0LmludGVybmFsQ2xlYXJUaW1lb3V0cygpO1xuICAgICAgICAgIF90aGlzNC51cGRhdGVTdGF0dXMuY2FuY2VsKCk7XG4gICAgICAgICAgZW52aXJvbm1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcignbW91c2Vkb3duJywgb25Nb3VzZURvd24pO1xuICAgICAgICAgIGVudmlyb25tZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ21vdXNldXAnLCBvbk1vdXNlVXApO1xuICAgICAgICAgIGVudmlyb25tZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ3RvdWNoc3RhcnQnLCBvblRvdWNoU3RhcnQpO1xuICAgICAgICAgIGVudmlyb25tZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ3RvdWNobW92ZScsIG9uVG91Y2hNb3ZlKTtcbiAgICAgICAgICBlbnZpcm9ubWVudC5yZW1vdmVFdmVudExpc3RlbmVyKCd0b3VjaGVuZCcsIG9uVG91Y2hFbmQpO1xuICAgICAgICB9O1xuICAgICAgfVxuICAgIH07XG4gICAgX3Byb3RvLnNob3VsZFNjcm9sbCA9IGZ1bmN0aW9uIHNob3VsZFNjcm9sbChwcmV2U3RhdGUsIHByZXZQcm9wcykge1xuICAgICAgdmFyIF9yZWYxMCA9IHRoaXMucHJvcHMuaGlnaGxpZ2h0ZWRJbmRleCA9PT0gdW5kZWZpbmVkID8gdGhpcy5nZXRTdGF0ZSgpIDogdGhpcy5wcm9wcyxcbiAgICAgICAgY3VycmVudEhpZ2hsaWdodGVkSW5kZXggPSBfcmVmMTAuaGlnaGxpZ2h0ZWRJbmRleDtcbiAgICAgIHZhciBfcmVmMTEgPSBwcmV2UHJvcHMuaGlnaGxpZ2h0ZWRJbmRleCA9PT0gdW5kZWZpbmVkID8gcHJldlN0YXRlIDogcHJldlByb3BzLFxuICAgICAgICBwcmV2SGlnaGxpZ2h0ZWRJbmRleCA9IF9yZWYxMS5oaWdobGlnaHRlZEluZGV4O1xuICAgICAgdmFyIHNjcm9sbFdoZW5PcGVuID0gY3VycmVudEhpZ2hsaWdodGVkSW5kZXggJiYgdGhpcy5nZXRTdGF0ZSgpLmlzT3BlbiAmJiAhcHJldlN0YXRlLmlzT3BlbjtcbiAgICAgIHZhciBzY3JvbGxXaGVuTmF2aWdhdGluZyA9IGN1cnJlbnRIaWdobGlnaHRlZEluZGV4ICE9PSBwcmV2SGlnaGxpZ2h0ZWRJbmRleDtcbiAgICAgIHJldHVybiBzY3JvbGxXaGVuT3BlbiB8fCBzY3JvbGxXaGVuTmF2aWdhdGluZztcbiAgICB9O1xuICAgIF9wcm90by5jb21wb25lbnREaWRVcGRhdGUgPSBmdW5jdGlvbiBjb21wb25lbnREaWRVcGRhdGUocHJldlByb3BzLCBwcmV2U3RhdGUpIHtcbiAgICAgIGlmIChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nKSB7XG4gICAgICAgIHZhbGlkYXRlQ29udHJvbGxlZFVuY2hhbmdlZCh0aGlzLnN0YXRlLCBwcmV2UHJvcHMsIHRoaXMucHJvcHMpO1xuICAgICAgICAvKiBpc3RhbmJ1bCBpZ25vcmUgaWYgKHJlYWN0LW5hdGl2ZSkgKi9cbiAgICAgICAgaWYgKHRoaXMuZ2V0TWVudVByb3BzLmNhbGxlZCAmJiAhdGhpcy5nZXRNZW51UHJvcHMuc3VwcHJlc3NSZWZFcnJvcikge1xuICAgICAgICAgIHZhbGlkYXRlR2V0TWVudVByb3BzQ2FsbGVkQ29ycmVjdGx5KHRoaXMuX21lbnVOb2RlLCB0aGlzLmdldE1lbnVQcm9wcyk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIGlmIChpc0NvbnRyb2xsZWRQcm9wKHRoaXMucHJvcHMsICdzZWxlY3RlZEl0ZW0nKSAmJiB0aGlzLnByb3BzLnNlbGVjdGVkSXRlbUNoYW5nZWQocHJldlByb3BzLnNlbGVjdGVkSXRlbSwgdGhpcy5wcm9wcy5zZWxlY3RlZEl0ZW0pKSB7XG4gICAgICAgIHRoaXMuaW50ZXJuYWxTZXRTdGF0ZSh7XG4gICAgICAgICAgdHlwZTogY29udHJvbGxlZFByb3BVcGRhdGVkU2VsZWN0ZWRJdGVtLFxuICAgICAgICAgIGlucHV0VmFsdWU6IHRoaXMucHJvcHMuaXRlbVRvU3RyaW5nKHRoaXMucHJvcHMuc2VsZWN0ZWRJdGVtKVxuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICAgIGlmICghdGhpcy5hdm9pZFNjcm9sbGluZyAmJiB0aGlzLnNob3VsZFNjcm9sbChwcmV2U3RhdGUsIHByZXZQcm9wcykpIHtcbiAgICAgICAgdGhpcy5zY3JvbGxIaWdobGlnaHRlZEl0ZW1JbnRvVmlldygpO1xuICAgICAgfVxuXG4gICAgICAvKiBpc3RhbmJ1bCBpZ25vcmUgZWxzZSAocmVhY3QtbmF0aXZlKSAqL1xuICAgICAge1xuICAgICAgICB0aGlzLnVwZGF0ZVN0YXR1cygpO1xuICAgICAgfVxuICAgIH07XG4gICAgX3Byb3RvLmNvbXBvbmVudFdpbGxVbm1vdW50ID0gZnVuY3Rpb24gY29tcG9uZW50V2lsbFVubW91bnQoKSB7XG4gICAgICB0aGlzLmNsZWFudXAoKTsgLy8gYXZvaWRzIG1lbW9yeSBsZWFrXG4gICAgfTtcbiAgICBfcHJvdG8ucmVuZGVyID0gZnVuY3Rpb24gcmVuZGVyKCkge1xuICAgICAgdmFyIGNoaWxkcmVuID0gdW53cmFwQXJyYXkodGhpcy5wcm9wcy5jaGlsZHJlbiwgbm9vcCk7XG4gICAgICAvLyBiZWNhdXNlIHRoZSBpdGVtcyBhcmUgcmVyZW5kZXJlZCBldmVyeSB0aW1lIHdlIGNhbGwgdGhlIGNoaWxkcmVuXG4gICAgICAvLyB3ZSBjbGVhciB0aGlzIG91dCBlYWNoIHJlbmRlciBhbmQgaXQgd2lsbCBiZSBwb3B1bGF0ZWQgYWdhaW4gYXNcbiAgICAgIC8vIGdldEl0ZW1Qcm9wcyBpcyBjYWxsZWQuXG4gICAgICB0aGlzLmNsZWFySXRlbXMoKTtcbiAgICAgIC8vIHdlIHJlc2V0IHRoaXMgc28gd2Uga25vdyB3aGV0aGVyIHRoZSB1c2VyIGNhbGxzIGdldFJvb3RQcm9wcyBkdXJpbmdcbiAgICAgIC8vIHRoaXMgcmVuZGVyLiBJZiB0aGV5IGRvIHRoZW4gd2UgZG9uJ3QgbmVlZCB0byBkbyBhbnl0aGluZyxcbiAgICAgIC8vIGlmIHRoZXkgZG9uJ3QgdGhlbiB3ZSBuZWVkIHRvIGNsb25lIHRoZSBlbGVtZW50IHRoZXkgcmV0dXJuIGFuZFxuICAgICAgLy8gYXBwbHkgdGhlIHByb3BzIGZvciB0aGVtLlxuICAgICAgdGhpcy5nZXRSb290UHJvcHMuY2FsbGVkID0gZmFsc2U7XG4gICAgICB0aGlzLmdldFJvb3RQcm9wcy5yZWZLZXkgPSB1bmRlZmluZWQ7XG4gICAgICB0aGlzLmdldFJvb3RQcm9wcy5zdXBwcmVzc1JlZkVycm9yID0gdW5kZWZpbmVkO1xuICAgICAgLy8gd2UgZG8gc29tZXRoaW5nIHNpbWlsYXIgZm9yIGdldE1lbnVQcm9wc1xuICAgICAgdGhpcy5nZXRNZW51UHJvcHMuY2FsbGVkID0gZmFsc2U7XG4gICAgICB0aGlzLmdldE1lbnVQcm9wcy5yZWZLZXkgPSB1bmRlZmluZWQ7XG4gICAgICB0aGlzLmdldE1lbnVQcm9wcy5zdXBwcmVzc1JlZkVycm9yID0gdW5kZWZpbmVkO1xuICAgICAgLy8gd2UgZG8gc29tZXRoaW5nIHNpbWlsYXIgZm9yIGdldExhYmVsUHJvcHNcbiAgICAgIHRoaXMuZ2V0TGFiZWxQcm9wcy5jYWxsZWQgPSBmYWxzZTtcbiAgICAgIC8vIGFuZCBzb21ldGhpbmcgc2ltaWxhciBmb3IgZ2V0SW5wdXRQcm9wc1xuICAgICAgdGhpcy5nZXRJbnB1dFByb3BzLmNhbGxlZCA9IGZhbHNlO1xuICAgICAgdmFyIGVsZW1lbnQgPSB1bndyYXBBcnJheShjaGlsZHJlbih0aGlzLmdldFN0YXRlQW5kSGVscGVycygpKSk7XG4gICAgICBpZiAoIWVsZW1lbnQpIHtcbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICB9XG4gICAgICBpZiAodGhpcy5nZXRSb290UHJvcHMuY2FsbGVkIHx8IHRoaXMucHJvcHMuc3VwcHJlc3NSZWZFcnJvcikge1xuICAgICAgICBpZiAocHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09ICdwcm9kdWN0aW9uJyAmJiAhdGhpcy5nZXRSb290UHJvcHMuc3VwcHJlc3NSZWZFcnJvciAmJiAhdGhpcy5wcm9wcy5zdXBwcmVzc1JlZkVycm9yKSB7XG4gICAgICAgICAgdmFsaWRhdGVHZXRSb290UHJvcHNDYWxsZWRDb3JyZWN0bHkoZWxlbWVudCwgdGhpcy5nZXRSb290UHJvcHMpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBlbGVtZW50O1xuICAgICAgfSBlbHNlIGlmIChpc0RPTUVsZW1lbnQoZWxlbWVudCkpIHtcbiAgICAgICAgLy8gdGhleSBkaWRuJ3QgYXBwbHkgdGhlIHJvb3QgcHJvcHMsIGJ1dCB3ZSBjYW4gY2xvbmVcbiAgICAgICAgLy8gdGhpcyBhbmQgYXBwbHkgdGhlIHByb3BzIG91cnNlbHZlc1xuICAgICAgICByZXR1cm4gLyojX19QVVJFX18qL2Nsb25lRWxlbWVudChlbGVtZW50LCB0aGlzLmdldFJvb3RQcm9wcyhnZXRFbGVtZW50UHJvcHMoZWxlbWVudCkpKTtcbiAgICAgIH1cblxuICAgICAgLyogaXN0YW5idWwgaWdub3JlIGVsc2UgKi9cbiAgICAgIGlmIChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nKSB7XG4gICAgICAgIC8vIHRoZXkgZGlkbid0IGFwcGx5IHRoZSByb290IHByb3BzLCBidXQgdGhleSBuZWVkIHRvXG4gICAgICAgIC8vIG90aGVyd2lzZSB3ZSBjYW4ndCBxdWVyeSBhcm91bmQgdGhlIGF1dG9jb21wbGV0ZVxuXG4gICAgICAgIHRocm93IG5ldyBFcnJvcignZG93bnNoaWZ0OiBJZiB5b3UgcmV0dXJuIGEgbm9uLURPTSBlbGVtZW50LCB5b3UgbXVzdCBhcHBseSB0aGUgZ2V0Um9vdFByb3BzIGZ1bmN0aW9uJyk7XG4gICAgICB9XG5cbiAgICAgIC8qIGlzdGFuYnVsIGlnbm9yZSBuZXh0ICovXG4gICAgICByZXR1cm4gdW5kZWZpbmVkO1xuICAgIH07XG4gICAgcmV0dXJuIERvd25zaGlmdDtcbiAgfShDb21wb25lbnQpO1xuICBEb3duc2hpZnQuZGVmYXVsdFByb3BzID0ge1xuICAgIGRlZmF1bHRIaWdobGlnaHRlZEluZGV4OiBudWxsLFxuICAgIGRlZmF1bHRJc09wZW46IGZhbHNlLFxuICAgIGdldEExMXlTdGF0dXNNZXNzYWdlOiBnZXRBMTF5U3RhdHVzTWVzc2FnZSxcbiAgICBpdGVtVG9TdHJpbmc6IGZ1bmN0aW9uIGl0ZW1Ub1N0cmluZyhpKSB7XG4gICAgICBpZiAoaSA9PSBudWxsKSB7XG4gICAgICAgIHJldHVybiAnJztcbiAgICAgIH1cbiAgICAgIGlmIChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nICYmIGlzUGxhaW5PYmplY3QoaSkgJiYgIWkuaGFzT3duUHJvcGVydHkoJ3RvU3RyaW5nJykpIHtcbiAgICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG5vLWNvbnNvbGVcbiAgICAgICAgY29uc29sZS53YXJuKCdkb3duc2hpZnQ6IEFuIG9iamVjdCB3YXMgcGFzc2VkIHRvIHRoZSBkZWZhdWx0IGltcGxlbWVudGF0aW9uIG9mIGBpdGVtVG9TdHJpbmdgLiBZb3Ugc2hvdWxkIHByb2JhYmx5IHByb3ZpZGUgeW91ciBvd24gYGl0ZW1Ub1N0cmluZ2AgaW1wbGVtZW50YXRpb24uIFBsZWFzZSByZWZlciB0byB0aGUgYGl0ZW1Ub1N0cmluZ2AgQVBJIGRvY3VtZW50YXRpb24uJywgJ1RoZSBvYmplY3QgdGhhdCB3YXMgcGFzc2VkOicsIGkpO1xuICAgICAgfVxuICAgICAgcmV0dXJuIFN0cmluZyhpKTtcbiAgICB9LFxuICAgIG9uU3RhdGVDaGFuZ2U6IG5vb3AsXG4gICAgb25JbnB1dFZhbHVlQ2hhbmdlOiBub29wLFxuICAgIG9uVXNlckFjdGlvbjogbm9vcCxcbiAgICBvbkNoYW5nZTogbm9vcCxcbiAgICBvblNlbGVjdDogbm9vcCxcbiAgICBvbk91dGVyQ2xpY2s6IG5vb3AsXG4gICAgc2VsZWN0ZWRJdGVtQ2hhbmdlZDogZnVuY3Rpb24gc2VsZWN0ZWRJdGVtQ2hhbmdlZChwcmV2SXRlbSwgaXRlbSkge1xuICAgICAgcmV0dXJuIHByZXZJdGVtICE9PSBpdGVtO1xuICAgIH0sXG4gICAgZW52aXJvbm1lbnQ6IC8qIGlzdGFuYnVsIGlnbm9yZSBuZXh0IChzc3IpICovXG4gICAgdHlwZW9mIHdpbmRvdyA9PT0gJ3VuZGVmaW5lZCcgfHwgZmFsc2UgPyB1bmRlZmluZWQgOiB3aW5kb3csXG4gICAgc3RhdGVSZWR1Y2VyOiBmdW5jdGlvbiBzdGF0ZVJlZHVjZXIoc3RhdGUsIHN0YXRlVG9TZXQpIHtcbiAgICAgIHJldHVybiBzdGF0ZVRvU2V0O1xuICAgIH0sXG4gICAgc3VwcHJlc3NSZWZFcnJvcjogZmFsc2UsXG4gICAgc2Nyb2xsSW50b1ZpZXc6IHNjcm9sbEludG9WaWV3XG4gIH07XG4gIERvd25zaGlmdC5zdGF0ZUNoYW5nZVR5cGVzID0gc3RhdGVDaGFuZ2VUeXBlcyQzO1xuICByZXR1cm4gRG93bnNoaWZ0O1xufSgpO1xucHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09IFwicHJvZHVjdGlvblwiID8gRG93bnNoaWZ0LnByb3BUeXBlcyA9IHtcbiAgY2hpbGRyZW46IFByb3BUeXBlcy5mdW5jLFxuICBkZWZhdWx0SGlnaGxpZ2h0ZWRJbmRleDogUHJvcFR5cGVzLm51bWJlcixcbiAgZGVmYXVsdElzT3BlbjogUHJvcFR5cGVzLmJvb2wsXG4gIGluaXRpYWxIaWdobGlnaHRlZEluZGV4OiBQcm9wVHlwZXMubnVtYmVyLFxuICBpbml0aWFsU2VsZWN0ZWRJdGVtOiBQcm9wVHlwZXMuYW55LFxuICBpbml0aWFsSW5wdXRWYWx1ZTogUHJvcFR5cGVzLnN0cmluZyxcbiAgaW5pdGlhbElzT3BlbjogUHJvcFR5cGVzLmJvb2wsXG4gIGdldEExMXlTdGF0dXNNZXNzYWdlOiBQcm9wVHlwZXMuZnVuYyxcbiAgaXRlbVRvU3RyaW5nOiBQcm9wVHlwZXMuZnVuYyxcbiAgb25DaGFuZ2U6IFByb3BUeXBlcy5mdW5jLFxuICBvblNlbGVjdDogUHJvcFR5cGVzLmZ1bmMsXG4gIG9uU3RhdGVDaGFuZ2U6IFByb3BUeXBlcy5mdW5jLFxuICBvbklucHV0VmFsdWVDaGFuZ2U6IFByb3BUeXBlcy5mdW5jLFxuICBvblVzZXJBY3Rpb246IFByb3BUeXBlcy5mdW5jLFxuICBvbk91dGVyQ2xpY2s6IFByb3BUeXBlcy5mdW5jLFxuICBzZWxlY3RlZEl0ZW1DaGFuZ2VkOiBQcm9wVHlwZXMuZnVuYyxcbiAgc3RhdGVSZWR1Y2VyOiBQcm9wVHlwZXMuZnVuYyxcbiAgaXRlbUNvdW50OiBQcm9wVHlwZXMubnVtYmVyLFxuICBpZDogUHJvcFR5cGVzLnN0cmluZyxcbiAgZW52aXJvbm1lbnQ6IFByb3BUeXBlcy5zaGFwZSh7XG4gICAgYWRkRXZlbnRMaXN0ZW5lcjogUHJvcFR5cGVzLmZ1bmMuaXNSZXF1aXJlZCxcbiAgICByZW1vdmVFdmVudExpc3RlbmVyOiBQcm9wVHlwZXMuZnVuYy5pc1JlcXVpcmVkLFxuICAgIGRvY3VtZW50OiBQcm9wVHlwZXMuc2hhcGUoe1xuICAgICAgY3JlYXRlRWxlbWVudDogUHJvcFR5cGVzLmZ1bmMuaXNSZXF1aXJlZCxcbiAgICAgIGdldEVsZW1lbnRCeUlkOiBQcm9wVHlwZXMuZnVuYy5pc1JlcXVpcmVkLFxuICAgICAgYWN0aXZlRWxlbWVudDogUHJvcFR5cGVzLmFueS5pc1JlcXVpcmVkLFxuICAgICAgYm9keTogUHJvcFR5cGVzLmFueS5pc1JlcXVpcmVkXG4gICAgfSkuaXNSZXF1aXJlZCxcbiAgICBOb2RlOiBQcm9wVHlwZXMuZnVuYy5pc1JlcXVpcmVkXG4gIH0pLFxuICBzdXBwcmVzc1JlZkVycm9yOiBQcm9wVHlwZXMuYm9vbCxcbiAgc2Nyb2xsSW50b1ZpZXc6IFByb3BUeXBlcy5mdW5jLFxuICAvLyB0aGluZ3Mgd2Uga2VlcCBpbiBzdGF0ZSBmb3IgdW5jb250cm9sbGVkIGNvbXBvbmVudHNcbiAgLy8gYnV0IGNhbiBhY2NlcHQgYXMgcHJvcHMgZm9yIGNvbnRyb2xsZWQgY29tcG9uZW50c1xuICAvKiBlc2xpbnQtZGlzYWJsZSByZWFjdC9uby11bnVzZWQtcHJvcC10eXBlcyAqL1xuICBzZWxlY3RlZEl0ZW06IFByb3BUeXBlcy5hbnksXG4gIGlzT3BlbjogUHJvcFR5cGVzLmJvb2wsXG4gIGlucHV0VmFsdWU6IFByb3BUeXBlcy5zdHJpbmcsXG4gIGhpZ2hsaWdodGVkSW5kZXg6IFByb3BUeXBlcy5udW1iZXIsXG4gIGxhYmVsSWQ6IFByb3BUeXBlcy5zdHJpbmcsXG4gIGlucHV0SWQ6IFByb3BUeXBlcy5zdHJpbmcsXG4gIG1lbnVJZDogUHJvcFR5cGVzLnN0cmluZyxcbiAgZ2V0SXRlbUlkOiBQcm9wVHlwZXMuZnVuY1xuICAvKiBlc2xpbnQtZW5hYmxlIHJlYWN0L25vLXVudXNlZC1wcm9wLXR5cGVzICovXG59IDogdm9pZCAwO1xudmFyIERvd25zaGlmdCQxID0gRG93bnNoaWZ0O1xuZnVuY3Rpb24gdmFsaWRhdGVHZXRNZW51UHJvcHNDYWxsZWRDb3JyZWN0bHkobm9kZSwgX3JlZjEyKSB7XG4gIHZhciByZWZLZXkgPSBfcmVmMTIucmVmS2V5O1xuICBpZiAoIW5vZGUpIHtcbiAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm8tY29uc29sZVxuICAgIGNvbnNvbGUuZXJyb3IoXCJkb3duc2hpZnQ6IFRoZSByZWYgcHJvcCBcXFwiXCIgKyByZWZLZXkgKyBcIlxcXCIgZnJvbSBnZXRNZW51UHJvcHMgd2FzIG5vdCBhcHBsaWVkIGNvcnJlY3RseSBvbiB5b3VyIG1lbnUgZWxlbWVudC5cIik7XG4gIH1cbn1cbmZ1bmN0aW9uIHZhbGlkYXRlR2V0Um9vdFByb3BzQ2FsbGVkQ29ycmVjdGx5KGVsZW1lbnQsIF9yZWYxMykge1xuICB2YXIgcmVmS2V5ID0gX3JlZjEzLnJlZktleTtcbiAgdmFyIHJlZktleVNwZWNpZmllZCA9IHJlZktleSAhPT0gJ3JlZic7XG4gIHZhciBpc0NvbXBvc2l0ZSA9ICFpc0RPTUVsZW1lbnQoZWxlbWVudCk7XG4gIGlmIChpc0NvbXBvc2l0ZSAmJiAhcmVmS2V5U3BlY2lmaWVkICYmICFpc0ZvcndhcmRSZWYoZWxlbWVudCkpIHtcbiAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm8tY29uc29sZVxuICAgIGNvbnNvbGUuZXJyb3IoJ2Rvd25zaGlmdDogWW91IHJldHVybmVkIGEgbm9uLURPTSBlbGVtZW50LiBZb3UgbXVzdCBzcGVjaWZ5IGEgcmVmS2V5IGluIGdldFJvb3RQcm9wcycpO1xuICB9IGVsc2UgaWYgKCFpc0NvbXBvc2l0ZSAmJiByZWZLZXlTcGVjaWZpZWQpIHtcbiAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm8tY29uc29sZVxuICAgIGNvbnNvbGUuZXJyb3IoXCJkb3duc2hpZnQ6IFlvdSByZXR1cm5lZCBhIERPTSBlbGVtZW50LiBZb3Ugc2hvdWxkIG5vdCBzcGVjaWZ5IGEgcmVmS2V5IGluIGdldFJvb3RQcm9wcy4gWW91IHNwZWNpZmllZCBcXFwiXCIgKyByZWZLZXkgKyBcIlxcXCJcIik7XG4gIH1cbiAgaWYgKCFpc0ZvcndhcmRSZWYoZWxlbWVudCkgJiYgIWdldEVsZW1lbnRQcm9wcyhlbGVtZW50KVtyZWZLZXldKSB7XG4gICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG5vLWNvbnNvbGVcbiAgICBjb25zb2xlLmVycm9yKFwiZG93bnNoaWZ0OiBZb3UgbXVzdCBhcHBseSB0aGUgcmVmIHByb3AgXFxcIlwiICsgcmVmS2V5ICsgXCJcXFwiIGZyb20gZ2V0Um9vdFByb3BzIG9udG8geW91ciByb290IGVsZW1lbnQuXCIpO1xuICB9XG59XG5cbnZhciBkcm9wZG93bkRlZmF1bHRTdGF0ZVZhbHVlcyA9IHtcbiAgaGlnaGxpZ2h0ZWRJbmRleDogLTEsXG4gIGlzT3BlbjogZmFsc2UsXG4gIHNlbGVjdGVkSXRlbTogbnVsbCxcbiAgaW5wdXRWYWx1ZTogJydcbn07XG5mdW5jdGlvbiBjYWxsT25DaGFuZ2VQcm9wcyhhY3Rpb24sIHN0YXRlLCBuZXdTdGF0ZSkge1xuICB2YXIgcHJvcHMgPSBhY3Rpb24ucHJvcHMsXG4gICAgdHlwZSA9IGFjdGlvbi50eXBlO1xuICB2YXIgY2hhbmdlcyA9IHt9O1xuICBPYmplY3Qua2V5cyhzdGF0ZSkuZm9yRWFjaChmdW5jdGlvbiAoa2V5KSB7XG4gICAgaW52b2tlT25DaGFuZ2VIYW5kbGVyKGtleSwgYWN0aW9uLCBzdGF0ZSwgbmV3U3RhdGUpO1xuICAgIGlmIChuZXdTdGF0ZVtrZXldICE9PSBzdGF0ZVtrZXldKSB7XG4gICAgICBjaGFuZ2VzW2tleV0gPSBuZXdTdGF0ZVtrZXldO1xuICAgIH1cbiAgfSk7XG4gIGlmIChwcm9wcy5vblN0YXRlQ2hhbmdlICYmIE9iamVjdC5rZXlzKGNoYW5nZXMpLmxlbmd0aCkge1xuICAgIHByb3BzLm9uU3RhdGVDaGFuZ2UoX2V4dGVuZHMoe1xuICAgICAgdHlwZTogdHlwZVxuICAgIH0sIGNoYW5nZXMpKTtcbiAgfVxufVxuZnVuY3Rpb24gaW52b2tlT25DaGFuZ2VIYW5kbGVyKGtleSwgYWN0aW9uLCBzdGF0ZSwgbmV3U3RhdGUpIHtcbiAgdmFyIHByb3BzID0gYWN0aW9uLnByb3BzLFxuICAgIHR5cGUgPSBhY3Rpb24udHlwZTtcbiAgdmFyIGhhbmRsZXIgPSBcIm9uXCIgKyBjYXBpdGFsaXplU3RyaW5nKGtleSkgKyBcIkNoYW5nZVwiO1xuICBpZiAocHJvcHNbaGFuZGxlcl0gJiYgbmV3U3RhdGVba2V5XSAhPT0gdW5kZWZpbmVkICYmIG5ld1N0YXRlW2tleV0gIT09IHN0YXRlW2tleV0pIHtcbiAgICBwcm9wc1toYW5kbGVyXShfZXh0ZW5kcyh7XG4gICAgICB0eXBlOiB0eXBlXG4gICAgfSwgbmV3U3RhdGUpKTtcbiAgfVxufVxuXG4vKipcbiAqIERlZmF1bHQgc3RhdGUgcmVkdWNlciB0aGF0IHJldHVybnMgdGhlIGNoYW5nZXMuXG4gKlxuICogQHBhcmFtIHtPYmplY3R9IHMgc3RhdGUuXG4gKiBAcGFyYW0ge09iamVjdH0gYSBhY3Rpb24gd2l0aCBjaGFuZ2VzLlxuICogQHJldHVybnMge09iamVjdH0gY2hhbmdlcy5cbiAqL1xuZnVuY3Rpb24gc3RhdGVSZWR1Y2VyKHMsIGEpIHtcbiAgcmV0dXJuIGEuY2hhbmdlcztcbn1cblxuLyoqXG4gKiBEZWJvdW5jZWQgY2FsbCBmb3IgdXBkYXRpbmcgdGhlIGExMXkgbWVzc2FnZS5cbiAqL1xudmFyIHVwZGF0ZUExMXlTdGF0dXMgPSBkZWJvdW5jZShmdW5jdGlvbiAoc3RhdHVzLCBkb2N1bWVudCkge1xuICBzZXRTdGF0dXMoc3RhdHVzLCBkb2N1bWVudCk7XG59LCAyMDApO1xuXG4vLyBpc3RhbmJ1bCBpZ25vcmUgbmV4dFxudmFyIHVzZUlzb21vcnBoaWNMYXlvdXRFZmZlY3QgPSB0eXBlb2Ygd2luZG93ICE9PSAndW5kZWZpbmVkJyAmJiB0eXBlb2Ygd2luZG93LmRvY3VtZW50ICE9PSAndW5kZWZpbmVkJyAmJiB0eXBlb2Ygd2luZG93LmRvY3VtZW50LmNyZWF0ZUVsZW1lbnQgIT09ICd1bmRlZmluZWQnID8gdXNlTGF5b3V0RWZmZWN0IDogdXNlRWZmZWN0O1xuXG4vLyBpc3RhbmJ1bCBpZ25vcmUgbmV4dFxudmFyIHVzZUVsZW1lbnRJZHMgPSAndXNlSWQnIGluIFJlYWN0IC8vIEF2b2lkIGNvbmRpdGlvbmFsIHVzZUlkIGNhbGxcbj8gZnVuY3Rpb24gdXNlRWxlbWVudElkcyhfcmVmKSB7XG4gIHZhciBpZCA9IF9yZWYuaWQsXG4gICAgbGFiZWxJZCA9IF9yZWYubGFiZWxJZCxcbiAgICBtZW51SWQgPSBfcmVmLm1lbnVJZCxcbiAgICBnZXRJdGVtSWQgPSBfcmVmLmdldEl0ZW1JZCxcbiAgICB0b2dnbGVCdXR0b25JZCA9IF9yZWYudG9nZ2xlQnV0dG9uSWQsXG4gICAgaW5wdXRJZCA9IF9yZWYuaW5wdXRJZDtcbiAgLy8gQXZvaWQgY29uZGl0aW9uYWwgdXNlSWQgY2FsbFxuICB2YXIgcmVhY3RJZCA9IFwiZG93bnNoaWZ0LVwiICsgUmVhY3QudXNlSWQoKTtcbiAgaWYgKCFpZCkge1xuICAgIGlkID0gcmVhY3RJZDtcbiAgfVxuICB2YXIgZWxlbWVudElkc1JlZiA9IHVzZVJlZih7XG4gICAgbGFiZWxJZDogbGFiZWxJZCB8fCBpZCArIFwiLWxhYmVsXCIsXG4gICAgbWVudUlkOiBtZW51SWQgfHwgaWQgKyBcIi1tZW51XCIsXG4gICAgZ2V0SXRlbUlkOiBnZXRJdGVtSWQgfHwgZnVuY3Rpb24gKGluZGV4KSB7XG4gICAgICByZXR1cm4gaWQgKyBcIi1pdGVtLVwiICsgaW5kZXg7XG4gICAgfSxcbiAgICB0b2dnbGVCdXR0b25JZDogdG9nZ2xlQnV0dG9uSWQgfHwgaWQgKyBcIi10b2dnbGUtYnV0dG9uXCIsXG4gICAgaW5wdXRJZDogaW5wdXRJZCB8fCBpZCArIFwiLWlucHV0XCJcbiAgfSk7XG4gIHJldHVybiBlbGVtZW50SWRzUmVmLmN1cnJlbnQ7XG59IDogZnVuY3Rpb24gdXNlRWxlbWVudElkcyhfcmVmMikge1xuICB2YXIgX3JlZjIkaWQgPSBfcmVmMi5pZCxcbiAgICBpZCA9IF9yZWYyJGlkID09PSB2b2lkIDAgPyBcImRvd25zaGlmdC1cIiArIGdlbmVyYXRlSWQoKSA6IF9yZWYyJGlkLFxuICAgIGxhYmVsSWQgPSBfcmVmMi5sYWJlbElkLFxuICAgIG1lbnVJZCA9IF9yZWYyLm1lbnVJZCxcbiAgICBnZXRJdGVtSWQgPSBfcmVmMi5nZXRJdGVtSWQsXG4gICAgdG9nZ2xlQnV0dG9uSWQgPSBfcmVmMi50b2dnbGVCdXR0b25JZCxcbiAgICBpbnB1dElkID0gX3JlZjIuaW5wdXRJZDtcbiAgdmFyIGVsZW1lbnRJZHNSZWYgPSB1c2VSZWYoe1xuICAgIGxhYmVsSWQ6IGxhYmVsSWQgfHwgaWQgKyBcIi1sYWJlbFwiLFxuICAgIG1lbnVJZDogbWVudUlkIHx8IGlkICsgXCItbWVudVwiLFxuICAgIGdldEl0ZW1JZDogZ2V0SXRlbUlkIHx8IGZ1bmN0aW9uIChpbmRleCkge1xuICAgICAgcmV0dXJuIGlkICsgXCItaXRlbS1cIiArIGluZGV4O1xuICAgIH0sXG4gICAgdG9nZ2xlQnV0dG9uSWQ6IHRvZ2dsZUJ1dHRvbklkIHx8IGlkICsgXCItdG9nZ2xlLWJ1dHRvblwiLFxuICAgIGlucHV0SWQ6IGlucHV0SWQgfHwgaWQgKyBcIi1pbnB1dFwiXG4gIH0pO1xuICByZXR1cm4gZWxlbWVudElkc1JlZi5jdXJyZW50O1xufTtcbmZ1bmN0aW9uIGdldEl0ZW1BbmRJbmRleChpdGVtUHJvcCwgaW5kZXhQcm9wLCBpdGVtcywgZXJyb3JNZXNzYWdlKSB7XG4gIHZhciBpdGVtLCBpbmRleDtcbiAgaWYgKGl0ZW1Qcm9wID09PSB1bmRlZmluZWQpIHtcbiAgICBpZiAoaW5kZXhQcm9wID09PSB1bmRlZmluZWQpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcihlcnJvck1lc3NhZ2UpO1xuICAgIH1cbiAgICBpdGVtID0gaXRlbXNbaW5kZXhQcm9wXTtcbiAgICBpbmRleCA9IGluZGV4UHJvcDtcbiAgfSBlbHNlIHtcbiAgICBpbmRleCA9IGluZGV4UHJvcCA9PT0gdW5kZWZpbmVkID8gaXRlbXMuaW5kZXhPZihpdGVtUHJvcCkgOiBpbmRleFByb3A7XG4gICAgaXRlbSA9IGl0ZW1Qcm9wO1xuICB9XG4gIHJldHVybiBbaXRlbSwgaW5kZXhdO1xufVxuZnVuY3Rpb24gaXNBY2NlcHRlZENoYXJhY3RlcktleShrZXkpIHtcbiAgcmV0dXJuIC9eXFxTezF9JC8udGVzdChrZXkpO1xufVxuZnVuY3Rpb24gY2FwaXRhbGl6ZVN0cmluZyhzdHJpbmcpIHtcbiAgcmV0dXJuIFwiXCIgKyBzdHJpbmcuc2xpY2UoMCwgMSkudG9VcHBlckNhc2UoKSArIHN0cmluZy5zbGljZSgxKTtcbn1cbmZ1bmN0aW9uIHVzZUxhdGVzdFJlZih2YWwpIHtcbiAgdmFyIHJlZiA9IHVzZVJlZih2YWwpO1xuICAvLyB0ZWNobmljYWxseSB0aGlzIGlzIG5vdCBcImNvbmN1cnJlbnQgbW9kZSBzYWZlXCIgYmVjYXVzZSB3ZSdyZSBtYW5pcHVsYXRpbmdcbiAgLy8gdGhlIHZhbHVlIGR1cmluZyByZW5kZXIgKHNvIGl0J3Mgbm90IGlkZW1wb3RlbnQpLiBIb3dldmVyLCB0aGUgcGxhY2VzIHRoaXNcbiAgLy8gaG9vayBpcyB1c2VkIGlzIHRvIHN1cHBvcnQgbWVtb2l6aW5nIGNhbGxiYWNrcyB3aGljaCB3aWxsIGJlIGNhbGxlZFxuICAvLyAqZHVyaW5nKiByZW5kZXIsIHNvIHdlIG5lZWQgdGhlIGxhdGVzdCB2YWx1ZXMgKmR1cmluZyogcmVuZGVyLlxuICAvLyBJZiBub3QgZm9yIHRoaXMsIHRoZW4gd2UnZCBwcm9iYWJseSB3YW50IHRvIHVzZSB1c2VMYXlvdXRFZmZlY3QgaW5zdGVhZC5cbiAgcmVmLmN1cnJlbnQgPSB2YWw7XG4gIHJldHVybiByZWY7XG59XG5cbi8qKlxuICogQ29tcHV0ZXMgdGhlIGNvbnRyb2xsZWQgc3RhdGUgdXNpbmcgYSB0aGUgcHJldmlvdXMgc3RhdGUsIHByb3BzLFxuICogdHdvIHJlZHVjZXJzLCBvbmUgZnJvbSBkb3duc2hpZnQgYW5kIGFuIG9wdGlvbmFsIG9uZSBmcm9tIHRoZSB1c2VyLlxuICogQWxzbyBjYWxscyB0aGUgb25DaGFuZ2UgaGFuZGxlcnMgZm9yIHN0YXRlIHZhbHVlcyB0aGF0IGhhdmUgY2hhbmdlZC5cbiAqXG4gKiBAcGFyYW0ge0Z1bmN0aW9ufSByZWR1Y2VyIFJlZHVjZXIgZnVuY3Rpb24gZnJvbSBkb3duc2hpZnQuXG4gKiBAcGFyYW0ge09iamVjdH0gcHJvcHMgVGhlIGhvb2sgcHJvcHMsIGFsc28gcGFzc2VkIHRvIGNyZWF0ZUluaXRpYWxTdGF0ZS5cbiAqIEBwYXJhbSB7RnVuY3Rpb259IGNyZWF0ZUluaXRpYWxTdGF0ZSBGdW5jdGlvbiB0aGF0IHJldHVybnMgdGhlIGluaXRpYWwgc3RhdGUuXG4gKiBAcGFyYW0ge0Z1bmN0aW9ufSBpc1N0YXRlRXF1YWwgRnVuY3Rpb24gdGhhdCBjaGVja3MgaWYgYSBwcmV2aW91cyBzdGF0ZSBpcyBlcXVhbCB0byB0aGUgbmV4dC5cbiAqIEByZXR1cm5zIHtBcnJheX0gQW4gYXJyYXkgd2l0aCB0aGUgc3RhdGUgYW5kIGFuIGFjdGlvbiBkaXNwYXRjaGVyLlxuICovXG5mdW5jdGlvbiB1c2VFbmhhbmNlZFJlZHVjZXIocmVkdWNlciwgcHJvcHMsIGNyZWF0ZUluaXRpYWxTdGF0ZSwgaXNTdGF0ZUVxdWFsKSB7XG4gIHZhciBwcmV2U3RhdGVSZWYgPSB1c2VSZWYoKTtcbiAgdmFyIGFjdGlvblJlZiA9IHVzZVJlZigpO1xuICB2YXIgZW5oYW5jZWRSZWR1Y2VyID0gdXNlQ2FsbGJhY2soZnVuY3Rpb24gKHN0YXRlLCBhY3Rpb24pIHtcbiAgICBhY3Rpb25SZWYuY3VycmVudCA9IGFjdGlvbjtcbiAgICBzdGF0ZSA9IGdldFN0YXRlKHN0YXRlLCBhY3Rpb24ucHJvcHMpO1xuICAgIHZhciBjaGFuZ2VzID0gcmVkdWNlcihzdGF0ZSwgYWN0aW9uKTtcbiAgICB2YXIgbmV3U3RhdGUgPSBhY3Rpb24ucHJvcHMuc3RhdGVSZWR1Y2VyKHN0YXRlLCBfZXh0ZW5kcyh7fSwgYWN0aW9uLCB7XG4gICAgICBjaGFuZ2VzOiBjaGFuZ2VzXG4gICAgfSkpO1xuICAgIHJldHVybiBuZXdTdGF0ZTtcbiAgfSwgW3JlZHVjZXJdKTtcbiAgdmFyIF91c2VSZWR1Y2VyID0gdXNlUmVkdWNlcihlbmhhbmNlZFJlZHVjZXIsIHByb3BzLCBjcmVhdGVJbml0aWFsU3RhdGUpLFxuICAgIHN0YXRlID0gX3VzZVJlZHVjZXJbMF0sXG4gICAgZGlzcGF0Y2ggPSBfdXNlUmVkdWNlclsxXTtcbiAgdmFyIHByb3BzUmVmID0gdXNlTGF0ZXN0UmVmKHByb3BzKTtcbiAgdmFyIGRpc3BhdGNoV2l0aFByb3BzID0gdXNlQ2FsbGJhY2soZnVuY3Rpb24gKGFjdGlvbikge1xuICAgIHJldHVybiBkaXNwYXRjaChfZXh0ZW5kcyh7XG4gICAgICBwcm9wczogcHJvcHNSZWYuY3VycmVudFxuICAgIH0sIGFjdGlvbikpO1xuICB9LCBbcHJvcHNSZWZdKTtcbiAgdmFyIGFjdGlvbiA9IGFjdGlvblJlZi5jdXJyZW50O1xuICB1c2VFZmZlY3QoZnVuY3Rpb24gKCkge1xuICAgIHZhciBwcmV2U3RhdGUgPSBnZXRTdGF0ZShwcmV2U3RhdGVSZWYuY3VycmVudCwgYWN0aW9uID09IG51bGwgPyB2b2lkIDAgOiBhY3Rpb24ucHJvcHMpO1xuICAgIHZhciBzaG91bGRDYWxsT25DaGFuZ2VQcm9wcyA9IGFjdGlvbiAmJiBwcmV2U3RhdGVSZWYuY3VycmVudCAmJiAhaXNTdGF0ZUVxdWFsKHByZXZTdGF0ZSwgc3RhdGUpO1xuICAgIGlmIChzaG91bGRDYWxsT25DaGFuZ2VQcm9wcykge1xuICAgICAgY2FsbE9uQ2hhbmdlUHJvcHMoYWN0aW9uLCBwcmV2U3RhdGUsIHN0YXRlKTtcbiAgICB9XG4gICAgcHJldlN0YXRlUmVmLmN1cnJlbnQgPSBzdGF0ZTtcbiAgfSwgW3N0YXRlLCBhY3Rpb24sIGlzU3RhdGVFcXVhbF0pO1xuICByZXR1cm4gW3N0YXRlLCBkaXNwYXRjaFdpdGhQcm9wc107XG59XG5cbi8qKlxuICogV3JhcHMgdGhlIHVzZUVuaGFuY2VkUmVkdWNlciBhbmQgYXBwbGllcyB0aGUgY29udHJvbGxlZCBwcm9wIHZhbHVlcyBiZWZvcmVcbiAqIHJldHVybmluZyB0aGUgbmV3IHN0YXRlLlxuICpcbiAqIEBwYXJhbSB7RnVuY3Rpb259IHJlZHVjZXIgUmVkdWNlciBmdW5jdGlvbiBmcm9tIGRvd25zaGlmdC5cbiAqIEBwYXJhbSB7T2JqZWN0fSBwcm9wcyBUaGUgaG9vayBwcm9wcywgYWxzbyBwYXNzZWQgdG8gY3JlYXRlSW5pdGlhbFN0YXRlLlxuICogQHBhcmFtIHtGdW5jdGlvbn0gY3JlYXRlSW5pdGlhbFN0YXRlIEZ1bmN0aW9uIHRoYXQgcmV0dXJucyB0aGUgaW5pdGlhbCBzdGF0ZS5cbiAqIEBwYXJhbSB7RnVuY3Rpb259IGlzU3RhdGVFcXVhbCBGdW5jdGlvbiB0aGF0IGNoZWNrcyBpZiBhIHByZXZpb3VzIHN0YXRlIGlzIGVxdWFsIHRvIHRoZSBuZXh0LlxuICogQHJldHVybnMge0FycmF5fSBBbiBhcnJheSB3aXRoIHRoZSBzdGF0ZSBhbmQgYW4gYWN0aW9uIGRpc3BhdGNoZXIuXG4gKi9cbmZ1bmN0aW9uIHVzZUNvbnRyb2xsZWRSZWR1Y2VyJDEocmVkdWNlciwgcHJvcHMsIGNyZWF0ZUluaXRpYWxTdGF0ZSwgaXNTdGF0ZUVxdWFsKSB7XG4gIHZhciBfdXNlRW5oYW5jZWRSZWR1Y2VyID0gdXNlRW5oYW5jZWRSZWR1Y2VyKHJlZHVjZXIsIHByb3BzLCBjcmVhdGVJbml0aWFsU3RhdGUsIGlzU3RhdGVFcXVhbCksXG4gICAgc3RhdGUgPSBfdXNlRW5oYW5jZWRSZWR1Y2VyWzBdLFxuICAgIGRpc3BhdGNoID0gX3VzZUVuaGFuY2VkUmVkdWNlclsxXTtcbiAgcmV0dXJuIFtnZXRTdGF0ZShzdGF0ZSwgcHJvcHMpLCBkaXNwYXRjaF07XG59XG52YXIgZGVmYXVsdFByb3BzJDMgPSB7XG4gIGl0ZW1Ub1N0cmluZzogZnVuY3Rpb24gaXRlbVRvU3RyaW5nKGl0ZW0pIHtcbiAgICByZXR1cm4gaXRlbSA/IFN0cmluZyhpdGVtKSA6ICcnO1xuICB9LFxuICBpdGVtVG9LZXk6IGZ1bmN0aW9uIGl0ZW1Ub0tleShpdGVtKSB7XG4gICAgcmV0dXJuIGl0ZW07XG4gIH0sXG4gIHN0YXRlUmVkdWNlcjogc3RhdGVSZWR1Y2VyLFxuICBzY3JvbGxJbnRvVmlldzogc2Nyb2xsSW50b1ZpZXcsXG4gIGVudmlyb25tZW50OiAvKiBpc3RhbmJ1bCBpZ25vcmUgbmV4dCAoc3NyKSAqL1xuICB0eXBlb2Ygd2luZG93ID09PSAndW5kZWZpbmVkJyB8fCBmYWxzZSA/IHVuZGVmaW5lZCA6IHdpbmRvd1xufTtcbmZ1bmN0aW9uIGdldERlZmF1bHRWYWx1ZSQxKHByb3BzLCBwcm9wS2V5LCBkZWZhdWx0U3RhdGVWYWx1ZXMpIHtcbiAgaWYgKGRlZmF1bHRTdGF0ZVZhbHVlcyA9PT0gdm9pZCAwKSB7XG4gICAgZGVmYXVsdFN0YXRlVmFsdWVzID0gZHJvcGRvd25EZWZhdWx0U3RhdGVWYWx1ZXM7XG4gIH1cbiAgdmFyIGRlZmF1bHRWYWx1ZSA9IHByb3BzW1wiZGVmYXVsdFwiICsgY2FwaXRhbGl6ZVN0cmluZyhwcm9wS2V5KV07XG4gIGlmIChkZWZhdWx0VmFsdWUgIT09IHVuZGVmaW5lZCkge1xuICAgIHJldHVybiBkZWZhdWx0VmFsdWU7XG4gIH1cbiAgcmV0dXJuIGRlZmF1bHRTdGF0ZVZhbHVlc1twcm9wS2V5XTtcbn1cbmZ1bmN0aW9uIGdldEluaXRpYWxWYWx1ZSQxKHByb3BzLCBwcm9wS2V5LCBkZWZhdWx0U3RhdGVWYWx1ZXMpIHtcbiAgaWYgKGRlZmF1bHRTdGF0ZVZhbHVlcyA9PT0gdm9pZCAwKSB7XG4gICAgZGVmYXVsdFN0YXRlVmFsdWVzID0gZHJvcGRvd25EZWZhdWx0U3RhdGVWYWx1ZXM7XG4gIH1cbiAgdmFyIHZhbHVlID0gcHJvcHNbcHJvcEtleV07XG4gIGlmICh2YWx1ZSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgcmV0dXJuIHZhbHVlO1xuICB9XG4gIHZhciBpbml0aWFsVmFsdWUgPSBwcm9wc1tcImluaXRpYWxcIiArIGNhcGl0YWxpemVTdHJpbmcocHJvcEtleSldO1xuICBpZiAoaW5pdGlhbFZhbHVlICE9PSB1bmRlZmluZWQpIHtcbiAgICByZXR1cm4gaW5pdGlhbFZhbHVlO1xuICB9XG4gIHJldHVybiBnZXREZWZhdWx0VmFsdWUkMShwcm9wcywgcHJvcEtleSwgZGVmYXVsdFN0YXRlVmFsdWVzKTtcbn1cbmZ1bmN0aW9uIGdldEluaXRpYWxTdGF0ZSQyKHByb3BzKSB7XG4gIHZhciBzZWxlY3RlZEl0ZW0gPSBnZXRJbml0aWFsVmFsdWUkMShwcm9wcywgJ3NlbGVjdGVkSXRlbScpO1xuICB2YXIgaXNPcGVuID0gZ2V0SW5pdGlhbFZhbHVlJDEocHJvcHMsICdpc09wZW4nKTtcbiAgdmFyIGhpZ2hsaWdodGVkSW5kZXggPSBnZXRJbml0aWFsSGlnaGxpZ2h0ZWRJbmRleChwcm9wcyk7XG4gIHZhciBpbnB1dFZhbHVlID0gZ2V0SW5pdGlhbFZhbHVlJDEocHJvcHMsICdpbnB1dFZhbHVlJyk7XG4gIHJldHVybiB7XG4gICAgaGlnaGxpZ2h0ZWRJbmRleDogaGlnaGxpZ2h0ZWRJbmRleCA8IDAgJiYgc2VsZWN0ZWRJdGVtICYmIGlzT3BlbiA/IHByb3BzLml0ZW1zLmZpbmRJbmRleChmdW5jdGlvbiAoaXRlbSkge1xuICAgICAgcmV0dXJuIHByb3BzLml0ZW1Ub0tleShpdGVtKSA9PT0gcHJvcHMuaXRlbVRvS2V5KHNlbGVjdGVkSXRlbSk7XG4gICAgfSkgOiBoaWdobGlnaHRlZEluZGV4LFxuICAgIGlzT3BlbjogaXNPcGVuLFxuICAgIHNlbGVjdGVkSXRlbTogc2VsZWN0ZWRJdGVtLFxuICAgIGlucHV0VmFsdWU6IGlucHV0VmFsdWVcbiAgfTtcbn1cbmZ1bmN0aW9uIGdldEhpZ2hsaWdodGVkSW5kZXhPbk9wZW4ocHJvcHMsIHN0YXRlLCBvZmZzZXQpIHtcbiAgdmFyIGl0ZW1zID0gcHJvcHMuaXRlbXMsXG4gICAgaW5pdGlhbEhpZ2hsaWdodGVkSW5kZXggPSBwcm9wcy5pbml0aWFsSGlnaGxpZ2h0ZWRJbmRleCxcbiAgICBkZWZhdWx0SGlnaGxpZ2h0ZWRJbmRleCA9IHByb3BzLmRlZmF1bHRIaWdobGlnaHRlZEluZGV4LFxuICAgIGlzSXRlbURpc2FibGVkID0gcHJvcHMuaXNJdGVtRGlzYWJsZWQsXG4gICAgaXRlbVRvS2V5ID0gcHJvcHMuaXRlbVRvS2V5O1xuICB2YXIgc2VsZWN0ZWRJdGVtID0gc3RhdGUuc2VsZWN0ZWRJdGVtLFxuICAgIGhpZ2hsaWdodGVkSW5kZXggPSBzdGF0ZS5oaWdobGlnaHRlZEluZGV4O1xuICBpZiAoaXRlbXMubGVuZ3RoID09PSAwKSB7XG4gICAgcmV0dXJuIC0xO1xuICB9XG5cbiAgLy8gaW5pdGlhbEhpZ2hsaWdodGVkSW5kZXggd2lsbCBnaXZlIHZhbHVlIHRvIGhpZ2hsaWdodGVkSW5kZXggb24gaW5pdGlhbCBzdGF0ZSBvbmx5LlxuICBpZiAoaW5pdGlhbEhpZ2hsaWdodGVkSW5kZXggIT09IHVuZGVmaW5lZCAmJiBoaWdobGlnaHRlZEluZGV4ID09PSBpbml0aWFsSGlnaGxpZ2h0ZWRJbmRleCAmJiAhaXNJdGVtRGlzYWJsZWQoaXRlbXNbaW5pdGlhbEhpZ2hsaWdodGVkSW5kZXhdLCBpbml0aWFsSGlnaGxpZ2h0ZWRJbmRleCkpIHtcbiAgICByZXR1cm4gaW5pdGlhbEhpZ2hsaWdodGVkSW5kZXg7XG4gIH1cbiAgaWYgKGRlZmF1bHRIaWdobGlnaHRlZEluZGV4ICE9PSB1bmRlZmluZWQgJiYgIWlzSXRlbURpc2FibGVkKGl0ZW1zW2RlZmF1bHRIaWdobGlnaHRlZEluZGV4XSwgZGVmYXVsdEhpZ2hsaWdodGVkSW5kZXgpKSB7XG4gICAgcmV0dXJuIGRlZmF1bHRIaWdobGlnaHRlZEluZGV4O1xuICB9XG4gIGlmIChzZWxlY3RlZEl0ZW0pIHtcbiAgICByZXR1cm4gaXRlbXMuZmluZEluZGV4KGZ1bmN0aW9uIChpdGVtKSB7XG4gICAgICByZXR1cm4gaXRlbVRvS2V5KHNlbGVjdGVkSXRlbSkgPT09IGl0ZW1Ub0tleShpdGVtKTtcbiAgICB9KTtcbiAgfVxuICBpZiAob2Zmc2V0IDwgMCAmJiAhaXNJdGVtRGlzYWJsZWQoaXRlbXNbaXRlbXMubGVuZ3RoIC0gMV0sIGl0ZW1zLmxlbmd0aCAtIDEpKSB7XG4gICAgcmV0dXJuIGl0ZW1zLmxlbmd0aCAtIDE7XG4gIH1cbiAgaWYgKG9mZnNldCA+IDAgJiYgIWlzSXRlbURpc2FibGVkKGl0ZW1zWzBdLCAwKSkge1xuICAgIHJldHVybiAwO1xuICB9XG4gIHJldHVybiAtMTtcbn1cbi8qKlxuICogVHJhY2tzIG1vdXNlIGFuZCB0b3VjaCBldmVudHMsIHN1Y2ggYXMgbW91c2VEb3duLCB0b3VjaE1vdmUgYW5kIHRvdWNoRW5kLlxuICpcbiAqIEBwYXJhbSB7V2luZG93fSBlbnZpcm9ubWVudCBUaGUgZW52aXJvbm1lbnQgdG8gYWRkIHRoZSBldmVudCBsaXN0ZW5lcnMgdG8sIGZvciBpbnN0YW5jZSB3aW5kb3cuXG4gKiBAcGFyYW0geygpID0+IHZvaWR9IGhhbmRsZUJsdXIgVGhlIGZ1bmN0aW9uIHRoYXQgaXMgY2FsbGVkIGlmIG1vdXNlRG93biBvciB0b3VjaEVuZCBvY2N1cmVkIG91dHNpZGUgdGhlIGRvd25zaGlmdEVsZW1lbnRzLlxuICogQHBhcmFtIHtBcnJheTx7Y3VycmVudDogSFRNTEVsZW1lbnR9Pn0gZG93bnNoaWZ0RWxlbWVudHNSZWZzIFRoZSByZWZzIGZvciB0aGUgZWxlbWVudHMgdGhhdCBzaG91bGQgbm90IHRyaWdnZXIgYSBibHVyIGFjdGlvbiBmcm9tIG1vdXNlRG93biBvciB0b3VjaEVuZC5cbiAqIEByZXR1cm5zIHt7aXNNb3VzZURvd246IGJvb2xlYW4sIGlzVG91Y2hNb3ZlOiBib29sZWFuLCBpc1RvdWNoRW5kOiBib29sZWFufX0gVGhlIG1vdXNlIGFuZCB0b3VjaCBldmVudHMgaW5mb3JtYXRpb24sIGlmIGFueSBvZiBhcmUgaGFwcGVuaW5nLlxuICovXG5mdW5jdGlvbiB1c2VNb3VzZUFuZFRvdWNoVHJhY2tlcihlbnZpcm9ubWVudCwgaGFuZGxlQmx1ciwgZG93bnNoaWZ0RWxlbWVudHNSZWZzKSB7XG4gIHZhciBtb3VzZUFuZFRvdWNoVHJhY2tlcnNSZWYgPSB1c2VSZWYoe1xuICAgIGlzTW91c2VEb3duOiBmYWxzZSxcbiAgICBpc1RvdWNoTW92ZTogZmFsc2UsXG4gICAgaXNUb3VjaEVuZDogZmFsc2VcbiAgfSk7XG4gIHVzZUVmZmVjdChmdW5jdGlvbiAoKSB7XG4gICAgaWYgKCFlbnZpcm9ubWVudCkge1xuICAgICAgcmV0dXJuIG5vb3A7XG4gICAgfVxuICAgIHZhciBkb3duc2hpZnRFbGVtZW50cyA9IGRvd25zaGlmdEVsZW1lbnRzUmVmcy5tYXAoZnVuY3Rpb24gKHJlZikge1xuICAgICAgcmV0dXJuIHJlZi5jdXJyZW50O1xuICAgIH0pO1xuICAgIGZ1bmN0aW9uIG9uTW91c2VEb3duKCkge1xuICAgICAgbW91c2VBbmRUb3VjaFRyYWNrZXJzUmVmLmN1cnJlbnQuaXNUb3VjaEVuZCA9IGZhbHNlOyAvLyByZXNldCB0aGlzIG9uZS5cbiAgICAgIG1vdXNlQW5kVG91Y2hUcmFja2Vyc1JlZi5jdXJyZW50LmlzTW91c2VEb3duID0gdHJ1ZTtcbiAgICB9XG4gICAgZnVuY3Rpb24gb25Nb3VzZVVwKGV2ZW50KSB7XG4gICAgICBtb3VzZUFuZFRvdWNoVHJhY2tlcnNSZWYuY3VycmVudC5pc01vdXNlRG93biA9IGZhbHNlO1xuICAgICAgaWYgKCF0YXJnZXRXaXRoaW5Eb3duc2hpZnQoZXZlbnQudGFyZ2V0LCBkb3duc2hpZnRFbGVtZW50cywgZW52aXJvbm1lbnQpKSB7XG4gICAgICAgIGhhbmRsZUJsdXIoKTtcbiAgICAgIH1cbiAgICB9XG4gICAgZnVuY3Rpb24gb25Ub3VjaFN0YXJ0KCkge1xuICAgICAgbW91c2VBbmRUb3VjaFRyYWNrZXJzUmVmLmN1cnJlbnQuaXNUb3VjaEVuZCA9IGZhbHNlO1xuICAgICAgbW91c2VBbmRUb3VjaFRyYWNrZXJzUmVmLmN1cnJlbnQuaXNUb3VjaE1vdmUgPSBmYWxzZTtcbiAgICB9XG4gICAgZnVuY3Rpb24gb25Ub3VjaE1vdmUoKSB7XG4gICAgICBtb3VzZUFuZFRvdWNoVHJhY2tlcnNSZWYuY3VycmVudC5pc1RvdWNoTW92ZSA9IHRydWU7XG4gICAgfVxuICAgIGZ1bmN0aW9uIG9uVG91Y2hFbmQoZXZlbnQpIHtcbiAgICAgIG1vdXNlQW5kVG91Y2hUcmFja2Vyc1JlZi5jdXJyZW50LmlzVG91Y2hFbmQgPSB0cnVlO1xuICAgICAgaWYgKCFtb3VzZUFuZFRvdWNoVHJhY2tlcnNSZWYuY3VycmVudC5pc1RvdWNoTW92ZSAmJiAhdGFyZ2V0V2l0aGluRG93bnNoaWZ0KGV2ZW50LnRhcmdldCwgZG93bnNoaWZ0RWxlbWVudHMsIGVudmlyb25tZW50LCBmYWxzZSkpIHtcbiAgICAgICAgaGFuZGxlQmx1cigpO1xuICAgICAgfVxuICAgIH1cbiAgICBlbnZpcm9ubWVudC5hZGRFdmVudExpc3RlbmVyKCdtb3VzZWRvd24nLCBvbk1vdXNlRG93bik7XG4gICAgZW52aXJvbm1lbnQuYWRkRXZlbnRMaXN0ZW5lcignbW91c2V1cCcsIG9uTW91c2VVcCk7XG4gICAgZW52aXJvbm1lbnQuYWRkRXZlbnRMaXN0ZW5lcigndG91Y2hzdGFydCcsIG9uVG91Y2hTdGFydCk7XG4gICAgZW52aXJvbm1lbnQuYWRkRXZlbnRMaXN0ZW5lcigndG91Y2htb3ZlJywgb25Ub3VjaE1vdmUpO1xuICAgIGVudmlyb25tZW50LmFkZEV2ZW50TGlzdGVuZXIoJ3RvdWNoZW5kJywgb25Ub3VjaEVuZCk7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIGNsZWFudXAoKSB7XG4gICAgICBlbnZpcm9ubWVudC5yZW1vdmVFdmVudExpc3RlbmVyKCdtb3VzZWRvd24nLCBvbk1vdXNlRG93bik7XG4gICAgICBlbnZpcm9ubWVudC5yZW1vdmVFdmVudExpc3RlbmVyKCdtb3VzZXVwJywgb25Nb3VzZVVwKTtcbiAgICAgIGVudmlyb25tZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ3RvdWNoc3RhcnQnLCBvblRvdWNoU3RhcnQpO1xuICAgICAgZW52aXJvbm1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcigndG91Y2htb3ZlJywgb25Ub3VjaE1vdmUpO1xuICAgICAgZW52aXJvbm1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcigndG91Y2hlbmQnLCBvblRvdWNoRW5kKTtcbiAgICB9O1xuICB9LCBbZG93bnNoaWZ0RWxlbWVudHNSZWZzLCBlbnZpcm9ubWVudCwgaGFuZGxlQmx1cl0pO1xuICByZXR1cm4gbW91c2VBbmRUb3VjaFRyYWNrZXJzUmVmLmN1cnJlbnQ7XG59XG5cbi8qIGlzdGFuYnVsIGlnbm9yZSBuZXh0ICovXG4vLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgaW1wb3J0L25vLW11dGFibGUtZXhwb3J0c1xudmFyIHVzZUdldHRlclByb3BzQ2FsbGVkQ2hlY2tlciA9IGZ1bmN0aW9uIHVzZUdldHRlclByb3BzQ2FsbGVkQ2hlY2tlcigpIHtcbiAgcmV0dXJuIG5vb3A7XG59O1xuLyoqXG4gKiBDdXN0b20gaG9vayB0aGF0IGNoZWNrcyBpZiBnZXR0ZXIgcHJvcHMgYXJlIGNhbGxlZCBjb3JyZWN0bHkuXG4gKlxuICogQHBhcmFtICB7Li4uYW55fSBwcm9wS2V5cyBHZXR0ZXIgcHJvcCBuYW1lcyB0byBiZSBoYW5kbGVkLlxuICogQHJldHVybnMge0Z1bmN0aW9ufSBTZXR0ZXIgZnVuY3Rpb24gY2FsbGVkIGluc2lkZSBnZXR0ZXIgcHJvcHMgdG8gc2V0IGNhbGwgaW5mb3JtYXRpb24uXG4gKi9cbi8qIGlzdGFuYnVsIGlnbm9yZSBuZXh0ICovXG5pZiAocHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09ICdwcm9kdWN0aW9uJykge1xuICB1c2VHZXR0ZXJQcm9wc0NhbGxlZENoZWNrZXIgPSBmdW5jdGlvbiB1c2VHZXR0ZXJQcm9wc0NhbGxlZENoZWNrZXIoKSB7XG4gICAgZm9yICh2YXIgX2xlbiA9IGFyZ3VtZW50cy5sZW5ndGgsIHByb3BLZXlzID0gbmV3IEFycmF5KF9sZW4pLCBfa2V5ID0gMDsgX2tleSA8IF9sZW47IF9rZXkrKykge1xuICAgICAgcHJvcEtleXNbX2tleV0gPSBhcmd1bWVudHNbX2tleV07XG4gICAgfVxuICAgIHZhciBnZXR0ZXJQcm9wc0NhbGxlZFJlZiA9IHVzZVJlZihwcm9wS2V5cy5yZWR1Y2UoZnVuY3Rpb24gKGFjYywgcHJvcEtleSkge1xuICAgICAgYWNjW3Byb3BLZXldID0ge307XG4gICAgICByZXR1cm4gYWNjO1xuICAgIH0sIHt9KSk7XG4gICAgdXNlRWZmZWN0KGZ1bmN0aW9uICgpIHtcbiAgICAgIE9iamVjdC5rZXlzKGdldHRlclByb3BzQ2FsbGVkUmVmLmN1cnJlbnQpLmZvckVhY2goZnVuY3Rpb24gKHByb3BLZXkpIHtcbiAgICAgICAgdmFyIHByb3BDYWxsSW5mbyA9IGdldHRlclByb3BzQ2FsbGVkUmVmLmN1cnJlbnRbcHJvcEtleV07XG4gICAgICAgIGlmICghT2JqZWN0LmtleXMocHJvcENhbGxJbmZvKS5sZW5ndGgpIHtcbiAgICAgICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm8tY29uc29sZVxuICAgICAgICAgIGNvbnNvbGUuZXJyb3IoXCJkb3duc2hpZnQ6IFlvdSBmb3Jnb3QgdG8gY2FsbCB0aGUgXCIgKyBwcm9wS2V5ICsgXCIgZ2V0dGVyIGZ1bmN0aW9uIG9uIHlvdXIgY29tcG9uZW50IC8gZWxlbWVudC5cIik7XG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIHZhciBzdXBwcmVzc1JlZkVycm9yID0gcHJvcENhbGxJbmZvLnN1cHByZXNzUmVmRXJyb3IsXG4gICAgICAgICAgcmVmS2V5ID0gcHJvcENhbGxJbmZvLnJlZktleSxcbiAgICAgICAgICBlbGVtZW50UmVmID0gcHJvcENhbGxJbmZvLmVsZW1lbnRSZWY7XG4gICAgICAgIGlmIChzdXBwcmVzc1JlZkVycm9yKSB7XG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIGlmICghKGVsZW1lbnRSZWYgIT0gbnVsbCAmJiBlbGVtZW50UmVmLmN1cnJlbnQpKSB7XG4gICAgICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG5vLWNvbnNvbGVcbiAgICAgICAgICBjb25zb2xlLmVycm9yKFwiZG93bnNoaWZ0OiBUaGUgcmVmIHByb3AgXFxcIlwiICsgcmVmS2V5ICsgXCJcXFwiIGZyb20gXCIgKyBwcm9wS2V5ICsgXCIgd2FzIG5vdCBhcHBsaWVkIGNvcnJlY3RseSBvbiB5b3VyIGVsZW1lbnQuXCIpO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9LCBbXSk7XG4gICAgdmFyIHNldEdldHRlclByb3BDYWxsSW5mbyA9IHVzZUNhbGxiYWNrKGZ1bmN0aW9uIChwcm9wS2V5LCBzdXBwcmVzc1JlZkVycm9yLCByZWZLZXksIGVsZW1lbnRSZWYpIHtcbiAgICAgIGdldHRlclByb3BzQ2FsbGVkUmVmLmN1cnJlbnRbcHJvcEtleV0gPSB7XG4gICAgICAgIHN1cHByZXNzUmVmRXJyb3I6IHN1cHByZXNzUmVmRXJyb3IsXG4gICAgICAgIHJlZktleTogcmVmS2V5LFxuICAgICAgICBlbGVtZW50UmVmOiBlbGVtZW50UmVmXG4gICAgICB9O1xuICAgIH0sIFtdKTtcbiAgICByZXR1cm4gc2V0R2V0dGVyUHJvcENhbGxJbmZvO1xuICB9O1xufVxuXG4vKipcbiAqIEFkZHMgYW4gYTExeSBhcmlhIGxpdmUgc3RhdHVzIG1lc3NhZ2UgaWYgZ2V0QTExeVN0YXR1c01lc3NhZ2UgaXMgcGFzc2VkLlxuICogQHBhcmFtIHsob3B0aW9uczogT2JqZWN0KSA9PiBzdHJpbmd9IGdldEExMXlTdGF0dXNNZXNzYWdlIFRoZSBmdW5jdGlvbiB0aGF0IGJ1aWxkcyB0aGUgc3RhdHVzIG1lc3NhZ2UuXG4gKiBAcGFyYW0ge09iamVjdH0gb3B0aW9ucyBUaGUgb3B0aW9ucyB0byBiZSBwYXNzZWQgdG8gZ2V0QTExeVN0YXR1c01lc3NhZ2UgaWYgY2FsbGVkLlxuICogQHBhcmFtIHtBcnJheTx1bmtub3duPn0gZGVwZW5kZW5jeUFycmF5IFRoZSBkZXBlbmRlbmN5IGFycmF5IHRoYXQgdHJpZ2dlcnMgdGhlIHN0YXR1cyBtZXNzYWdlIHNldHRlciB2aWEgdXNlRWZmZWN0LlxuICogQHBhcmFtIHt7ZG9jdW1lbnQ6IERvY3VtZW50fX0gZW52aXJvbm1lbnQgVGhlIGVudmlyb25tZW50IG9iamVjdCBjb250YWluaW5nIHRoZSBkb2N1bWVudC5cbiAqL1xuZnVuY3Rpb24gdXNlQTExeU1lc3NhZ2VTdGF0dXMoZ2V0QTExeVN0YXR1c01lc3NhZ2UsIG9wdGlvbnMsIGRlcGVuZGVuY3lBcnJheSwgZW52aXJvbm1lbnQpIHtcbiAgaWYgKGVudmlyb25tZW50ID09PSB2b2lkIDApIHtcbiAgICBlbnZpcm9ubWVudCA9IHt9O1xuICB9XG4gIHZhciBkb2N1bWVudCA9IGVudmlyb25tZW50LmRvY3VtZW50O1xuICB2YXIgaXNJbml0aWFsTW91bnQgPSB1c2VJc0luaXRpYWxNb3VudCgpO1xuXG4gIC8vIEFkZHMgYW4gYTExeSBhcmlhIGxpdmUgc3RhdHVzIG1lc3NhZ2UgaWYgZ2V0QTExeVN0YXR1c01lc3NhZ2UgaXMgcGFzc2VkLlxuICB1c2VFZmZlY3QoZnVuY3Rpb24gKCkge1xuICAgIGlmICghZ2V0QTExeVN0YXR1c01lc3NhZ2UgfHwgaXNJbml0aWFsTW91bnQgfHwgZmFsc2UgfHwgIWRvY3VtZW50KSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIHZhciBzdGF0dXMgPSBnZXRBMTF5U3RhdHVzTWVzc2FnZShvcHRpb25zKTtcbiAgICB1cGRhdGVBMTF5U3RhdHVzKHN0YXR1cywgZG9jdW1lbnQpO1xuXG4gICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIHJlYWN0LWhvb2tzL2V4aGF1c3RpdmUtZGVwc1xuICB9LCBkZXBlbmRlbmN5QXJyYXkpO1xuXG4gIC8vIENsZWFudXAgdGhlIHN0YXR1cyBtZXNzYWdlIGNvbnRhaW5lci5cbiAgdXNlRWZmZWN0KGZ1bmN0aW9uICgpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKCkge1xuICAgICAgdXBkYXRlQTExeVN0YXR1cy5jYW5jZWwoKTtcbiAgICAgIGNsZWFudXBTdGF0dXNEaXYoZG9jdW1lbnQpO1xuICAgIH07XG4gIH0sIFtkb2N1bWVudF0pO1xufVxuZnVuY3Rpb24gdXNlU2Nyb2xsSW50b1ZpZXcoX3JlZjMpIHtcbiAgdmFyIGhpZ2hsaWdodGVkSW5kZXggPSBfcmVmMy5oaWdobGlnaHRlZEluZGV4LFxuICAgIGlzT3BlbiA9IF9yZWYzLmlzT3BlbixcbiAgICBpdGVtUmVmcyA9IF9yZWYzLml0ZW1SZWZzLFxuICAgIGdldEl0ZW1Ob2RlRnJvbUluZGV4ID0gX3JlZjMuZ2V0SXRlbU5vZGVGcm9tSW5kZXgsXG4gICAgbWVudUVsZW1lbnQgPSBfcmVmMy5tZW51RWxlbWVudCxcbiAgICBzY3JvbGxJbnRvVmlld1Byb3AgPSBfcmVmMy5zY3JvbGxJbnRvVmlldztcbiAgLy8gdXNlZCBub3QgdG8gc2Nyb2xsIG9uIGhpZ2hsaWdodCBieSBtb3VzZS5cbiAgdmFyIHNob3VsZFNjcm9sbFJlZiA9IHVzZVJlZih0cnVlKTtcbiAgLy8gU2Nyb2xsIG9uIGhpZ2hsaWdodGVkIGl0ZW0gaWYgY2hhbmdlIGNvbWVzIGZyb20ga2V5Ym9hcmQuXG4gIHVzZUlzb21vcnBoaWNMYXlvdXRFZmZlY3QoZnVuY3Rpb24gKCkge1xuICAgIGlmIChoaWdobGlnaHRlZEluZGV4IDwgMCB8fCAhaXNPcGVuIHx8ICFPYmplY3Qua2V5cyhpdGVtUmVmcy5jdXJyZW50KS5sZW5ndGgpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgaWYgKHNob3VsZFNjcm9sbFJlZi5jdXJyZW50ID09PSBmYWxzZSkge1xuICAgICAgc2hvdWxkU2Nyb2xsUmVmLmN1cnJlbnQgPSB0cnVlO1xuICAgIH0gZWxzZSB7XG4gICAgICBzY3JvbGxJbnRvVmlld1Byb3AoZ2V0SXRlbU5vZGVGcm9tSW5kZXgoaGlnaGxpZ2h0ZWRJbmRleCksIG1lbnVFbGVtZW50KTtcbiAgICB9XG4gICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIHJlYWN0LWhvb2tzL2V4aGF1c3RpdmUtZGVwc1xuICB9LCBbaGlnaGxpZ2h0ZWRJbmRleF0pO1xuICByZXR1cm4gc2hvdWxkU2Nyb2xsUmVmO1xufVxuXG4vLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgaW1wb3J0L25vLW11dGFibGUtZXhwb3J0c1xudmFyIHVzZUNvbnRyb2xQcm9wc1ZhbGlkYXRvciA9IG5vb3A7XG4vKiBpc3RhbmJ1bCBpZ25vcmUgbmV4dCAqL1xuaWYgKHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSAncHJvZHVjdGlvbicpIHtcbiAgdXNlQ29udHJvbFByb3BzVmFsaWRhdG9yID0gZnVuY3Rpb24gdXNlQ29udHJvbFByb3BzVmFsaWRhdG9yKF9yZWY0KSB7XG4gICAgdmFyIHByb3BzID0gX3JlZjQucHJvcHMsXG4gICAgICBzdGF0ZSA9IF9yZWY0LnN0YXRlO1xuICAgIC8vIHVzZWQgZm9yIGNoZWNraW5nIHdoZW4gcHJvcHMgYXJlIG1vdmluZyBmcm9tIGNvbnRyb2xsZWQgdG8gdW5jb250cm9sbGVkLlxuICAgIHZhciBwcmV2UHJvcHNSZWYgPSB1c2VSZWYocHJvcHMpO1xuICAgIHZhciBpc0luaXRpYWxNb3VudCA9IHVzZUlzSW5pdGlhbE1vdW50KCk7XG4gICAgdXNlRWZmZWN0KGZ1bmN0aW9uICgpIHtcbiAgICAgIGlmIChpc0luaXRpYWxNb3VudCkge1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgICB2YWxpZGF0ZUNvbnRyb2xsZWRVbmNoYW5nZWQoc3RhdGUsIHByZXZQcm9wc1JlZi5jdXJyZW50LCBwcm9wcyk7XG4gICAgICBwcmV2UHJvcHNSZWYuY3VycmVudCA9IHByb3BzO1xuICAgIH0sIFtzdGF0ZSwgcHJvcHMsIGlzSW5pdGlhbE1vdW50XSk7XG4gIH07XG59XG5cbi8qKlxuICogSGFuZGxlcyBzZWxlY3Rpb24gb24gRW50ZXIgLyBBbHQgKyBBcnJvd1VwLiBDbG9zZXMgdGhlIG1lbnUgYW5kIHJlc2V0cyB0aGUgaGlnaGxpZ2h0ZWQgaW5kZXgsIHVubGVzcyB0aGVyZSBpcyBhIGhpZ2hsaWdodGVkLlxuICogSW4gdGhhdCBjYXNlLCBzZWxlY3RzIHRoZSBpdGVtIGFuZCByZXNldHMgdG8gZGVmYXVsdHMgZm9yIG9wZW4gc3RhdGUgYW5kIGhpZ2hsaWdodGVkIGlkZXguXG4gKiBAcGFyYW0ge09iamVjdH0gcHJvcHMgVGhlIHVzZUNvbWJvYm94IHByb3BzLlxuICogQHBhcmFtIHtudW1iZXJ9IGhpZ2hsaWdodGVkSW5kZXggVGhlIGluZGV4IGZyb20gdGhlIHN0YXRlLlxuICogQHBhcmFtIHtib29sZWFufSBpbnB1dFZhbHVlIEFsc28gcmV0dXJuIHRoZSBpbnB1dCB2YWx1ZSBmb3Igc3RhdGUuXG4gKiBAcmV0dXJucyBUaGUgY2hhbmdlcyBmb3IgdGhlIHN0YXRlLlxuICovXG5mdW5jdGlvbiBnZXRDaGFuZ2VzT25TZWxlY3Rpb24ocHJvcHMsIGhpZ2hsaWdodGVkSW5kZXgsIGlucHV0VmFsdWUpIHtcbiAgdmFyIF9wcm9wcyRpdGVtcztcbiAgaWYgKGlucHV0VmFsdWUgPT09IHZvaWQgMCkge1xuICAgIGlucHV0VmFsdWUgPSB0cnVlO1xuICB9XG4gIHZhciBzaG91bGRTZWxlY3QgPSAoKF9wcm9wcyRpdGVtcyA9IHByb3BzLml0ZW1zKSA9PSBudWxsID8gdm9pZCAwIDogX3Byb3BzJGl0ZW1zLmxlbmd0aCkgJiYgaGlnaGxpZ2h0ZWRJbmRleCA+PSAwO1xuICByZXR1cm4gX2V4dGVuZHMoe1xuICAgIGlzT3BlbjogZmFsc2UsXG4gICAgaGlnaGxpZ2h0ZWRJbmRleDogLTFcbiAgfSwgc2hvdWxkU2VsZWN0ICYmIF9leHRlbmRzKHtcbiAgICBzZWxlY3RlZEl0ZW06IHByb3BzLml0ZW1zW2hpZ2hsaWdodGVkSW5kZXhdLFxuICAgIGlzT3BlbjogZ2V0RGVmYXVsdFZhbHVlJDEocHJvcHMsICdpc09wZW4nKSxcbiAgICBoaWdobGlnaHRlZEluZGV4OiBnZXREZWZhdWx0VmFsdWUkMShwcm9wcywgJ2hpZ2hsaWdodGVkSW5kZXgnKVxuICB9LCBpbnB1dFZhbHVlICYmIHtcbiAgICBpbnB1dFZhbHVlOiBwcm9wcy5pdGVtVG9TdHJpbmcocHJvcHMuaXRlbXNbaGlnaGxpZ2h0ZWRJbmRleF0pXG4gIH0pKTtcbn1cblxuLyoqXG4gKiBDaGVjayBpZiBhIHN0YXRlIGlzIGVxdWFsIGZvciBkcm9wZG93bnMsIGJ5IGNvbXBhcmluZyBpc09wZW4sIGlucHV0VmFsdWUsIGhpZ2hsaWdodGVkSW5kZXggYW5kIHNlbGVjdGVkIGl0ZW0uXG4gKiBVc2VkIGJ5IHVzZVNlbGVjdCBhbmQgdXNlQ29tYm9ib3guXG4gKlxuICogQHBhcmFtIHtPYmplY3R9IHByZXZTdGF0ZVxuICogQHBhcmFtIHtPYmplY3R9IG5ld1N0YXRlXG4gKiBAcmV0dXJucyB7Ym9vbGVhbn0gV2hlYXRoZXIgdGhlIHN0YXRlcyBhcmUgZGVlcGx5IGVxdWFsLlxuICovXG5mdW5jdGlvbiBpc0Ryb3Bkb3duc1N0YXRlRXF1YWwocHJldlN0YXRlLCBuZXdTdGF0ZSkge1xuICByZXR1cm4gcHJldlN0YXRlLmlzT3BlbiA9PT0gbmV3U3RhdGUuaXNPcGVuICYmIHByZXZTdGF0ZS5pbnB1dFZhbHVlID09PSBuZXdTdGF0ZS5pbnB1dFZhbHVlICYmIHByZXZTdGF0ZS5oaWdobGlnaHRlZEluZGV4ID09PSBuZXdTdGF0ZS5oaWdobGlnaHRlZEluZGV4ICYmIHByZXZTdGF0ZS5zZWxlY3RlZEl0ZW0gPT09IG5ld1N0YXRlLnNlbGVjdGVkSXRlbTtcbn1cblxuLyoqXG4gKiBUcmFja3MgaWYgaXQncyB0aGUgZmlyc3QgcmVuZGVyLlxuICovXG5mdW5jdGlvbiB1c2VJc0luaXRpYWxNb3VudCgpIHtcbiAgdmFyIGlzSW5pdGlhbE1vdW50UmVmID0gUmVhY3QudXNlUmVmKHRydWUpO1xuICBSZWFjdC51c2VFZmZlY3QoZnVuY3Rpb24gKCkge1xuICAgIGlzSW5pdGlhbE1vdW50UmVmLmN1cnJlbnQgPSBmYWxzZTtcbiAgICByZXR1cm4gZnVuY3Rpb24gKCkge1xuICAgICAgaXNJbml0aWFsTW91bnRSZWYuY3VycmVudCA9IHRydWU7XG4gICAgfTtcbiAgfSwgW10pO1xuICByZXR1cm4gaXNJbml0aWFsTW91bnRSZWYuY3VycmVudDtcbn1cblxuLyoqXG4gKiBSZXR1cm5zIHRoZSBuZXcgaGlnaGxpZ2h0ZWRJbmRleCBiYXNlZCBvbiB0aGUgZGVmYXVsdEhpZ2hsaWdodGVkSW5kZXggcHJvcCwgaWYgaXQncyBub3QgZGlzYWJsZWQuXG4gKlxuICogQHBhcmFtIHtPYmplY3R9IHByb3BzIFByb3BzIGZyb20gdXNlQ29tYm9ib3ggb3IgdXNlU2VsZWN0LlxuICogQHJldHVybnMge251bWJlcn0gVGhlIGhpZ2hsaWdodGVkIGluZGV4LlxuICovXG5mdW5jdGlvbiBnZXREZWZhdWx0SGlnaGxpZ2h0ZWRJbmRleChwcm9wcykge1xuICB2YXIgaGlnaGxpZ2h0ZWRJbmRleCA9IGdldERlZmF1bHRWYWx1ZSQxKHByb3BzLCAnaGlnaGxpZ2h0ZWRJbmRleCcpO1xuICBpZiAoaGlnaGxpZ2h0ZWRJbmRleCA+IC0xICYmIHByb3BzLmlzSXRlbURpc2FibGVkKHByb3BzLml0ZW1zW2hpZ2hsaWdodGVkSW5kZXhdLCBoaWdobGlnaHRlZEluZGV4KSkge1xuICAgIHJldHVybiAtMTtcbiAgfVxuICByZXR1cm4gaGlnaGxpZ2h0ZWRJbmRleDtcbn1cblxuLyoqXG4gKiBSZXR1cm5zIHRoZSBuZXcgaGlnaGxpZ2h0ZWRJbmRleCBiYXNlZCBvbiB0aGUgaW5pdGlhbEhpZ2hsaWdodGVkSW5kZXggcHJvcCwgaWYgbm90IGRpc2FibGVkLlxuICpcbiAqIEBwYXJhbSB7T2JqZWN0fSBwcm9wcyBQcm9wcyBmcm9tIHVzZUNvbWJvYm94IG9yIHVzZVNlbGVjdC5cbiAqIEByZXR1cm5zIHtudW1iZXJ9IFRoZSBoaWdobGlnaHRlZCBpbmRleC5cbiAqL1xuZnVuY3Rpb24gZ2V0SW5pdGlhbEhpZ2hsaWdodGVkSW5kZXgocHJvcHMpIHtcbiAgdmFyIGhpZ2hsaWdodGVkSW5kZXggPSBnZXRJbml0aWFsVmFsdWUkMShwcm9wcywgJ2hpZ2hsaWdodGVkSW5kZXgnKTtcbiAgaWYgKGhpZ2hsaWdodGVkSW5kZXggPiAtMSAmJiBwcm9wcy5pc0l0ZW1EaXNhYmxlZChwcm9wcy5pdGVtc1toaWdobGlnaHRlZEluZGV4XSwgaGlnaGxpZ2h0ZWRJbmRleCkpIHtcbiAgICByZXR1cm4gLTE7XG4gIH1cbiAgcmV0dXJuIGhpZ2hsaWdodGVkSW5kZXg7XG59XG5cbi8vIFNoYXJlZCBiZXR3ZWVuIGFsbCBleHBvcnRzLlxudmFyIGNvbW1vblByb3BUeXBlcyA9IHtcbiAgZW52aXJvbm1lbnQ6IFByb3BUeXBlcy5zaGFwZSh7XG4gICAgYWRkRXZlbnRMaXN0ZW5lcjogUHJvcFR5cGVzLmZ1bmMuaXNSZXF1aXJlZCxcbiAgICByZW1vdmVFdmVudExpc3RlbmVyOiBQcm9wVHlwZXMuZnVuYy5pc1JlcXVpcmVkLFxuICAgIGRvY3VtZW50OiBQcm9wVHlwZXMuc2hhcGUoe1xuICAgICAgY3JlYXRlRWxlbWVudDogUHJvcFR5cGVzLmZ1bmMuaXNSZXF1aXJlZCxcbiAgICAgIGdldEVsZW1lbnRCeUlkOiBQcm9wVHlwZXMuZnVuYy5pc1JlcXVpcmVkLFxuICAgICAgYWN0aXZlRWxlbWVudDogUHJvcFR5cGVzLmFueS5pc1JlcXVpcmVkLFxuICAgICAgYm9keTogUHJvcFR5cGVzLmFueS5pc1JlcXVpcmVkXG4gICAgfSkuaXNSZXF1aXJlZCxcbiAgICBOb2RlOiBQcm9wVHlwZXMuZnVuYy5pc1JlcXVpcmVkXG4gIH0pLFxuICBpdGVtVG9TdHJpbmc6IFByb3BUeXBlcy5mdW5jLFxuICBpdGVtVG9LZXk6IFByb3BUeXBlcy5mdW5jLFxuICBzdGF0ZVJlZHVjZXI6IFByb3BUeXBlcy5mdW5jXG59O1xuXG4vLyBTaGFyZWQgYmV0d2VlbiB1c2VTZWxlY3QsIHVzZUNvbWJvYm94LCBEb3duc2hpZnQuXG52YXIgY29tbW9uRHJvcGRvd25Qcm9wVHlwZXMgPSBfZXh0ZW5kcyh7fSwgY29tbW9uUHJvcFR5cGVzLCB7XG4gIGdldEExMXlTdGF0dXNNZXNzYWdlOiBQcm9wVHlwZXMuZnVuYyxcbiAgaGlnaGxpZ2h0ZWRJbmRleDogUHJvcFR5cGVzLm51bWJlcixcbiAgZGVmYXVsdEhpZ2hsaWdodGVkSW5kZXg6IFByb3BUeXBlcy5udW1iZXIsXG4gIGluaXRpYWxIaWdobGlnaHRlZEluZGV4OiBQcm9wVHlwZXMubnVtYmVyLFxuICBpc09wZW46IFByb3BUeXBlcy5ib29sLFxuICBkZWZhdWx0SXNPcGVuOiBQcm9wVHlwZXMuYm9vbCxcbiAgaW5pdGlhbElzT3BlbjogUHJvcFR5cGVzLmJvb2wsXG4gIHNlbGVjdGVkSXRlbTogUHJvcFR5cGVzLmFueSxcbiAgaW5pdGlhbFNlbGVjdGVkSXRlbTogUHJvcFR5cGVzLmFueSxcbiAgZGVmYXVsdFNlbGVjdGVkSXRlbTogUHJvcFR5cGVzLmFueSxcbiAgaWQ6IFByb3BUeXBlcy5zdHJpbmcsXG4gIGxhYmVsSWQ6IFByb3BUeXBlcy5zdHJpbmcsXG4gIG1lbnVJZDogUHJvcFR5cGVzLnN0cmluZyxcbiAgZ2V0SXRlbUlkOiBQcm9wVHlwZXMuZnVuYyxcbiAgdG9nZ2xlQnV0dG9uSWQ6IFByb3BUeXBlcy5zdHJpbmcsXG4gIG9uU2VsZWN0ZWRJdGVtQ2hhbmdlOiBQcm9wVHlwZXMuZnVuYyxcbiAgb25IaWdobGlnaHRlZEluZGV4Q2hhbmdlOiBQcm9wVHlwZXMuZnVuYyxcbiAgb25TdGF0ZUNoYW5nZTogUHJvcFR5cGVzLmZ1bmMsXG4gIG9uSXNPcGVuQ2hhbmdlOiBQcm9wVHlwZXMuZnVuYyxcbiAgc2Nyb2xsSW50b1ZpZXc6IFByb3BUeXBlcy5mdW5jXG59KTtcblxuZnVuY3Rpb24gZG93bnNoaWZ0Q29tbW9uUmVkdWNlcihzdGF0ZSwgYWN0aW9uLCBzdGF0ZUNoYW5nZVR5cGVzKSB7XG4gIHZhciB0eXBlID0gYWN0aW9uLnR5cGUsXG4gICAgcHJvcHMgPSBhY3Rpb24ucHJvcHM7XG4gIHZhciBjaGFuZ2VzO1xuICBzd2l0Y2ggKHR5cGUpIHtcbiAgICBjYXNlIHN0YXRlQ2hhbmdlVHlwZXMuSXRlbU1vdXNlTW92ZTpcbiAgICAgIGNoYW5nZXMgPSB7XG4gICAgICAgIGhpZ2hsaWdodGVkSW5kZXg6IGFjdGlvbi5kaXNhYmxlZCA/IC0xIDogYWN0aW9uLmluZGV4XG4gICAgICB9O1xuICAgICAgYnJlYWs7XG4gICAgY2FzZSBzdGF0ZUNoYW5nZVR5cGVzLk1lbnVNb3VzZUxlYXZlOlxuICAgICAgY2hhbmdlcyA9IHtcbiAgICAgICAgaGlnaGxpZ2h0ZWRJbmRleDogLTFcbiAgICAgIH07XG4gICAgICBicmVhaztcbiAgICBjYXNlIHN0YXRlQ2hhbmdlVHlwZXMuVG9nZ2xlQnV0dG9uQ2xpY2s6XG4gICAgY2FzZSBzdGF0ZUNoYW5nZVR5cGVzLkZ1bmN0aW9uVG9nZ2xlTWVudTpcbiAgICAgIGNoYW5nZXMgPSB7XG4gICAgICAgIGlzT3BlbjogIXN0YXRlLmlzT3BlbixcbiAgICAgICAgaGlnaGxpZ2h0ZWRJbmRleDogc3RhdGUuaXNPcGVuID8gLTEgOiBnZXRIaWdobGlnaHRlZEluZGV4T25PcGVuKHByb3BzLCBzdGF0ZSwgMClcbiAgICAgIH07XG4gICAgICBicmVhaztcbiAgICBjYXNlIHN0YXRlQ2hhbmdlVHlwZXMuRnVuY3Rpb25PcGVuTWVudTpcbiAgICAgIGNoYW5nZXMgPSB7XG4gICAgICAgIGlzT3BlbjogdHJ1ZSxcbiAgICAgICAgaGlnaGxpZ2h0ZWRJbmRleDogZ2V0SGlnaGxpZ2h0ZWRJbmRleE9uT3Blbihwcm9wcywgc3RhdGUsIDApXG4gICAgICB9O1xuICAgICAgYnJlYWs7XG4gICAgY2FzZSBzdGF0ZUNoYW5nZVR5cGVzLkZ1bmN0aW9uQ2xvc2VNZW51OlxuICAgICAgY2hhbmdlcyA9IHtcbiAgICAgICAgaXNPcGVuOiBmYWxzZVxuICAgICAgfTtcbiAgICAgIGJyZWFrO1xuICAgIGNhc2Ugc3RhdGVDaGFuZ2VUeXBlcy5GdW5jdGlvblNldEhpZ2hsaWdodGVkSW5kZXg6XG4gICAgICBjaGFuZ2VzID0ge1xuICAgICAgICBoaWdobGlnaHRlZEluZGV4OiBwcm9wcy5pc0l0ZW1EaXNhYmxlZChwcm9wcy5pdGVtc1thY3Rpb24uaGlnaGxpZ2h0ZWRJbmRleF0sIGFjdGlvbi5oaWdobGlnaHRlZEluZGV4KSA/IC0xIDogYWN0aW9uLmhpZ2hsaWdodGVkSW5kZXhcbiAgICAgIH07XG4gICAgICBicmVhaztcbiAgICBjYXNlIHN0YXRlQ2hhbmdlVHlwZXMuRnVuY3Rpb25TZXRJbnB1dFZhbHVlOlxuICAgICAgY2hhbmdlcyA9IHtcbiAgICAgICAgaW5wdXRWYWx1ZTogYWN0aW9uLmlucHV0VmFsdWVcbiAgICAgIH07XG4gICAgICBicmVhaztcbiAgICBjYXNlIHN0YXRlQ2hhbmdlVHlwZXMuRnVuY3Rpb25SZXNldDpcbiAgICAgIGNoYW5nZXMgPSB7XG4gICAgICAgIGhpZ2hsaWdodGVkSW5kZXg6IGdldERlZmF1bHRIaWdobGlnaHRlZEluZGV4KHByb3BzKSxcbiAgICAgICAgaXNPcGVuOiBnZXREZWZhdWx0VmFsdWUkMShwcm9wcywgJ2lzT3BlbicpLFxuICAgICAgICBzZWxlY3RlZEl0ZW06IGdldERlZmF1bHRWYWx1ZSQxKHByb3BzLCAnc2VsZWN0ZWRJdGVtJyksXG4gICAgICAgIGlucHV0VmFsdWU6IGdldERlZmF1bHRWYWx1ZSQxKHByb3BzLCAnaW5wdXRWYWx1ZScpXG4gICAgICB9O1xuICAgICAgYnJlYWs7XG4gICAgZGVmYXVsdDpcbiAgICAgIHRocm93IG5ldyBFcnJvcignUmVkdWNlciBjYWxsZWQgd2l0aG91dCBwcm9wZXIgYWN0aW9uIHR5cGUuJyk7XG4gIH1cbiAgcmV0dXJuIF9leHRlbmRzKHt9LCBzdGF0ZSwgY2hhbmdlcyk7XG59XG4vKiBlc2xpbnQtZW5hYmxlIGNvbXBsZXhpdHkgKi9cblxuZnVuY3Rpb24gZ2V0SXRlbUluZGV4QnlDaGFyYWN0ZXJLZXkoX2EpIHtcbiAgICB2YXIga2V5c1NvRmFyID0gX2Eua2V5c1NvRmFyLCBoaWdobGlnaHRlZEluZGV4ID0gX2EuaGlnaGxpZ2h0ZWRJbmRleCwgaXRlbXMgPSBfYS5pdGVtcywgaXRlbVRvU3RyaW5nID0gX2EuaXRlbVRvU3RyaW5nLCBpc0l0ZW1EaXNhYmxlZCA9IF9hLmlzSXRlbURpc2FibGVkO1xuICAgIHZhciBsb3dlckNhc2VkS2V5c1NvRmFyID0ga2V5c1NvRmFyLnRvTG93ZXJDYXNlKCk7XG4gICAgZm9yICh2YXIgaW5kZXggPSAwOyBpbmRleCA8IGl0ZW1zLmxlbmd0aDsgaW5kZXgrKykge1xuICAgICAgICAvLyBpZiB3ZSBhbHJlYWR5IGhhdmUgYSBzZWFyY2ggcXVlcnkgaW4gcHJvZ3Jlc3MsIHdlIGFsc28gY29uc2lkZXIgdGhlIGN1cnJlbnQgaGlnaGxpZ2h0ZWQgaXRlbS5cbiAgICAgICAgdmFyIG9mZnNldEluZGV4ID0gKGluZGV4ICsgaGlnaGxpZ2h0ZWRJbmRleCArIChrZXlzU29GYXIubGVuZ3RoIDwgMiA/IDEgOiAwKSkgJSBpdGVtcy5sZW5ndGg7XG4gICAgICAgIHZhciBpdGVtID0gaXRlbXNbb2Zmc2V0SW5kZXhdO1xuICAgICAgICBpZiAoaXRlbSAhPT0gdW5kZWZpbmVkICYmXG4gICAgICAgICAgICBpdGVtVG9TdHJpbmcoaXRlbSkudG9Mb3dlckNhc2UoKS5zdGFydHNXaXRoKGxvd2VyQ2FzZWRLZXlzU29GYXIpICYmXG4gICAgICAgICAgICAhaXNJdGVtRGlzYWJsZWQoaXRlbSwgb2Zmc2V0SW5kZXgpKSB7XG4gICAgICAgICAgICByZXR1cm4gb2Zmc2V0SW5kZXg7XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIGhpZ2hsaWdodGVkSW5kZXg7XG59XG52YXIgcHJvcFR5cGVzJDIgPSBfX2Fzc2lnbihfX2Fzc2lnbih7fSwgY29tbW9uRHJvcGRvd25Qcm9wVHlwZXMpLCB7IGl0ZW1zOiBQcm9wVHlwZXMuYXJyYXkuaXNSZXF1aXJlZCwgaXNJdGVtRGlzYWJsZWQ6IFByb3BUeXBlcy5mdW5jIH0pO1xudmFyIGRlZmF1bHRQcm9wcyQyID0gX19hc3NpZ24oX19hc3NpZ24oe30sIGRlZmF1bHRQcm9wcyQzKSwgeyBpc0l0ZW1EaXNhYmxlZDogZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfSB9KTtcbi8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBpbXBvcnQvbm8tbXV0YWJsZS1leHBvcnRzXG52YXIgdmFsaWRhdGVQcm9wVHlwZXMkMiA9IG5vb3A7XG4vKiBpc3RhbmJ1bCBpZ25vcmUgbmV4dCAqL1xuaWYgKHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSAncHJvZHVjdGlvbicpIHtcbiAgICB2YWxpZGF0ZVByb3BUeXBlcyQyID0gZnVuY3Rpb24gKG9wdGlvbnMsIGNhbGxlcikge1xuICAgICAgICBQcm9wVHlwZXMuY2hlY2tQcm9wVHlwZXMocHJvcFR5cGVzJDIsIG9wdGlvbnMsICdwcm9wJywgY2FsbGVyLm5hbWUpO1xuICAgIH07XG59XG5cbnZhciBUb2dnbGVCdXR0b25DbGljayQxID0gcHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09IFwicHJvZHVjdGlvblwiID8gJ19fdG9nZ2xlYnV0dG9uX2NsaWNrX18nIDogMDtcbnZhciBUb2dnbGVCdXR0b25LZXlEb3duQXJyb3dEb3duID0gcHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09IFwicHJvZHVjdGlvblwiID8gJ19fdG9nZ2xlYnV0dG9uX2tleWRvd25fYXJyb3dfZG93bl9fJyA6IDE7XG52YXIgVG9nZ2xlQnV0dG9uS2V5RG93bkFycm93VXAgPSBwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gXCJwcm9kdWN0aW9uXCIgPyAnX190b2dnbGVidXR0b25fa2V5ZG93bl9hcnJvd191cF9fJyA6IDI7XG52YXIgVG9nZ2xlQnV0dG9uS2V5RG93bkNoYXJhY3RlciA9IHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSBcInByb2R1Y3Rpb25cIiA/ICdfX3RvZ2dsZWJ1dHRvbl9rZXlkb3duX2NoYXJhY3Rlcl9fJyA6IDM7XG52YXIgVG9nZ2xlQnV0dG9uS2V5RG93bkVzY2FwZSA9IHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSBcInByb2R1Y3Rpb25cIiA/ICdfX3RvZ2dsZWJ1dHRvbl9rZXlkb3duX2VzY2FwZV9fJyA6IDQ7XG52YXIgVG9nZ2xlQnV0dG9uS2V5RG93bkhvbWUgPSBwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gXCJwcm9kdWN0aW9uXCIgPyAnX190b2dnbGVidXR0b25fa2V5ZG93bl9ob21lX18nIDogNTtcbnZhciBUb2dnbGVCdXR0b25LZXlEb3duRW5kID0gcHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09IFwicHJvZHVjdGlvblwiID8gJ19fdG9nZ2xlYnV0dG9uX2tleWRvd25fZW5kX18nIDogNjtcbnZhciBUb2dnbGVCdXR0b25LZXlEb3duRW50ZXIgPSBwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gXCJwcm9kdWN0aW9uXCIgPyAnX190b2dnbGVidXR0b25fa2V5ZG93bl9lbnRlcl9fJyA6IDc7XG52YXIgVG9nZ2xlQnV0dG9uS2V5RG93blNwYWNlQnV0dG9uID0gcHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09IFwicHJvZHVjdGlvblwiID8gJ19fdG9nZ2xlYnV0dG9uX2tleWRvd25fc3BhY2VfYnV0dG9uX18nIDogODtcbnZhciBUb2dnbGVCdXR0b25LZXlEb3duUGFnZVVwID0gcHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09IFwicHJvZHVjdGlvblwiID8gJ19fdG9nZ2xlYnV0dG9uX2tleWRvd25fcGFnZV91cF9fJyA6IDk7XG52YXIgVG9nZ2xlQnV0dG9uS2V5RG93blBhZ2VEb3duID0gcHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09IFwicHJvZHVjdGlvblwiID8gJ19fdG9nZ2xlYnV0dG9uX2tleWRvd25fcGFnZV9kb3duX18nIDogMTA7XG52YXIgVG9nZ2xlQnV0dG9uQmx1ciA9IHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSBcInByb2R1Y3Rpb25cIiA/ICdfX3RvZ2dsZWJ1dHRvbl9ibHVyX18nIDogMTE7XG52YXIgTWVudU1vdXNlTGVhdmUkMSA9IHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSBcInByb2R1Y3Rpb25cIiA/ICdfX21lbnVfbW91c2VfbGVhdmVfXycgOiAxMjtcbnZhciBJdGVtTW91c2VNb3ZlJDEgPSBwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gXCJwcm9kdWN0aW9uXCIgPyAnX19pdGVtX21vdXNlX21vdmVfXycgOiAxMztcbnZhciBJdGVtQ2xpY2skMSA9IHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSBcInByb2R1Y3Rpb25cIiA/ICdfX2l0ZW1fY2xpY2tfXycgOiAxNDtcbnZhciBGdW5jdGlvblRvZ2dsZU1lbnUkMSA9IHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSBcInByb2R1Y3Rpb25cIiA/ICdfX2Z1bmN0aW9uX3RvZ2dsZV9tZW51X18nIDogMTU7XG52YXIgRnVuY3Rpb25PcGVuTWVudSQxID0gcHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09IFwicHJvZHVjdGlvblwiID8gJ19fZnVuY3Rpb25fb3Blbl9tZW51X18nIDogMTY7XG52YXIgRnVuY3Rpb25DbG9zZU1lbnUkMSA9IHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSBcInByb2R1Y3Rpb25cIiA/ICdfX2Z1bmN0aW9uX2Nsb3NlX21lbnVfXycgOiAxNztcbnZhciBGdW5jdGlvblNldEhpZ2hsaWdodGVkSW5kZXgkMSA9IHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSBcInByb2R1Y3Rpb25cIiA/ICdfX2Z1bmN0aW9uX3NldF9oaWdobGlnaHRlZF9pbmRleF9fJyA6IDE4O1xudmFyIEZ1bmN0aW9uU2VsZWN0SXRlbSQxID0gcHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09IFwicHJvZHVjdGlvblwiID8gJ19fZnVuY3Rpb25fc2VsZWN0X2l0ZW1fXycgOiAxOTtcbnZhciBGdW5jdGlvblNldElucHV0VmFsdWUkMSA9IHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSBcInByb2R1Y3Rpb25cIiA/ICdfX2Z1bmN0aW9uX3NldF9pbnB1dF92YWx1ZV9fJyA6IDIwO1xudmFyIEZ1bmN0aW9uUmVzZXQkMiA9IHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSBcInByb2R1Y3Rpb25cIiA/ICdfX2Z1bmN0aW9uX3Jlc2V0X18nIDogMjE7XG5cbnZhciBzdGF0ZUNoYW5nZVR5cGVzJDIgPSAvKiNfX1BVUkVfXyovT2JqZWN0LmZyZWV6ZSh7XG4gIF9fcHJvdG9fXzogbnVsbCxcbiAgRnVuY3Rpb25DbG9zZU1lbnU6IEZ1bmN0aW9uQ2xvc2VNZW51JDEsXG4gIEZ1bmN0aW9uT3Blbk1lbnU6IEZ1bmN0aW9uT3Blbk1lbnUkMSxcbiAgRnVuY3Rpb25SZXNldDogRnVuY3Rpb25SZXNldCQyLFxuICBGdW5jdGlvblNlbGVjdEl0ZW06IEZ1bmN0aW9uU2VsZWN0SXRlbSQxLFxuICBGdW5jdGlvblNldEhpZ2hsaWdodGVkSW5kZXg6IEZ1bmN0aW9uU2V0SGlnaGxpZ2h0ZWRJbmRleCQxLFxuICBGdW5jdGlvblNldElucHV0VmFsdWU6IEZ1bmN0aW9uU2V0SW5wdXRWYWx1ZSQxLFxuICBGdW5jdGlvblRvZ2dsZU1lbnU6IEZ1bmN0aW9uVG9nZ2xlTWVudSQxLFxuICBJdGVtQ2xpY2s6IEl0ZW1DbGljayQxLFxuICBJdGVtTW91c2VNb3ZlOiBJdGVtTW91c2VNb3ZlJDEsXG4gIE1lbnVNb3VzZUxlYXZlOiBNZW51TW91c2VMZWF2ZSQxLFxuICBUb2dnbGVCdXR0b25CbHVyOiBUb2dnbGVCdXR0b25CbHVyLFxuICBUb2dnbGVCdXR0b25DbGljazogVG9nZ2xlQnV0dG9uQ2xpY2skMSxcbiAgVG9nZ2xlQnV0dG9uS2V5RG93bkFycm93RG93bjogVG9nZ2xlQnV0dG9uS2V5RG93bkFycm93RG93bixcbiAgVG9nZ2xlQnV0dG9uS2V5RG93bkFycm93VXA6IFRvZ2dsZUJ1dHRvbktleURvd25BcnJvd1VwLFxuICBUb2dnbGVCdXR0b25LZXlEb3duQ2hhcmFjdGVyOiBUb2dnbGVCdXR0b25LZXlEb3duQ2hhcmFjdGVyLFxuICBUb2dnbGVCdXR0b25LZXlEb3duRW5kOiBUb2dnbGVCdXR0b25LZXlEb3duRW5kLFxuICBUb2dnbGVCdXR0b25LZXlEb3duRW50ZXI6IFRvZ2dsZUJ1dHRvbktleURvd25FbnRlcixcbiAgVG9nZ2xlQnV0dG9uS2V5RG93bkVzY2FwZTogVG9nZ2xlQnV0dG9uS2V5RG93bkVzY2FwZSxcbiAgVG9nZ2xlQnV0dG9uS2V5RG93bkhvbWU6IFRvZ2dsZUJ1dHRvbktleURvd25Ib21lLFxuICBUb2dnbGVCdXR0b25LZXlEb3duUGFnZURvd246IFRvZ2dsZUJ1dHRvbktleURvd25QYWdlRG93bixcbiAgVG9nZ2xlQnV0dG9uS2V5RG93blBhZ2VVcDogVG9nZ2xlQnV0dG9uS2V5RG93blBhZ2VVcCxcbiAgVG9nZ2xlQnV0dG9uS2V5RG93blNwYWNlQnV0dG9uOiBUb2dnbGVCdXR0b25LZXlEb3duU3BhY2VCdXR0b25cbn0pO1xuXG4vKiBlc2xpbnQtZGlzYWJsZSBjb21wbGV4aXR5ICovXG5mdW5jdGlvbiBkb3duc2hpZnRTZWxlY3RSZWR1Y2VyKHN0YXRlLCBhY3Rpb24pIHtcbiAgdmFyIF9wcm9wcyRpdGVtcztcbiAgdmFyIHR5cGUgPSBhY3Rpb24udHlwZSxcbiAgICBwcm9wcyA9IGFjdGlvbi5wcm9wcyxcbiAgICBhbHRLZXkgPSBhY3Rpb24uYWx0S2V5O1xuICB2YXIgY2hhbmdlcztcbiAgc3dpdGNoICh0eXBlKSB7XG4gICAgY2FzZSBJdGVtQ2xpY2skMTpcbiAgICAgIGNoYW5nZXMgPSB7XG4gICAgICAgIGlzT3BlbjogZ2V0RGVmYXVsdFZhbHVlJDEocHJvcHMsICdpc09wZW4nKSxcbiAgICAgICAgaGlnaGxpZ2h0ZWRJbmRleDogZ2V0RGVmYXVsdEhpZ2hsaWdodGVkSW5kZXgocHJvcHMpLFxuICAgICAgICBzZWxlY3RlZEl0ZW06IHByb3BzLml0ZW1zW2FjdGlvbi5pbmRleF1cbiAgICAgIH07XG4gICAgICBicmVhaztcbiAgICBjYXNlIFRvZ2dsZUJ1dHRvbktleURvd25DaGFyYWN0ZXI6XG4gICAgICB7XG4gICAgICAgIHZhciBsb3dlcmNhc2VkS2V5ID0gYWN0aW9uLmtleTtcbiAgICAgICAgdmFyIGlucHV0VmFsdWUgPSBcIlwiICsgc3RhdGUuaW5wdXRWYWx1ZSArIGxvd2VyY2FzZWRLZXk7XG4gICAgICAgIHZhciBwcmV2SGlnaGxpZ2h0ZWRJbmRleCA9ICFzdGF0ZS5pc09wZW4gJiYgc3RhdGUuc2VsZWN0ZWRJdGVtID8gcHJvcHMuaXRlbXMuZmluZEluZGV4KGZ1bmN0aW9uIChpdGVtKSB7XG4gICAgICAgICAgcmV0dXJuIHByb3BzLml0ZW1Ub0tleShpdGVtKSA9PT0gcHJvcHMuaXRlbVRvS2V5KHN0YXRlLnNlbGVjdGVkSXRlbSk7XG4gICAgICAgIH0pIDogc3RhdGUuaGlnaGxpZ2h0ZWRJbmRleDtcbiAgICAgICAgdmFyIGhpZ2hsaWdodGVkSW5kZXggPSBnZXRJdGVtSW5kZXhCeUNoYXJhY3RlcktleSh7XG4gICAgICAgICAga2V5c1NvRmFyOiBpbnB1dFZhbHVlLFxuICAgICAgICAgIGhpZ2hsaWdodGVkSW5kZXg6IHByZXZIaWdobGlnaHRlZEluZGV4LFxuICAgICAgICAgIGl0ZW1zOiBwcm9wcy5pdGVtcyxcbiAgICAgICAgICBpdGVtVG9TdHJpbmc6IHByb3BzLml0ZW1Ub1N0cmluZyxcbiAgICAgICAgICBpc0l0ZW1EaXNhYmxlZDogcHJvcHMuaXNJdGVtRGlzYWJsZWRcbiAgICAgICAgfSk7XG4gICAgICAgIGNoYW5nZXMgPSB7XG4gICAgICAgICAgaW5wdXRWYWx1ZTogaW5wdXRWYWx1ZSxcbiAgICAgICAgICBoaWdobGlnaHRlZEluZGV4OiBoaWdobGlnaHRlZEluZGV4LFxuICAgICAgICAgIGlzT3BlbjogdHJ1ZVxuICAgICAgICB9O1xuICAgICAgfVxuICAgICAgYnJlYWs7XG4gICAgY2FzZSBUb2dnbGVCdXR0b25LZXlEb3duQXJyb3dEb3duOlxuICAgICAge1xuICAgICAgICB2YXIgX2hpZ2hsaWdodGVkSW5kZXggPSBzdGF0ZS5pc09wZW4gPyBnZXRIaWdobGlnaHRlZEluZGV4KHN0YXRlLmhpZ2hsaWdodGVkSW5kZXgsIDEsIHByb3BzLml0ZW1zLCBwcm9wcy5pc0l0ZW1EaXNhYmxlZCkgOiBhbHRLZXkgJiYgc3RhdGUuc2VsZWN0ZWRJdGVtID09IG51bGwgPyAtMSA6IGdldEhpZ2hsaWdodGVkSW5kZXhPbk9wZW4ocHJvcHMsIHN0YXRlLCAxKTtcbiAgICAgICAgY2hhbmdlcyA9IHtcbiAgICAgICAgICBoaWdobGlnaHRlZEluZGV4OiBfaGlnaGxpZ2h0ZWRJbmRleCxcbiAgICAgICAgICBpc09wZW46IHRydWVcbiAgICAgICAgfTtcbiAgICAgIH1cbiAgICAgIGJyZWFrO1xuICAgIGNhc2UgVG9nZ2xlQnV0dG9uS2V5RG93bkFycm93VXA6XG4gICAgICBpZiAoc3RhdGUuaXNPcGVuICYmIGFsdEtleSkge1xuICAgICAgICBjaGFuZ2VzID0gZ2V0Q2hhbmdlc09uU2VsZWN0aW9uKHByb3BzLCBzdGF0ZS5oaWdobGlnaHRlZEluZGV4LCBmYWxzZSk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICB2YXIgX2hpZ2hsaWdodGVkSW5kZXgyID0gc3RhdGUuaXNPcGVuID8gZ2V0SGlnaGxpZ2h0ZWRJbmRleChzdGF0ZS5oaWdobGlnaHRlZEluZGV4LCAtMSwgcHJvcHMuaXRlbXMsIHByb3BzLmlzSXRlbURpc2FibGVkKSA6IGdldEhpZ2hsaWdodGVkSW5kZXhPbk9wZW4ocHJvcHMsIHN0YXRlLCAtMSk7XG4gICAgICAgIGNoYW5nZXMgPSB7XG4gICAgICAgICAgaGlnaGxpZ2h0ZWRJbmRleDogX2hpZ2hsaWdodGVkSW5kZXgyLFxuICAgICAgICAgIGlzT3BlbjogdHJ1ZVxuICAgICAgICB9O1xuICAgICAgfVxuICAgICAgYnJlYWs7XG4gICAgLy8gb25seSB0cmlnZ2VyZWQgd2hlbiBtZW51IGlzIG9wZW4uXG4gICAgY2FzZSBUb2dnbGVCdXR0b25LZXlEb3duRW50ZXI6XG4gICAgY2FzZSBUb2dnbGVCdXR0b25LZXlEb3duU3BhY2VCdXR0b246XG4gICAgICBjaGFuZ2VzID0gZ2V0Q2hhbmdlc09uU2VsZWN0aW9uKHByb3BzLCBzdGF0ZS5oaWdobGlnaHRlZEluZGV4LCBmYWxzZSk7XG4gICAgICBicmVhaztcbiAgICBjYXNlIFRvZ2dsZUJ1dHRvbktleURvd25Ib21lOlxuICAgICAgY2hhbmdlcyA9IHtcbiAgICAgICAgaGlnaGxpZ2h0ZWRJbmRleDogZ2V0Tm9uRGlzYWJsZWRJbmRleCgwLCBmYWxzZSwgcHJvcHMuaXRlbXMsIHByb3BzLmlzSXRlbURpc2FibGVkKSxcbiAgICAgICAgaXNPcGVuOiB0cnVlXG4gICAgICB9O1xuICAgICAgYnJlYWs7XG4gICAgY2FzZSBUb2dnbGVCdXR0b25LZXlEb3duRW5kOlxuICAgICAgY2hhbmdlcyA9IHtcbiAgICAgICAgaGlnaGxpZ2h0ZWRJbmRleDogZ2V0Tm9uRGlzYWJsZWRJbmRleChwcm9wcy5pdGVtcy5sZW5ndGggLSAxLCB0cnVlLCBwcm9wcy5pdGVtcywgcHJvcHMuaXNJdGVtRGlzYWJsZWQpLFxuICAgICAgICBpc09wZW46IHRydWVcbiAgICAgIH07XG4gICAgICBicmVhaztcbiAgICBjYXNlIFRvZ2dsZUJ1dHRvbktleURvd25QYWdlVXA6XG4gICAgICBjaGFuZ2VzID0ge1xuICAgICAgICBoaWdobGlnaHRlZEluZGV4OiBnZXRIaWdobGlnaHRlZEluZGV4KHN0YXRlLmhpZ2hsaWdodGVkSW5kZXgsIC0xMCwgcHJvcHMuaXRlbXMsIHByb3BzLmlzSXRlbURpc2FibGVkKVxuICAgICAgfTtcbiAgICAgIGJyZWFrO1xuICAgIGNhc2UgVG9nZ2xlQnV0dG9uS2V5RG93blBhZ2VEb3duOlxuICAgICAgY2hhbmdlcyA9IHtcbiAgICAgICAgaGlnaGxpZ2h0ZWRJbmRleDogZ2V0SGlnaGxpZ2h0ZWRJbmRleChzdGF0ZS5oaWdobGlnaHRlZEluZGV4LCAxMCwgcHJvcHMuaXRlbXMsIHByb3BzLmlzSXRlbURpc2FibGVkKVxuICAgICAgfTtcbiAgICAgIGJyZWFrO1xuICAgIGNhc2UgVG9nZ2xlQnV0dG9uS2V5RG93bkVzY2FwZTpcbiAgICAgIGNoYW5nZXMgPSB7XG4gICAgICAgIGlzT3BlbjogZmFsc2UsXG4gICAgICAgIGhpZ2hsaWdodGVkSW5kZXg6IC0xXG4gICAgICB9O1xuICAgICAgYnJlYWs7XG4gICAgY2FzZSBUb2dnbGVCdXR0b25CbHVyOlxuICAgICAgY2hhbmdlcyA9IF9leHRlbmRzKHtcbiAgICAgICAgaXNPcGVuOiBmYWxzZSxcbiAgICAgICAgaGlnaGxpZ2h0ZWRJbmRleDogLTFcbiAgICAgIH0sIHN0YXRlLmhpZ2hsaWdodGVkSW5kZXggPj0gMCAmJiAoKF9wcm9wcyRpdGVtcyA9IHByb3BzLml0ZW1zKSA9PSBudWxsID8gdm9pZCAwIDogX3Byb3BzJGl0ZW1zLmxlbmd0aCkgJiYge1xuICAgICAgICBzZWxlY3RlZEl0ZW06IHByb3BzLml0ZW1zW3N0YXRlLmhpZ2hsaWdodGVkSW5kZXhdXG4gICAgICB9KTtcbiAgICAgIGJyZWFrO1xuICAgIGNhc2UgRnVuY3Rpb25TZWxlY3RJdGVtJDE6XG4gICAgICBjaGFuZ2VzID0ge1xuICAgICAgICBzZWxlY3RlZEl0ZW06IGFjdGlvbi5zZWxlY3RlZEl0ZW1cbiAgICAgIH07XG4gICAgICBicmVhaztcbiAgICBkZWZhdWx0OlxuICAgICAgcmV0dXJuIGRvd25zaGlmdENvbW1vblJlZHVjZXIoc3RhdGUsIGFjdGlvbiwgc3RhdGVDaGFuZ2VUeXBlcyQyKTtcbiAgfVxuICByZXR1cm4gX2V4dGVuZHMoe30sIHN0YXRlLCBjaGFuZ2VzKTtcbn1cbi8qIGVzbGludC1lbmFibGUgY29tcGxleGl0eSAqL1xuXG52YXIgX2V4Y2x1ZGVkJDIgPSBbXCJvbkNsaWNrXCJdLFxuICBfZXhjbHVkZWQyJDIgPSBbXCJvbk1vdXNlTGVhdmVcIiwgXCJyZWZLZXlcIiwgXCJyZWZcIl0sXG4gIF9leGNsdWRlZDMkMSA9IFtcIm9uQmx1clwiLCBcIm9uQ2xpY2tcIiwgXCJvblByZXNzXCIsIFwib25LZXlEb3duXCIsIFwicmVmS2V5XCIsIFwicmVmXCJdLFxuICBfZXhjbHVkZWQ0JDEgPSBbXCJpdGVtXCIsIFwiaW5kZXhcIiwgXCJvbk1vdXNlTW92ZVwiLCBcIm9uQ2xpY2tcIiwgXCJvbk1vdXNlRG93blwiLCBcIm9uUHJlc3NcIiwgXCJyZWZLZXlcIiwgXCJkaXNhYmxlZFwiLCBcInJlZlwiXTtcbnVzZVNlbGVjdC5zdGF0ZUNoYW5nZVR5cGVzID0gc3RhdGVDaGFuZ2VUeXBlcyQyO1xuZnVuY3Rpb24gdXNlU2VsZWN0KHVzZXJQcm9wcykge1xuICBpZiAodXNlclByb3BzID09PSB2b2lkIDApIHtcbiAgICB1c2VyUHJvcHMgPSB7fTtcbiAgfVxuICB2YWxpZGF0ZVByb3BUeXBlcyQyKHVzZXJQcm9wcywgdXNlU2VsZWN0KTtcbiAgLy8gUHJvcHMgZGVmYXVsdHMgYW5kIGRlc3RydWN0dXJpbmcuXG4gIHZhciBwcm9wcyA9IF9leHRlbmRzKHt9LCBkZWZhdWx0UHJvcHMkMiwgdXNlclByb3BzKTtcbiAgdmFyIHNjcm9sbEludG9WaWV3ID0gcHJvcHMuc2Nyb2xsSW50b1ZpZXcsXG4gICAgZW52aXJvbm1lbnQgPSBwcm9wcy5lbnZpcm9ubWVudCxcbiAgICBnZXRBMTF5U3RhdHVzTWVzc2FnZSA9IHByb3BzLmdldEExMXlTdGF0dXNNZXNzYWdlO1xuICAvLyBJbml0aWFsIHN0YXRlIGRlcGVuZGluZyBvbiBjb250cm9sbGVkIHByb3BzLlxuICB2YXIgX3VzZUNvbnRyb2xsZWRSZWR1Y2VyID0gdXNlQ29udHJvbGxlZFJlZHVjZXIkMShkb3duc2hpZnRTZWxlY3RSZWR1Y2VyLCBwcm9wcywgZ2V0SW5pdGlhbFN0YXRlJDIsIGlzRHJvcGRvd25zU3RhdGVFcXVhbCksXG4gICAgc3RhdGUgPSBfdXNlQ29udHJvbGxlZFJlZHVjZXJbMF0sXG4gICAgZGlzcGF0Y2ggPSBfdXNlQ29udHJvbGxlZFJlZHVjZXJbMV07XG4gIHZhciBpc09wZW4gPSBzdGF0ZS5pc09wZW4sXG4gICAgaGlnaGxpZ2h0ZWRJbmRleCA9IHN0YXRlLmhpZ2hsaWdodGVkSW5kZXgsXG4gICAgc2VsZWN0ZWRJdGVtID0gc3RhdGUuc2VsZWN0ZWRJdGVtLFxuICAgIGlucHV0VmFsdWUgPSBzdGF0ZS5pbnB1dFZhbHVlO1xuICAvLyBFbGVtZW50IGVmcy5cbiAgdmFyIHRvZ2dsZUJ1dHRvblJlZiA9IHVzZVJlZihudWxsKTtcbiAgdmFyIG1lbnVSZWYgPSB1c2VSZWYobnVsbCk7XG4gIHZhciBpdGVtUmVmcyA9IHVzZVJlZih7fSk7XG5cbiAgLy8gdXNlZCB0byBrZWVwIHRoZSBpbnB1dFZhbHVlIGNsZWFyVGltZW91dCBvYmplY3QgYmV0d2VlbiByZW5kZXJzLlxuICB2YXIgY2xlYXJUaW1lb3V0UmVmID0gdXNlUmVmKG51bGwpO1xuICAvLyBwcmV2ZW50IGlkIHJlLWdlbmVyYXRpb24gYmV0d2VlbiByZW5kZXJzLlxuICB2YXIgZWxlbWVudElkcyA9IHVzZUVsZW1lbnRJZHMocHJvcHMpO1xuICAvLyB1dGlsaXR5IGNhbGxiYWNrIHRvIGdldCBpdGVtIGVsZW1lbnQuXG4gIHZhciBsYXRlc3QgPSB1c2VMYXRlc3RSZWYoe1xuICAgIHN0YXRlOiBzdGF0ZSxcbiAgICBwcm9wczogcHJvcHNcbiAgfSk7XG5cbiAgLy8gU29tZSB1dGlscy5cbiAgdmFyIGdldEl0ZW1Ob2RlRnJvbUluZGV4ID0gdXNlQ2FsbGJhY2soZnVuY3Rpb24gKGluZGV4KSB7XG4gICAgcmV0dXJuIGl0ZW1SZWZzLmN1cnJlbnRbZWxlbWVudElkcy5nZXRJdGVtSWQoaW5kZXgpXTtcbiAgfSwgW2VsZW1lbnRJZHNdKTtcblxuICAvLyBFZmZlY3RzLlxuICAvLyBBZGRzIGFuIGExMXkgYXJpYSBsaXZlIHN0YXR1cyBtZXNzYWdlIGlmIGdldEExMXlTdGF0dXNNZXNzYWdlIGlzIHBhc3NlZC5cbiAgdXNlQTExeU1lc3NhZ2VTdGF0dXMoZ2V0QTExeVN0YXR1c01lc3NhZ2UsIHN0YXRlLCBbaXNPcGVuLCBoaWdobGlnaHRlZEluZGV4LCBzZWxlY3RlZEl0ZW0sIGlucHV0VmFsdWVdLCBlbnZpcm9ubWVudCk7XG4gIC8vIFNjcm9sbCBvbiBoaWdobGlnaHRlZCBpdGVtIGlmIGNoYW5nZSBjb21lcyBmcm9tIGtleWJvYXJkLlxuICB2YXIgc2hvdWxkU2Nyb2xsUmVmID0gdXNlU2Nyb2xsSW50b1ZpZXcoe1xuICAgIG1lbnVFbGVtZW50OiBtZW51UmVmLmN1cnJlbnQsXG4gICAgaGlnaGxpZ2h0ZWRJbmRleDogaGlnaGxpZ2h0ZWRJbmRleCxcbiAgICBpc09wZW46IGlzT3BlbixcbiAgICBpdGVtUmVmczogaXRlbVJlZnMsXG4gICAgc2Nyb2xsSW50b1ZpZXc6IHNjcm9sbEludG9WaWV3LFxuICAgIGdldEl0ZW1Ob2RlRnJvbUluZGV4OiBnZXRJdGVtTm9kZUZyb21JbmRleFxuICB9KTtcbiAgLy8gU2V0cyBjbGVhbnVwIGZvciB0aGUga2V5c1NvRmFyIGNhbGxiYWNrLCBkZWJvdW5kZWQgYWZ0ZXIgNTAwbXMuXG4gIHVzZUVmZmVjdChmdW5jdGlvbiAoKSB7XG4gICAgLy8gaW5pdCB0aGUgY2xlYW4gZnVuY3Rpb24gaGVyZSBhcyB3ZSBuZWVkIGFjY2VzcyB0byBkaXNwYXRjaC5cbiAgICBjbGVhclRpbWVvdXRSZWYuY3VycmVudCA9IGRlYm91bmNlKGZ1bmN0aW9uIChvdXRlckRpc3BhdGNoKSB7XG4gICAgICBvdXRlckRpc3BhdGNoKHtcbiAgICAgICAgdHlwZTogRnVuY3Rpb25TZXRJbnB1dFZhbHVlJDEsXG4gICAgICAgIGlucHV0VmFsdWU6ICcnXG4gICAgICB9KTtcbiAgICB9LCA1MDApO1xuXG4gICAgLy8gQ2FuY2VsIGFueSBwZW5kaW5nIGRlYm91bmNlZCBjYWxscyBvbiBtb3VudFxuICAgIHJldHVybiBmdW5jdGlvbiAoKSB7XG4gICAgICBjbGVhclRpbWVvdXRSZWYuY3VycmVudC5jYW5jZWwoKTtcbiAgICB9O1xuICB9LCBbXSk7XG4gIC8vIEludm9rZXMgdGhlIGtleXNTb0ZhciBjYWxsYmFjayBzZXQgdXAgYWJvdmUuXG4gIHVzZUVmZmVjdChmdW5jdGlvbiAoKSB7XG4gICAgaWYgKCFpbnB1dFZhbHVlKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIGNsZWFyVGltZW91dFJlZi5jdXJyZW50KGRpc3BhdGNoKTtcbiAgfSwgW2Rpc3BhdGNoLCBpbnB1dFZhbHVlXSk7XG4gIHVzZUNvbnRyb2xQcm9wc1ZhbGlkYXRvcih7XG4gICAgcHJvcHM6IHByb3BzLFxuICAgIHN0YXRlOiBzdGF0ZVxuICB9KTtcbiAgLy8gRm9jdXMgdGhlIHRvZ2dsZSBidXR0b24gb24gZmlyc3QgcmVuZGVyIGlmIHJlcXVpcmVkLlxuICB1c2VFZmZlY3QoZnVuY3Rpb24gKCkge1xuICAgIHZhciBmb2N1c09uT3BlbiA9IGdldEluaXRpYWxWYWx1ZSQxKHByb3BzLCAnaXNPcGVuJyk7XG4gICAgaWYgKGZvY3VzT25PcGVuICYmIHRvZ2dsZUJ1dHRvblJlZi5jdXJyZW50KSB7XG4gICAgICB0b2dnbGVCdXR0b25SZWYuY3VycmVudC5mb2N1cygpO1xuICAgIH1cbiAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgcmVhY3QtaG9va3MvZXhoYXVzdGl2ZS1kZXBzXG4gIH0sIFtdKTtcbiAgdmFyIG1vdXNlQW5kVG91Y2hUcmFja2VycyA9IHVzZU1vdXNlQW5kVG91Y2hUcmFja2VyKGVudmlyb25tZW50LCB1c2VDYWxsYmFjayhmdW5jdGlvbiBoYW5kbGVCbHVyKCkge1xuICAgIGlmIChsYXRlc3QuY3VycmVudC5zdGF0ZS5pc09wZW4pIHtcbiAgICAgIGRpc3BhdGNoKHtcbiAgICAgICAgdHlwZTogVG9nZ2xlQnV0dG9uQmx1clxuICAgICAgfSk7XG4gICAgfVxuICB9LCBbZGlzcGF0Y2gsIGxhdGVzdF0pLCB1c2VNZW1vKGZ1bmN0aW9uICgpIHtcbiAgICByZXR1cm4gW21lbnVSZWYsIHRvZ2dsZUJ1dHRvblJlZl07XG4gIH0sIFttZW51UmVmLmN1cnJlbnQsIHRvZ2dsZUJ1dHRvblJlZi5jdXJyZW50XSkpO1xuICB2YXIgc2V0R2V0dGVyUHJvcENhbGxJbmZvID0gdXNlR2V0dGVyUHJvcHNDYWxsZWRDaGVja2VyKCdnZXRNZW51UHJvcHMnLCAnZ2V0VG9nZ2xlQnV0dG9uUHJvcHMnKTtcbiAgLy8gUmVzZXQgaXRlbVJlZnMgb24gY2xvc2UuXG4gIHVzZUVmZmVjdChmdW5jdGlvbiAoKSB7XG4gICAgaWYgKCFpc09wZW4pIHtcbiAgICAgIGl0ZW1SZWZzLmN1cnJlbnQgPSB7fTtcbiAgICB9XG4gIH0sIFtpc09wZW5dKTtcblxuICAvLyBFdmVudCBoYW5kbGVyIGZ1bmN0aW9ucy5cbiAgdmFyIHRvZ2dsZUJ1dHRvbktleURvd25IYW5kbGVycyA9IHVzZU1lbW8oZnVuY3Rpb24gKCkge1xuICAgIHJldHVybiB7XG4gICAgICBBcnJvd0Rvd246IGZ1bmN0aW9uIEFycm93RG93bihldmVudCkge1xuICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICBkaXNwYXRjaCh7XG4gICAgICAgICAgdHlwZTogVG9nZ2xlQnV0dG9uS2V5RG93bkFycm93RG93bixcbiAgICAgICAgICBhbHRLZXk6IGV2ZW50LmFsdEtleVxuICAgICAgICB9KTtcbiAgICAgIH0sXG4gICAgICBBcnJvd1VwOiBmdW5jdGlvbiBBcnJvd1VwKGV2ZW50KSB7XG4gICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgIGRpc3BhdGNoKHtcbiAgICAgICAgICB0eXBlOiBUb2dnbGVCdXR0b25LZXlEb3duQXJyb3dVcCxcbiAgICAgICAgICBhbHRLZXk6IGV2ZW50LmFsdEtleVxuICAgICAgICB9KTtcbiAgICAgIH0sXG4gICAgICBIb21lOiBmdW5jdGlvbiBIb21lKGV2ZW50KSB7XG4gICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgIGRpc3BhdGNoKHtcbiAgICAgICAgICB0eXBlOiBUb2dnbGVCdXR0b25LZXlEb3duSG9tZVxuICAgICAgICB9KTtcbiAgICAgIH0sXG4gICAgICBFbmQ6IGZ1bmN0aW9uIEVuZChldmVudCkge1xuICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICBkaXNwYXRjaCh7XG4gICAgICAgICAgdHlwZTogVG9nZ2xlQnV0dG9uS2V5RG93bkVuZFxuICAgICAgICB9KTtcbiAgICAgIH0sXG4gICAgICBFc2NhcGU6IGZ1bmN0aW9uIEVzY2FwZSgpIHtcbiAgICAgICAgaWYgKGxhdGVzdC5jdXJyZW50LnN0YXRlLmlzT3Blbikge1xuICAgICAgICAgIGRpc3BhdGNoKHtcbiAgICAgICAgICAgIHR5cGU6IFRvZ2dsZUJ1dHRvbktleURvd25Fc2NhcGVcbiAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgfSxcbiAgICAgIEVudGVyOiBmdW5jdGlvbiBFbnRlcihldmVudCkge1xuICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICBkaXNwYXRjaCh7XG4gICAgICAgICAgdHlwZTogbGF0ZXN0LmN1cnJlbnQuc3RhdGUuaXNPcGVuID8gVG9nZ2xlQnV0dG9uS2V5RG93bkVudGVyIDogVG9nZ2xlQnV0dG9uQ2xpY2skMVxuICAgICAgICB9KTtcbiAgICAgIH0sXG4gICAgICBQYWdlVXA6IGZ1bmN0aW9uIFBhZ2VVcChldmVudCkge1xuICAgICAgICBpZiAobGF0ZXN0LmN1cnJlbnQuc3RhdGUuaXNPcGVuKSB7XG4gICAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICBkaXNwYXRjaCh7XG4gICAgICAgICAgICB0eXBlOiBUb2dnbGVCdXR0b25LZXlEb3duUGFnZVVwXG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgIH0sXG4gICAgICBQYWdlRG93bjogZnVuY3Rpb24gUGFnZURvd24oZXZlbnQpIHtcbiAgICAgICAgaWYgKGxhdGVzdC5jdXJyZW50LnN0YXRlLmlzT3Blbikge1xuICAgICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgZGlzcGF0Y2goe1xuICAgICAgICAgICAgdHlwZTogVG9nZ2xlQnV0dG9uS2V5RG93blBhZ2VEb3duXG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgIH0sXG4gICAgICAnICc6IGZ1bmN0aW9uIF8oZXZlbnQpIHtcbiAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgdmFyIGN1cnJlbnRTdGF0ZSA9IGxhdGVzdC5jdXJyZW50LnN0YXRlO1xuICAgICAgICBpZiAoIWN1cnJlbnRTdGF0ZS5pc09wZW4pIHtcbiAgICAgICAgICBkaXNwYXRjaCh7XG4gICAgICAgICAgICB0eXBlOiBUb2dnbGVCdXR0b25DbGljayQxXG4gICAgICAgICAgfSk7XG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIGlmIChjdXJyZW50U3RhdGUuaW5wdXRWYWx1ZSkge1xuICAgICAgICAgIGRpc3BhdGNoKHtcbiAgICAgICAgICAgIHR5cGU6IFRvZ2dsZUJ1dHRvbktleURvd25DaGFyYWN0ZXIsXG4gICAgICAgICAgICBrZXk6ICcgJ1xuICAgICAgICAgIH0pO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGRpc3BhdGNoKHtcbiAgICAgICAgICAgIHR5cGU6IFRvZ2dsZUJ1dHRvbktleURvd25TcGFjZUJ1dHRvblxuICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfTtcbiAgfSwgW2Rpc3BhdGNoLCBsYXRlc3RdKTtcblxuICAvLyBBY3Rpb24gZnVuY3Rpb25zLlxuICB2YXIgdG9nZ2xlTWVudSA9IHVzZUNhbGxiYWNrKGZ1bmN0aW9uICgpIHtcbiAgICBkaXNwYXRjaCh7XG4gICAgICB0eXBlOiBGdW5jdGlvblRvZ2dsZU1lbnUkMVxuICAgIH0pO1xuICB9LCBbZGlzcGF0Y2hdKTtcbiAgdmFyIGNsb3NlTWVudSA9IHVzZUNhbGxiYWNrKGZ1bmN0aW9uICgpIHtcbiAgICBkaXNwYXRjaCh7XG4gICAgICB0eXBlOiBGdW5jdGlvbkNsb3NlTWVudSQxXG4gICAgfSk7XG4gIH0sIFtkaXNwYXRjaF0pO1xuICB2YXIgb3Blbk1lbnUgPSB1c2VDYWxsYmFjayhmdW5jdGlvbiAoKSB7XG4gICAgZGlzcGF0Y2goe1xuICAgICAgdHlwZTogRnVuY3Rpb25PcGVuTWVudSQxXG4gICAgfSk7XG4gIH0sIFtkaXNwYXRjaF0pO1xuICB2YXIgc2V0SGlnaGxpZ2h0ZWRJbmRleCA9IHVzZUNhbGxiYWNrKGZ1bmN0aW9uIChuZXdIaWdobGlnaHRlZEluZGV4KSB7XG4gICAgZGlzcGF0Y2goe1xuICAgICAgdHlwZTogRnVuY3Rpb25TZXRIaWdobGlnaHRlZEluZGV4JDEsXG4gICAgICBoaWdobGlnaHRlZEluZGV4OiBuZXdIaWdobGlnaHRlZEluZGV4XG4gICAgfSk7XG4gIH0sIFtkaXNwYXRjaF0pO1xuICB2YXIgc2VsZWN0SXRlbSA9IHVzZUNhbGxiYWNrKGZ1bmN0aW9uIChuZXdTZWxlY3RlZEl0ZW0pIHtcbiAgICBkaXNwYXRjaCh7XG4gICAgICB0eXBlOiBGdW5jdGlvblNlbGVjdEl0ZW0kMSxcbiAgICAgIHNlbGVjdGVkSXRlbTogbmV3U2VsZWN0ZWRJdGVtXG4gICAgfSk7XG4gIH0sIFtkaXNwYXRjaF0pO1xuICB2YXIgcmVzZXQgPSB1c2VDYWxsYmFjayhmdW5jdGlvbiAoKSB7XG4gICAgZGlzcGF0Y2goe1xuICAgICAgdHlwZTogRnVuY3Rpb25SZXNldCQyXG4gICAgfSk7XG4gIH0sIFtkaXNwYXRjaF0pO1xuICB2YXIgc2V0SW5wdXRWYWx1ZSA9IHVzZUNhbGxiYWNrKGZ1bmN0aW9uIChuZXdJbnB1dFZhbHVlKSB7XG4gICAgZGlzcGF0Y2goe1xuICAgICAgdHlwZTogRnVuY3Rpb25TZXRJbnB1dFZhbHVlJDEsXG4gICAgICBpbnB1dFZhbHVlOiBuZXdJbnB1dFZhbHVlXG4gICAgfSk7XG4gIH0sIFtkaXNwYXRjaF0pO1xuICAvLyBHZXR0ZXIgZnVuY3Rpb25zLlxuICB2YXIgZ2V0TGFiZWxQcm9wcyA9IHVzZUNhbGxiYWNrKGZ1bmN0aW9uIChfdGVtcCkge1xuICAgIHZhciBfcmVmID0gX3RlbXAgPT09IHZvaWQgMCA/IHt9IDogX3RlbXAsXG4gICAgICBvbkNsaWNrID0gX3JlZi5vbkNsaWNrLFxuICAgICAgbGFiZWxQcm9wcyA9IF9vYmplY3RXaXRob3V0UHJvcGVydGllc0xvb3NlKF9yZWYsIF9leGNsdWRlZCQyKTtcbiAgICB2YXIgbGFiZWxIYW5kbGVDbGljayA9IGZ1bmN0aW9uIGxhYmVsSGFuZGxlQ2xpY2soKSB7XG4gICAgICB2YXIgX3RvZ2dsZUJ1dHRvblJlZiRjdXJyO1xuICAgICAgKF90b2dnbGVCdXR0b25SZWYkY3VyciA9IHRvZ2dsZUJ1dHRvblJlZi5jdXJyZW50KSA9PSBudWxsIHx8IF90b2dnbGVCdXR0b25SZWYkY3Vyci5mb2N1cygpO1xuICAgIH07XG4gICAgcmV0dXJuIF9leHRlbmRzKHtcbiAgICAgIGlkOiBlbGVtZW50SWRzLmxhYmVsSWQsXG4gICAgICBodG1sRm9yOiBlbGVtZW50SWRzLnRvZ2dsZUJ1dHRvbklkLFxuICAgICAgb25DbGljazogY2FsbEFsbEV2ZW50SGFuZGxlcnMob25DbGljaywgbGFiZWxIYW5kbGVDbGljaylcbiAgICB9LCBsYWJlbFByb3BzKTtcbiAgfSwgW2VsZW1lbnRJZHNdKTtcbiAgdmFyIGdldE1lbnVQcm9wcyA9IHVzZUNhbGxiYWNrKGZ1bmN0aW9uIChfdGVtcDIsIF90ZW1wMykge1xuICAgIHZhciBfZXh0ZW5kczI7XG4gICAgdmFyIF9yZWYyID0gX3RlbXAyID09PSB2b2lkIDAgPyB7fSA6IF90ZW1wMixcbiAgICAgIG9uTW91c2VMZWF2ZSA9IF9yZWYyLm9uTW91c2VMZWF2ZSxcbiAgICAgIF9yZWYyJHJlZktleSA9IF9yZWYyLnJlZktleSxcbiAgICAgIHJlZktleSA9IF9yZWYyJHJlZktleSA9PT0gdm9pZCAwID8gJ3JlZicgOiBfcmVmMiRyZWZLZXksXG4gICAgICByZWYgPSBfcmVmMi5yZWYsXG4gICAgICByZXN0ID0gX29iamVjdFdpdGhvdXRQcm9wZXJ0aWVzTG9vc2UoX3JlZjIsIF9leGNsdWRlZDIkMik7XG4gICAgdmFyIF9yZWYzID0gX3RlbXAzID09PSB2b2lkIDAgPyB7fSA6IF90ZW1wMyxcbiAgICAgIF9yZWYzJHN1cHByZXNzUmVmRXJybyA9IF9yZWYzLnN1cHByZXNzUmVmRXJyb3IsXG4gICAgICBzdXBwcmVzc1JlZkVycm9yID0gX3JlZjMkc3VwcHJlc3NSZWZFcnJvID09PSB2b2lkIDAgPyBmYWxzZSA6IF9yZWYzJHN1cHByZXNzUmVmRXJybztcbiAgICB2YXIgbWVudUhhbmRsZU1vdXNlTGVhdmUgPSBmdW5jdGlvbiBtZW51SGFuZGxlTW91c2VMZWF2ZSgpIHtcbiAgICAgIGRpc3BhdGNoKHtcbiAgICAgICAgdHlwZTogTWVudU1vdXNlTGVhdmUkMVxuICAgICAgfSk7XG4gICAgfTtcbiAgICBzZXRHZXR0ZXJQcm9wQ2FsbEluZm8oJ2dldE1lbnVQcm9wcycsIHN1cHByZXNzUmVmRXJyb3IsIHJlZktleSwgbWVudVJlZik7XG4gICAgcmV0dXJuIF9leHRlbmRzKChfZXh0ZW5kczIgPSB7fSwgX2V4dGVuZHMyW3JlZktleV0gPSBoYW5kbGVSZWZzKHJlZiwgZnVuY3Rpb24gKG1lbnVOb2RlKSB7XG4gICAgICBtZW51UmVmLmN1cnJlbnQgPSBtZW51Tm9kZTtcbiAgICB9KSwgX2V4dGVuZHMyLmlkID0gZWxlbWVudElkcy5tZW51SWQsIF9leHRlbmRzMi5yb2xlID0gJ2xpc3Rib3gnLCBfZXh0ZW5kczJbJ2FyaWEtbGFiZWxsZWRieSddID0gcmVzdCAmJiByZXN0WydhcmlhLWxhYmVsJ10gPyB1bmRlZmluZWQgOiBcIlwiICsgZWxlbWVudElkcy5sYWJlbElkLCBfZXh0ZW5kczIub25Nb3VzZUxlYXZlID0gY2FsbEFsbEV2ZW50SGFuZGxlcnMob25Nb3VzZUxlYXZlLCBtZW51SGFuZGxlTW91c2VMZWF2ZSksIF9leHRlbmRzMiksIHJlc3QpO1xuICB9LCBbZGlzcGF0Y2gsIHNldEdldHRlclByb3BDYWxsSW5mbywgZWxlbWVudElkc10pO1xuICB2YXIgZ2V0VG9nZ2xlQnV0dG9uUHJvcHMgPSB1c2VDYWxsYmFjayhmdW5jdGlvbiAoX3RlbXA0LCBfdGVtcDUpIHtcbiAgICB2YXIgX2V4dGVuZHMzO1xuICAgIHZhciBfcmVmNCA9IF90ZW1wNCA9PT0gdm9pZCAwID8ge30gOiBfdGVtcDQsXG4gICAgICBvbkJsdXIgPSBfcmVmNC5vbkJsdXIsXG4gICAgICBvbkNsaWNrID0gX3JlZjQub25DbGljaztcbiAgICAgIF9yZWY0Lm9uUHJlc3M7XG4gICAgICB2YXIgb25LZXlEb3duID0gX3JlZjQub25LZXlEb3duLFxuICAgICAgX3JlZjQkcmVmS2V5ID0gX3JlZjQucmVmS2V5LFxuICAgICAgcmVmS2V5ID0gX3JlZjQkcmVmS2V5ID09PSB2b2lkIDAgPyAncmVmJyA6IF9yZWY0JHJlZktleSxcbiAgICAgIHJlZiA9IF9yZWY0LnJlZixcbiAgICAgIHJlc3QgPSBfb2JqZWN0V2l0aG91dFByb3BlcnRpZXNMb29zZShfcmVmNCwgX2V4Y2x1ZGVkMyQxKTtcbiAgICB2YXIgX3JlZjUgPSBfdGVtcDUgPT09IHZvaWQgMCA/IHt9IDogX3RlbXA1LFxuICAgICAgX3JlZjUkc3VwcHJlc3NSZWZFcnJvID0gX3JlZjUuc3VwcHJlc3NSZWZFcnJvcixcbiAgICAgIHN1cHByZXNzUmVmRXJyb3IgPSBfcmVmNSRzdXBwcmVzc1JlZkVycm8gPT09IHZvaWQgMCA/IGZhbHNlIDogX3JlZjUkc3VwcHJlc3NSZWZFcnJvO1xuICAgIHZhciBsYXRlc3RTdGF0ZSA9IGxhdGVzdC5jdXJyZW50LnN0YXRlO1xuICAgIHZhciB0b2dnbGVCdXR0b25IYW5kbGVDbGljayA9IGZ1bmN0aW9uIHRvZ2dsZUJ1dHRvbkhhbmRsZUNsaWNrKCkge1xuICAgICAgZGlzcGF0Y2goe1xuICAgICAgICB0eXBlOiBUb2dnbGVCdXR0b25DbGljayQxXG4gICAgICB9KTtcbiAgICB9O1xuICAgIHZhciB0b2dnbGVCdXR0b25IYW5kbGVCbHVyID0gZnVuY3Rpb24gdG9nZ2xlQnV0dG9uSGFuZGxlQmx1cigpIHtcbiAgICAgIGlmIChsYXRlc3RTdGF0ZS5pc09wZW4gJiYgIW1vdXNlQW5kVG91Y2hUcmFja2Vycy5pc01vdXNlRG93bikge1xuICAgICAgICBkaXNwYXRjaCh7XG4gICAgICAgICAgdHlwZTogVG9nZ2xlQnV0dG9uQmx1clxuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICB9O1xuICAgIHZhciB0b2dnbGVCdXR0b25IYW5kbGVLZXlEb3duID0gZnVuY3Rpb24gdG9nZ2xlQnV0dG9uSGFuZGxlS2V5RG93bihldmVudCkge1xuICAgICAgdmFyIGtleSA9IG5vcm1hbGl6ZUFycm93S2V5KGV2ZW50KTtcbiAgICAgIGlmIChrZXkgJiYgdG9nZ2xlQnV0dG9uS2V5RG93bkhhbmRsZXJzW2tleV0pIHtcbiAgICAgICAgdG9nZ2xlQnV0dG9uS2V5RG93bkhhbmRsZXJzW2tleV0oZXZlbnQpO1xuICAgICAgfSBlbHNlIGlmIChpc0FjY2VwdGVkQ2hhcmFjdGVyS2V5KGtleSkpIHtcbiAgICAgICAgZGlzcGF0Y2goe1xuICAgICAgICAgIHR5cGU6IFRvZ2dsZUJ1dHRvbktleURvd25DaGFyYWN0ZXIsXG4gICAgICAgICAga2V5OiBrZXlcbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgfTtcbiAgICB2YXIgdG9nZ2xlUHJvcHMgPSBfZXh0ZW5kcygoX2V4dGVuZHMzID0ge30sIF9leHRlbmRzM1tyZWZLZXldID0gaGFuZGxlUmVmcyhyZWYsIGZ1bmN0aW9uICh0b2dnbGVCdXR0b25Ob2RlKSB7XG4gICAgICB0b2dnbGVCdXR0b25SZWYuY3VycmVudCA9IHRvZ2dsZUJ1dHRvbk5vZGU7XG4gICAgfSksIF9leHRlbmRzM1snYXJpYS1hY3RpdmVkZXNjZW5kYW50J10gPSBsYXRlc3RTdGF0ZS5pc09wZW4gJiYgbGF0ZXN0U3RhdGUuaGlnaGxpZ2h0ZWRJbmRleCA+IC0xID8gZWxlbWVudElkcy5nZXRJdGVtSWQobGF0ZXN0U3RhdGUuaGlnaGxpZ2h0ZWRJbmRleCkgOiAnJywgX2V4dGVuZHMzWydhcmlhLWNvbnRyb2xzJ10gPSBlbGVtZW50SWRzLm1lbnVJZCwgX2V4dGVuZHMzWydhcmlhLWV4cGFuZGVkJ10gPSBsYXRlc3QuY3VycmVudC5zdGF0ZS5pc09wZW4sIF9leHRlbmRzM1snYXJpYS1oYXNwb3B1cCddID0gJ2xpc3Rib3gnLCBfZXh0ZW5kczNbJ2FyaWEtbGFiZWxsZWRieSddID0gcmVzdCAmJiByZXN0WydhcmlhLWxhYmVsJ10gPyB1bmRlZmluZWQgOiBcIlwiICsgZWxlbWVudElkcy5sYWJlbElkLCBfZXh0ZW5kczMuaWQgPSBlbGVtZW50SWRzLnRvZ2dsZUJ1dHRvbklkLCBfZXh0ZW5kczMucm9sZSA9ICdjb21ib2JveCcsIF9leHRlbmRzMy50YWJJbmRleCA9IDAsIF9leHRlbmRzMy5vbkJsdXIgPSBjYWxsQWxsRXZlbnRIYW5kbGVycyhvbkJsdXIsIHRvZ2dsZUJ1dHRvbkhhbmRsZUJsdXIpLCBfZXh0ZW5kczMpLCByZXN0KTtcbiAgICBpZiAoIXJlc3QuZGlzYWJsZWQpIHtcbiAgICAgIC8qIGlzdGFuYnVsIGlnbm9yZSBpZiAocmVhY3QtbmF0aXZlKSAqL1xuICAgICAge1xuICAgICAgICB0b2dnbGVQcm9wcy5vbkNsaWNrID0gY2FsbEFsbEV2ZW50SGFuZGxlcnMob25DbGljaywgdG9nZ2xlQnV0dG9uSGFuZGxlQ2xpY2spO1xuICAgICAgICB0b2dnbGVQcm9wcy5vbktleURvd24gPSBjYWxsQWxsRXZlbnRIYW5kbGVycyhvbktleURvd24sIHRvZ2dsZUJ1dHRvbkhhbmRsZUtleURvd24pO1xuICAgICAgfVxuICAgIH1cbiAgICBzZXRHZXR0ZXJQcm9wQ2FsbEluZm8oJ2dldFRvZ2dsZUJ1dHRvblByb3BzJywgc3VwcHJlc3NSZWZFcnJvciwgcmVmS2V5LCB0b2dnbGVCdXR0b25SZWYpO1xuICAgIHJldHVybiB0b2dnbGVQcm9wcztcbiAgfSwgW2Rpc3BhdGNoLCBlbGVtZW50SWRzLCBsYXRlc3QsIG1vdXNlQW5kVG91Y2hUcmFja2Vycywgc2V0R2V0dGVyUHJvcENhbGxJbmZvLCB0b2dnbGVCdXR0b25LZXlEb3duSGFuZGxlcnNdKTtcbiAgdmFyIGdldEl0ZW1Qcm9wcyA9IHVzZUNhbGxiYWNrKGZ1bmN0aW9uIChfdGVtcDYpIHtcbiAgICB2YXIgX2V4dGVuZHM0O1xuICAgIHZhciBfcmVmNiA9IF90ZW1wNiA9PT0gdm9pZCAwID8ge30gOiBfdGVtcDYsXG4gICAgICBpdGVtUHJvcCA9IF9yZWY2Lml0ZW0sXG4gICAgICBpbmRleFByb3AgPSBfcmVmNi5pbmRleCxcbiAgICAgIG9uTW91c2VNb3ZlID0gX3JlZjYub25Nb3VzZU1vdmUsXG4gICAgICBvbkNsaWNrID0gX3JlZjYub25DbGljayxcbiAgICAgIG9uTW91c2VEb3duID0gX3JlZjYub25Nb3VzZURvd247XG4gICAgICBfcmVmNi5vblByZXNzO1xuICAgICAgdmFyIF9yZWY2JHJlZktleSA9IF9yZWY2LnJlZktleSxcbiAgICAgIHJlZktleSA9IF9yZWY2JHJlZktleSA9PT0gdm9pZCAwID8gJ3JlZicgOiBfcmVmNiRyZWZLZXksXG4gICAgICBkaXNhYmxlZFByb3AgPSBfcmVmNi5kaXNhYmxlZCxcbiAgICAgIHJlZiA9IF9yZWY2LnJlZixcbiAgICAgIHJlc3QgPSBfb2JqZWN0V2l0aG91dFByb3BlcnRpZXNMb29zZShfcmVmNiwgX2V4Y2x1ZGVkNCQxKTtcbiAgICBpZiAoZGlzYWJsZWRQcm9wICE9PSB1bmRlZmluZWQpIHtcbiAgICAgIGNvbnNvbGUud2FybignUGFzc2luZyBcImRpc2FibGVkXCIgYXMgYW4gYXJndW1lbnQgdG8gZ2V0SXRlbVByb3BzIGlzIG5vdCBzdXBwb3J0ZWQgYW55bW9yZS4gUGxlYXNlIHVzZSB0aGUgaXNJdGVtRGlzYWJsZWQgcHJvcCBmcm9tIHVzZVNlbGVjdC4nKTtcbiAgICB9XG4gICAgdmFyIF9sYXRlc3QkY3VycmVudCA9IGxhdGVzdC5jdXJyZW50LFxuICAgICAgbGF0ZXN0U3RhdGUgPSBfbGF0ZXN0JGN1cnJlbnQuc3RhdGUsXG4gICAgICBsYXRlc3RQcm9wcyA9IF9sYXRlc3QkY3VycmVudC5wcm9wcztcbiAgICB2YXIgX2dldEl0ZW1BbmRJbmRleCA9IGdldEl0ZW1BbmRJbmRleChpdGVtUHJvcCwgaW5kZXhQcm9wLCBsYXRlc3RQcm9wcy5pdGVtcywgJ1Bhc3MgZWl0aGVyIGl0ZW0gb3IgaW5kZXggdG8gZ2V0SXRlbVByb3BzIScpLFxuICAgICAgaXRlbSA9IF9nZXRJdGVtQW5kSW5kZXhbMF0sXG4gICAgICBpbmRleCA9IF9nZXRJdGVtQW5kSW5kZXhbMV07XG4gICAgdmFyIGRpc2FibGVkID0gbGF0ZXN0UHJvcHMuaXNJdGVtRGlzYWJsZWQoaXRlbSwgaW5kZXgpO1xuICAgIHZhciBpdGVtSGFuZGxlTW91c2VNb3ZlID0gZnVuY3Rpb24gaXRlbUhhbmRsZU1vdXNlTW92ZSgpIHtcbiAgICAgIGlmIChtb3VzZUFuZFRvdWNoVHJhY2tlcnMuaXNUb3VjaEVuZCB8fCBpbmRleCA9PT0gbGF0ZXN0U3RhdGUuaGlnaGxpZ2h0ZWRJbmRleCkge1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgICBzaG91bGRTY3JvbGxSZWYuY3VycmVudCA9IGZhbHNlO1xuICAgICAgZGlzcGF0Y2goe1xuICAgICAgICB0eXBlOiBJdGVtTW91c2VNb3ZlJDEsXG4gICAgICAgIGluZGV4OiBpbmRleCxcbiAgICAgICAgZGlzYWJsZWQ6IGRpc2FibGVkXG4gICAgICB9KTtcbiAgICB9O1xuICAgIHZhciBpdGVtSGFuZGxlQ2xpY2sgPSBmdW5jdGlvbiBpdGVtSGFuZGxlQ2xpY2soKSB7XG4gICAgICBkaXNwYXRjaCh7XG4gICAgICAgIHR5cGU6IEl0ZW1DbGljayQxLFxuICAgICAgICBpbmRleDogaW5kZXhcbiAgICAgIH0pO1xuICAgIH07XG4gICAgdmFyIGl0ZW1IYW5kbGVNb3VzZURvd24gPSBmdW5jdGlvbiBpdGVtSGFuZGxlTW91c2VEb3duKGUpIHtcbiAgICAgIHJldHVybiBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgfTsgLy8ga2VlcCBmb2N1cyBvbiB0aGUgdG9nZ2xlIGFmdGVyIGl0ZW0gY2xpY2sgc2VsZWN0LlxuXG4gICAgdmFyIGl0ZW1Qcm9wcyA9IF9leHRlbmRzKChfZXh0ZW5kczQgPSB7fSwgX2V4dGVuZHM0W3JlZktleV0gPSBoYW5kbGVSZWZzKHJlZiwgZnVuY3Rpb24gKGl0ZW1Ob2RlKSB7XG4gICAgICBpZiAoaXRlbU5vZGUpIHtcbiAgICAgICAgaXRlbVJlZnMuY3VycmVudFtlbGVtZW50SWRzLmdldEl0ZW1JZChpbmRleCldID0gaXRlbU5vZGU7XG4gICAgICB9XG4gICAgfSksIF9leHRlbmRzNFsnYXJpYS1kaXNhYmxlZCddID0gZGlzYWJsZWQsIF9leHRlbmRzNFsnYXJpYS1zZWxlY3RlZCddID0gaXRlbSA9PT0gbGF0ZXN0U3RhdGUuc2VsZWN0ZWRJdGVtLCBfZXh0ZW5kczQuaWQgPSBlbGVtZW50SWRzLmdldEl0ZW1JZChpbmRleCksIF9leHRlbmRzNC5yb2xlID0gJ29wdGlvbicsIF9leHRlbmRzNCksIHJlc3QpO1xuICAgIGlmICghZGlzYWJsZWQpIHtcbiAgICAgIC8qIGlzdGFuYnVsIGlnbm9yZSBuZXh0IChyZWFjdC1uYXRpdmUpICovXG4gICAgICB7XG4gICAgICAgIGl0ZW1Qcm9wcy5vbkNsaWNrID0gY2FsbEFsbEV2ZW50SGFuZGxlcnMob25DbGljaywgaXRlbUhhbmRsZUNsaWNrKTtcbiAgICAgIH1cbiAgICB9XG4gICAgaXRlbVByb3BzLm9uTW91c2VNb3ZlID0gY2FsbEFsbEV2ZW50SGFuZGxlcnMob25Nb3VzZU1vdmUsIGl0ZW1IYW5kbGVNb3VzZU1vdmUpO1xuICAgIGl0ZW1Qcm9wcy5vbk1vdXNlRG93biA9IGNhbGxBbGxFdmVudEhhbmRsZXJzKG9uTW91c2VEb3duLCBpdGVtSGFuZGxlTW91c2VEb3duKTtcbiAgICByZXR1cm4gaXRlbVByb3BzO1xuICB9LCBbbGF0ZXN0LCBlbGVtZW50SWRzLCBtb3VzZUFuZFRvdWNoVHJhY2tlcnMsIHNob3VsZFNjcm9sbFJlZiwgZGlzcGF0Y2hdKTtcbiAgcmV0dXJuIHtcbiAgICAvLyBwcm9wIGdldHRlcnMuXG4gICAgZ2V0VG9nZ2xlQnV0dG9uUHJvcHM6IGdldFRvZ2dsZUJ1dHRvblByb3BzLFxuICAgIGdldExhYmVsUHJvcHM6IGdldExhYmVsUHJvcHMsXG4gICAgZ2V0TWVudVByb3BzOiBnZXRNZW51UHJvcHMsXG4gICAgZ2V0SXRlbVByb3BzOiBnZXRJdGVtUHJvcHMsXG4gICAgLy8gYWN0aW9ucy5cbiAgICB0b2dnbGVNZW51OiB0b2dnbGVNZW51LFxuICAgIG9wZW5NZW51OiBvcGVuTWVudSxcbiAgICBjbG9zZU1lbnU6IGNsb3NlTWVudSxcbiAgICBzZXRIaWdobGlnaHRlZEluZGV4OiBzZXRIaWdobGlnaHRlZEluZGV4LFxuICAgIHNlbGVjdEl0ZW06IHNlbGVjdEl0ZW0sXG4gICAgcmVzZXQ6IHJlc2V0LFxuICAgIHNldElucHV0VmFsdWU6IHNldElucHV0VmFsdWUsXG4gICAgLy8gc3RhdGUuXG4gICAgaGlnaGxpZ2h0ZWRJbmRleDogaGlnaGxpZ2h0ZWRJbmRleCxcbiAgICBpc09wZW46IGlzT3BlbixcbiAgICBzZWxlY3RlZEl0ZW06IHNlbGVjdGVkSXRlbSxcbiAgICBpbnB1dFZhbHVlOiBpbnB1dFZhbHVlXG4gIH07XG59XG5cbnZhciBJbnB1dEtleURvd25BcnJvd0Rvd24gPSBwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gXCJwcm9kdWN0aW9uXCIgPyAnX19pbnB1dF9rZXlkb3duX2Fycm93X2Rvd25fXycgOiAwO1xudmFyIElucHV0S2V5RG93bkFycm93VXAgPSBwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gXCJwcm9kdWN0aW9uXCIgPyAnX19pbnB1dF9rZXlkb3duX2Fycm93X3VwX18nIDogMTtcbnZhciBJbnB1dEtleURvd25Fc2NhcGUgPSBwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gXCJwcm9kdWN0aW9uXCIgPyAnX19pbnB1dF9rZXlkb3duX2VzY2FwZV9fJyA6IDI7XG52YXIgSW5wdXRLZXlEb3duSG9tZSA9IHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSBcInByb2R1Y3Rpb25cIiA/ICdfX2lucHV0X2tleWRvd25faG9tZV9fJyA6IDM7XG52YXIgSW5wdXRLZXlEb3duRW5kID0gcHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09IFwicHJvZHVjdGlvblwiID8gJ19faW5wdXRfa2V5ZG93bl9lbmRfXycgOiA0O1xudmFyIElucHV0S2V5RG93blBhZ2VVcCA9IHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSBcInByb2R1Y3Rpb25cIiA/ICdfX2lucHV0X2tleWRvd25fcGFnZV91cF9fJyA6IDU7XG52YXIgSW5wdXRLZXlEb3duUGFnZURvd24gPSBwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gXCJwcm9kdWN0aW9uXCIgPyAnX19pbnB1dF9rZXlkb3duX3BhZ2VfZG93bl9fJyA6IDY7XG52YXIgSW5wdXRLZXlEb3duRW50ZXIgPSBwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gXCJwcm9kdWN0aW9uXCIgPyAnX19pbnB1dF9rZXlkb3duX2VudGVyX18nIDogNztcbnZhciBJbnB1dENoYW5nZSA9IHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSBcInByb2R1Y3Rpb25cIiA/ICdfX2lucHV0X2NoYW5nZV9fJyA6IDg7XG52YXIgSW5wdXRCbHVyID0gcHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09IFwicHJvZHVjdGlvblwiID8gJ19faW5wdXRfYmx1cl9fJyA6IDk7XG52YXIgSW5wdXRDbGljayA9IHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSBcInByb2R1Y3Rpb25cIiA/ICdfX2lucHV0X2NsaWNrX18nIDogMTA7XG52YXIgTWVudU1vdXNlTGVhdmUgPSBwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gXCJwcm9kdWN0aW9uXCIgPyAnX19tZW51X21vdXNlX2xlYXZlX18nIDogMTE7XG52YXIgSXRlbU1vdXNlTW92ZSA9IHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSBcInByb2R1Y3Rpb25cIiA/ICdfX2l0ZW1fbW91c2VfbW92ZV9fJyA6IDEyO1xudmFyIEl0ZW1DbGljayA9IHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSBcInByb2R1Y3Rpb25cIiA/ICdfX2l0ZW1fY2xpY2tfXycgOiAxMztcbnZhciBUb2dnbGVCdXR0b25DbGljayA9IHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSBcInByb2R1Y3Rpb25cIiA/ICdfX3RvZ2dsZWJ1dHRvbl9jbGlja19fJyA6IDE0O1xudmFyIEZ1bmN0aW9uVG9nZ2xlTWVudSA9IHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSBcInByb2R1Y3Rpb25cIiA/ICdfX2Z1bmN0aW9uX3RvZ2dsZV9tZW51X18nIDogMTU7XG52YXIgRnVuY3Rpb25PcGVuTWVudSA9IHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSBcInByb2R1Y3Rpb25cIiA/ICdfX2Z1bmN0aW9uX29wZW5fbWVudV9fJyA6IDE2O1xudmFyIEZ1bmN0aW9uQ2xvc2VNZW51ID0gcHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09IFwicHJvZHVjdGlvblwiID8gJ19fZnVuY3Rpb25fY2xvc2VfbWVudV9fJyA6IDE3O1xudmFyIEZ1bmN0aW9uU2V0SGlnaGxpZ2h0ZWRJbmRleCA9IHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSBcInByb2R1Y3Rpb25cIiA/ICdfX2Z1bmN0aW9uX3NldF9oaWdobGlnaHRlZF9pbmRleF9fJyA6IDE4O1xudmFyIEZ1bmN0aW9uU2VsZWN0SXRlbSA9IHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSBcInByb2R1Y3Rpb25cIiA/ICdfX2Z1bmN0aW9uX3NlbGVjdF9pdGVtX18nIDogMTk7XG52YXIgRnVuY3Rpb25TZXRJbnB1dFZhbHVlID0gcHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09IFwicHJvZHVjdGlvblwiID8gJ19fZnVuY3Rpb25fc2V0X2lucHV0X3ZhbHVlX18nIDogMjA7XG52YXIgRnVuY3Rpb25SZXNldCQxID0gcHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09IFwicHJvZHVjdGlvblwiID8gJ19fZnVuY3Rpb25fcmVzZXRfXycgOiAyMTtcbnZhciBDb250cm9sbGVkUHJvcFVwZGF0ZWRTZWxlY3RlZEl0ZW0gPSBwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gXCJwcm9kdWN0aW9uXCIgPyAnX19jb250cm9sbGVkX3Byb3BfdXBkYXRlZF9zZWxlY3RlZF9pdGVtX18nIDogMjI7XG5cbnZhciBzdGF0ZUNoYW5nZVR5cGVzJDEgPSAvKiNfX1BVUkVfXyovT2JqZWN0LmZyZWV6ZSh7XG4gIF9fcHJvdG9fXzogbnVsbCxcbiAgQ29udHJvbGxlZFByb3BVcGRhdGVkU2VsZWN0ZWRJdGVtOiBDb250cm9sbGVkUHJvcFVwZGF0ZWRTZWxlY3RlZEl0ZW0sXG4gIEZ1bmN0aW9uQ2xvc2VNZW51OiBGdW5jdGlvbkNsb3NlTWVudSxcbiAgRnVuY3Rpb25PcGVuTWVudTogRnVuY3Rpb25PcGVuTWVudSxcbiAgRnVuY3Rpb25SZXNldDogRnVuY3Rpb25SZXNldCQxLFxuICBGdW5jdGlvblNlbGVjdEl0ZW06IEZ1bmN0aW9uU2VsZWN0SXRlbSxcbiAgRnVuY3Rpb25TZXRIaWdobGlnaHRlZEluZGV4OiBGdW5jdGlvblNldEhpZ2hsaWdodGVkSW5kZXgsXG4gIEZ1bmN0aW9uU2V0SW5wdXRWYWx1ZTogRnVuY3Rpb25TZXRJbnB1dFZhbHVlLFxuICBGdW5jdGlvblRvZ2dsZU1lbnU6IEZ1bmN0aW9uVG9nZ2xlTWVudSxcbiAgSW5wdXRCbHVyOiBJbnB1dEJsdXIsXG4gIElucHV0Q2hhbmdlOiBJbnB1dENoYW5nZSxcbiAgSW5wdXRDbGljazogSW5wdXRDbGljayxcbiAgSW5wdXRLZXlEb3duQXJyb3dEb3duOiBJbnB1dEtleURvd25BcnJvd0Rvd24sXG4gIElucHV0S2V5RG93bkFycm93VXA6IElucHV0S2V5RG93bkFycm93VXAsXG4gIElucHV0S2V5RG93bkVuZDogSW5wdXRLZXlEb3duRW5kLFxuICBJbnB1dEtleURvd25FbnRlcjogSW5wdXRLZXlEb3duRW50ZXIsXG4gIElucHV0S2V5RG93bkVzY2FwZTogSW5wdXRLZXlEb3duRXNjYXBlLFxuICBJbnB1dEtleURvd25Ib21lOiBJbnB1dEtleURvd25Ib21lLFxuICBJbnB1dEtleURvd25QYWdlRG93bjogSW5wdXRLZXlEb3duUGFnZURvd24sXG4gIElucHV0S2V5RG93blBhZ2VVcDogSW5wdXRLZXlEb3duUGFnZVVwLFxuICBJdGVtQ2xpY2s6IEl0ZW1DbGljayxcbiAgSXRlbU1vdXNlTW92ZTogSXRlbU1vdXNlTW92ZSxcbiAgTWVudU1vdXNlTGVhdmU6IE1lbnVNb3VzZUxlYXZlLFxuICBUb2dnbGVCdXR0b25DbGljazogVG9nZ2xlQnV0dG9uQ2xpY2tcbn0pO1xuXG5mdW5jdGlvbiBnZXRJbml0aWFsU3RhdGUkMShwcm9wcykge1xuICB2YXIgaW5pdGlhbFN0YXRlID0gZ2V0SW5pdGlhbFN0YXRlJDIocHJvcHMpO1xuICB2YXIgc2VsZWN0ZWRJdGVtID0gaW5pdGlhbFN0YXRlLnNlbGVjdGVkSXRlbTtcbiAgdmFyIGlucHV0VmFsdWUgPSBpbml0aWFsU3RhdGUuaW5wdXRWYWx1ZTtcbiAgaWYgKGlucHV0VmFsdWUgPT09ICcnICYmIHNlbGVjdGVkSXRlbSAmJiBwcm9wcy5kZWZhdWx0SW5wdXRWYWx1ZSA9PT0gdW5kZWZpbmVkICYmIHByb3BzLmluaXRpYWxJbnB1dFZhbHVlID09PSB1bmRlZmluZWQgJiYgcHJvcHMuaW5wdXRWYWx1ZSA9PT0gdW5kZWZpbmVkKSB7XG4gICAgaW5wdXRWYWx1ZSA9IHByb3BzLml0ZW1Ub1N0cmluZyhzZWxlY3RlZEl0ZW0pO1xuICB9XG4gIHJldHVybiBfZXh0ZW5kcyh7fSwgaW5pdGlhbFN0YXRlLCB7XG4gICAgaW5wdXRWYWx1ZTogaW5wdXRWYWx1ZVxuICB9KTtcbn1cbnZhciBwcm9wVHlwZXMkMSA9IF9leHRlbmRzKHt9LCBjb21tb25Ecm9wZG93blByb3BUeXBlcywge1xuICBpdGVtczogUHJvcFR5cGVzLmFycmF5LmlzUmVxdWlyZWQsXG4gIGlzSXRlbURpc2FibGVkOiBQcm9wVHlwZXMuZnVuYyxcbiAgaW5wdXRWYWx1ZTogUHJvcFR5cGVzLnN0cmluZyxcbiAgZGVmYXVsdElucHV0VmFsdWU6IFByb3BUeXBlcy5zdHJpbmcsXG4gIGluaXRpYWxJbnB1dFZhbHVlOiBQcm9wVHlwZXMuc3RyaW5nLFxuICBpbnB1dElkOiBQcm9wVHlwZXMuc3RyaW5nLFxuICBvbklucHV0VmFsdWVDaGFuZ2U6IFByb3BUeXBlcy5mdW5jXG59KTtcblxuLyoqXG4gKiBUaGUgdXNlQ29tYm9ib3ggdmVyc2lvbiBvZiB1c2VDb250cm9sbGVkUmVkdWNlciwgd2hpY2ggYWxzb1xuICogY2hlY2tzIGlmIHRoZSBjb250cm9sbGVkIHByb3Agc2VsZWN0ZWRJdGVtIGNoYW5nZWQgYmV0d2VlblxuICogcmVuZGVycy4gSWYgc28sIGl0IHdpbGwgYWxzbyB1cGRhdGUgaW5wdXRWYWx1ZSB3aXRoIGl0c1xuICogc3RyaW5nIGVxdWl2YWxlbnQuIEl0IHVzZXMgdGhlIGNvbW1vbiB1c2VFbmhhbmNlZFJlZHVjZXIgdG9cbiAqIGNvbXB1dGUgdGhlIHJlc3Qgb2YgdGhlIHN0YXRlLlxuICpcbiAqIEBwYXJhbSB7RnVuY3Rpb259IHJlZHVjZXIgUmVkdWNlciBmdW5jdGlvbiBmcm9tIGRvd25zaGlmdC5cbiAqIEBwYXJhbSB7T2JqZWN0fSBwcm9wcyBUaGUgaG9vayBwcm9wcywgYWxzbyBwYXNzZWQgdG8gY3JlYXRlSW5pdGlhbFN0YXRlLlxuICogQHBhcmFtIHtGdW5jdGlvbn0gY3JlYXRlSW5pdGlhbFN0YXRlIEZ1bmN0aW9uIHRoYXQgcmV0dXJucyB0aGUgaW5pdGlhbCBzdGF0ZS5cbiAqIEBwYXJhbSB7RnVuY3Rpb259IGlzU3RhdGVFcXVhbCBGdW5jdGlvbiB0aGF0IGNoZWNrcyBpZiBhIHByZXZpb3VzIHN0YXRlIGlzIGVxdWFsIHRvIHRoZSBuZXh0LlxuICogQHJldHVybnMge0FycmF5fSBBbiBhcnJheSB3aXRoIHRoZSBzdGF0ZSBhbmQgYW4gYWN0aW9uIGRpc3BhdGNoZXIuXG4gKi9cbmZ1bmN0aW9uIHVzZUNvbnRyb2xsZWRSZWR1Y2VyKHJlZHVjZXIsIHByb3BzLCBjcmVhdGVJbml0aWFsU3RhdGUsIGlzU3RhdGVFcXVhbCkge1xuICB2YXIgcHJldmlvdXNTZWxlY3RlZEl0ZW1SZWYgPSB1c2VSZWYoKTtcbiAgdmFyIF91c2VFbmhhbmNlZFJlZHVjZXIgPSB1c2VFbmhhbmNlZFJlZHVjZXIocmVkdWNlciwgcHJvcHMsIGNyZWF0ZUluaXRpYWxTdGF0ZSwgaXNTdGF0ZUVxdWFsKSxcbiAgICBzdGF0ZSA9IF91c2VFbmhhbmNlZFJlZHVjZXJbMF0sXG4gICAgZGlzcGF0Y2ggPSBfdXNlRW5oYW5jZWRSZWR1Y2VyWzFdO1xuICB2YXIgaXNJbml0aWFsTW91bnQgPSB1c2VJc0luaXRpYWxNb3VudCgpO1xuICB1c2VFZmZlY3QoZnVuY3Rpb24gKCkge1xuICAgIGlmICghaXNDb250cm9sbGVkUHJvcChwcm9wcywgJ3NlbGVjdGVkSXRlbScpKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIGlmICghaXNJbml0aWFsTW91bnQgLy8gb24gZmlyc3QgbW91bnQgd2UgYWxyZWFkeSBoYXZlIHRoZSBwcm9wZXIgaW5wdXRWYWx1ZSBmb3IgYSBpbml0aWFsIHNlbGVjdGVkIGl0ZW0uXG4gICAgKSB7XG4gICAgICB2YXIgc2hvdWxkQ2FsbERpc3BhdGNoID0gcHJvcHMuaXRlbVRvS2V5KHByb3BzLnNlbGVjdGVkSXRlbSkgIT09IHByb3BzLml0ZW1Ub0tleShwcmV2aW91c1NlbGVjdGVkSXRlbVJlZi5jdXJyZW50KTtcbiAgICAgIGlmIChzaG91bGRDYWxsRGlzcGF0Y2gpIHtcbiAgICAgICAgZGlzcGF0Y2goe1xuICAgICAgICAgIHR5cGU6IENvbnRyb2xsZWRQcm9wVXBkYXRlZFNlbGVjdGVkSXRlbSxcbiAgICAgICAgICBpbnB1dFZhbHVlOiBwcm9wcy5pdGVtVG9TdHJpbmcocHJvcHMuc2VsZWN0ZWRJdGVtKVxuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICB9XG4gICAgcHJldmlvdXNTZWxlY3RlZEl0ZW1SZWYuY3VycmVudCA9IHN0YXRlLnNlbGVjdGVkSXRlbSA9PT0gcHJldmlvdXNTZWxlY3RlZEl0ZW1SZWYuY3VycmVudCA/IHByb3BzLnNlbGVjdGVkSXRlbSA6IHN0YXRlLnNlbGVjdGVkSXRlbTtcbiAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgcmVhY3QtaG9va3MvZXhoYXVzdGl2ZS1kZXBzXG4gIH0sIFtzdGF0ZS5zZWxlY3RlZEl0ZW0sIHByb3BzLnNlbGVjdGVkSXRlbV0pO1xuICByZXR1cm4gW2dldFN0YXRlKHN0YXRlLCBwcm9wcyksIGRpc3BhdGNoXTtcbn1cblxuLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIGltcG9ydC9uby1tdXRhYmxlLWV4cG9ydHNcbnZhciB2YWxpZGF0ZVByb3BUeXBlcyQxID0gbm9vcDtcbi8qIGlzdGFuYnVsIGlnbm9yZSBuZXh0ICovXG5pZiAocHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09ICdwcm9kdWN0aW9uJykge1xuICB2YWxpZGF0ZVByb3BUeXBlcyQxID0gZnVuY3Rpb24gdmFsaWRhdGVQcm9wVHlwZXMob3B0aW9ucywgY2FsbGVyKSB7XG4gICAgUHJvcFR5cGVzLmNoZWNrUHJvcFR5cGVzKHByb3BUeXBlcyQxLCBvcHRpb25zLCAncHJvcCcsIGNhbGxlci5uYW1lKTtcbiAgfTtcbn1cbnZhciBkZWZhdWx0UHJvcHMkMSA9IF9leHRlbmRzKHt9LCBkZWZhdWx0UHJvcHMkMywge1xuICBpc0l0ZW1EaXNhYmxlZDogZnVuY3Rpb24gaXNJdGVtRGlzYWJsZWQoKSB7XG4gICAgcmV0dXJuIGZhbHNlO1xuICB9XG59KTtcblxuLyogZXNsaW50LWRpc2FibGUgY29tcGxleGl0eSAqL1xuZnVuY3Rpb24gZG93bnNoaWZ0VXNlQ29tYm9ib3hSZWR1Y2VyKHN0YXRlLCBhY3Rpb24pIHtcbiAgdmFyIF9wcm9wcyRpdGVtcztcbiAgdmFyIHR5cGUgPSBhY3Rpb24udHlwZSxcbiAgICBwcm9wcyA9IGFjdGlvbi5wcm9wcyxcbiAgICBhbHRLZXkgPSBhY3Rpb24uYWx0S2V5O1xuICB2YXIgY2hhbmdlcztcbiAgc3dpdGNoICh0eXBlKSB7XG4gICAgY2FzZSBJdGVtQ2xpY2s6XG4gICAgICBjaGFuZ2VzID0ge1xuICAgICAgICBpc09wZW46IGdldERlZmF1bHRWYWx1ZSQxKHByb3BzLCAnaXNPcGVuJyksXG4gICAgICAgIGhpZ2hsaWdodGVkSW5kZXg6IGdldERlZmF1bHRIaWdobGlnaHRlZEluZGV4KHByb3BzKSxcbiAgICAgICAgc2VsZWN0ZWRJdGVtOiBwcm9wcy5pdGVtc1thY3Rpb24uaW5kZXhdLFxuICAgICAgICBpbnB1dFZhbHVlOiBwcm9wcy5pdGVtVG9TdHJpbmcocHJvcHMuaXRlbXNbYWN0aW9uLmluZGV4XSlcbiAgICAgIH07XG4gICAgICBicmVhaztcbiAgICBjYXNlIElucHV0S2V5RG93bkFycm93RG93bjpcbiAgICAgIGlmIChzdGF0ZS5pc09wZW4pIHtcbiAgICAgICAgY2hhbmdlcyA9IHtcbiAgICAgICAgICBoaWdobGlnaHRlZEluZGV4OiBnZXRIaWdobGlnaHRlZEluZGV4KHN0YXRlLmhpZ2hsaWdodGVkSW5kZXgsIDEsIHByb3BzLml0ZW1zLCBwcm9wcy5pc0l0ZW1EaXNhYmxlZCwgdHJ1ZSlcbiAgICAgICAgfTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGNoYW5nZXMgPSB7XG4gICAgICAgICAgaGlnaGxpZ2h0ZWRJbmRleDogYWx0S2V5ICYmIHN0YXRlLnNlbGVjdGVkSXRlbSA9PSBudWxsID8gLTEgOiBnZXRIaWdobGlnaHRlZEluZGV4T25PcGVuKHByb3BzLCBzdGF0ZSwgMSksXG4gICAgICAgICAgaXNPcGVuOiBwcm9wcy5pdGVtcy5sZW5ndGggPj0gMFxuICAgICAgICB9O1xuICAgICAgfVxuICAgICAgYnJlYWs7XG4gICAgY2FzZSBJbnB1dEtleURvd25BcnJvd1VwOlxuICAgICAgaWYgKHN0YXRlLmlzT3Blbikge1xuICAgICAgICBpZiAoYWx0S2V5KSB7XG4gICAgICAgICAgY2hhbmdlcyA9IGdldENoYW5nZXNPblNlbGVjdGlvbihwcm9wcywgc3RhdGUuaGlnaGxpZ2h0ZWRJbmRleCk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgY2hhbmdlcyA9IHtcbiAgICAgICAgICAgIGhpZ2hsaWdodGVkSW5kZXg6IGdldEhpZ2hsaWdodGVkSW5kZXgoc3RhdGUuaGlnaGxpZ2h0ZWRJbmRleCwgLTEsIHByb3BzLml0ZW1zLCBwcm9wcy5pc0l0ZW1EaXNhYmxlZCwgdHJ1ZSlcbiAgICAgICAgICB9O1xuICAgICAgICB9XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBjaGFuZ2VzID0ge1xuICAgICAgICAgIGhpZ2hsaWdodGVkSW5kZXg6IGdldEhpZ2hsaWdodGVkSW5kZXhPbk9wZW4ocHJvcHMsIHN0YXRlLCAtMSksXG4gICAgICAgICAgaXNPcGVuOiBwcm9wcy5pdGVtcy5sZW5ndGggPj0gMFxuICAgICAgICB9O1xuICAgICAgfVxuICAgICAgYnJlYWs7XG4gICAgY2FzZSBJbnB1dEtleURvd25FbnRlcjpcbiAgICAgIGNoYW5nZXMgPSBnZXRDaGFuZ2VzT25TZWxlY3Rpb24ocHJvcHMsIHN0YXRlLmhpZ2hsaWdodGVkSW5kZXgpO1xuICAgICAgYnJlYWs7XG4gICAgY2FzZSBJbnB1dEtleURvd25Fc2NhcGU6XG4gICAgICBjaGFuZ2VzID0gX2V4dGVuZHMoe1xuICAgICAgICBpc09wZW46IGZhbHNlLFxuICAgICAgICBoaWdobGlnaHRlZEluZGV4OiAtMVxuICAgICAgfSwgIXN0YXRlLmlzT3BlbiAmJiB7XG4gICAgICAgIHNlbGVjdGVkSXRlbTogbnVsbCxcbiAgICAgICAgaW5wdXRWYWx1ZTogJydcbiAgICAgIH0pO1xuICAgICAgYnJlYWs7XG4gICAgY2FzZSBJbnB1dEtleURvd25QYWdlVXA6XG4gICAgICBjaGFuZ2VzID0ge1xuICAgICAgICBoaWdobGlnaHRlZEluZGV4OiBnZXRIaWdobGlnaHRlZEluZGV4KHN0YXRlLmhpZ2hsaWdodGVkSW5kZXgsIC0xMCwgcHJvcHMuaXRlbXMsIHByb3BzLmlzSXRlbURpc2FibGVkLCB0cnVlKVxuICAgICAgfTtcbiAgICAgIGJyZWFrO1xuICAgIGNhc2UgSW5wdXRLZXlEb3duUGFnZURvd246XG4gICAgICBjaGFuZ2VzID0ge1xuICAgICAgICBoaWdobGlnaHRlZEluZGV4OiBnZXRIaWdobGlnaHRlZEluZGV4KHN0YXRlLmhpZ2hsaWdodGVkSW5kZXgsIDEwLCBwcm9wcy5pdGVtcywgcHJvcHMuaXNJdGVtRGlzYWJsZWQsIHRydWUpXG4gICAgICB9O1xuICAgICAgYnJlYWs7XG4gICAgY2FzZSBJbnB1dEtleURvd25Ib21lOlxuICAgICAgY2hhbmdlcyA9IHtcbiAgICAgICAgaGlnaGxpZ2h0ZWRJbmRleDogZ2V0Tm9uRGlzYWJsZWRJbmRleCgwLCBmYWxzZSwgcHJvcHMuaXRlbXMsIHByb3BzLmlzSXRlbURpc2FibGVkKVxuICAgICAgfTtcbiAgICAgIGJyZWFrO1xuICAgIGNhc2UgSW5wdXRLZXlEb3duRW5kOlxuICAgICAgY2hhbmdlcyA9IHtcbiAgICAgICAgaGlnaGxpZ2h0ZWRJbmRleDogZ2V0Tm9uRGlzYWJsZWRJbmRleChwcm9wcy5pdGVtcy5sZW5ndGggLSAxLCB0cnVlLCBwcm9wcy5pdGVtcywgcHJvcHMuaXNJdGVtRGlzYWJsZWQpXG4gICAgICB9O1xuICAgICAgYnJlYWs7XG4gICAgY2FzZSBJbnB1dEJsdXI6XG4gICAgICBjaGFuZ2VzID0gX2V4dGVuZHMoe1xuICAgICAgICBpc09wZW46IGZhbHNlLFxuICAgICAgICBoaWdobGlnaHRlZEluZGV4OiAtMVxuICAgICAgfSwgc3RhdGUuaGlnaGxpZ2h0ZWRJbmRleCA+PSAwICYmICgoX3Byb3BzJGl0ZW1zID0gcHJvcHMuaXRlbXMpID09IG51bGwgPyB2b2lkIDAgOiBfcHJvcHMkaXRlbXMubGVuZ3RoKSAmJiBhY3Rpb24uc2VsZWN0SXRlbSAmJiB7XG4gICAgICAgIHNlbGVjdGVkSXRlbTogcHJvcHMuaXRlbXNbc3RhdGUuaGlnaGxpZ2h0ZWRJbmRleF0sXG4gICAgICAgIGlucHV0VmFsdWU6IHByb3BzLml0ZW1Ub1N0cmluZyhwcm9wcy5pdGVtc1tzdGF0ZS5oaWdobGlnaHRlZEluZGV4XSlcbiAgICAgIH0pO1xuICAgICAgYnJlYWs7XG4gICAgY2FzZSBJbnB1dENoYW5nZTpcbiAgICAgIGNoYW5nZXMgPSB7XG4gICAgICAgIGlzT3BlbjogdHJ1ZSxcbiAgICAgICAgaGlnaGxpZ2h0ZWRJbmRleDogZ2V0RGVmYXVsdEhpZ2hsaWdodGVkSW5kZXgocHJvcHMpLFxuICAgICAgICBpbnB1dFZhbHVlOiBhY3Rpb24uaW5wdXRWYWx1ZVxuICAgICAgfTtcbiAgICAgIGJyZWFrO1xuICAgIGNhc2UgSW5wdXRDbGljazpcbiAgICAgIGNoYW5nZXMgPSB7XG4gICAgICAgIGlzT3BlbjogIXN0YXRlLmlzT3BlbixcbiAgICAgICAgaGlnaGxpZ2h0ZWRJbmRleDogc3RhdGUuaXNPcGVuID8gLTEgOiBnZXRIaWdobGlnaHRlZEluZGV4T25PcGVuKHByb3BzLCBzdGF0ZSwgMClcbiAgICAgIH07XG4gICAgICBicmVhaztcbiAgICBjYXNlIEZ1bmN0aW9uU2VsZWN0SXRlbTpcbiAgICAgIGNoYW5nZXMgPSB7XG4gICAgICAgIHNlbGVjdGVkSXRlbTogYWN0aW9uLnNlbGVjdGVkSXRlbSxcbiAgICAgICAgaW5wdXRWYWx1ZTogcHJvcHMuaXRlbVRvU3RyaW5nKGFjdGlvbi5zZWxlY3RlZEl0ZW0pXG4gICAgICB9O1xuICAgICAgYnJlYWs7XG4gICAgY2FzZSBDb250cm9sbGVkUHJvcFVwZGF0ZWRTZWxlY3RlZEl0ZW06XG4gICAgICBjaGFuZ2VzID0ge1xuICAgICAgICBpbnB1dFZhbHVlOiBhY3Rpb24uaW5wdXRWYWx1ZVxuICAgICAgfTtcbiAgICAgIGJyZWFrO1xuICAgIGRlZmF1bHQ6XG4gICAgICByZXR1cm4gZG93bnNoaWZ0Q29tbW9uUmVkdWNlcihzdGF0ZSwgYWN0aW9uLCBzdGF0ZUNoYW5nZVR5cGVzJDEpO1xuICB9XG4gIHJldHVybiBfZXh0ZW5kcyh7fSwgc3RhdGUsIGNoYW5nZXMpO1xufVxuLyogZXNsaW50LWVuYWJsZSBjb21wbGV4aXR5ICovXG5cbnZhciBfZXhjbHVkZWQkMSA9IFtcIm9uTW91c2VMZWF2ZVwiLCBcInJlZktleVwiLCBcInJlZlwiXSxcbiAgX2V4Y2x1ZGVkMiQxID0gW1wiaXRlbVwiLCBcImluZGV4XCIsIFwicmVmS2V5XCIsIFwicmVmXCIsIFwib25Nb3VzZU1vdmVcIiwgXCJvbk1vdXNlRG93blwiLCBcIm9uQ2xpY2tcIiwgXCJvblByZXNzXCIsIFwiZGlzYWJsZWRcIl0sXG4gIF9leGNsdWRlZDMgPSBbXCJvbkNsaWNrXCIsIFwib25QcmVzc1wiLCBcInJlZktleVwiLCBcInJlZlwiXSxcbiAgX2V4Y2x1ZGVkNCA9IFtcIm9uS2V5RG93blwiLCBcIm9uQ2hhbmdlXCIsIFwib25JbnB1dFwiLCBcIm9uQmx1clwiLCBcIm9uQ2hhbmdlVGV4dFwiLCBcIm9uQ2xpY2tcIiwgXCJyZWZLZXlcIiwgXCJyZWZcIl07XG51c2VDb21ib2JveC5zdGF0ZUNoYW5nZVR5cGVzID0gc3RhdGVDaGFuZ2VUeXBlcyQxO1xuZnVuY3Rpb24gdXNlQ29tYm9ib3godXNlclByb3BzKSB7XG4gIGlmICh1c2VyUHJvcHMgPT09IHZvaWQgMCkge1xuICAgIHVzZXJQcm9wcyA9IHt9O1xuICB9XG4gIHZhbGlkYXRlUHJvcFR5cGVzJDEodXNlclByb3BzLCB1c2VDb21ib2JveCk7XG4gIC8vIFByb3BzIGRlZmF1bHRzIGFuZCBkZXN0cnVjdHVyaW5nLlxuICB2YXIgcHJvcHMgPSBfZXh0ZW5kcyh7fSwgZGVmYXVsdFByb3BzJDEsIHVzZXJQcm9wcyk7XG4gIHZhciBpdGVtcyA9IHByb3BzLml0ZW1zLFxuICAgIHNjcm9sbEludG9WaWV3ID0gcHJvcHMuc2Nyb2xsSW50b1ZpZXcsXG4gICAgZW52aXJvbm1lbnQgPSBwcm9wcy5lbnZpcm9ubWVudCxcbiAgICBnZXRBMTF5U3RhdHVzTWVzc2FnZSA9IHByb3BzLmdldEExMXlTdGF0dXNNZXNzYWdlO1xuICAvLyBJbml0aWFsIHN0YXRlIGRlcGVuZGluZyBvbiBjb250cm9sbGVkIHByb3BzLlxuICB2YXIgX3VzZUNvbnRyb2xsZWRSZWR1Y2VyID0gdXNlQ29udHJvbGxlZFJlZHVjZXIoZG93bnNoaWZ0VXNlQ29tYm9ib3hSZWR1Y2VyLCBwcm9wcywgZ2V0SW5pdGlhbFN0YXRlJDEsIGlzRHJvcGRvd25zU3RhdGVFcXVhbCksXG4gICAgc3RhdGUgPSBfdXNlQ29udHJvbGxlZFJlZHVjZXJbMF0sXG4gICAgZGlzcGF0Y2ggPSBfdXNlQ29udHJvbGxlZFJlZHVjZXJbMV07XG4gIHZhciBpc09wZW4gPSBzdGF0ZS5pc09wZW4sXG4gICAgaGlnaGxpZ2h0ZWRJbmRleCA9IHN0YXRlLmhpZ2hsaWdodGVkSW5kZXgsXG4gICAgc2VsZWN0ZWRJdGVtID0gc3RhdGUuc2VsZWN0ZWRJdGVtLFxuICAgIGlucHV0VmFsdWUgPSBzdGF0ZS5pbnB1dFZhbHVlO1xuXG4gIC8vIEVsZW1lbnQgcmVmcy5cbiAgdmFyIG1lbnVSZWYgPSB1c2VSZWYobnVsbCk7XG4gIHZhciBpdGVtUmVmcyA9IHVzZVJlZih7fSk7XG4gIHZhciBpbnB1dFJlZiA9IHVzZVJlZihudWxsKTtcbiAgdmFyIHRvZ2dsZUJ1dHRvblJlZiA9IHVzZVJlZihudWxsKTtcbiAgdmFyIGlzSW5pdGlhbE1vdW50ID0gdXNlSXNJbml0aWFsTW91bnQoKTtcblxuICAvLyBwcmV2ZW50IGlkIHJlLWdlbmVyYXRpb24gYmV0d2VlbiByZW5kZXJzLlxuICB2YXIgZWxlbWVudElkcyA9IHVzZUVsZW1lbnRJZHMocHJvcHMpO1xuICAvLyB1c2VkIHRvIGtlZXAgdHJhY2sgb2YgaG93IG1hbnkgaXRlbXMgd2UgaGFkIG9uIHByZXZpb3VzIGN5Y2xlLlxuICB2YXIgcHJldmlvdXNSZXN1bHRDb3VudFJlZiA9IHVzZVJlZigpO1xuICAvLyB1dGlsaXR5IGNhbGxiYWNrIHRvIGdldCBpdGVtIGVsZW1lbnQuXG4gIHZhciBsYXRlc3QgPSB1c2VMYXRlc3RSZWYoe1xuICAgIHN0YXRlOiBzdGF0ZSxcbiAgICBwcm9wczogcHJvcHNcbiAgfSk7XG4gIHZhciBnZXRJdGVtTm9kZUZyb21JbmRleCA9IHVzZUNhbGxiYWNrKGZ1bmN0aW9uIChpbmRleCkge1xuICAgIHJldHVybiBpdGVtUmVmcy5jdXJyZW50W2VsZW1lbnRJZHMuZ2V0SXRlbUlkKGluZGV4KV07XG4gIH0sIFtlbGVtZW50SWRzXSk7XG5cbiAgLy8gRWZmZWN0cy5cbiAgLy8gQWRkcyBhbiBhMTF5IGFyaWEgbGl2ZSBzdGF0dXMgbWVzc2FnZSBpZiBnZXRBMTF5U3RhdHVzTWVzc2FnZSBpcyBwYXNzZWQuXG4gIHVzZUExMXlNZXNzYWdlU3RhdHVzKGdldEExMXlTdGF0dXNNZXNzYWdlLCBzdGF0ZSwgW2lzT3BlbiwgaGlnaGxpZ2h0ZWRJbmRleCwgc2VsZWN0ZWRJdGVtLCBpbnB1dFZhbHVlXSwgZW52aXJvbm1lbnQpO1xuICAvLyBTY3JvbGwgb24gaGlnaGxpZ2h0ZWQgaXRlbSBpZiBjaGFuZ2UgY29tZXMgZnJvbSBrZXlib2FyZC5cbiAgdmFyIHNob3VsZFNjcm9sbFJlZiA9IHVzZVNjcm9sbEludG9WaWV3KHtcbiAgICBtZW51RWxlbWVudDogbWVudVJlZi5jdXJyZW50LFxuICAgIGhpZ2hsaWdodGVkSW5kZXg6IGhpZ2hsaWdodGVkSW5kZXgsXG4gICAgaXNPcGVuOiBpc09wZW4sXG4gICAgaXRlbVJlZnM6IGl0ZW1SZWZzLFxuICAgIHNjcm9sbEludG9WaWV3OiBzY3JvbGxJbnRvVmlldyxcbiAgICBnZXRJdGVtTm9kZUZyb21JbmRleDogZ2V0SXRlbU5vZGVGcm9tSW5kZXhcbiAgfSk7XG4gIHVzZUNvbnRyb2xQcm9wc1ZhbGlkYXRvcih7XG4gICAgcHJvcHM6IHByb3BzLFxuICAgIHN0YXRlOiBzdGF0ZVxuICB9KTtcbiAgLy8gRm9jdXMgdGhlIGlucHV0IG9uIGZpcnN0IHJlbmRlciBpZiByZXF1aXJlZC5cbiAgdXNlRWZmZWN0KGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgZm9jdXNPbk9wZW4gPSBnZXRJbml0aWFsVmFsdWUkMShwcm9wcywgJ2lzT3BlbicpO1xuICAgIGlmIChmb2N1c09uT3BlbiAmJiBpbnB1dFJlZi5jdXJyZW50KSB7XG4gICAgICBpbnB1dFJlZi5jdXJyZW50LmZvY3VzKCk7XG4gICAgfVxuICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSByZWFjdC1ob29rcy9leGhhdXN0aXZlLWRlcHNcbiAgfSwgW10pO1xuICB1c2VFZmZlY3QoZnVuY3Rpb24gKCkge1xuICAgIGlmICghaXNJbml0aWFsTW91bnQpIHtcbiAgICAgIHByZXZpb3VzUmVzdWx0Q291bnRSZWYuY3VycmVudCA9IGl0ZW1zLmxlbmd0aDtcbiAgICB9XG4gIH0pO1xuICB2YXIgbW91c2VBbmRUb3VjaFRyYWNrZXJzID0gdXNlTW91c2VBbmRUb3VjaFRyYWNrZXIoZW52aXJvbm1lbnQsIHVzZUNhbGxiYWNrKGZ1bmN0aW9uIGhhbmRsZUJsdXIoKSB7XG4gICAgaWYgKGxhdGVzdC5jdXJyZW50LnN0YXRlLmlzT3Blbikge1xuICAgICAgZGlzcGF0Y2goe1xuICAgICAgICB0eXBlOiBJbnB1dEJsdXIsXG4gICAgICAgIHNlbGVjdEl0ZW06IGZhbHNlXG4gICAgICB9KTtcbiAgICB9XG4gIH0sIFtkaXNwYXRjaCwgbGF0ZXN0XSksIHVzZU1lbW8oZnVuY3Rpb24gKCkge1xuICAgIHJldHVybiBbbWVudVJlZiwgdG9nZ2xlQnV0dG9uUmVmLCBpbnB1dFJlZl07XG4gIH0sIFttZW51UmVmLmN1cnJlbnQsIHRvZ2dsZUJ1dHRvblJlZi5jdXJyZW50LCBpbnB1dFJlZi5jdXJyZW50XSkpO1xuICB2YXIgc2V0R2V0dGVyUHJvcENhbGxJbmZvID0gdXNlR2V0dGVyUHJvcHNDYWxsZWRDaGVja2VyKCdnZXRJbnB1dFByb3BzJywgJ2dldE1lbnVQcm9wcycpO1xuICAvLyBSZXNldCBpdGVtUmVmcyBvbiBjbG9zZS5cbiAgdXNlRWZmZWN0KGZ1bmN0aW9uICgpIHtcbiAgICBpZiAoIWlzT3Blbikge1xuICAgICAgaXRlbVJlZnMuY3VycmVudCA9IHt9O1xuICAgIH1cbiAgfSwgW2lzT3Blbl0pO1xuICAvLyBSZXNldCBpdGVtUmVmcyBvbiBjbG9zZS5cbiAgdXNlRWZmZWN0KGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgX2lucHV0UmVmJGN1cnJlbnQ7XG4gICAgaWYgKCFpc09wZW4gfHwgIShlbnZpcm9ubWVudCAhPSBudWxsICYmIGVudmlyb25tZW50LmRvY3VtZW50KSB8fCAhKGlucHV0UmVmICE9IG51bGwgJiYgKF9pbnB1dFJlZiRjdXJyZW50ID0gaW5wdXRSZWYuY3VycmVudCkgIT0gbnVsbCAmJiBfaW5wdXRSZWYkY3VycmVudC5mb2N1cykpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgaWYgKGVudmlyb25tZW50LmRvY3VtZW50LmFjdGl2ZUVsZW1lbnQgIT09IGlucHV0UmVmLmN1cnJlbnQpIHtcbiAgICAgIGlucHV0UmVmLmN1cnJlbnQuZm9jdXMoKTtcbiAgICB9XG4gIH0sIFtpc09wZW4sIGVudmlyb25tZW50XSk7XG5cbiAgLyogRXZlbnQgaGFuZGxlciBmdW5jdGlvbnMgKi9cbiAgdmFyIGlucHV0S2V5RG93bkhhbmRsZXJzID0gdXNlTWVtbyhmdW5jdGlvbiAoKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIEFycm93RG93bjogZnVuY3Rpb24gQXJyb3dEb3duKGV2ZW50KSB7XG4gICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgIGRpc3BhdGNoKHtcbiAgICAgICAgICB0eXBlOiBJbnB1dEtleURvd25BcnJvd0Rvd24sXG4gICAgICAgICAgYWx0S2V5OiBldmVudC5hbHRLZXlcbiAgICAgICAgfSk7XG4gICAgICB9LFxuICAgICAgQXJyb3dVcDogZnVuY3Rpb24gQXJyb3dVcChldmVudCkge1xuICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICBkaXNwYXRjaCh7XG4gICAgICAgICAgdHlwZTogSW5wdXRLZXlEb3duQXJyb3dVcCxcbiAgICAgICAgICBhbHRLZXk6IGV2ZW50LmFsdEtleVxuICAgICAgICB9KTtcbiAgICAgIH0sXG4gICAgICBIb21lOiBmdW5jdGlvbiBIb21lKGV2ZW50KSB7XG4gICAgICAgIGlmICghbGF0ZXN0LmN1cnJlbnQuc3RhdGUuaXNPcGVuKSB7XG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgIGRpc3BhdGNoKHtcbiAgICAgICAgICB0eXBlOiBJbnB1dEtleURvd25Ib21lXG4gICAgICAgIH0pO1xuICAgICAgfSxcbiAgICAgIEVuZDogZnVuY3Rpb24gRW5kKGV2ZW50KSB7XG4gICAgICAgIGlmICghbGF0ZXN0LmN1cnJlbnQuc3RhdGUuaXNPcGVuKSB7XG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgIGRpc3BhdGNoKHtcbiAgICAgICAgICB0eXBlOiBJbnB1dEtleURvd25FbmRcbiAgICAgICAgfSk7XG4gICAgICB9LFxuICAgICAgRXNjYXBlOiBmdW5jdGlvbiBFc2NhcGUoZXZlbnQpIHtcbiAgICAgICAgdmFyIGxhdGVzdFN0YXRlID0gbGF0ZXN0LmN1cnJlbnQuc3RhdGU7XG4gICAgICAgIGlmIChsYXRlc3RTdGF0ZS5pc09wZW4gfHwgbGF0ZXN0U3RhdGUuaW5wdXRWYWx1ZSB8fCBsYXRlc3RTdGF0ZS5zZWxlY3RlZEl0ZW0gfHwgbGF0ZXN0U3RhdGUuaGlnaGxpZ2h0ZWRJbmRleCA+IC0xKSB7XG4gICAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICBkaXNwYXRjaCh7XG4gICAgICAgICAgICB0eXBlOiBJbnB1dEtleURvd25Fc2NhcGVcbiAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgfSxcbiAgICAgIEVudGVyOiBmdW5jdGlvbiBFbnRlcihldmVudCkge1xuICAgICAgICB2YXIgbGF0ZXN0U3RhdGUgPSBsYXRlc3QuY3VycmVudC5zdGF0ZTtcbiAgICAgICAgLy8gaWYgY2xvc2VkIG9yIG5vIGhpZ2hsaWdodGVkIGluZGV4LCBkbyBub3RoaW5nLlxuICAgICAgICBpZiAoIWxhdGVzdFN0YXRlLmlzT3BlbiB8fCBldmVudC53aGljaCA9PT0gMjI5IC8vIGlmIElNRSBjb21wb3NpbmcsIHdhaXQgZm9yIG5leHQgRW50ZXIga2V5ZG93biBldmVudC5cbiAgICAgICAgKSB7XG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgIGRpc3BhdGNoKHtcbiAgICAgICAgICB0eXBlOiBJbnB1dEtleURvd25FbnRlclxuICAgICAgICB9KTtcbiAgICAgIH0sXG4gICAgICBQYWdlVXA6IGZ1bmN0aW9uIFBhZ2VVcChldmVudCkge1xuICAgICAgICBpZiAobGF0ZXN0LmN1cnJlbnQuc3RhdGUuaXNPcGVuKSB7XG4gICAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICBkaXNwYXRjaCh7XG4gICAgICAgICAgICB0eXBlOiBJbnB1dEtleURvd25QYWdlVXBcbiAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgfSxcbiAgICAgIFBhZ2VEb3duOiBmdW5jdGlvbiBQYWdlRG93bihldmVudCkge1xuICAgICAgICBpZiAobGF0ZXN0LmN1cnJlbnQuc3RhdGUuaXNPcGVuKSB7XG4gICAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICBkaXNwYXRjaCh7XG4gICAgICAgICAgICB0eXBlOiBJbnB1dEtleURvd25QYWdlRG93blxuICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfTtcbiAgfSwgW2Rpc3BhdGNoLCBsYXRlc3RdKTtcblxuICAvLyBHZXR0ZXIgcHJvcHMuXG4gIHZhciBnZXRMYWJlbFByb3BzID0gdXNlQ2FsbGJhY2soZnVuY3Rpb24gKGxhYmVsUHJvcHMpIHtcbiAgICByZXR1cm4gX2V4dGVuZHMoe1xuICAgICAgaWQ6IGVsZW1lbnRJZHMubGFiZWxJZCxcbiAgICAgIGh0bWxGb3I6IGVsZW1lbnRJZHMuaW5wdXRJZFxuICAgIH0sIGxhYmVsUHJvcHMpO1xuICB9LCBbZWxlbWVudElkc10pO1xuICB2YXIgZ2V0TWVudVByb3BzID0gdXNlQ2FsbGJhY2soZnVuY3Rpb24gKF90ZW1wLCBfdGVtcDIpIHtcbiAgICB2YXIgX2V4dGVuZHMyO1xuICAgIHZhciBfcmVmID0gX3RlbXAgPT09IHZvaWQgMCA/IHt9IDogX3RlbXAsXG4gICAgICBvbk1vdXNlTGVhdmUgPSBfcmVmLm9uTW91c2VMZWF2ZSxcbiAgICAgIF9yZWYkcmVmS2V5ID0gX3JlZi5yZWZLZXksXG4gICAgICByZWZLZXkgPSBfcmVmJHJlZktleSA9PT0gdm9pZCAwID8gJ3JlZicgOiBfcmVmJHJlZktleSxcbiAgICAgIHJlZiA9IF9yZWYucmVmLFxuICAgICAgcmVzdCA9IF9vYmplY3RXaXRob3V0UHJvcGVydGllc0xvb3NlKF9yZWYsIF9leGNsdWRlZCQxKTtcbiAgICB2YXIgX3JlZjIgPSBfdGVtcDIgPT09IHZvaWQgMCA/IHt9IDogX3RlbXAyLFxuICAgICAgX3JlZjIkc3VwcHJlc3NSZWZFcnJvID0gX3JlZjIuc3VwcHJlc3NSZWZFcnJvcixcbiAgICAgIHN1cHByZXNzUmVmRXJyb3IgPSBfcmVmMiRzdXBwcmVzc1JlZkVycm8gPT09IHZvaWQgMCA/IGZhbHNlIDogX3JlZjIkc3VwcHJlc3NSZWZFcnJvO1xuICAgIHNldEdldHRlclByb3BDYWxsSW5mbygnZ2V0TWVudVByb3BzJywgc3VwcHJlc3NSZWZFcnJvciwgcmVmS2V5LCBtZW51UmVmKTtcbiAgICByZXR1cm4gX2V4dGVuZHMoKF9leHRlbmRzMiA9IHt9LCBfZXh0ZW5kczJbcmVmS2V5XSA9IGhhbmRsZVJlZnMocmVmLCBmdW5jdGlvbiAobWVudU5vZGUpIHtcbiAgICAgIG1lbnVSZWYuY3VycmVudCA9IG1lbnVOb2RlO1xuICAgIH0pLCBfZXh0ZW5kczIuaWQgPSBlbGVtZW50SWRzLm1lbnVJZCwgX2V4dGVuZHMyLnJvbGUgPSAnbGlzdGJveCcsIF9leHRlbmRzMlsnYXJpYS1sYWJlbGxlZGJ5J10gPSByZXN0ICYmIHJlc3RbJ2FyaWEtbGFiZWwnXSA/IHVuZGVmaW5lZCA6IFwiXCIgKyBlbGVtZW50SWRzLmxhYmVsSWQsIF9leHRlbmRzMi5vbk1vdXNlTGVhdmUgPSBjYWxsQWxsRXZlbnRIYW5kbGVycyhvbk1vdXNlTGVhdmUsIGZ1bmN0aW9uICgpIHtcbiAgICAgIGRpc3BhdGNoKHtcbiAgICAgICAgdHlwZTogTWVudU1vdXNlTGVhdmVcbiAgICAgIH0pO1xuICAgIH0pLCBfZXh0ZW5kczIpLCByZXN0KTtcbiAgfSwgW2Rpc3BhdGNoLCBzZXRHZXR0ZXJQcm9wQ2FsbEluZm8sIGVsZW1lbnRJZHNdKTtcbiAgdmFyIGdldEl0ZW1Qcm9wcyA9IHVzZUNhbGxiYWNrKGZ1bmN0aW9uIChfdGVtcDMpIHtcbiAgICB2YXIgX2V4dGVuZHMzLCBfcmVmNDtcbiAgICB2YXIgX3JlZjMgPSBfdGVtcDMgPT09IHZvaWQgMCA/IHt9IDogX3RlbXAzLFxuICAgICAgaXRlbVByb3AgPSBfcmVmMy5pdGVtLFxuICAgICAgaW5kZXhQcm9wID0gX3JlZjMuaW5kZXgsXG4gICAgICBfcmVmMyRyZWZLZXkgPSBfcmVmMy5yZWZLZXksXG4gICAgICByZWZLZXkgPSBfcmVmMyRyZWZLZXkgPT09IHZvaWQgMCA/ICdyZWYnIDogX3JlZjMkcmVmS2V5LFxuICAgICAgcmVmID0gX3JlZjMucmVmLFxuICAgICAgb25Nb3VzZU1vdmUgPSBfcmVmMy5vbk1vdXNlTW92ZSxcbiAgICAgIG9uTW91c2VEb3duID0gX3JlZjMub25Nb3VzZURvd24sXG4gICAgICBvbkNsaWNrID0gX3JlZjMub25DbGljaztcbiAgICAgIF9yZWYzLm9uUHJlc3M7XG4gICAgICB2YXIgZGlzYWJsZWRQcm9wID0gX3JlZjMuZGlzYWJsZWQsXG4gICAgICByZXN0ID0gX29iamVjdFdpdGhvdXRQcm9wZXJ0aWVzTG9vc2UoX3JlZjMsIF9leGNsdWRlZDIkMSk7XG4gICAgaWYgKGRpc2FibGVkUHJvcCAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICBjb25zb2xlLndhcm4oJ1Bhc3NpbmcgXCJkaXNhYmxlZFwiIGFzIGFuIGFyZ3VtZW50IHRvIGdldEl0ZW1Qcm9wcyBpcyBub3Qgc3VwcG9ydGVkIGFueW1vcmUuIFBsZWFzZSB1c2UgdGhlIGlzSXRlbURpc2FibGVkIHByb3AgZnJvbSB1c2VDb21ib2JveC4nKTtcbiAgICB9XG4gICAgdmFyIF9sYXRlc3QkY3VycmVudCA9IGxhdGVzdC5jdXJyZW50LFxuICAgICAgbGF0ZXN0UHJvcHMgPSBfbGF0ZXN0JGN1cnJlbnQucHJvcHMsXG4gICAgICBsYXRlc3RTdGF0ZSA9IF9sYXRlc3QkY3VycmVudC5zdGF0ZTtcbiAgICB2YXIgX2dldEl0ZW1BbmRJbmRleCA9IGdldEl0ZW1BbmRJbmRleChpdGVtUHJvcCwgaW5kZXhQcm9wLCBsYXRlc3RQcm9wcy5pdGVtcywgJ1Bhc3MgZWl0aGVyIGl0ZW0gb3IgaW5kZXggdG8gZ2V0SXRlbVByb3BzIScpLFxuICAgICAgaXRlbSA9IF9nZXRJdGVtQW5kSW5kZXhbMF0sXG4gICAgICBpbmRleCA9IF9nZXRJdGVtQW5kSW5kZXhbMV07XG4gICAgdmFyIGRpc2FibGVkID0gbGF0ZXN0UHJvcHMuaXNJdGVtRGlzYWJsZWQoaXRlbSwgaW5kZXgpO1xuICAgIHZhciBvblNlbGVjdEtleSA9ICdvbkNsaWNrJztcbiAgICB2YXIgY3VzdG9tQ2xpY2tIYW5kbGVyID0gb25DbGljaztcbiAgICB2YXIgaXRlbUhhbmRsZU1vdXNlTW92ZSA9IGZ1bmN0aW9uIGl0ZW1IYW5kbGVNb3VzZU1vdmUoKSB7XG4gICAgICBpZiAobW91c2VBbmRUb3VjaFRyYWNrZXJzLmlzVG91Y2hFbmQgfHwgaW5kZXggPT09IGxhdGVzdFN0YXRlLmhpZ2hsaWdodGVkSW5kZXgpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgICAgc2hvdWxkU2Nyb2xsUmVmLmN1cnJlbnQgPSBmYWxzZTtcbiAgICAgIGRpc3BhdGNoKHtcbiAgICAgICAgdHlwZTogSXRlbU1vdXNlTW92ZSxcbiAgICAgICAgaW5kZXg6IGluZGV4LFxuICAgICAgICBkaXNhYmxlZDogZGlzYWJsZWRcbiAgICAgIH0pO1xuICAgIH07XG4gICAgdmFyIGl0ZW1IYW5kbGVDbGljayA9IGZ1bmN0aW9uIGl0ZW1IYW5kbGVDbGljaygpIHtcbiAgICAgIGRpc3BhdGNoKHtcbiAgICAgICAgdHlwZTogSXRlbUNsaWNrLFxuICAgICAgICBpbmRleDogaW5kZXhcbiAgICAgIH0pO1xuICAgIH07XG4gICAgdmFyIGl0ZW1IYW5kbGVNb3VzZURvd24gPSBmdW5jdGlvbiBpdGVtSGFuZGxlTW91c2VEb3duKGUpIHtcbiAgICAgIHJldHVybiBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgfTsgLy8ga2VlcCBmb2N1cyBvbiB0aGUgaW5wdXQgYWZ0ZXIgaXRlbSBjbGljayBzZWxlY3QuXG5cbiAgICByZXR1cm4gX2V4dGVuZHMoKF9leHRlbmRzMyA9IHt9LCBfZXh0ZW5kczNbcmVmS2V5XSA9IGhhbmRsZVJlZnMocmVmLCBmdW5jdGlvbiAoaXRlbU5vZGUpIHtcbiAgICAgIGlmIChpdGVtTm9kZSkge1xuICAgICAgICBpdGVtUmVmcy5jdXJyZW50W2VsZW1lbnRJZHMuZ2V0SXRlbUlkKGluZGV4KV0gPSBpdGVtTm9kZTtcbiAgICAgIH1cbiAgICB9KSwgX2V4dGVuZHMzWydhcmlhLWRpc2FibGVkJ10gPSBkaXNhYmxlZCwgX2V4dGVuZHMzWydhcmlhLXNlbGVjdGVkJ10gPSBpbmRleCA9PT0gbGF0ZXN0U3RhdGUuaGlnaGxpZ2h0ZWRJbmRleCwgX2V4dGVuZHMzLmlkID0gZWxlbWVudElkcy5nZXRJdGVtSWQoaW5kZXgpLCBfZXh0ZW5kczMucm9sZSA9ICdvcHRpb24nLCBfZXh0ZW5kczMpLCAhZGlzYWJsZWQgJiYgKF9yZWY0ID0ge30sIF9yZWY0W29uU2VsZWN0S2V5XSA9IGNhbGxBbGxFdmVudEhhbmRsZXJzKGN1c3RvbUNsaWNrSGFuZGxlciwgaXRlbUhhbmRsZUNsaWNrKSwgX3JlZjQpLCB7XG4gICAgICBvbk1vdXNlTW92ZTogY2FsbEFsbEV2ZW50SGFuZGxlcnMob25Nb3VzZU1vdmUsIGl0ZW1IYW5kbGVNb3VzZU1vdmUpLFxuICAgICAgb25Nb3VzZURvd246IGNhbGxBbGxFdmVudEhhbmRsZXJzKG9uTW91c2VEb3duLCBpdGVtSGFuZGxlTW91c2VEb3duKVxuICAgIH0sIHJlc3QpO1xuICB9LCBbZGlzcGF0Y2gsIGVsZW1lbnRJZHMsIGxhdGVzdCwgbW91c2VBbmRUb3VjaFRyYWNrZXJzLCBzaG91bGRTY3JvbGxSZWZdKTtcbiAgdmFyIGdldFRvZ2dsZUJ1dHRvblByb3BzID0gdXNlQ2FsbGJhY2soZnVuY3Rpb24gKF90ZW1wNCkge1xuICAgIHZhciBfZXh0ZW5kczQ7XG4gICAgdmFyIF9yZWY1ID0gX3RlbXA0ID09PSB2b2lkIDAgPyB7fSA6IF90ZW1wNCxcbiAgICAgIG9uQ2xpY2sgPSBfcmVmNS5vbkNsaWNrO1xuICAgICAgX3JlZjUub25QcmVzcztcbiAgICAgIHZhciBfcmVmNSRyZWZLZXkgPSBfcmVmNS5yZWZLZXksXG4gICAgICByZWZLZXkgPSBfcmVmNSRyZWZLZXkgPT09IHZvaWQgMCA/ICdyZWYnIDogX3JlZjUkcmVmS2V5LFxuICAgICAgcmVmID0gX3JlZjUucmVmLFxuICAgICAgcmVzdCA9IF9vYmplY3RXaXRob3V0UHJvcGVydGllc0xvb3NlKF9yZWY1LCBfZXhjbHVkZWQzKTtcbiAgICB2YXIgbGF0ZXN0U3RhdGUgPSBsYXRlc3QuY3VycmVudC5zdGF0ZTtcbiAgICB2YXIgdG9nZ2xlQnV0dG9uSGFuZGxlQ2xpY2sgPSBmdW5jdGlvbiB0b2dnbGVCdXR0b25IYW5kbGVDbGljaygpIHtcbiAgICAgIGRpc3BhdGNoKHtcbiAgICAgICAgdHlwZTogVG9nZ2xlQnV0dG9uQ2xpY2tcbiAgICAgIH0pO1xuICAgIH07XG4gICAgcmV0dXJuIF9leHRlbmRzKChfZXh0ZW5kczQgPSB7fSwgX2V4dGVuZHM0W3JlZktleV0gPSBoYW5kbGVSZWZzKHJlZiwgZnVuY3Rpb24gKHRvZ2dsZUJ1dHRvbk5vZGUpIHtcbiAgICAgIHRvZ2dsZUJ1dHRvblJlZi5jdXJyZW50ID0gdG9nZ2xlQnV0dG9uTm9kZTtcbiAgICB9KSwgX2V4dGVuZHM0WydhcmlhLWNvbnRyb2xzJ10gPSBlbGVtZW50SWRzLm1lbnVJZCwgX2V4dGVuZHM0WydhcmlhLWV4cGFuZGVkJ10gPSBsYXRlc3RTdGF0ZS5pc09wZW4sIF9leHRlbmRzNC5pZCA9IGVsZW1lbnRJZHMudG9nZ2xlQnV0dG9uSWQsIF9leHRlbmRzNC50YWJJbmRleCA9IC0xLCBfZXh0ZW5kczQpLCAhcmVzdC5kaXNhYmxlZCAmJiBfZXh0ZW5kcyh7fSwge1xuICAgICAgb25DbGljazogY2FsbEFsbEV2ZW50SGFuZGxlcnMob25DbGljaywgdG9nZ2xlQnV0dG9uSGFuZGxlQ2xpY2spXG4gICAgfSksIHJlc3QpO1xuICB9LCBbZGlzcGF0Y2gsIGxhdGVzdCwgZWxlbWVudElkc10pO1xuICB2YXIgZ2V0SW5wdXRQcm9wcyA9IHVzZUNhbGxiYWNrKGZ1bmN0aW9uIChfdGVtcDUsIF90ZW1wNikge1xuICAgIHZhciBfZXh0ZW5kczU7XG4gICAgdmFyIF9yZWY2ID0gX3RlbXA1ID09PSB2b2lkIDAgPyB7fSA6IF90ZW1wNSxcbiAgICAgIG9uS2V5RG93biA9IF9yZWY2Lm9uS2V5RG93bixcbiAgICAgIG9uQ2hhbmdlID0gX3JlZjYub25DaGFuZ2UsXG4gICAgICBvbklucHV0ID0gX3JlZjYub25JbnB1dCxcbiAgICAgIG9uQmx1ciA9IF9yZWY2Lm9uQmx1cjtcbiAgICAgIF9yZWY2Lm9uQ2hhbmdlVGV4dDtcbiAgICAgIHZhciBvbkNsaWNrID0gX3JlZjYub25DbGljayxcbiAgICAgIF9yZWY2JHJlZktleSA9IF9yZWY2LnJlZktleSxcbiAgICAgIHJlZktleSA9IF9yZWY2JHJlZktleSA9PT0gdm9pZCAwID8gJ3JlZicgOiBfcmVmNiRyZWZLZXksXG4gICAgICByZWYgPSBfcmVmNi5yZWYsXG4gICAgICByZXN0ID0gX29iamVjdFdpdGhvdXRQcm9wZXJ0aWVzTG9vc2UoX3JlZjYsIF9leGNsdWRlZDQpO1xuICAgIHZhciBfcmVmNyA9IF90ZW1wNiA9PT0gdm9pZCAwID8ge30gOiBfdGVtcDYsXG4gICAgICBfcmVmNyRzdXBwcmVzc1JlZkVycm8gPSBfcmVmNy5zdXBwcmVzc1JlZkVycm9yLFxuICAgICAgc3VwcHJlc3NSZWZFcnJvciA9IF9yZWY3JHN1cHByZXNzUmVmRXJybyA9PT0gdm9pZCAwID8gZmFsc2UgOiBfcmVmNyRzdXBwcmVzc1JlZkVycm87XG4gICAgc2V0R2V0dGVyUHJvcENhbGxJbmZvKCdnZXRJbnB1dFByb3BzJywgc3VwcHJlc3NSZWZFcnJvciwgcmVmS2V5LCBpbnB1dFJlZik7XG4gICAgdmFyIGxhdGVzdFN0YXRlID0gbGF0ZXN0LmN1cnJlbnQuc3RhdGU7XG4gICAgdmFyIGlucHV0SGFuZGxlS2V5RG93biA9IGZ1bmN0aW9uIGlucHV0SGFuZGxlS2V5RG93bihldmVudCkge1xuICAgICAgdmFyIGtleSA9IG5vcm1hbGl6ZUFycm93S2V5KGV2ZW50KTtcbiAgICAgIGlmIChrZXkgJiYgaW5wdXRLZXlEb3duSGFuZGxlcnNba2V5XSkge1xuICAgICAgICBpbnB1dEtleURvd25IYW5kbGVyc1trZXldKGV2ZW50KTtcbiAgICAgIH1cbiAgICB9O1xuICAgIHZhciBpbnB1dEhhbmRsZUNoYW5nZSA9IGZ1bmN0aW9uIGlucHV0SGFuZGxlQ2hhbmdlKGV2ZW50KSB7XG4gICAgICBkaXNwYXRjaCh7XG4gICAgICAgIHR5cGU6IElucHV0Q2hhbmdlLFxuICAgICAgICBpbnB1dFZhbHVlOiBldmVudC50YXJnZXQudmFsdWVcbiAgICAgIH0pO1xuICAgIH07XG4gICAgdmFyIGlucHV0SGFuZGxlQmx1ciA9IGZ1bmN0aW9uIGlucHV0SGFuZGxlQmx1cihldmVudCkge1xuICAgICAgLyogaXN0YW5idWwgaWdub3JlIGVsc2UgKi9cbiAgICAgIGlmIChlbnZpcm9ubWVudCAhPSBudWxsICYmIGVudmlyb25tZW50LmRvY3VtZW50ICYmIGxhdGVzdFN0YXRlLmlzT3BlbiAmJiAhbW91c2VBbmRUb3VjaFRyYWNrZXJzLmlzTW91c2VEb3duKSB7XG4gICAgICAgIHZhciBpc0JsdXJCeVRhYkNoYW5nZSA9IGV2ZW50LnJlbGF0ZWRUYXJnZXQgPT09IG51bGwgJiYgZW52aXJvbm1lbnQuZG9jdW1lbnQuYWN0aXZlRWxlbWVudCAhPT0gZW52aXJvbm1lbnQuZG9jdW1lbnQuYm9keTtcbiAgICAgICAgZGlzcGF0Y2goe1xuICAgICAgICAgIHR5cGU6IElucHV0Qmx1cixcbiAgICAgICAgICBzZWxlY3RJdGVtOiAhaXNCbHVyQnlUYWJDaGFuZ2VcbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgfTtcbiAgICB2YXIgaW5wdXRIYW5kbGVDbGljayA9IGZ1bmN0aW9uIGlucHV0SGFuZGxlQ2xpY2soKSB7XG4gICAgICBkaXNwYXRjaCh7XG4gICAgICAgIHR5cGU6IElucHV0Q2xpY2tcbiAgICAgIH0pO1xuICAgIH07XG5cbiAgICAvKiBpc3RhbmJ1bCBpZ25vcmUgbmV4dCAocHJlYWN0KSAqL1xuICAgIHZhciBvbkNoYW5nZUtleSA9ICdvbkNoYW5nZSc7XG4gICAgdmFyIGV2ZW50SGFuZGxlcnMgPSB7fTtcbiAgICBpZiAoIXJlc3QuZGlzYWJsZWQpIHtcbiAgICAgIHZhciBfZXZlbnRIYW5kbGVycztcbiAgICAgIGV2ZW50SGFuZGxlcnMgPSAoX2V2ZW50SGFuZGxlcnMgPSB7fSwgX2V2ZW50SGFuZGxlcnNbb25DaGFuZ2VLZXldID0gY2FsbEFsbEV2ZW50SGFuZGxlcnMob25DaGFuZ2UsIG9uSW5wdXQsIGlucHV0SGFuZGxlQ2hhbmdlKSwgX2V2ZW50SGFuZGxlcnMub25LZXlEb3duID0gY2FsbEFsbEV2ZW50SGFuZGxlcnMob25LZXlEb3duLCBpbnB1dEhhbmRsZUtleURvd24pLCBfZXZlbnRIYW5kbGVycy5vbkJsdXIgPSBjYWxsQWxsRXZlbnRIYW5kbGVycyhvbkJsdXIsIGlucHV0SGFuZGxlQmx1ciksIF9ldmVudEhhbmRsZXJzLm9uQ2xpY2sgPSBjYWxsQWxsRXZlbnRIYW5kbGVycyhvbkNsaWNrLCBpbnB1dEhhbmRsZUNsaWNrKSwgX2V2ZW50SGFuZGxlcnMpO1xuICAgIH1cbiAgICByZXR1cm4gX2V4dGVuZHMoKF9leHRlbmRzNSA9IHt9LCBfZXh0ZW5kczVbcmVmS2V5XSA9IGhhbmRsZVJlZnMocmVmLCBmdW5jdGlvbiAoaW5wdXROb2RlKSB7XG4gICAgICBpbnB1dFJlZi5jdXJyZW50ID0gaW5wdXROb2RlO1xuICAgIH0pLCBfZXh0ZW5kczVbJ2FyaWEtYWN0aXZlZGVzY2VuZGFudCddID0gbGF0ZXN0U3RhdGUuaXNPcGVuICYmIGxhdGVzdFN0YXRlLmhpZ2hsaWdodGVkSW5kZXggPiAtMSA/IGVsZW1lbnRJZHMuZ2V0SXRlbUlkKGxhdGVzdFN0YXRlLmhpZ2hsaWdodGVkSW5kZXgpIDogJycsIF9leHRlbmRzNVsnYXJpYS1hdXRvY29tcGxldGUnXSA9ICdsaXN0JywgX2V4dGVuZHM1WydhcmlhLWNvbnRyb2xzJ10gPSBlbGVtZW50SWRzLm1lbnVJZCwgX2V4dGVuZHM1WydhcmlhLWV4cGFuZGVkJ10gPSBsYXRlc3RTdGF0ZS5pc09wZW4sIF9leHRlbmRzNVsnYXJpYS1sYWJlbGxlZGJ5J10gPSByZXN0ICYmIHJlc3RbJ2FyaWEtbGFiZWwnXSA/IHVuZGVmaW5lZCA6IGVsZW1lbnRJZHMubGFiZWxJZCwgX2V4dGVuZHM1LmF1dG9Db21wbGV0ZSA9ICdvZmYnLCBfZXh0ZW5kczUuaWQgPSBlbGVtZW50SWRzLmlucHV0SWQsIF9leHRlbmRzNS5yb2xlID0gJ2NvbWJvYm94JywgX2V4dGVuZHM1LnZhbHVlID0gbGF0ZXN0U3RhdGUuaW5wdXRWYWx1ZSwgX2V4dGVuZHM1KSwgZXZlbnRIYW5kbGVycywgcmVzdCk7XG4gIH0sIFtkaXNwYXRjaCwgZWxlbWVudElkcywgZW52aXJvbm1lbnQsIGlucHV0S2V5RG93bkhhbmRsZXJzLCBsYXRlc3QsIG1vdXNlQW5kVG91Y2hUcmFja2Vycywgc2V0R2V0dGVyUHJvcENhbGxJbmZvXSk7XG5cbiAgLy8gcmV0dXJuc1xuICB2YXIgdG9nZ2xlTWVudSA9IHVzZUNhbGxiYWNrKGZ1bmN0aW9uICgpIHtcbiAgICBkaXNwYXRjaCh7XG4gICAgICB0eXBlOiBGdW5jdGlvblRvZ2dsZU1lbnVcbiAgICB9KTtcbiAgfSwgW2Rpc3BhdGNoXSk7XG4gIHZhciBjbG9zZU1lbnUgPSB1c2VDYWxsYmFjayhmdW5jdGlvbiAoKSB7XG4gICAgZGlzcGF0Y2goe1xuICAgICAgdHlwZTogRnVuY3Rpb25DbG9zZU1lbnVcbiAgICB9KTtcbiAgfSwgW2Rpc3BhdGNoXSk7XG4gIHZhciBvcGVuTWVudSA9IHVzZUNhbGxiYWNrKGZ1bmN0aW9uICgpIHtcbiAgICBkaXNwYXRjaCh7XG4gICAgICB0eXBlOiBGdW5jdGlvbk9wZW5NZW51XG4gICAgfSk7XG4gIH0sIFtkaXNwYXRjaF0pO1xuICB2YXIgc2V0SGlnaGxpZ2h0ZWRJbmRleCA9IHVzZUNhbGxiYWNrKGZ1bmN0aW9uIChuZXdIaWdobGlnaHRlZEluZGV4KSB7XG4gICAgZGlzcGF0Y2goe1xuICAgICAgdHlwZTogRnVuY3Rpb25TZXRIaWdobGlnaHRlZEluZGV4LFxuICAgICAgaGlnaGxpZ2h0ZWRJbmRleDogbmV3SGlnaGxpZ2h0ZWRJbmRleFxuICAgIH0pO1xuICB9LCBbZGlzcGF0Y2hdKTtcbiAgdmFyIHNlbGVjdEl0ZW0gPSB1c2VDYWxsYmFjayhmdW5jdGlvbiAobmV3U2VsZWN0ZWRJdGVtKSB7XG4gICAgZGlzcGF0Y2goe1xuICAgICAgdHlwZTogRnVuY3Rpb25TZWxlY3RJdGVtLFxuICAgICAgc2VsZWN0ZWRJdGVtOiBuZXdTZWxlY3RlZEl0ZW1cbiAgICB9KTtcbiAgfSwgW2Rpc3BhdGNoXSk7XG4gIHZhciBzZXRJbnB1dFZhbHVlID0gdXNlQ2FsbGJhY2soZnVuY3Rpb24gKG5ld0lucHV0VmFsdWUpIHtcbiAgICBkaXNwYXRjaCh7XG4gICAgICB0eXBlOiBGdW5jdGlvblNldElucHV0VmFsdWUsXG4gICAgICBpbnB1dFZhbHVlOiBuZXdJbnB1dFZhbHVlXG4gICAgfSk7XG4gIH0sIFtkaXNwYXRjaF0pO1xuICB2YXIgcmVzZXQgPSB1c2VDYWxsYmFjayhmdW5jdGlvbiAoKSB7XG4gICAgZGlzcGF0Y2goe1xuICAgICAgdHlwZTogRnVuY3Rpb25SZXNldCQxXG4gICAgfSk7XG4gIH0sIFtkaXNwYXRjaF0pO1xuICByZXR1cm4ge1xuICAgIC8vIHByb3AgZ2V0dGVycy5cbiAgICBnZXRJdGVtUHJvcHM6IGdldEl0ZW1Qcm9wcyxcbiAgICBnZXRMYWJlbFByb3BzOiBnZXRMYWJlbFByb3BzLFxuICAgIGdldE1lbnVQcm9wczogZ2V0TWVudVByb3BzLFxuICAgIGdldElucHV0UHJvcHM6IGdldElucHV0UHJvcHMsXG4gICAgZ2V0VG9nZ2xlQnV0dG9uUHJvcHM6IGdldFRvZ2dsZUJ1dHRvblByb3BzLFxuICAgIC8vIGFjdGlvbnMuXG4gICAgdG9nZ2xlTWVudTogdG9nZ2xlTWVudSxcbiAgICBvcGVuTWVudTogb3Blbk1lbnUsXG4gICAgY2xvc2VNZW51OiBjbG9zZU1lbnUsXG4gICAgc2V0SGlnaGxpZ2h0ZWRJbmRleDogc2V0SGlnaGxpZ2h0ZWRJbmRleCxcbiAgICBzZXRJbnB1dFZhbHVlOiBzZXRJbnB1dFZhbHVlLFxuICAgIHNlbGVjdEl0ZW06IHNlbGVjdEl0ZW0sXG4gICAgcmVzZXQ6IHJlc2V0LFxuICAgIC8vIHN0YXRlLlxuICAgIGhpZ2hsaWdodGVkSW5kZXg6IGhpZ2hsaWdodGVkSW5kZXgsXG4gICAgaXNPcGVuOiBpc09wZW4sXG4gICAgc2VsZWN0ZWRJdGVtOiBzZWxlY3RlZEl0ZW0sXG4gICAgaW5wdXRWYWx1ZTogaW5wdXRWYWx1ZVxuICB9O1xufVxuXG52YXIgZGVmYXVsdFN0YXRlVmFsdWVzID0ge1xuICBhY3RpdmVJbmRleDogLTEsXG4gIHNlbGVjdGVkSXRlbXM6IFtdXG59O1xuXG4vKipcbiAqIFJldHVybnMgdGhlIGluaXRpYWwgdmFsdWUgZm9yIGEgc3RhdGUga2V5IGluIHRoZSBmb2xsb3dpbmcgb3JkZXI6XG4gKiAxLiBjb250cm9sbGVkIHByb3AsIDIuIGluaXRpYWwgcHJvcCwgMy4gZGVmYXVsdCBwcm9wLCA0LiBkZWZhdWx0XG4gKiB2YWx1ZSBmcm9tIERvd25zaGlmdC5cbiAqXG4gKiBAcGFyYW0ge09iamVjdH0gcHJvcHMgUHJvcHMgcGFzc2VkIHRvIHRoZSBob29rLlxuICogQHBhcmFtIHtzdHJpbmd9IHByb3BLZXkgUHJvcHMga2V5IHRvIGdlbmVyYXRlIHRoZSB2YWx1ZSBmb3IuXG4gKiBAcmV0dXJucyB7YW55fSBUaGUgaW5pdGlhbCB2YWx1ZSBmb3IgdGhhdCBwcm9wLlxuICovXG5mdW5jdGlvbiBnZXRJbml0aWFsVmFsdWUocHJvcHMsIHByb3BLZXkpIHtcbiAgcmV0dXJuIGdldEluaXRpYWxWYWx1ZSQxKHByb3BzLCBwcm9wS2V5LCBkZWZhdWx0U3RhdGVWYWx1ZXMpO1xufVxuXG4vKipcbiAqIFJldHVybnMgdGhlIGRlZmF1bHQgdmFsdWUgZm9yIGEgc3RhdGUga2V5IGluIHRoZSBmb2xsb3dpbmcgb3JkZXI6XG4gKiAxLiBjb250cm9sbGVkIHByb3AsIDIuIGRlZmF1bHQgcHJvcCwgMy4gZGVmYXVsdCB2YWx1ZSBmcm9tIERvd25zaGlmdC5cbiAqXG4gKiBAcGFyYW0ge09iamVjdH0gcHJvcHMgUHJvcHMgcGFzc2VkIHRvIHRoZSBob29rLlxuICogQHBhcmFtIHtzdHJpbmd9IHByb3BLZXkgUHJvcHMga2V5IHRvIGdlbmVyYXRlIHRoZSB2YWx1ZSBmb3IuXG4gKiBAcmV0dXJucyB7YW55fSBUaGUgaW5pdGlhbCB2YWx1ZSBmb3IgdGhhdCBwcm9wLlxuICovXG5mdW5jdGlvbiBnZXREZWZhdWx0VmFsdWUocHJvcHMsIHByb3BLZXkpIHtcbiAgcmV0dXJuIGdldERlZmF1bHRWYWx1ZSQxKHByb3BzLCBwcm9wS2V5LCBkZWZhdWx0U3RhdGVWYWx1ZXMpO1xufVxuXG4vKipcbiAqIEdldHMgdGhlIGluaXRpYWwgc3RhdGUgYmFzZWQgb24gdGhlIHByb3ZpZGVkIHByb3BzLiBJdCB1c2VzIGluaXRpYWwsIGRlZmF1bHRcbiAqIGFuZCBjb250cm9sbGVkIHByb3BzIHJlbGF0ZWQgdG8gc3RhdGUgaW4gb3JkZXIgdG8gY29tcHV0ZSB0aGUgaW5pdGlhbCB2YWx1ZS5cbiAqXG4gKiBAcGFyYW0ge09iamVjdH0gcHJvcHMgUHJvcHMgcGFzc2VkIHRvIHRoZSBob29rLlxuICogQHJldHVybnMge09iamVjdH0gVGhlIGluaXRpYWwgc3RhdGUuXG4gKi9cbmZ1bmN0aW9uIGdldEluaXRpYWxTdGF0ZShwcm9wcykge1xuICB2YXIgYWN0aXZlSW5kZXggPSBnZXRJbml0aWFsVmFsdWUocHJvcHMsICdhY3RpdmVJbmRleCcpO1xuICB2YXIgc2VsZWN0ZWRJdGVtcyA9IGdldEluaXRpYWxWYWx1ZShwcm9wcywgJ3NlbGVjdGVkSXRlbXMnKTtcbiAgcmV0dXJuIHtcbiAgICBhY3RpdmVJbmRleDogYWN0aXZlSW5kZXgsXG4gICAgc2VsZWN0ZWRJdGVtczogc2VsZWN0ZWRJdGVtc1xuICB9O1xufVxuXG4vKipcbiAqIFJldHVybnMgdHJ1ZSBpZiBkcm9wZG93biBrZXlkb3duIG9wZXJhdGlvbiBpcyBwZXJtaXR0ZWQuIFNob3VsZCBub3QgYmVcbiAqIGFsbG93ZWQgb24ga2V5ZG93biB3aXRoIG1vZGlmaWVyIGtleXMgKGN0cmwsIGFsdCwgc2hpZnQsIG1ldGEpLCBvblxuICogaW5wdXQgZWxlbWVudCB3aXRoIHRleHQgY29udGVudCB0aGF0IGlzIGVpdGhlciBoaWdobGlnaHRlZCBvciBzZWxlY3Rpb25cbiAqIGN1cnNvciBpcyBub3QgYXQgdGhlIHN0YXJ0aW5nIHBvc2l0aW9uLlxuICpcbiAqIEBwYXJhbSB7S2V5Ym9hcmRFdmVudH0gZXZlbnQgVGhlIGV2ZW50IGZyb20ga2V5ZG93bi5cbiAqIEByZXR1cm5zIHtib29sZWFufSBXaGV0aGVyIHRoZSBvcGVyYXRpb24gaXMgYWxsb3dlZC5cbiAqL1xuZnVuY3Rpb24gaXNLZXlEb3duT3BlcmF0aW9uUGVybWl0dGVkKGV2ZW50KSB7XG4gIGlmIChldmVudC5zaGlmdEtleSB8fCBldmVudC5tZXRhS2V5IHx8IGV2ZW50LmN0cmxLZXkgfHwgZXZlbnQuYWx0S2V5KSB7XG4gICAgcmV0dXJuIGZhbHNlO1xuICB9XG4gIHZhciBlbGVtZW50ID0gZXZlbnQudGFyZ2V0O1xuICBpZiAoZWxlbWVudCBpbnN0YW5jZW9mIEhUTUxJbnB1dEVsZW1lbnQgJiZcbiAgLy8gaWYgZWxlbWVudCBpcyBhIHRleHQgaW5wdXRcbiAgZWxlbWVudC52YWx1ZSAhPT0gJycgJiYgKFxuICAvLyBhbmQgd2UgaGF2ZSB0ZXh0IGluIGl0XG4gIC8vIGFuZCBjdXJzb3IgaXMgZWl0aGVyIG5vdCBhdCB0aGUgc3RhcnQgb3IgaXMgY3VycmVudGx5IGhpZ2hsaWdodGluZyB0ZXh0LlxuICBlbGVtZW50LnNlbGVjdGlvblN0YXJ0ICE9PSAwIHx8IGVsZW1lbnQuc2VsZWN0aW9uRW5kICE9PSAwKSkge1xuICAgIHJldHVybiBmYWxzZTtcbiAgfVxuICByZXR1cm4gdHJ1ZTtcbn1cblxuLyoqXG4gKiBDaGVjayBpZiBhIHN0YXRlIGlzIGVxdWFsIGZvciB0YWdsaXN0LCBieSBjb21wYXJpbmcgYWN0aXZlIGluZGV4IGFuZCBzZWxlY3RlZCBpdGVtcy5cbiAqIFVzZWQgYnkgdXNlU2VsZWN0IGFuZCB1c2VDb21ib2JveC5cbiAqXG4gKiBAcGFyYW0ge09iamVjdH0gcHJldlN0YXRlXG4gKiBAcGFyYW0ge09iamVjdH0gbmV3U3RhdGVcbiAqIEByZXR1cm5zIHtib29sZWFufSBXaGVhdGhlciB0aGUgc3RhdGVzIGFyZSBkZWVwbHkgZXF1YWwuXG4gKi9cbmZ1bmN0aW9uIGlzU3RhdGVFcXVhbChwcmV2U3RhdGUsIG5ld1N0YXRlKSB7XG4gIHJldHVybiBwcmV2U3RhdGUuc2VsZWN0ZWRJdGVtcyA9PT0gbmV3U3RhdGUuc2VsZWN0ZWRJdGVtcyAmJiBwcmV2U3RhdGUuYWN0aXZlSW5kZXggPT09IG5ld1N0YXRlLmFjdGl2ZUluZGV4O1xufVxudmFyIHByb3BUeXBlcyA9IHtcbiAgc3RhdGVSZWR1Y2VyOiBjb21tb25Qcm9wVHlwZXMuc3RhdGVSZWR1Y2VyLFxuICBpdGVtVG9LZXk6IGNvbW1vblByb3BUeXBlcy5pdGVtVG9LZXksXG4gIGVudmlyb25tZW50OiBjb21tb25Qcm9wVHlwZXMuZW52aXJvbm1lbnQsXG4gIHNlbGVjdGVkSXRlbXM6IFByb3BUeXBlcy5hcnJheSxcbiAgaW5pdGlhbFNlbGVjdGVkSXRlbXM6IFByb3BUeXBlcy5hcnJheSxcbiAgZGVmYXVsdFNlbGVjdGVkSXRlbXM6IFByb3BUeXBlcy5hcnJheSxcbiAgZ2V0QTExeVN0YXR1c01lc3NhZ2U6IFByb3BUeXBlcy5mdW5jLFxuICBhY3RpdmVJbmRleDogUHJvcFR5cGVzLm51bWJlcixcbiAgaW5pdGlhbEFjdGl2ZUluZGV4OiBQcm9wVHlwZXMubnVtYmVyLFxuICBkZWZhdWx0QWN0aXZlSW5kZXg6IFByb3BUeXBlcy5udW1iZXIsXG4gIG9uQWN0aXZlSW5kZXhDaGFuZ2U6IFByb3BUeXBlcy5mdW5jLFxuICBvblNlbGVjdGVkSXRlbXNDaGFuZ2U6IFByb3BUeXBlcy5mdW5jLFxuICBrZXlOYXZpZ2F0aW9uTmV4dDogUHJvcFR5cGVzLnN0cmluZyxcbiAga2V5TmF2aWdhdGlvblByZXZpb3VzOiBQcm9wVHlwZXMuc3RyaW5nXG59O1xudmFyIGRlZmF1bHRQcm9wcyA9IHtcbiAgaXRlbVRvS2V5OiBkZWZhdWx0UHJvcHMkMy5pdGVtVG9LZXksXG4gIHN0YXRlUmVkdWNlcjogZGVmYXVsdFByb3BzJDMuc3RhdGVSZWR1Y2VyLFxuICBlbnZpcm9ubWVudDogZGVmYXVsdFByb3BzJDMuZW52aXJvbm1lbnQsXG4gIGtleU5hdmlnYXRpb25OZXh0OiAnQXJyb3dSaWdodCcsXG4gIGtleU5hdmlnYXRpb25QcmV2aW91czogJ0Fycm93TGVmdCdcbn07XG5cbi8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBpbXBvcnQvbm8tbXV0YWJsZS1leHBvcnRzXG52YXIgdmFsaWRhdGVQcm9wVHlwZXMgPSBub29wO1xuLyogaXN0YW5idWwgaWdub3JlIG5leHQgKi9cbmlmIChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nKSB7XG4gIHZhbGlkYXRlUHJvcFR5cGVzID0gZnVuY3Rpb24gdmFsaWRhdGVQcm9wVHlwZXMob3B0aW9ucywgY2FsbGVyKSB7XG4gICAgUHJvcFR5cGVzLmNoZWNrUHJvcFR5cGVzKHByb3BUeXBlcywgb3B0aW9ucywgJ3Byb3AnLCBjYWxsZXIubmFtZSk7XG4gIH07XG59XG5cbnZhciBTZWxlY3RlZEl0ZW1DbGljayA9IHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSBcInByb2R1Y3Rpb25cIiA/ICdfX3NlbGVjdGVkX2l0ZW1fY2xpY2tfXycgOiAwO1xudmFyIFNlbGVjdGVkSXRlbUtleURvd25EZWxldGUgPSBwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gXCJwcm9kdWN0aW9uXCIgPyAnX19zZWxlY3RlZF9pdGVtX2tleWRvd25fZGVsZXRlX18nIDogMTtcbnZhciBTZWxlY3RlZEl0ZW1LZXlEb3duQmFja3NwYWNlID0gcHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09IFwicHJvZHVjdGlvblwiID8gJ19fc2VsZWN0ZWRfaXRlbV9rZXlkb3duX2JhY2tzcGFjZV9fJyA6IDI7XG52YXIgU2VsZWN0ZWRJdGVtS2V5RG93bk5hdmlnYXRpb25OZXh0ID0gcHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09IFwicHJvZHVjdGlvblwiID8gJ19fc2VsZWN0ZWRfaXRlbV9rZXlkb3duX25hdmlnYXRpb25fbmV4dF9fJyA6IDM7XG52YXIgU2VsZWN0ZWRJdGVtS2V5RG93bk5hdmlnYXRpb25QcmV2aW91cyA9IHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSBcInByb2R1Y3Rpb25cIiA/ICdfX3NlbGVjdGVkX2l0ZW1fa2V5ZG93bl9uYXZpZ2F0aW9uX3ByZXZpb3VzX18nIDogNDtcbnZhciBEcm9wZG93bktleURvd25OYXZpZ2F0aW9uUHJldmlvdXMgPSBwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gXCJwcm9kdWN0aW9uXCIgPyAnX19kcm9wZG93bl9rZXlkb3duX25hdmlnYXRpb25fcHJldmlvdXNfXycgOiA1O1xudmFyIERyb3Bkb3duS2V5RG93bkJhY2tzcGFjZSA9IHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSBcInByb2R1Y3Rpb25cIiA/ICdfX2Ryb3Bkb3duX2tleWRvd25fYmFja3NwYWNlX18nIDogNjtcbnZhciBEcm9wZG93bkNsaWNrID0gcHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09IFwicHJvZHVjdGlvblwiID8gJ19fZHJvcGRvd25fY2xpY2tfXycgOiA3O1xudmFyIEZ1bmN0aW9uQWRkU2VsZWN0ZWRJdGVtID0gcHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09IFwicHJvZHVjdGlvblwiID8gJ19fZnVuY3Rpb25fYWRkX3NlbGVjdGVkX2l0ZW1fXycgOiA4O1xudmFyIEZ1bmN0aW9uUmVtb3ZlU2VsZWN0ZWRJdGVtID0gcHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09IFwicHJvZHVjdGlvblwiID8gJ19fZnVuY3Rpb25fcmVtb3ZlX3NlbGVjdGVkX2l0ZW1fXycgOiA5O1xudmFyIEZ1bmN0aW9uU2V0U2VsZWN0ZWRJdGVtcyA9IHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSBcInByb2R1Y3Rpb25cIiA/ICdfX2Z1bmN0aW9uX3NldF9zZWxlY3RlZF9pdGVtc19fJyA6IDEwO1xudmFyIEZ1bmN0aW9uU2V0QWN0aXZlSW5kZXggPSBwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gXCJwcm9kdWN0aW9uXCIgPyAnX19mdW5jdGlvbl9zZXRfYWN0aXZlX2luZGV4X18nIDogMTE7XG52YXIgRnVuY3Rpb25SZXNldCA9IHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSBcInByb2R1Y3Rpb25cIiA/ICdfX2Z1bmN0aW9uX3Jlc2V0X18nIDogMTI7XG5cbnZhciBzdGF0ZUNoYW5nZVR5cGVzID0gLyojX19QVVJFX18qL09iamVjdC5mcmVlemUoe1xuICBfX3Byb3RvX186IG51bGwsXG4gIERyb3Bkb3duQ2xpY2s6IERyb3Bkb3duQ2xpY2ssXG4gIERyb3Bkb3duS2V5RG93bkJhY2tzcGFjZTogRHJvcGRvd25LZXlEb3duQmFja3NwYWNlLFxuICBEcm9wZG93bktleURvd25OYXZpZ2F0aW9uUHJldmlvdXM6IERyb3Bkb3duS2V5RG93bk5hdmlnYXRpb25QcmV2aW91cyxcbiAgRnVuY3Rpb25BZGRTZWxlY3RlZEl0ZW06IEZ1bmN0aW9uQWRkU2VsZWN0ZWRJdGVtLFxuICBGdW5jdGlvblJlbW92ZVNlbGVjdGVkSXRlbTogRnVuY3Rpb25SZW1vdmVTZWxlY3RlZEl0ZW0sXG4gIEZ1bmN0aW9uUmVzZXQ6IEZ1bmN0aW9uUmVzZXQsXG4gIEZ1bmN0aW9uU2V0QWN0aXZlSW5kZXg6IEZ1bmN0aW9uU2V0QWN0aXZlSW5kZXgsXG4gIEZ1bmN0aW9uU2V0U2VsZWN0ZWRJdGVtczogRnVuY3Rpb25TZXRTZWxlY3RlZEl0ZW1zLFxuICBTZWxlY3RlZEl0ZW1DbGljazogU2VsZWN0ZWRJdGVtQ2xpY2ssXG4gIFNlbGVjdGVkSXRlbUtleURvd25CYWNrc3BhY2U6IFNlbGVjdGVkSXRlbUtleURvd25CYWNrc3BhY2UsXG4gIFNlbGVjdGVkSXRlbUtleURvd25EZWxldGU6IFNlbGVjdGVkSXRlbUtleURvd25EZWxldGUsXG4gIFNlbGVjdGVkSXRlbUtleURvd25OYXZpZ2F0aW9uTmV4dDogU2VsZWN0ZWRJdGVtS2V5RG93bk5hdmlnYXRpb25OZXh0LFxuICBTZWxlY3RlZEl0ZW1LZXlEb3duTmF2aWdhdGlvblByZXZpb3VzOiBTZWxlY3RlZEl0ZW1LZXlEb3duTmF2aWdhdGlvblByZXZpb3VzXG59KTtcblxuLyogZXNsaW50LWRpc2FibGUgY29tcGxleGl0eSAqL1xuZnVuY3Rpb24gZG93bnNoaWZ0TXVsdGlwbGVTZWxlY3Rpb25SZWR1Y2VyKHN0YXRlLCBhY3Rpb24pIHtcbiAgdmFyIHR5cGUgPSBhY3Rpb24udHlwZSxcbiAgICBpbmRleCA9IGFjdGlvbi5pbmRleCxcbiAgICBwcm9wcyA9IGFjdGlvbi5wcm9wcyxcbiAgICBzZWxlY3RlZEl0ZW0gPSBhY3Rpb24uc2VsZWN0ZWRJdGVtO1xuICB2YXIgYWN0aXZlSW5kZXggPSBzdGF0ZS5hY3RpdmVJbmRleCxcbiAgICBzZWxlY3RlZEl0ZW1zID0gc3RhdGUuc2VsZWN0ZWRJdGVtcztcbiAgdmFyIGNoYW5nZXM7XG4gIHN3aXRjaCAodHlwZSkge1xuICAgIGNhc2UgU2VsZWN0ZWRJdGVtQ2xpY2s6XG4gICAgICBjaGFuZ2VzID0ge1xuICAgICAgICBhY3RpdmVJbmRleDogaW5kZXhcbiAgICAgIH07XG4gICAgICBicmVhaztcbiAgICBjYXNlIFNlbGVjdGVkSXRlbUtleURvd25OYXZpZ2F0aW9uUHJldmlvdXM6XG4gICAgICBjaGFuZ2VzID0ge1xuICAgICAgICBhY3RpdmVJbmRleDogYWN0aXZlSW5kZXggLSAxIDwgMCA/IDAgOiBhY3RpdmVJbmRleCAtIDFcbiAgICAgIH07XG4gICAgICBicmVhaztcbiAgICBjYXNlIFNlbGVjdGVkSXRlbUtleURvd25OYXZpZ2F0aW9uTmV4dDpcbiAgICAgIGNoYW5nZXMgPSB7XG4gICAgICAgIGFjdGl2ZUluZGV4OiBhY3RpdmVJbmRleCArIDEgPj0gc2VsZWN0ZWRJdGVtcy5sZW5ndGggPyAtMSA6IGFjdGl2ZUluZGV4ICsgMVxuICAgICAgfTtcbiAgICAgIGJyZWFrO1xuICAgIGNhc2UgU2VsZWN0ZWRJdGVtS2V5RG93bkJhY2tzcGFjZTpcbiAgICBjYXNlIFNlbGVjdGVkSXRlbUtleURvd25EZWxldGU6XG4gICAgICB7XG4gICAgICAgIGlmIChhY3RpdmVJbmRleCA8IDApIHtcbiAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuICAgICAgICB2YXIgbmV3QWN0aXZlSW5kZXggPSBhY3RpdmVJbmRleDtcbiAgICAgICAgaWYgKHNlbGVjdGVkSXRlbXMubGVuZ3RoID09PSAxKSB7XG4gICAgICAgICAgbmV3QWN0aXZlSW5kZXggPSAtMTtcbiAgICAgICAgfSBlbHNlIGlmIChhY3RpdmVJbmRleCA9PT0gc2VsZWN0ZWRJdGVtcy5sZW5ndGggLSAxKSB7XG4gICAgICAgICAgbmV3QWN0aXZlSW5kZXggPSBzZWxlY3RlZEl0ZW1zLmxlbmd0aCAtIDI7XG4gICAgICAgIH1cbiAgICAgICAgY2hhbmdlcyA9IF9leHRlbmRzKHtcbiAgICAgICAgICBzZWxlY3RlZEl0ZW1zOiBbXS5jb25jYXQoc2VsZWN0ZWRJdGVtcy5zbGljZSgwLCBhY3RpdmVJbmRleCksIHNlbGVjdGVkSXRlbXMuc2xpY2UoYWN0aXZlSW5kZXggKyAxKSlcbiAgICAgICAgfSwge1xuICAgICAgICAgIGFjdGl2ZUluZGV4OiBuZXdBY3RpdmVJbmRleFxuICAgICAgICB9KTtcbiAgICAgICAgYnJlYWs7XG4gICAgICB9XG4gICAgY2FzZSBEcm9wZG93bktleURvd25OYXZpZ2F0aW9uUHJldmlvdXM6XG4gICAgICBjaGFuZ2VzID0ge1xuICAgICAgICBhY3RpdmVJbmRleDogc2VsZWN0ZWRJdGVtcy5sZW5ndGggLSAxXG4gICAgICB9O1xuICAgICAgYnJlYWs7XG4gICAgY2FzZSBEcm9wZG93bktleURvd25CYWNrc3BhY2U6XG4gICAgICBjaGFuZ2VzID0ge1xuICAgICAgICBzZWxlY3RlZEl0ZW1zOiBzZWxlY3RlZEl0ZW1zLnNsaWNlKDAsIHNlbGVjdGVkSXRlbXMubGVuZ3RoIC0gMSlcbiAgICAgIH07XG4gICAgICBicmVhaztcbiAgICBjYXNlIEZ1bmN0aW9uQWRkU2VsZWN0ZWRJdGVtOlxuICAgICAgY2hhbmdlcyA9IHtcbiAgICAgICAgc2VsZWN0ZWRJdGVtczogW10uY29uY2F0KHNlbGVjdGVkSXRlbXMsIFtzZWxlY3RlZEl0ZW1dKVxuICAgICAgfTtcbiAgICAgIGJyZWFrO1xuICAgIGNhc2UgRHJvcGRvd25DbGljazpcbiAgICAgIGNoYW5nZXMgPSB7XG4gICAgICAgIGFjdGl2ZUluZGV4OiAtMVxuICAgICAgfTtcbiAgICAgIGJyZWFrO1xuICAgIGNhc2UgRnVuY3Rpb25SZW1vdmVTZWxlY3RlZEl0ZW06XG4gICAgICB7XG4gICAgICAgIHZhciBfbmV3QWN0aXZlSW5kZXggPSBhY3RpdmVJbmRleDtcbiAgICAgICAgdmFyIHNlbGVjdGVkSXRlbUluZGV4ID0gc2VsZWN0ZWRJdGVtcy5maW5kSW5kZXgoZnVuY3Rpb24gKGl0ZW0pIHtcbiAgICAgICAgICByZXR1cm4gcHJvcHMuaXRlbVRvS2V5KGl0ZW0pID09PSBwcm9wcy5pdGVtVG9LZXkoc2VsZWN0ZWRJdGVtKTtcbiAgICAgICAgfSk7XG4gICAgICAgIGlmIChzZWxlY3RlZEl0ZW1JbmRleCA8IDApIHtcbiAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuICAgICAgICBpZiAoc2VsZWN0ZWRJdGVtcy5sZW5ndGggPT09IDEpIHtcbiAgICAgICAgICBfbmV3QWN0aXZlSW5kZXggPSAtMTtcbiAgICAgICAgfSBlbHNlIGlmIChzZWxlY3RlZEl0ZW1JbmRleCA9PT0gc2VsZWN0ZWRJdGVtcy5sZW5ndGggLSAxKSB7XG4gICAgICAgICAgX25ld0FjdGl2ZUluZGV4ID0gc2VsZWN0ZWRJdGVtcy5sZW5ndGggLSAyO1xuICAgICAgICB9XG4gICAgICAgIGNoYW5nZXMgPSB7XG4gICAgICAgICAgc2VsZWN0ZWRJdGVtczogW10uY29uY2F0KHNlbGVjdGVkSXRlbXMuc2xpY2UoMCwgc2VsZWN0ZWRJdGVtSW5kZXgpLCBzZWxlY3RlZEl0ZW1zLnNsaWNlKHNlbGVjdGVkSXRlbUluZGV4ICsgMSkpLFxuICAgICAgICAgIGFjdGl2ZUluZGV4OiBfbmV3QWN0aXZlSW5kZXhcbiAgICAgICAgfTtcbiAgICAgICAgYnJlYWs7XG4gICAgICB9XG4gICAgY2FzZSBGdW5jdGlvblNldFNlbGVjdGVkSXRlbXM6XG4gICAgICB7XG4gICAgICAgIHZhciBuZXdTZWxlY3RlZEl0ZW1zID0gYWN0aW9uLnNlbGVjdGVkSXRlbXM7XG4gICAgICAgIGNoYW5nZXMgPSB7XG4gICAgICAgICAgc2VsZWN0ZWRJdGVtczogbmV3U2VsZWN0ZWRJdGVtc1xuICAgICAgICB9O1xuICAgICAgICBicmVhaztcbiAgICAgIH1cbiAgICBjYXNlIEZ1bmN0aW9uU2V0QWN0aXZlSW5kZXg6XG4gICAgICB7XG4gICAgICAgIHZhciBfbmV3QWN0aXZlSW5kZXgyID0gYWN0aW9uLmFjdGl2ZUluZGV4O1xuICAgICAgICBjaGFuZ2VzID0ge1xuICAgICAgICAgIGFjdGl2ZUluZGV4OiBfbmV3QWN0aXZlSW5kZXgyXG4gICAgICAgIH07XG4gICAgICAgIGJyZWFrO1xuICAgICAgfVxuICAgIGNhc2UgRnVuY3Rpb25SZXNldDpcbiAgICAgIGNoYW5nZXMgPSB7XG4gICAgICAgIGFjdGl2ZUluZGV4OiBnZXREZWZhdWx0VmFsdWUocHJvcHMsICdhY3RpdmVJbmRleCcpLFxuICAgICAgICBzZWxlY3RlZEl0ZW1zOiBnZXREZWZhdWx0VmFsdWUocHJvcHMsICdzZWxlY3RlZEl0ZW1zJylcbiAgICAgIH07XG4gICAgICBicmVhaztcbiAgICBkZWZhdWx0OlxuICAgICAgdGhyb3cgbmV3IEVycm9yKCdSZWR1Y2VyIGNhbGxlZCB3aXRob3V0IHByb3BlciBhY3Rpb24gdHlwZS4nKTtcbiAgfVxuICByZXR1cm4gX2V4dGVuZHMoe30sIHN0YXRlLCBjaGFuZ2VzKTtcbn1cblxudmFyIF9leGNsdWRlZCA9IFtcInJlZktleVwiLCBcInJlZlwiLCBcIm9uQ2xpY2tcIiwgXCJvbktleURvd25cIiwgXCJzZWxlY3RlZEl0ZW1cIiwgXCJpbmRleFwiXSxcbiAgX2V4Y2x1ZGVkMiA9IFtcInJlZktleVwiLCBcInJlZlwiLCBcIm9uS2V5RG93blwiLCBcIm9uQ2xpY2tcIiwgXCJwcmV2ZW50S2V5QWN0aW9uXCJdO1xudXNlTXVsdGlwbGVTZWxlY3Rpb24uc3RhdGVDaGFuZ2VUeXBlcyA9IHN0YXRlQ2hhbmdlVHlwZXM7XG5mdW5jdGlvbiB1c2VNdWx0aXBsZVNlbGVjdGlvbih1c2VyUHJvcHMpIHtcbiAgaWYgKHVzZXJQcm9wcyA9PT0gdm9pZCAwKSB7XG4gICAgdXNlclByb3BzID0ge307XG4gIH1cbiAgdmFsaWRhdGVQcm9wVHlwZXModXNlclByb3BzLCB1c2VNdWx0aXBsZVNlbGVjdGlvbik7XG4gIC8vIFByb3BzIGRlZmF1bHRzIGFuZCBkZXN0cnVjdHVyaW5nLlxuICB2YXIgcHJvcHMgPSBfZXh0ZW5kcyh7fSwgZGVmYXVsdFByb3BzLCB1c2VyUHJvcHMpO1xuICB2YXIgZ2V0QTExeVN0YXR1c01lc3NhZ2UgPSBwcm9wcy5nZXRBMTF5U3RhdHVzTWVzc2FnZSxcbiAgICBlbnZpcm9ubWVudCA9IHByb3BzLmVudmlyb25tZW50LFxuICAgIGtleU5hdmlnYXRpb25OZXh0ID0gcHJvcHMua2V5TmF2aWdhdGlvbk5leHQsXG4gICAga2V5TmF2aWdhdGlvblByZXZpb3VzID0gcHJvcHMua2V5TmF2aWdhdGlvblByZXZpb3VzO1xuXG4gIC8vIFJlZHVjZXIgaW5pdC5cbiAgdmFyIF91c2VDb250cm9sbGVkUmVkdWNlciA9IHVzZUNvbnRyb2xsZWRSZWR1Y2VyJDEoZG93bnNoaWZ0TXVsdGlwbGVTZWxlY3Rpb25SZWR1Y2VyLCBwcm9wcywgZ2V0SW5pdGlhbFN0YXRlLCBpc1N0YXRlRXF1YWwpLFxuICAgIHN0YXRlID0gX3VzZUNvbnRyb2xsZWRSZWR1Y2VyWzBdLFxuICAgIGRpc3BhdGNoID0gX3VzZUNvbnRyb2xsZWRSZWR1Y2VyWzFdO1xuICB2YXIgYWN0aXZlSW5kZXggPSBzdGF0ZS5hY3RpdmVJbmRleCxcbiAgICBzZWxlY3RlZEl0ZW1zID0gc3RhdGUuc2VsZWN0ZWRJdGVtcztcblxuICAvLyBSZWZzLlxuICB2YXIgaXNJbml0aWFsTW91bnQgPSB1c2VJc0luaXRpYWxNb3VudCgpO1xuICB2YXIgZHJvcGRvd25SZWYgPSB1c2VSZWYobnVsbCk7XG4gIHZhciBzZWxlY3RlZEl0ZW1SZWZzID0gdXNlUmVmKCk7XG4gIHNlbGVjdGVkSXRlbVJlZnMuY3VycmVudCA9IFtdO1xuICB2YXIgbGF0ZXN0ID0gdXNlTGF0ZXN0UmVmKHtcbiAgICBzdGF0ZTogc3RhdGUsXG4gICAgcHJvcHM6IHByb3BzXG4gIH0pO1xuXG4gIC8vIEVmZmVjdHMuXG4gIC8vIEFkZHMgYW4gYTExeSBhcmlhIGxpdmUgc3RhdHVzIG1lc3NhZ2UgaWYgZ2V0QTExeVN0YXR1c01lc3NhZ2UgaXMgcGFzc2VkLlxuICB1c2VBMTF5TWVzc2FnZVN0YXR1cyhnZXRBMTF5U3RhdHVzTWVzc2FnZSwgc3RhdGUsIFthY3RpdmVJbmRleCwgc2VsZWN0ZWRJdGVtc10sIGVudmlyb25tZW50KTtcbiAgLy8gU2V0cyBmb2N1cyBvbiBhY3RpdmUgaXRlbS5cbiAgdXNlRWZmZWN0KGZ1bmN0aW9uICgpIHtcbiAgICBpZiAoaXNJbml0aWFsTW91bnQpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgaWYgKGFjdGl2ZUluZGV4ID09PSAtMSAmJiBkcm9wZG93blJlZi5jdXJyZW50KSB7XG4gICAgICBkcm9wZG93blJlZi5jdXJyZW50LmZvY3VzKCk7XG4gICAgfSBlbHNlIGlmIChzZWxlY3RlZEl0ZW1SZWZzLmN1cnJlbnRbYWN0aXZlSW5kZXhdKSB7XG4gICAgICBzZWxlY3RlZEl0ZW1SZWZzLmN1cnJlbnRbYWN0aXZlSW5kZXhdLmZvY3VzKCk7XG4gICAgfVxuICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSByZWFjdC1ob29rcy9leGhhdXN0aXZlLWRlcHNcbiAgfSwgW2FjdGl2ZUluZGV4XSk7XG4gIHVzZUNvbnRyb2xQcm9wc1ZhbGlkYXRvcih7XG4gICAgcHJvcHM6IHByb3BzLFxuICAgIHN0YXRlOiBzdGF0ZVxuICB9KTtcbiAgdmFyIHNldEdldHRlclByb3BDYWxsSW5mbyA9IHVzZUdldHRlclByb3BzQ2FsbGVkQ2hlY2tlcignZ2V0RHJvcGRvd25Qcm9wcycpO1xuXG4gIC8vIEV2ZW50IGhhbmRsZXIgZnVuY3Rpb25zLlxuICB2YXIgc2VsZWN0ZWRJdGVtS2V5RG93bkhhbmRsZXJzID0gdXNlTWVtbyhmdW5jdGlvbiAoKSB7XG4gICAgdmFyIF9yZWY7XG4gICAgcmV0dXJuIF9yZWYgPSB7fSwgX3JlZltrZXlOYXZpZ2F0aW9uUHJldmlvdXNdID0gZnVuY3Rpb24gKCkge1xuICAgICAgZGlzcGF0Y2goe1xuICAgICAgICB0eXBlOiBTZWxlY3RlZEl0ZW1LZXlEb3duTmF2aWdhdGlvblByZXZpb3VzXG4gICAgICB9KTtcbiAgICB9LCBfcmVmW2tleU5hdmlnYXRpb25OZXh0XSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIGRpc3BhdGNoKHtcbiAgICAgICAgdHlwZTogU2VsZWN0ZWRJdGVtS2V5RG93bk5hdmlnYXRpb25OZXh0XG4gICAgICB9KTtcbiAgICB9LCBfcmVmLkRlbGV0ZSA9IGZ1bmN0aW9uIERlbGV0ZSgpIHtcbiAgICAgIGRpc3BhdGNoKHtcbiAgICAgICAgdHlwZTogU2VsZWN0ZWRJdGVtS2V5RG93bkRlbGV0ZVxuICAgICAgfSk7XG4gICAgfSwgX3JlZi5CYWNrc3BhY2UgPSBmdW5jdGlvbiBCYWNrc3BhY2UoKSB7XG4gICAgICBkaXNwYXRjaCh7XG4gICAgICAgIHR5cGU6IFNlbGVjdGVkSXRlbUtleURvd25CYWNrc3BhY2VcbiAgICAgIH0pO1xuICAgIH0sIF9yZWY7XG4gIH0sIFtkaXNwYXRjaCwga2V5TmF2aWdhdGlvbk5leHQsIGtleU5hdmlnYXRpb25QcmV2aW91c10pO1xuICB2YXIgZHJvcGRvd25LZXlEb3duSGFuZGxlcnMgPSB1c2VNZW1vKGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgX3JlZjI7XG4gICAgcmV0dXJuIF9yZWYyID0ge30sIF9yZWYyW2tleU5hdmlnYXRpb25QcmV2aW91c10gPSBmdW5jdGlvbiAoZXZlbnQpIHtcbiAgICAgIGlmIChpc0tleURvd25PcGVyYXRpb25QZXJtaXR0ZWQoZXZlbnQpKSB7XG4gICAgICAgIGRpc3BhdGNoKHtcbiAgICAgICAgICB0eXBlOiBEcm9wZG93bktleURvd25OYXZpZ2F0aW9uUHJldmlvdXNcbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgfSwgX3JlZjIuQmFja3NwYWNlID0gZnVuY3Rpb24gQmFja3NwYWNlKGV2ZW50KSB7XG4gICAgICBpZiAoaXNLZXlEb3duT3BlcmF0aW9uUGVybWl0dGVkKGV2ZW50KSkge1xuICAgICAgICBkaXNwYXRjaCh7XG4gICAgICAgICAgdHlwZTogRHJvcGRvd25LZXlEb3duQmFja3NwYWNlXG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgIH0sIF9yZWYyO1xuICB9LCBbZGlzcGF0Y2gsIGtleU5hdmlnYXRpb25QcmV2aW91c10pO1xuXG4gIC8vIEdldHRlciBwcm9wcy5cbiAgdmFyIGdldFNlbGVjdGVkSXRlbVByb3BzID0gdXNlQ2FsbGJhY2soZnVuY3Rpb24gKF90ZW1wKSB7XG4gICAgdmFyIF9leHRlbmRzMjtcbiAgICB2YXIgX3JlZjMgPSBfdGVtcCA9PT0gdm9pZCAwID8ge30gOiBfdGVtcCxcbiAgICAgIF9yZWYzJHJlZktleSA9IF9yZWYzLnJlZktleSxcbiAgICAgIHJlZktleSA9IF9yZWYzJHJlZktleSA9PT0gdm9pZCAwID8gJ3JlZicgOiBfcmVmMyRyZWZLZXksXG4gICAgICByZWYgPSBfcmVmMy5yZWYsXG4gICAgICBvbkNsaWNrID0gX3JlZjMub25DbGljayxcbiAgICAgIG9uS2V5RG93biA9IF9yZWYzLm9uS2V5RG93bixcbiAgICAgIHNlbGVjdGVkSXRlbVByb3AgPSBfcmVmMy5zZWxlY3RlZEl0ZW0sXG4gICAgICBpbmRleFByb3AgPSBfcmVmMy5pbmRleCxcbiAgICAgIHJlc3QgPSBfb2JqZWN0V2l0aG91dFByb3BlcnRpZXNMb29zZShfcmVmMywgX2V4Y2x1ZGVkKTtcbiAgICB2YXIgbGF0ZXN0U3RhdGUgPSBsYXRlc3QuY3VycmVudC5zdGF0ZTtcbiAgICB2YXIgX2dldEl0ZW1BbmRJbmRleCA9IGdldEl0ZW1BbmRJbmRleChzZWxlY3RlZEl0ZW1Qcm9wLCBpbmRleFByb3AsIGxhdGVzdFN0YXRlLnNlbGVjdGVkSXRlbXMsICdQYXNzIGVpdGhlciBpdGVtIG9yIGluZGV4IHRvIGdldFNlbGVjdGVkSXRlbVByb3BzIScpLFxuICAgICAgaW5kZXggPSBfZ2V0SXRlbUFuZEluZGV4WzFdO1xuICAgIHZhciBpc0ZvY3VzYWJsZSA9IGluZGV4ID4gLTEgJiYgaW5kZXggPT09IGxhdGVzdFN0YXRlLmFjdGl2ZUluZGV4O1xuICAgIHZhciBzZWxlY3RlZEl0ZW1IYW5kbGVDbGljayA9IGZ1bmN0aW9uIHNlbGVjdGVkSXRlbUhhbmRsZUNsaWNrKCkge1xuICAgICAgZGlzcGF0Y2goe1xuICAgICAgICB0eXBlOiBTZWxlY3RlZEl0ZW1DbGljayxcbiAgICAgICAgaW5kZXg6IGluZGV4XG4gICAgICB9KTtcbiAgICB9O1xuICAgIHZhciBzZWxlY3RlZEl0ZW1IYW5kbGVLZXlEb3duID0gZnVuY3Rpb24gc2VsZWN0ZWRJdGVtSGFuZGxlS2V5RG93bihldmVudCkge1xuICAgICAgdmFyIGtleSA9IG5vcm1hbGl6ZUFycm93S2V5KGV2ZW50KTtcbiAgICAgIGlmIChrZXkgJiYgc2VsZWN0ZWRJdGVtS2V5RG93bkhhbmRsZXJzW2tleV0pIHtcbiAgICAgICAgc2VsZWN0ZWRJdGVtS2V5RG93bkhhbmRsZXJzW2tleV0oZXZlbnQpO1xuICAgICAgfVxuICAgIH07XG4gICAgcmV0dXJuIF9leHRlbmRzKChfZXh0ZW5kczIgPSB7fSwgX2V4dGVuZHMyW3JlZktleV0gPSBoYW5kbGVSZWZzKHJlZiwgZnVuY3Rpb24gKHNlbGVjdGVkSXRlbU5vZGUpIHtcbiAgICAgIGlmIChzZWxlY3RlZEl0ZW1Ob2RlKSB7XG4gICAgICAgIHNlbGVjdGVkSXRlbVJlZnMuY3VycmVudC5wdXNoKHNlbGVjdGVkSXRlbU5vZGUpO1xuICAgICAgfVxuICAgIH0pLCBfZXh0ZW5kczIudGFiSW5kZXggPSBpc0ZvY3VzYWJsZSA/IDAgOiAtMSwgX2V4dGVuZHMyLm9uQ2xpY2sgPSBjYWxsQWxsRXZlbnRIYW5kbGVycyhvbkNsaWNrLCBzZWxlY3RlZEl0ZW1IYW5kbGVDbGljayksIF9leHRlbmRzMi5vbktleURvd24gPSBjYWxsQWxsRXZlbnRIYW5kbGVycyhvbktleURvd24sIHNlbGVjdGVkSXRlbUhhbmRsZUtleURvd24pLCBfZXh0ZW5kczIpLCByZXN0KTtcbiAgfSwgW2Rpc3BhdGNoLCBsYXRlc3QsIHNlbGVjdGVkSXRlbUtleURvd25IYW5kbGVyc10pO1xuICB2YXIgZ2V0RHJvcGRvd25Qcm9wcyA9IHVzZUNhbGxiYWNrKGZ1bmN0aW9uIChfdGVtcDIsIF90ZW1wMykge1xuICAgIHZhciBfZXh0ZW5kczM7XG4gICAgdmFyIF9yZWY0ID0gX3RlbXAyID09PSB2b2lkIDAgPyB7fSA6IF90ZW1wMixcbiAgICAgIF9yZWY0JHJlZktleSA9IF9yZWY0LnJlZktleSxcbiAgICAgIHJlZktleSA9IF9yZWY0JHJlZktleSA9PT0gdm9pZCAwID8gJ3JlZicgOiBfcmVmNCRyZWZLZXksXG4gICAgICByZWYgPSBfcmVmNC5yZWYsXG4gICAgICBvbktleURvd24gPSBfcmVmNC5vbktleURvd24sXG4gICAgICBvbkNsaWNrID0gX3JlZjQub25DbGljayxcbiAgICAgIF9yZWY0JHByZXZlbnRLZXlBY3RpbyA9IF9yZWY0LnByZXZlbnRLZXlBY3Rpb24sXG4gICAgICBwcmV2ZW50S2V5QWN0aW9uID0gX3JlZjQkcHJldmVudEtleUFjdGlvID09PSB2b2lkIDAgPyBmYWxzZSA6IF9yZWY0JHByZXZlbnRLZXlBY3RpbyxcbiAgICAgIHJlc3QgPSBfb2JqZWN0V2l0aG91dFByb3BlcnRpZXNMb29zZShfcmVmNCwgX2V4Y2x1ZGVkMik7XG4gICAgdmFyIF9yZWY1ID0gX3RlbXAzID09PSB2b2lkIDAgPyB7fSA6IF90ZW1wMyxcbiAgICAgIF9yZWY1JHN1cHByZXNzUmVmRXJybyA9IF9yZWY1LnN1cHByZXNzUmVmRXJyb3IsXG4gICAgICBzdXBwcmVzc1JlZkVycm9yID0gX3JlZjUkc3VwcHJlc3NSZWZFcnJvID09PSB2b2lkIDAgPyBmYWxzZSA6IF9yZWY1JHN1cHByZXNzUmVmRXJybztcbiAgICBzZXRHZXR0ZXJQcm9wQ2FsbEluZm8oJ2dldERyb3Bkb3duUHJvcHMnLCBzdXBwcmVzc1JlZkVycm9yLCByZWZLZXksIGRyb3Bkb3duUmVmKTtcbiAgICB2YXIgZHJvcGRvd25IYW5kbGVLZXlEb3duID0gZnVuY3Rpb24gZHJvcGRvd25IYW5kbGVLZXlEb3duKGV2ZW50KSB7XG4gICAgICB2YXIga2V5ID0gbm9ybWFsaXplQXJyb3dLZXkoZXZlbnQpO1xuICAgICAgaWYgKGtleSAmJiBkcm9wZG93bktleURvd25IYW5kbGVyc1trZXldKSB7XG4gICAgICAgIGRyb3Bkb3duS2V5RG93bkhhbmRsZXJzW2tleV0oZXZlbnQpO1xuICAgICAgfVxuICAgIH07XG4gICAgdmFyIGRyb3Bkb3duSGFuZGxlQ2xpY2sgPSBmdW5jdGlvbiBkcm9wZG93bkhhbmRsZUNsaWNrKCkge1xuICAgICAgZGlzcGF0Y2goe1xuICAgICAgICB0eXBlOiBEcm9wZG93bkNsaWNrXG4gICAgICB9KTtcbiAgICB9O1xuICAgIHJldHVybiBfZXh0ZW5kcygoX2V4dGVuZHMzID0ge30sIF9leHRlbmRzM1tyZWZLZXldID0gaGFuZGxlUmVmcyhyZWYsIGZ1bmN0aW9uIChkcm9wZG93bk5vZGUpIHtcbiAgICAgIGlmIChkcm9wZG93bk5vZGUpIHtcbiAgICAgICAgZHJvcGRvd25SZWYuY3VycmVudCA9IGRyb3Bkb3duTm9kZTtcbiAgICAgIH1cbiAgICB9KSwgX2V4dGVuZHMzKSwgIXByZXZlbnRLZXlBY3Rpb24gJiYge1xuICAgICAgb25LZXlEb3duOiBjYWxsQWxsRXZlbnRIYW5kbGVycyhvbktleURvd24sIGRyb3Bkb3duSGFuZGxlS2V5RG93biksXG4gICAgICBvbkNsaWNrOiBjYWxsQWxsRXZlbnRIYW5kbGVycyhvbkNsaWNrLCBkcm9wZG93bkhhbmRsZUNsaWNrKVxuICAgIH0sIHJlc3QpO1xuICB9LCBbZGlzcGF0Y2gsIGRyb3Bkb3duS2V5RG93bkhhbmRsZXJzLCBzZXRHZXR0ZXJQcm9wQ2FsbEluZm9dKTtcblxuICAvLyByZXR1cm5zXG4gIHZhciBhZGRTZWxlY3RlZEl0ZW0gPSB1c2VDYWxsYmFjayhmdW5jdGlvbiAoc2VsZWN0ZWRJdGVtKSB7XG4gICAgZGlzcGF0Y2goe1xuICAgICAgdHlwZTogRnVuY3Rpb25BZGRTZWxlY3RlZEl0ZW0sXG4gICAgICBzZWxlY3RlZEl0ZW06IHNlbGVjdGVkSXRlbVxuICAgIH0pO1xuICB9LCBbZGlzcGF0Y2hdKTtcbiAgdmFyIHJlbW92ZVNlbGVjdGVkSXRlbSA9IHVzZUNhbGxiYWNrKGZ1bmN0aW9uIChzZWxlY3RlZEl0ZW0pIHtcbiAgICBkaXNwYXRjaCh7XG4gICAgICB0eXBlOiBGdW5jdGlvblJlbW92ZVNlbGVjdGVkSXRlbSxcbiAgICAgIHNlbGVjdGVkSXRlbTogc2VsZWN0ZWRJdGVtXG4gICAgfSk7XG4gIH0sIFtkaXNwYXRjaF0pO1xuICB2YXIgc2V0U2VsZWN0ZWRJdGVtcyA9IHVzZUNhbGxiYWNrKGZ1bmN0aW9uIChuZXdTZWxlY3RlZEl0ZW1zKSB7XG4gICAgZGlzcGF0Y2goe1xuICAgICAgdHlwZTogRnVuY3Rpb25TZXRTZWxlY3RlZEl0ZW1zLFxuICAgICAgc2VsZWN0ZWRJdGVtczogbmV3U2VsZWN0ZWRJdGVtc1xuICAgIH0pO1xuICB9LCBbZGlzcGF0Y2hdKTtcbiAgdmFyIHNldEFjdGl2ZUluZGV4ID0gdXNlQ2FsbGJhY2soZnVuY3Rpb24gKG5ld0FjdGl2ZUluZGV4KSB7XG4gICAgZGlzcGF0Y2goe1xuICAgICAgdHlwZTogRnVuY3Rpb25TZXRBY3RpdmVJbmRleCxcbiAgICAgIGFjdGl2ZUluZGV4OiBuZXdBY3RpdmVJbmRleFxuICAgIH0pO1xuICB9LCBbZGlzcGF0Y2hdKTtcbiAgdmFyIHJlc2V0ID0gdXNlQ2FsbGJhY2soZnVuY3Rpb24gKCkge1xuICAgIGRpc3BhdGNoKHtcbiAgICAgIHR5cGU6IEZ1bmN0aW9uUmVzZXRcbiAgICB9KTtcbiAgfSwgW2Rpc3BhdGNoXSk7XG4gIHJldHVybiB7XG4gICAgZ2V0U2VsZWN0ZWRJdGVtUHJvcHM6IGdldFNlbGVjdGVkSXRlbVByb3BzLFxuICAgIGdldERyb3Bkb3duUHJvcHM6IGdldERyb3Bkb3duUHJvcHMsXG4gICAgYWRkU2VsZWN0ZWRJdGVtOiBhZGRTZWxlY3RlZEl0ZW0sXG4gICAgcmVtb3ZlU2VsZWN0ZWRJdGVtOiByZW1vdmVTZWxlY3RlZEl0ZW0sXG4gICAgc2V0U2VsZWN0ZWRJdGVtczogc2V0U2VsZWN0ZWRJdGVtcyxcbiAgICBzZXRBY3RpdmVJbmRleDogc2V0QWN0aXZlSW5kZXgsXG4gICAgcmVzZXQ6IHJlc2V0LFxuICAgIHNlbGVjdGVkSXRlbXM6IHNlbGVjdGVkSXRlbXMsXG4gICAgYWN0aXZlSW5kZXg6IGFjdGl2ZUluZGV4XG4gIH07XG59XG5cbmV4cG9ydCB7IERvd25zaGlmdCQxIGFzIGRlZmF1bHQsIHJlc2V0SWRDb3VudGVyLCB1c2VDb21ib2JveCwgdXNlTXVsdGlwbGVTZWxlY3Rpb24sIHVzZVNlbGVjdCB9O1xuIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./node_modules/downshift/dist/downshift.esm.js\n")},"./node_modules/downshift/node_modules/react-is/cjs/react-is.production.min.js":(__unused_webpack_module,exports)=>{eval('var __webpack_unused_export__;\n/**\n * @license React\n * react-is.production.min.js\n *\n * Copyright (c) Facebook, Inc. and its affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */\nvar b=Symbol.for("react.element"),c=Symbol.for("react.portal"),d=Symbol.for("react.fragment"),e=Symbol.for("react.strict_mode"),f=Symbol.for("react.profiler"),g=Symbol.for("react.provider"),h=Symbol.for("react.context"),k=Symbol.for("react.server_context"),l=Symbol.for("react.forward_ref"),m=Symbol.for("react.suspense"),n=Symbol.for("react.suspense_list"),p=Symbol.for("react.memo"),q=Symbol.for("react.lazy"),t=Symbol.for("react.offscreen"),u;u=Symbol.for("react.module.reference");\nfunction v(a){if("object"===typeof a&&null!==a){var r=a.$$typeof;switch(r){case b:switch(a=a.type,a){case d:case f:case e:case m:case n:return a;default:switch(a=a&&a.$$typeof,a){case k:case h:case l:case q:case p:case g:return a;default:return r}}case c:return r}}}__webpack_unused_export__=h;__webpack_unused_export__=g;__webpack_unused_export__=b;__webpack_unused_export__=l;__webpack_unused_export__=d;__webpack_unused_export__=q;__webpack_unused_export__=p;__webpack_unused_export__=c;__webpack_unused_export__=f;__webpack_unused_export__=e;__webpack_unused_export__=m;\n__webpack_unused_export__=n;__webpack_unused_export__=function(){return!1};__webpack_unused_export__=function(){return!1};__webpack_unused_export__=function(a){return v(a)===h};__webpack_unused_export__=function(a){return v(a)===g};__webpack_unused_export__=function(a){return"object"===typeof a&&null!==a&&a.$$typeof===b};__webpack_unused_export__=function(a){return v(a)===l};__webpack_unused_export__=function(a){return v(a)===d};__webpack_unused_export__=function(a){return v(a)===q};__webpack_unused_export__=function(a){return v(a)===p};\n__webpack_unused_export__=function(a){return v(a)===c};__webpack_unused_export__=function(a){return v(a)===f};__webpack_unused_export__=function(a){return v(a)===e};__webpack_unused_export__=function(a){return v(a)===m};__webpack_unused_export__=function(a){return v(a)===n};\n__webpack_unused_export__=function(a){return"string"===typeof a||"function"===typeof a||a===d||a===f||a===e||a===m||a===n||a===t||"object"===typeof a&&null!==a&&(a.$$typeof===q||a.$$typeof===p||a.$$typeof===g||a.$$typeof===h||a.$$typeof===l||a.$$typeof===u||void 0!==a.getModuleId)?!0:!1};__webpack_unused_export__=v;\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9ub2RlX21vZHVsZXMvZG93bnNoaWZ0L25vZGVfbW9kdWxlcy9yZWFjdC1pcy9janMvcmVhY3QtaXMucHJvZHVjdGlvbi5taW4uanMiLCJtYXBwaW5ncyI6IjtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9AZm9saW8vc3RyaXBlcy1jb21wb25lbnRzLy4vbm9kZV9tb2R1bGVzL2Rvd25zaGlmdC9ub2RlX21vZHVsZXMvcmVhY3QtaXMvY2pzL3JlYWN0LWlzLnByb2R1Y3Rpb24ubWluLmpzP2U1YTAiXSwic291cmNlc0NvbnRlbnQiOlsiLyoqXG4gKiBAbGljZW5zZSBSZWFjdFxuICogcmVhY3QtaXMucHJvZHVjdGlvbi5taW4uanNcbiAqXG4gKiBDb3B5cmlnaHQgKGMpIEZhY2Vib29rLCBJbmMuIGFuZCBpdHMgYWZmaWxpYXRlcy5cbiAqXG4gKiBUaGlzIHNvdXJjZSBjb2RlIGlzIGxpY2Vuc2VkIHVuZGVyIHRoZSBNSVQgbGljZW5zZSBmb3VuZCBpbiB0aGVcbiAqIExJQ0VOU0UgZmlsZSBpbiB0aGUgcm9vdCBkaXJlY3Rvcnkgb2YgdGhpcyBzb3VyY2UgdHJlZS5cbiAqL1xuJ3VzZSBzdHJpY3QnO3ZhciBiPVN5bWJvbC5mb3IoXCJyZWFjdC5lbGVtZW50XCIpLGM9U3ltYm9sLmZvcihcInJlYWN0LnBvcnRhbFwiKSxkPVN5bWJvbC5mb3IoXCJyZWFjdC5mcmFnbWVudFwiKSxlPVN5bWJvbC5mb3IoXCJyZWFjdC5zdHJpY3RfbW9kZVwiKSxmPVN5bWJvbC5mb3IoXCJyZWFjdC5wcm9maWxlclwiKSxnPVN5bWJvbC5mb3IoXCJyZWFjdC5wcm92aWRlclwiKSxoPVN5bWJvbC5mb3IoXCJyZWFjdC5jb250ZXh0XCIpLGs9U3ltYm9sLmZvcihcInJlYWN0LnNlcnZlcl9jb250ZXh0XCIpLGw9U3ltYm9sLmZvcihcInJlYWN0LmZvcndhcmRfcmVmXCIpLG09U3ltYm9sLmZvcihcInJlYWN0LnN1c3BlbnNlXCIpLG49U3ltYm9sLmZvcihcInJlYWN0LnN1c3BlbnNlX2xpc3RcIikscD1TeW1ib2wuZm9yKFwicmVhY3QubWVtb1wiKSxxPVN5bWJvbC5mb3IoXCJyZWFjdC5sYXp5XCIpLHQ9U3ltYm9sLmZvcihcInJlYWN0Lm9mZnNjcmVlblwiKSx1O3U9U3ltYm9sLmZvcihcInJlYWN0Lm1vZHVsZS5yZWZlcmVuY2VcIik7XG5mdW5jdGlvbiB2KGEpe2lmKFwib2JqZWN0XCI9PT10eXBlb2YgYSYmbnVsbCE9PWEpe3ZhciByPWEuJCR0eXBlb2Y7c3dpdGNoKHIpe2Nhc2UgYjpzd2l0Y2goYT1hLnR5cGUsYSl7Y2FzZSBkOmNhc2UgZjpjYXNlIGU6Y2FzZSBtOmNhc2UgbjpyZXR1cm4gYTtkZWZhdWx0OnN3aXRjaChhPWEmJmEuJCR0eXBlb2YsYSl7Y2FzZSBrOmNhc2UgaDpjYXNlIGw6Y2FzZSBxOmNhc2UgcDpjYXNlIGc6cmV0dXJuIGE7ZGVmYXVsdDpyZXR1cm4gcn19Y2FzZSBjOnJldHVybiByfX19ZXhwb3J0cy5Db250ZXh0Q29uc3VtZXI9aDtleHBvcnRzLkNvbnRleHRQcm92aWRlcj1nO2V4cG9ydHMuRWxlbWVudD1iO2V4cG9ydHMuRm9yd2FyZFJlZj1sO2V4cG9ydHMuRnJhZ21lbnQ9ZDtleHBvcnRzLkxhenk9cTtleHBvcnRzLk1lbW89cDtleHBvcnRzLlBvcnRhbD1jO2V4cG9ydHMuUHJvZmlsZXI9ZjtleHBvcnRzLlN0cmljdE1vZGU9ZTtleHBvcnRzLlN1c3BlbnNlPW07XG5leHBvcnRzLlN1c3BlbnNlTGlzdD1uO2V4cG9ydHMuaXNBc3luY01vZGU9ZnVuY3Rpb24oKXtyZXR1cm4hMX07ZXhwb3J0cy5pc0NvbmN1cnJlbnRNb2RlPWZ1bmN0aW9uKCl7cmV0dXJuITF9O2V4cG9ydHMuaXNDb250ZXh0Q29uc3VtZXI9ZnVuY3Rpb24oYSl7cmV0dXJuIHYoYSk9PT1ofTtleHBvcnRzLmlzQ29udGV4dFByb3ZpZGVyPWZ1bmN0aW9uKGEpe3JldHVybiB2KGEpPT09Z307ZXhwb3J0cy5pc0VsZW1lbnQ9ZnVuY3Rpb24oYSl7cmV0dXJuXCJvYmplY3RcIj09PXR5cGVvZiBhJiZudWxsIT09YSYmYS4kJHR5cGVvZj09PWJ9O2V4cG9ydHMuaXNGb3J3YXJkUmVmPWZ1bmN0aW9uKGEpe3JldHVybiB2KGEpPT09bH07ZXhwb3J0cy5pc0ZyYWdtZW50PWZ1bmN0aW9uKGEpe3JldHVybiB2KGEpPT09ZH07ZXhwb3J0cy5pc0xhenk9ZnVuY3Rpb24oYSl7cmV0dXJuIHYoYSk9PT1xfTtleHBvcnRzLmlzTWVtbz1mdW5jdGlvbihhKXtyZXR1cm4gdihhKT09PXB9O1xuZXhwb3J0cy5pc1BvcnRhbD1mdW5jdGlvbihhKXtyZXR1cm4gdihhKT09PWN9O2V4cG9ydHMuaXNQcm9maWxlcj1mdW5jdGlvbihhKXtyZXR1cm4gdihhKT09PWZ9O2V4cG9ydHMuaXNTdHJpY3RNb2RlPWZ1bmN0aW9uKGEpe3JldHVybiB2KGEpPT09ZX07ZXhwb3J0cy5pc1N1c3BlbnNlPWZ1bmN0aW9uKGEpe3JldHVybiB2KGEpPT09bX07ZXhwb3J0cy5pc1N1c3BlbnNlTGlzdD1mdW5jdGlvbihhKXtyZXR1cm4gdihhKT09PW59O1xuZXhwb3J0cy5pc1ZhbGlkRWxlbWVudFR5cGU9ZnVuY3Rpb24oYSl7cmV0dXJuXCJzdHJpbmdcIj09PXR5cGVvZiBhfHxcImZ1bmN0aW9uXCI9PT10eXBlb2YgYXx8YT09PWR8fGE9PT1mfHxhPT09ZXx8YT09PW18fGE9PT1ufHxhPT09dHx8XCJvYmplY3RcIj09PXR5cGVvZiBhJiZudWxsIT09YSYmKGEuJCR0eXBlb2Y9PT1xfHxhLiQkdHlwZW9mPT09cHx8YS4kJHR5cGVvZj09PWd8fGEuJCR0eXBlb2Y9PT1ofHxhLiQkdHlwZW9mPT09bHx8YS4kJHR5cGVvZj09PXV8fHZvaWQgMCE9PWEuZ2V0TW9kdWxlSWQpPyEwOiExfTtleHBvcnRzLnR5cGVPZj12O1xuIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./node_modules/downshift/node_modules/react-is/cjs/react-is.production.min.js\n')},"./node_modules/downshift/node_modules/react-is/index.js":(module,__unused_webpack_exports,__webpack_require__)=>{eval('\n\nif (true) {\n  /* unused reexport */ __webpack_require__("./node_modules/downshift/node_modules/react-is/cjs/react-is.production.min.js");\n} else {}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9ub2RlX21vZHVsZXMvZG93bnNoaWZ0L25vZGVfbW9kdWxlcy9yZWFjdC1pcy9pbmRleC5qcyIsIm1hcHBpbmdzIjoiQUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vQGZvbGlvL3N0cmlwZXMtY29tcG9uZW50cy8uL25vZGVfbW9kdWxlcy9kb3duc2hpZnQvbm9kZV9tb2R1bGVzL3JlYWN0LWlzL2luZGV4LmpzPzcwM2QiXSwic291cmNlc0NvbnRlbnQiOlsiJ3VzZSBzdHJpY3QnO1xuXG5pZiAocHJvY2Vzcy5lbnYuTk9ERV9FTlYgPT09ICdwcm9kdWN0aW9uJykge1xuICBtb2R1bGUuZXhwb3J0cyA9IHJlcXVpcmUoJy4vY2pzL3JlYWN0LWlzLnByb2R1Y3Rpb24ubWluLmpzJyk7XG59IGVsc2Uge1xuICBtb2R1bGUuZXhwb3J0cyA9IHJlcXVpcmUoJy4vY2pzL3JlYWN0LWlzLmRldmVsb3BtZW50LmpzJyk7XG59XG4iXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./node_modules/downshift/node_modules/react-is/index.js\n')},"./node_modules/prop-types-extra/lib/all.js":(module,exports,__webpack_require__)=>{eval('\n\nObject.defineProperty(exports, "__esModule", ({\n  value: true\n}));\nexports["default"] = all;\n\nvar _createChainableTypeChecker = __webpack_require__("./node_modules/prop-types-extra/lib/utils/createChainableTypeChecker.js");\n\nvar _createChainableTypeChecker2 = _interopRequireDefault(_createChainableTypeChecker);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction all() {\n  for (var _len = arguments.length, validators = Array(_len), _key = 0; _key < _len; _key++) {\n    validators[_key] = arguments[_key];\n  }\n\n  function allPropTypes() {\n    for (var _len2 = arguments.length, args = Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n      args[_key2] = arguments[_key2];\n    }\n\n    var error = null;\n\n    validators.forEach(function (validator) {\n      if (error != null) {\n        return;\n      }\n\n      var result = validator.apply(undefined, args);\n      if (result != null) {\n        error = result;\n      }\n    });\n\n    return error;\n  }\n\n  return (0, _createChainableTypeChecker2.default)(allPropTypes);\n}\nmodule.exports = exports[\'default\'];//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9ub2RlX21vZHVsZXMvcHJvcC10eXBlcy1leHRyYS9saWIvYWxsLmpzIiwibWFwcGluZ3MiOiJBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSIsInNvdXJjZXMiOlsid2VicGFjazovL0Bmb2xpby9zdHJpcGVzLWNvbXBvbmVudHMvLi9ub2RlX21vZHVsZXMvcHJvcC10eXBlcy1leHRyYS9saWIvYWxsLmpzPzJiZDQiXSwic291cmNlc0NvbnRlbnQiOlsiJ3VzZSBzdHJpY3QnO1xuXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcbiAgdmFsdWU6IHRydWVcbn0pO1xuZXhwb3J0cy5kZWZhdWx0ID0gYWxsO1xuXG52YXIgX2NyZWF0ZUNoYWluYWJsZVR5cGVDaGVja2VyID0gcmVxdWlyZSgnLi91dGlscy9jcmVhdGVDaGFpbmFibGVUeXBlQ2hlY2tlcicpO1xuXG52YXIgX2NyZWF0ZUNoYWluYWJsZVR5cGVDaGVja2VyMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2NyZWF0ZUNoYWluYWJsZVR5cGVDaGVja2VyKTtcblxuZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH1cblxuZnVuY3Rpb24gYWxsKCkge1xuICBmb3IgKHZhciBfbGVuID0gYXJndW1lbnRzLmxlbmd0aCwgdmFsaWRhdG9ycyA9IEFycmF5KF9sZW4pLCBfa2V5ID0gMDsgX2tleSA8IF9sZW47IF9rZXkrKykge1xuICAgIHZhbGlkYXRvcnNbX2tleV0gPSBhcmd1bWVudHNbX2tleV07XG4gIH1cblxuICBmdW5jdGlvbiBhbGxQcm9wVHlwZXMoKSB7XG4gICAgZm9yICh2YXIgX2xlbjIgPSBhcmd1bWVudHMubGVuZ3RoLCBhcmdzID0gQXJyYXkoX2xlbjIpLCBfa2V5MiA9IDA7IF9rZXkyIDwgX2xlbjI7IF9rZXkyKyspIHtcbiAgICAgIGFyZ3NbX2tleTJdID0gYXJndW1lbnRzW19rZXkyXTtcbiAgICB9XG5cbiAgICB2YXIgZXJyb3IgPSBudWxsO1xuXG4gICAgdmFsaWRhdG9ycy5mb3JFYWNoKGZ1bmN0aW9uICh2YWxpZGF0b3IpIHtcbiAgICAgIGlmIChlcnJvciAhPSBudWxsKSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cblxuICAgICAgdmFyIHJlc3VsdCA9IHZhbGlkYXRvci5hcHBseSh1bmRlZmluZWQsIGFyZ3MpO1xuICAgICAgaWYgKHJlc3VsdCAhPSBudWxsKSB7XG4gICAgICAgIGVycm9yID0gcmVzdWx0O1xuICAgICAgfVxuICAgIH0pO1xuXG4gICAgcmV0dXJuIGVycm9yO1xuICB9XG5cbiAgcmV0dXJuICgwLCBfY3JlYXRlQ2hhaW5hYmxlVHlwZUNoZWNrZXIyLmRlZmF1bHQpKGFsbFByb3BUeXBlcyk7XG59XG5tb2R1bGUuZXhwb3J0cyA9IGV4cG9ydHNbJ2RlZmF1bHQnXTsiXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./node_modules/prop-types-extra/lib/all.js\n')},"./node_modules/prop-types-extra/lib/componentOrElement.js":(module,exports,__webpack_require__)=>{eval("\n\nObject.defineProperty(exports, \"__esModule\", ({\n  value: true\n}));\n\nvar _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; };\n\nvar _react = __webpack_require__(\"./node_modules/react/index.js\");\n\nvar _react2 = _interopRequireDefault(_react);\n\nvar _createChainableTypeChecker = __webpack_require__(\"./node_modules/prop-types-extra/lib/utils/createChainableTypeChecker.js\");\n\nvar _createChainableTypeChecker2 = _interopRequireDefault(_createChainableTypeChecker);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction validate(props, propName, componentName, location, propFullName) {\n  var propValue = props[propName];\n  var propType = typeof propValue === 'undefined' ? 'undefined' : _typeof(propValue);\n\n  if (_react2.default.isValidElement(propValue)) {\n    return new Error('Invalid ' + location + ' `' + propFullName + '` of type ReactElement ' + ('supplied to `' + componentName + '`, expected a ReactComponent or a ') + 'DOMElement. You can usually obtain a ReactComponent or DOMElement ' + 'from a ReactElement by attaching a ref to it.');\n  }\n\n  if ((propType !== 'object' || typeof propValue.render !== 'function') && propValue.nodeType !== 1) {\n    return new Error('Invalid ' + location + ' `' + propFullName + '` of value `' + propValue + '` ' + ('supplied to `' + componentName + '`, expected a ReactComponent or a ') + 'DOMElement.');\n  }\n\n  return null;\n}\n\nexports[\"default\"] = (0, _createChainableTypeChecker2.default)(validate);\nmodule.exports = exports['default'];//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9ub2RlX21vZHVsZXMvcHJvcC10eXBlcy1leHRyYS9saWIvY29tcG9uZW50T3JFbGVtZW50LmpzIiwibWFwcGluZ3MiOiJBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9AZm9saW8vc3RyaXBlcy1jb21wb25lbnRzLy4vbm9kZV9tb2R1bGVzL3Byb3AtdHlwZXMtZXh0cmEvbGliL2NvbXBvbmVudE9yRWxlbWVudC5qcz85ZGUxIl0sInNvdXJjZXNDb250ZW50IjpbIid1c2Ugc3RyaWN0JztcblxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG4gIHZhbHVlOiB0cnVlXG59KTtcblxudmFyIF90eXBlb2YgPSB0eXBlb2YgU3ltYm9sID09PSBcImZ1bmN0aW9uXCIgJiYgdHlwZW9mIFN5bWJvbC5pdGVyYXRvciA9PT0gXCJzeW1ib2xcIiA/IGZ1bmN0aW9uIChvYmopIHsgcmV0dXJuIHR5cGVvZiBvYmo7IH0gOiBmdW5jdGlvbiAob2JqKSB7IHJldHVybiBvYmogJiYgdHlwZW9mIFN5bWJvbCA9PT0gXCJmdW5jdGlvblwiICYmIG9iai5jb25zdHJ1Y3RvciA9PT0gU3ltYm9sICYmIG9iaiAhPT0gU3ltYm9sLnByb3RvdHlwZSA/IFwic3ltYm9sXCIgOiB0eXBlb2Ygb2JqOyB9O1xuXG52YXIgX3JlYWN0ID0gcmVxdWlyZSgncmVhY3QnKTtcblxudmFyIF9yZWFjdDIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9yZWFjdCk7XG5cbnZhciBfY3JlYXRlQ2hhaW5hYmxlVHlwZUNoZWNrZXIgPSByZXF1aXJlKCcuL3V0aWxzL2NyZWF0ZUNoYWluYWJsZVR5cGVDaGVja2VyJyk7XG5cbnZhciBfY3JlYXRlQ2hhaW5hYmxlVHlwZUNoZWNrZXIyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfY3JlYXRlQ2hhaW5hYmxlVHlwZUNoZWNrZXIpO1xuXG5mdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyBkZWZhdWx0OiBvYmogfTsgfVxuXG5mdW5jdGlvbiB2YWxpZGF0ZShwcm9wcywgcHJvcE5hbWUsIGNvbXBvbmVudE5hbWUsIGxvY2F0aW9uLCBwcm9wRnVsbE5hbWUpIHtcbiAgdmFyIHByb3BWYWx1ZSA9IHByb3BzW3Byb3BOYW1lXTtcbiAgdmFyIHByb3BUeXBlID0gdHlwZW9mIHByb3BWYWx1ZSA9PT0gJ3VuZGVmaW5lZCcgPyAndW5kZWZpbmVkJyA6IF90eXBlb2YocHJvcFZhbHVlKTtcblxuICBpZiAoX3JlYWN0Mi5kZWZhdWx0LmlzVmFsaWRFbGVtZW50KHByb3BWYWx1ZSkpIHtcbiAgICByZXR1cm4gbmV3IEVycm9yKCdJbnZhbGlkICcgKyBsb2NhdGlvbiArICcgYCcgKyBwcm9wRnVsbE5hbWUgKyAnYCBvZiB0eXBlIFJlYWN0RWxlbWVudCAnICsgKCdzdXBwbGllZCB0byBgJyArIGNvbXBvbmVudE5hbWUgKyAnYCwgZXhwZWN0ZWQgYSBSZWFjdENvbXBvbmVudCBvciBhICcpICsgJ0RPTUVsZW1lbnQuIFlvdSBjYW4gdXN1YWxseSBvYnRhaW4gYSBSZWFjdENvbXBvbmVudCBvciBET01FbGVtZW50ICcgKyAnZnJvbSBhIFJlYWN0RWxlbWVudCBieSBhdHRhY2hpbmcgYSByZWYgdG8gaXQuJyk7XG4gIH1cblxuICBpZiAoKHByb3BUeXBlICE9PSAnb2JqZWN0JyB8fCB0eXBlb2YgcHJvcFZhbHVlLnJlbmRlciAhPT0gJ2Z1bmN0aW9uJykgJiYgcHJvcFZhbHVlLm5vZGVUeXBlICE9PSAxKSB7XG4gICAgcmV0dXJuIG5ldyBFcnJvcignSW52YWxpZCAnICsgbG9jYXRpb24gKyAnIGAnICsgcHJvcEZ1bGxOYW1lICsgJ2Agb2YgdmFsdWUgYCcgKyBwcm9wVmFsdWUgKyAnYCAnICsgKCdzdXBwbGllZCB0byBgJyArIGNvbXBvbmVudE5hbWUgKyAnYCwgZXhwZWN0ZWQgYSBSZWFjdENvbXBvbmVudCBvciBhICcpICsgJ0RPTUVsZW1lbnQuJyk7XG4gIH1cblxuICByZXR1cm4gbnVsbDtcbn1cblxuZXhwb3J0cy5kZWZhdWx0ID0gKDAsIF9jcmVhdGVDaGFpbmFibGVUeXBlQ2hlY2tlcjIuZGVmYXVsdCkodmFsaWRhdGUpO1xubW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107Il0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./node_modules/prop-types-extra/lib/componentOrElement.js\n")},"./node_modules/prop-types-extra/lib/deprecated.js":(module,exports,__webpack_require__)=>{eval("\n\nObject.defineProperty(exports, \"__esModule\", ({\n  value: true\n}));\nexports[\"default\"] = deprecated;\n\nvar _warning = __webpack_require__(\"./node_modules/warning/warning.js\");\n\nvar _warning2 = _interopRequireDefault(_warning);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nvar warned = {};\n\nfunction deprecated(validator, reason) {\n  return function validate(props, propName, componentName, location, propFullName) {\n    var componentNameSafe = componentName || '<<anonymous>>';\n    var propFullNameSafe = propFullName || propName;\n\n    if (props[propName] != null) {\n      var messageKey = componentName + '.' + propName;\n\n      (0, _warning2.default)(warned[messageKey], 'The ' + location + ' `' + propFullNameSafe + '` of ' + ('`' + componentNameSafe + '` is deprecated. ' + reason + '.'));\n\n      warned[messageKey] = true;\n    }\n\n    for (var _len = arguments.length, args = Array(_len > 5 ? _len - 5 : 0), _key = 5; _key < _len; _key++) {\n      args[_key - 5] = arguments[_key];\n    }\n\n    return validator.apply(undefined, [props, propName, componentName, location, propFullName].concat(args));\n  };\n}\n\n/* eslint-disable no-underscore-dangle */\nfunction _resetWarned() {\n  warned = {};\n}\n\ndeprecated._resetWarned = _resetWarned;\n/* eslint-enable no-underscore-dangle */\n\nmodule.exports = exports['default'];//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9ub2RlX21vZHVsZXMvcHJvcC10eXBlcy1leHRyYS9saWIvZGVwcmVjYXRlZC5qcyIsIm1hcHBpbmdzIjoiQUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9AZm9saW8vc3RyaXBlcy1jb21wb25lbnRzLy4vbm9kZV9tb2R1bGVzL3Byb3AtdHlwZXMtZXh0cmEvbGliL2RlcHJlY2F0ZWQuanM/ZjQ4ZiJdLCJzb3VyY2VzQ29udGVudCI6WyIndXNlIHN0cmljdCc7XG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICB2YWx1ZTogdHJ1ZVxufSk7XG5leHBvcnRzLmRlZmF1bHQgPSBkZXByZWNhdGVkO1xuXG52YXIgX3dhcm5pbmcgPSByZXF1aXJlKCd3YXJuaW5nJyk7XG5cbnZhciBfd2FybmluZzIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF93YXJuaW5nKTtcblxuZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH1cblxudmFyIHdhcm5lZCA9IHt9O1xuXG5mdW5jdGlvbiBkZXByZWNhdGVkKHZhbGlkYXRvciwgcmVhc29uKSB7XG4gIHJldHVybiBmdW5jdGlvbiB2YWxpZGF0ZShwcm9wcywgcHJvcE5hbWUsIGNvbXBvbmVudE5hbWUsIGxvY2F0aW9uLCBwcm9wRnVsbE5hbWUpIHtcbiAgICB2YXIgY29tcG9uZW50TmFtZVNhZmUgPSBjb21wb25lbnROYW1lIHx8ICc8PGFub255bW91cz4+JztcbiAgICB2YXIgcHJvcEZ1bGxOYW1lU2FmZSA9IHByb3BGdWxsTmFtZSB8fCBwcm9wTmFtZTtcblxuICAgIGlmIChwcm9wc1twcm9wTmFtZV0gIT0gbnVsbCkge1xuICAgICAgdmFyIG1lc3NhZ2VLZXkgPSBjb21wb25lbnROYW1lICsgJy4nICsgcHJvcE5hbWU7XG5cbiAgICAgICgwLCBfd2FybmluZzIuZGVmYXVsdCkod2FybmVkW21lc3NhZ2VLZXldLCAnVGhlICcgKyBsb2NhdGlvbiArICcgYCcgKyBwcm9wRnVsbE5hbWVTYWZlICsgJ2Agb2YgJyArICgnYCcgKyBjb21wb25lbnROYW1lU2FmZSArICdgIGlzIGRlcHJlY2F0ZWQuICcgKyByZWFzb24gKyAnLicpKTtcblxuICAgICAgd2FybmVkW21lc3NhZ2VLZXldID0gdHJ1ZTtcbiAgICB9XG5cbiAgICBmb3IgKHZhciBfbGVuID0gYXJndW1lbnRzLmxlbmd0aCwgYXJncyA9IEFycmF5KF9sZW4gPiA1ID8gX2xlbiAtIDUgOiAwKSwgX2tleSA9IDU7IF9rZXkgPCBfbGVuOyBfa2V5KyspIHtcbiAgICAgIGFyZ3NbX2tleSAtIDVdID0gYXJndW1lbnRzW19rZXldO1xuICAgIH1cblxuICAgIHJldHVybiB2YWxpZGF0b3IuYXBwbHkodW5kZWZpbmVkLCBbcHJvcHMsIHByb3BOYW1lLCBjb21wb25lbnROYW1lLCBsb2NhdGlvbiwgcHJvcEZ1bGxOYW1lXS5jb25jYXQoYXJncykpO1xuICB9O1xufVxuXG4vKiBlc2xpbnQtZGlzYWJsZSBuby11bmRlcnNjb3JlLWRhbmdsZSAqL1xuZnVuY3Rpb24gX3Jlc2V0V2FybmVkKCkge1xuICB3YXJuZWQgPSB7fTtcbn1cblxuZGVwcmVjYXRlZC5fcmVzZXRXYXJuZWQgPSBfcmVzZXRXYXJuZWQ7XG4vKiBlc2xpbnQtZW5hYmxlIG5vLXVuZGVyc2NvcmUtZGFuZ2xlICovXG5cbm1vZHVsZS5leHBvcnRzID0gZXhwb3J0c1snZGVmYXVsdCddOyJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./node_modules/prop-types-extra/lib/deprecated.js\n")},"./node_modules/prop-types-extra/lib/elementType.js":(module,exports,__webpack_require__)=>{eval("\n\nObject.defineProperty(exports, \"__esModule\", ({\n  value: true\n}));\n\nvar _react = __webpack_require__(\"./node_modules/react/index.js\");\n\nvar _react2 = _interopRequireDefault(_react);\n\nvar _reactIs = __webpack_require__(\"./node_modules/react-is/index.js\");\n\nvar _createChainableTypeChecker = __webpack_require__(\"./node_modules/prop-types-extra/lib/utils/createChainableTypeChecker.js\");\n\nvar _createChainableTypeChecker2 = _interopRequireDefault(_createChainableTypeChecker);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction elementType(props, propName, componentName, location, propFullName) {\n  var propValue = props[propName];\n\n  if (_react2.default.isValidElement(propValue)) {\n    return new Error('Invalid ' + location + ' `' + propFullName + '` of type ReactElement ' + ('supplied to `' + componentName + '`,expected an element type (a string ') + ', component class, or function component).');\n  }\n\n  if (!(0, _reactIs.isValidElementType)(propValue)) {\n    return new Error('Invalid ' + location + ' `' + propFullName + '` of value `' + propValue + '` ' + ('supplied to `' + componentName + '`, expected an element type (a string ') + ', component class, or function component).');\n  }\n\n  return null;\n}\n\nexports[\"default\"] = (0, _createChainableTypeChecker2.default)(elementType);\nmodule.exports = exports['default'];//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9ub2RlX21vZHVsZXMvcHJvcC10eXBlcy1leHRyYS9saWIvZWxlbWVudFR5cGUuanMiLCJtYXBwaW5ncyI6IkFBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9AZm9saW8vc3RyaXBlcy1jb21wb25lbnRzLy4vbm9kZV9tb2R1bGVzL3Byb3AtdHlwZXMtZXh0cmEvbGliL2VsZW1lbnRUeXBlLmpzPzA0NmMiXSwic291cmNlc0NvbnRlbnQiOlsiJ3VzZSBzdHJpY3QnO1xuXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcbiAgdmFsdWU6IHRydWVcbn0pO1xuXG52YXIgX3JlYWN0ID0gcmVxdWlyZSgncmVhY3QnKTtcblxudmFyIF9yZWFjdDIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9yZWFjdCk7XG5cbnZhciBfcmVhY3RJcyA9IHJlcXVpcmUoJ3JlYWN0LWlzJyk7XG5cbnZhciBfY3JlYXRlQ2hhaW5hYmxlVHlwZUNoZWNrZXIgPSByZXF1aXJlKCcuL3V0aWxzL2NyZWF0ZUNoYWluYWJsZVR5cGVDaGVja2VyJyk7XG5cbnZhciBfY3JlYXRlQ2hhaW5hYmxlVHlwZUNoZWNrZXIyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfY3JlYXRlQ2hhaW5hYmxlVHlwZUNoZWNrZXIpO1xuXG5mdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyBkZWZhdWx0OiBvYmogfTsgfVxuXG5mdW5jdGlvbiBlbGVtZW50VHlwZShwcm9wcywgcHJvcE5hbWUsIGNvbXBvbmVudE5hbWUsIGxvY2F0aW9uLCBwcm9wRnVsbE5hbWUpIHtcbiAgdmFyIHByb3BWYWx1ZSA9IHByb3BzW3Byb3BOYW1lXTtcblxuICBpZiAoX3JlYWN0Mi5kZWZhdWx0LmlzVmFsaWRFbGVtZW50KHByb3BWYWx1ZSkpIHtcbiAgICByZXR1cm4gbmV3IEVycm9yKCdJbnZhbGlkICcgKyBsb2NhdGlvbiArICcgYCcgKyBwcm9wRnVsbE5hbWUgKyAnYCBvZiB0eXBlIFJlYWN0RWxlbWVudCAnICsgKCdzdXBwbGllZCB0byBgJyArIGNvbXBvbmVudE5hbWUgKyAnYCxleHBlY3RlZCBhbiBlbGVtZW50IHR5cGUgKGEgc3RyaW5nICcpICsgJywgY29tcG9uZW50IGNsYXNzLCBvciBmdW5jdGlvbiBjb21wb25lbnQpLicpO1xuICB9XG5cbiAgaWYgKCEoMCwgX3JlYWN0SXMuaXNWYWxpZEVsZW1lbnRUeXBlKShwcm9wVmFsdWUpKSB7XG4gICAgcmV0dXJuIG5ldyBFcnJvcignSW52YWxpZCAnICsgbG9jYXRpb24gKyAnIGAnICsgcHJvcEZ1bGxOYW1lICsgJ2Agb2YgdmFsdWUgYCcgKyBwcm9wVmFsdWUgKyAnYCAnICsgKCdzdXBwbGllZCB0byBgJyArIGNvbXBvbmVudE5hbWUgKyAnYCwgZXhwZWN0ZWQgYW4gZWxlbWVudCB0eXBlIChhIHN0cmluZyAnKSArICcsIGNvbXBvbmVudCBjbGFzcywgb3IgZnVuY3Rpb24gY29tcG9uZW50KS4nKTtcbiAgfVxuXG4gIHJldHVybiBudWxsO1xufVxuXG5leHBvcnRzLmRlZmF1bHQgPSAoMCwgX2NyZWF0ZUNoYWluYWJsZVR5cGVDaGVja2VyMi5kZWZhdWx0KShlbGVtZW50VHlwZSk7XG5tb2R1bGUuZXhwb3J0cyA9IGV4cG9ydHNbJ2RlZmF1bHQnXTsiXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./node_modules/prop-types-extra/lib/elementType.js\n")},"./node_modules/prop-types-extra/lib/index.js":(__unused_webpack_module,exports,__webpack_require__)=>{eval('var __webpack_unused_export__;\n\n\n__webpack_unused_export__ = ({\n  value: true\n});\n__webpack_unused_export__ = __webpack_unused_export__ = exports.io = __webpack_unused_export__ = __webpack_unused_export__ = undefined;\n\nvar _all = __webpack_require__("./node_modules/prop-types-extra/lib/all.js");\n\nvar _all2 = _interopRequireDefault(_all);\n\nvar _componentOrElement = __webpack_require__("./node_modules/prop-types-extra/lib/componentOrElement.js");\n\nvar _componentOrElement2 = _interopRequireDefault(_componentOrElement);\n\nvar _deprecated = __webpack_require__("./node_modules/prop-types-extra/lib/deprecated.js");\n\nvar _deprecated2 = _interopRequireDefault(_deprecated);\n\nvar _elementType = __webpack_require__("./node_modules/prop-types-extra/lib/elementType.js");\n\nvar _elementType2 = _interopRequireDefault(_elementType);\n\nvar _isRequiredForA11y = __webpack_require__("./node_modules/prop-types-extra/lib/isRequiredForA11y.js");\n\nvar _isRequiredForA11y2 = _interopRequireDefault(_isRequiredForA11y);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n__webpack_unused_export__ = _all2.default;\n__webpack_unused_export__ = _componentOrElement2.default;\nexports.io = _deprecated2.default;\n__webpack_unused_export__ = _elementType2.default;\n__webpack_unused_export__ = _isRequiredForA11y2.default;//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9ub2RlX21vZHVsZXMvcHJvcC10eXBlcy1leHRyYS9saWIvaW5kZXguanMiLCJtYXBwaW5ncyI6IjtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vQGZvbGlvL3N0cmlwZXMtY29tcG9uZW50cy8uL25vZGVfbW9kdWxlcy9wcm9wLXR5cGVzLWV4dHJhL2xpYi9pbmRleC5qcz8xZmFkIl0sInNvdXJjZXNDb250ZW50IjpbIid1c2Ugc3RyaWN0JztcblxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG4gIHZhbHVlOiB0cnVlXG59KTtcbmV4cG9ydHMuaXNSZXF1aXJlZEZvckExMXkgPSBleHBvcnRzLmVsZW1lbnRUeXBlID0gZXhwb3J0cy5kZXByZWNhdGVkID0gZXhwb3J0cy5jb21wb25lbnRPckVsZW1lbnQgPSBleHBvcnRzLmFsbCA9IHVuZGVmaW5lZDtcblxudmFyIF9hbGwgPSByZXF1aXJlKCcuL2FsbCcpO1xuXG52YXIgX2FsbDIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9hbGwpO1xuXG52YXIgX2NvbXBvbmVudE9yRWxlbWVudCA9IHJlcXVpcmUoJy4vY29tcG9uZW50T3JFbGVtZW50Jyk7XG5cbnZhciBfY29tcG9uZW50T3JFbGVtZW50MiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2NvbXBvbmVudE9yRWxlbWVudCk7XG5cbnZhciBfZGVwcmVjYXRlZCA9IHJlcXVpcmUoJy4vZGVwcmVjYXRlZCcpO1xuXG52YXIgX2RlcHJlY2F0ZWQyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfZGVwcmVjYXRlZCk7XG5cbnZhciBfZWxlbWVudFR5cGUgPSByZXF1aXJlKCcuL2VsZW1lbnRUeXBlJyk7XG5cbnZhciBfZWxlbWVudFR5cGUyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfZWxlbWVudFR5cGUpO1xuXG52YXIgX2lzUmVxdWlyZWRGb3JBMTF5ID0gcmVxdWlyZSgnLi9pc1JlcXVpcmVkRm9yQTExeScpO1xuXG52YXIgX2lzUmVxdWlyZWRGb3JBMTF5MiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2lzUmVxdWlyZWRGb3JBMTF5KTtcblxuZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH1cblxuZXhwb3J0cy5hbGwgPSBfYWxsMi5kZWZhdWx0O1xuZXhwb3J0cy5jb21wb25lbnRPckVsZW1lbnQgPSBfY29tcG9uZW50T3JFbGVtZW50Mi5kZWZhdWx0O1xuZXhwb3J0cy5kZXByZWNhdGVkID0gX2RlcHJlY2F0ZWQyLmRlZmF1bHQ7XG5leHBvcnRzLmVsZW1lbnRUeXBlID0gX2VsZW1lbnRUeXBlMi5kZWZhdWx0O1xuZXhwb3J0cy5pc1JlcXVpcmVkRm9yQTExeSA9IF9pc1JlcXVpcmVkRm9yQTExeTIuZGVmYXVsdDsiXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./node_modules/prop-types-extra/lib/index.js\n')},"./node_modules/prop-types-extra/lib/isRequiredForA11y.js":(module,exports)=>{eval("\n\nObject.defineProperty(exports, \"__esModule\", ({\n  value: true\n}));\nexports[\"default\"] = isRequiredForA11y;\nfunction isRequiredForA11y(validator) {\n  return function validate(props, propName, componentName, location, propFullName) {\n    var componentNameSafe = componentName || '<<anonymous>>';\n    var propFullNameSafe = propFullName || propName;\n\n    if (props[propName] == null) {\n      return new Error('The ' + location + ' `' + propFullNameSafe + '` is required to make ' + ('`' + componentNameSafe + '` accessible for users of assistive ') + 'technologies such as screen readers.');\n    }\n\n    for (var _len = arguments.length, args = Array(_len > 5 ? _len - 5 : 0), _key = 5; _key < _len; _key++) {\n      args[_key - 5] = arguments[_key];\n    }\n\n    return validator.apply(undefined, [props, propName, componentName, location, propFullName].concat(args));\n  };\n}\nmodule.exports = exports['default'];//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9ub2RlX21vZHVsZXMvcHJvcC10eXBlcy1leHRyYS9saWIvaXNSZXF1aXJlZEZvckExMXkuanMiLCJtYXBwaW5ncyI6IkFBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSIsInNvdXJjZXMiOlsid2VicGFjazovL0Bmb2xpby9zdHJpcGVzLWNvbXBvbmVudHMvLi9ub2RlX21vZHVsZXMvcHJvcC10eXBlcy1leHRyYS9saWIvaXNSZXF1aXJlZEZvckExMXkuanM/MDRlZiJdLCJzb3VyY2VzQ29udGVudCI6WyIndXNlIHN0cmljdCc7XG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICB2YWx1ZTogdHJ1ZVxufSk7XG5leHBvcnRzLmRlZmF1bHQgPSBpc1JlcXVpcmVkRm9yQTExeTtcbmZ1bmN0aW9uIGlzUmVxdWlyZWRGb3JBMTF5KHZhbGlkYXRvcikge1xuICByZXR1cm4gZnVuY3Rpb24gdmFsaWRhdGUocHJvcHMsIHByb3BOYW1lLCBjb21wb25lbnROYW1lLCBsb2NhdGlvbiwgcHJvcEZ1bGxOYW1lKSB7XG4gICAgdmFyIGNvbXBvbmVudE5hbWVTYWZlID0gY29tcG9uZW50TmFtZSB8fCAnPDxhbm9ueW1vdXM+Pic7XG4gICAgdmFyIHByb3BGdWxsTmFtZVNhZmUgPSBwcm9wRnVsbE5hbWUgfHwgcHJvcE5hbWU7XG5cbiAgICBpZiAocHJvcHNbcHJvcE5hbWVdID09IG51bGwpIHtcbiAgICAgIHJldHVybiBuZXcgRXJyb3IoJ1RoZSAnICsgbG9jYXRpb24gKyAnIGAnICsgcHJvcEZ1bGxOYW1lU2FmZSArICdgIGlzIHJlcXVpcmVkIHRvIG1ha2UgJyArICgnYCcgKyBjb21wb25lbnROYW1lU2FmZSArICdgIGFjY2Vzc2libGUgZm9yIHVzZXJzIG9mIGFzc2lzdGl2ZSAnKSArICd0ZWNobm9sb2dpZXMgc3VjaCBhcyBzY3JlZW4gcmVhZGVycy4nKTtcbiAgICB9XG5cbiAgICBmb3IgKHZhciBfbGVuID0gYXJndW1lbnRzLmxlbmd0aCwgYXJncyA9IEFycmF5KF9sZW4gPiA1ID8gX2xlbiAtIDUgOiAwKSwgX2tleSA9IDU7IF9rZXkgPCBfbGVuOyBfa2V5KyspIHtcbiAgICAgIGFyZ3NbX2tleSAtIDVdID0gYXJndW1lbnRzW19rZXldO1xuICAgIH1cblxuICAgIHJldHVybiB2YWxpZGF0b3IuYXBwbHkodW5kZWZpbmVkLCBbcHJvcHMsIHByb3BOYW1lLCBjb21wb25lbnROYW1lLCBsb2NhdGlvbiwgcHJvcEZ1bGxOYW1lXS5jb25jYXQoYXJncykpO1xuICB9O1xufVxubW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107Il0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./node_modules/prop-types-extra/lib/isRequiredForA11y.js\n")},"./node_modules/prop-types-extra/lib/utils/createChainableTypeChecker.js":(module,exports)=>{eval("\n\nObject.defineProperty(exports, \"__esModule\", ({\n  value: true\n}));\nexports[\"default\"] = createChainableTypeChecker;\n/**\n * Copyright 2013-present, Facebook, Inc.\n * All rights reserved.\n *\n * This source code is licensed under the BSD-style license found in the\n * LICENSE file in the root directory of this source tree. An additional grant\n * of patent rights can be found in the PATENTS file in the same directory.\n */\n\n// Mostly taken from ReactPropTypes.\n\nfunction createChainableTypeChecker(validate) {\n  function checkType(isRequired, props, propName, componentName, location, propFullName) {\n    var componentNameSafe = componentName || '<<anonymous>>';\n    var propFullNameSafe = propFullName || propName;\n\n    if (props[propName] == null) {\n      if (isRequired) {\n        return new Error('Required ' + location + ' `' + propFullNameSafe + '` was not specified ' + ('in `' + componentNameSafe + '`.'));\n      }\n\n      return null;\n    }\n\n    for (var _len = arguments.length, args = Array(_len > 6 ? _len - 6 : 0), _key = 6; _key < _len; _key++) {\n      args[_key - 6] = arguments[_key];\n    }\n\n    return validate.apply(undefined, [props, propName, componentNameSafe, location, propFullNameSafe].concat(args));\n  }\n\n  var chainedCheckType = checkType.bind(null, false);\n  chainedCheckType.isRequired = checkType.bind(null, true);\n\n  return chainedCheckType;\n}\nmodule.exports = exports['default'];//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9ub2RlX21vZHVsZXMvcHJvcC10eXBlcy1leHRyYS9saWIvdXRpbHMvY3JlYXRlQ2hhaW5hYmxlVHlwZUNoZWNrZXIuanMiLCJtYXBwaW5ncyI6IkFBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9AZm9saW8vc3RyaXBlcy1jb21wb25lbnRzLy4vbm9kZV9tb2R1bGVzL3Byb3AtdHlwZXMtZXh0cmEvbGliL3V0aWxzL2NyZWF0ZUNoYWluYWJsZVR5cGVDaGVja2VyLmpzP2E2ZjIiXSwic291cmNlc0NvbnRlbnQiOlsiJ3VzZSBzdHJpY3QnO1xuXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcbiAgdmFsdWU6IHRydWVcbn0pO1xuZXhwb3J0cy5kZWZhdWx0ID0gY3JlYXRlQ2hhaW5hYmxlVHlwZUNoZWNrZXI7XG4vKipcbiAqIENvcHlyaWdodCAyMDEzLXByZXNlbnQsIEZhY2Vib29rLCBJbmMuXG4gKiBBbGwgcmlnaHRzIHJlc2VydmVkLlxuICpcbiAqIFRoaXMgc291cmNlIGNvZGUgaXMgbGljZW5zZWQgdW5kZXIgdGhlIEJTRC1zdHlsZSBsaWNlbnNlIGZvdW5kIGluIHRoZVxuICogTElDRU5TRSBmaWxlIGluIHRoZSByb290IGRpcmVjdG9yeSBvZiB0aGlzIHNvdXJjZSB0cmVlLiBBbiBhZGRpdGlvbmFsIGdyYW50XG4gKiBvZiBwYXRlbnQgcmlnaHRzIGNhbiBiZSBmb3VuZCBpbiB0aGUgUEFURU5UUyBmaWxlIGluIHRoZSBzYW1lIGRpcmVjdG9yeS5cbiAqL1xuXG4vLyBNb3N0bHkgdGFrZW4gZnJvbSBSZWFjdFByb3BUeXBlcy5cblxuZnVuY3Rpb24gY3JlYXRlQ2hhaW5hYmxlVHlwZUNoZWNrZXIodmFsaWRhdGUpIHtcbiAgZnVuY3Rpb24gY2hlY2tUeXBlKGlzUmVxdWlyZWQsIHByb3BzLCBwcm9wTmFtZSwgY29tcG9uZW50TmFtZSwgbG9jYXRpb24sIHByb3BGdWxsTmFtZSkge1xuICAgIHZhciBjb21wb25lbnROYW1lU2FmZSA9IGNvbXBvbmVudE5hbWUgfHwgJzw8YW5vbnltb3VzPj4nO1xuICAgIHZhciBwcm9wRnVsbE5hbWVTYWZlID0gcHJvcEZ1bGxOYW1lIHx8IHByb3BOYW1lO1xuXG4gICAgaWYgKHByb3BzW3Byb3BOYW1lXSA9PSBudWxsKSB7XG4gICAgICBpZiAoaXNSZXF1aXJlZCkge1xuICAgICAgICByZXR1cm4gbmV3IEVycm9yKCdSZXF1aXJlZCAnICsgbG9jYXRpb24gKyAnIGAnICsgcHJvcEZ1bGxOYW1lU2FmZSArICdgIHdhcyBub3Qgc3BlY2lmaWVkICcgKyAoJ2luIGAnICsgY29tcG9uZW50TmFtZVNhZmUgKyAnYC4nKSk7XG4gICAgICB9XG5cbiAgICAgIHJldHVybiBudWxsO1xuICAgIH1cblxuICAgIGZvciAodmFyIF9sZW4gPSBhcmd1bWVudHMubGVuZ3RoLCBhcmdzID0gQXJyYXkoX2xlbiA+IDYgPyBfbGVuIC0gNiA6IDApLCBfa2V5ID0gNjsgX2tleSA8IF9sZW47IF9rZXkrKykge1xuICAgICAgYXJnc1tfa2V5IC0gNl0gPSBhcmd1bWVudHNbX2tleV07XG4gICAgfVxuXG4gICAgcmV0dXJuIHZhbGlkYXRlLmFwcGx5KHVuZGVmaW5lZCwgW3Byb3BzLCBwcm9wTmFtZSwgY29tcG9uZW50TmFtZVNhZmUsIGxvY2F0aW9uLCBwcm9wRnVsbE5hbWVTYWZlXS5jb25jYXQoYXJncykpO1xuICB9XG5cbiAgdmFyIGNoYWluZWRDaGVja1R5cGUgPSBjaGVja1R5cGUuYmluZChudWxsLCBmYWxzZSk7XG4gIGNoYWluZWRDaGVja1R5cGUuaXNSZXF1aXJlZCA9IGNoZWNrVHlwZS5iaW5kKG51bGwsIHRydWUpO1xuXG4gIHJldHVybiBjaGFpbmVkQ2hlY2tUeXBlO1xufVxubW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107Il0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./node_modules/prop-types-extra/lib/utils/createChainableTypeChecker.js\n")}}]);